clusterUpOptional[{finalConfigurationconf=newHdfsConfiguration();cluster=newMiniDFSCluster.Builder(conf).numDataNodes(3).build();cluster.waitActive();}]
simpleReadAfterWriteOptional[{LOG.info("Testingread-after-writewithFSimplementation:{}",fs);finalPathpath=newPath(TEST_PATH,FILENAME);if(!fs.mkdirs(path.getParent())){thrownewIOException("Mkdirsfailedtocreate"+TEST_PATH);}try(FSDataOutputStreamout=fs.create(path)){out.writeUTF(TEXT);}try(FSDataInputStreamin=fs.open(path)){finalStringresult=in.readUTF();Assert.assertEquals("Didn'treadbacktextwewrote.",TEXT,result);}}]
clusterDownOptional[{if(cluster!=null){cluster.close();}}]
