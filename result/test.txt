public String create(PipelineOptions options)
{    return options.getJobName().replace('-', '_');}
0
public String create(PipelineOptions options)
{    return "projects/" + options.as(GcpOptions.class).getProject() + "/subscriptions/" + options.getJobName();}
0
public String create(PipelineOptions options)
{    return "projects/" + options.as(GcpOptions.class).getProject() + "/topics/" + options.getJobName();}
0
public void setup() throws IOException
{    Sleeper sleeper = Sleeper.DEFAULT;    BackOff backOff = FluentBackoff.DEFAULT.withMaxRetries(3).withInitialBackoff(Duration.millis(200)).backoff();    Throwable lastException = null;    try {        do {            try {                setupPubsub();                setupBigQueryTable();                return;            } catch (GoogleJsonResponseException e) {                lastException = e;            }        } while (BackOffUtils.next(sleeper, backOff));    } catch (InterruptedException e) {        Thread.currentThread().interrupt();        }    throw new RuntimeException(lastException);}
1
public void setupPubsub() throws IOException
{    ExamplePubsubTopicAndSubscriptionOptions pubsubOptions = options.as(ExamplePubsubTopicAndSubscriptionOptions.class);    if (!pubsubOptions.getPubsubTopic().isEmpty()) {        pendingMessages.add("**********************Set Up Pubsub************************");        setupPubsubTopic(pubsubOptions.getPubsubTopic());        pendingMessages.add("The Pub/Sub topic has been set up for this example: " + pubsubOptions.getPubsubTopic());        if (!pubsubOptions.getPubsubSubscription().isEmpty()) {            setupPubsubSubscription(pubsubOptions.getPubsubTopic(), pubsubOptions.getPubsubSubscription());            pendingMessages.add("The Pub/Sub subscription has been set up for this example: " + pubsubOptions.getPubsubSubscription());        }    }}
0
public void setupBigQueryTable() throws IOException
{    ExampleBigQueryTableOptions bigQueryTableOptions = options.as(ExampleBigQueryTableOptions.class);    if (bigQueryTableOptions.getBigQueryDataset() != null && bigQueryTableOptions.getBigQueryTable() != null && bigQueryTableOptions.getBigQuerySchema() != null) {        pendingMessages.add("******************Set Up Big Query Table*******************");        setupBigQueryTable(bigQueryTableOptions.getProject(), bigQueryTableOptions.getBigQueryDataset(), bigQueryTableOptions.getBigQueryTable(), bigQueryTableOptions.getBigQuerySchema());        pendingMessages.add("The BigQuery table has been set up for this example: " + bigQueryTableOptions.getProject() + ":" + bigQueryTableOptions.getBigQueryDataset() + "." + bigQueryTableOptions.getBigQueryTable());    }}
1
private void tearDown()
{    pendingMessages.add("*************************Tear Down*************************");    ExamplePubsubTopicAndSubscriptionOptions pubsubOptions = options.as(ExamplePubsubTopicAndSubscriptionOptions.class);    if (!pubsubOptions.getPubsubTopic().isEmpty()) {        try {            deletePubsubTopic(pubsubOptions.getPubsubTopic());            pendingMessages.add("The Pub/Sub topic has been deleted: " + pubsubOptions.getPubsubTopic());        } catch (IOException e) {            pendingMessages.add("Failed to delete the Pub/Sub topic : " + pubsubOptions.getPubsubTopic());        }        if (!pubsubOptions.getPubsubSubscription().isEmpty()) {            try {                deletePubsubSubscription(pubsubOptions.getPubsubSubscription());                pendingMessages.add("The Pub/Sub subscription has been deleted: " + pubsubOptions.getPubsubSubscription());            } catch (IOException e) {                pendingMessages.add("Failed to delete the Pub/Sub subscription : " + pubsubOptions.getPubsubSubscription());            }        }    }    ExampleBigQueryTableOptions bigQueryTableOptions = options.as(ExampleBigQueryTableOptions.class);    if (bigQueryTableOptions.getBigQueryDataset() != null && bigQueryTableOptions.getBigQueryTable() != null && bigQueryTableOptions.getBigQuerySchema() != null) {        pendingMessages.add("The BigQuery table might contain the example's output, " + "and it is not deleted automatically: " + bigQueryTableOptions.getProject() + ":" + bigQueryTableOptions.getBigQueryDataset() + "." + bigQueryTableOptions.getBigQueryTable());        pendingMessages.add("Please go to the Developers Console to delete it manually." + " Otherwise, you may be charged for its usage.");    }}
0
private void tearDown()
{    pendingMessages.add("*************************Tear Down*************************");    ExamplePubsubTopicAndSubscriptionOptions pubsubOptions = options.as(ExamplePubsubTopicAndSubscriptionOptions.class);    if (!pubsubOptions.getPubsubTopic().isEmpty()) {        try {            deletePubsubTopic(pubsubOptions.getPubsubTopic());            pendingMessages.add("The Pub/Sub topic has been deleted: " + pubsubOptions.getPubsubTopic());        } catch (IOException e) {            pendingMessages.add("Failed to delete the Pub/Sub topic : " + pubsubOptions.getPubsubTopic());        }        if (!pubsubOptions.getPubsubSubscription().isEmpty()) {            try {                deletePubsubSubscription(pubsubOptions.getPubsubSubscription());                pendingMessages.add("The Pub/Sub subscription has been deleted: " + pubsubOptions.getPubsubSubscription());            } catch (IOException e) {                pendingMessages.add("Failed to delete the Pub/Sub subscription : " + pubsubOptions.getPubsubSubscription());            }        }    }    ExampleBigQueryTableOptions bigQueryTableOptions = options.as(ExampleBigQueryTableOptions.class);    if (bigQueryTableOptions.getBigQueryDataset() != null && bigQueryTableOptions.getBigQueryTable() != null && bigQueryTableOptions.getBigQuerySchema() != null) {        pendingMessages.add("The BigQuery table might contain the example's output, " + "and it is not deleted automatically: " + bigQueryTableOptions.getProject() + ":" + bigQueryTableOptions.getBigQueryDataset() + "." + bigQueryTableOptions.getBigQueryTable());        pendingMessages.add("Please go to the Developers Console to delete it manually." + " Otherwise, you may be charged for its usage.");    }}
0
private void tearDown()
{    pendingMessages.add("*************************Tear Down*************************");    ExamplePubsubTopicAndSubscriptionOptions pubsubOptions = options.as(ExamplePubsubTopicAndSubscriptionOptions.class);    if (!pubsubOptions.getPubsubTopic().isEmpty()) {        try {            deletePubsubTopic(pubsubOptions.getPubsubTopic());            pendingMessages.add("The Pub/Sub topic has been deleted: " + pubsubOptions.getPubsubTopic());        } catch (IOException e) {            pendingMessages.add("Failed to delete the Pub/Sub topic : " + pubsubOptions.getPubsubTopic());        }        if (!pubsubOptions.getPubsubSubscription().isEmpty()) {            try {                deletePubsubSubscription(pubsubOptions.getPubsubSubscription());                pendingMessages.add("The Pub/Sub subscription has been deleted: " + pubsubOptions.getPubsubSubscription());            } catch (IOException e) {                pendingMessages.add("Failed to delete the Pub/Sub subscription : " + pubsubOptions.getPubsubSubscription());            }        }    }    ExampleBigQueryTableOptions bigQueryTableOptions = options.as(ExampleBigQueryTableOptions.class);    if (bigQueryTableOptions.getBigQueryDataset() != null && bigQueryTableOptions.getBigQueryTable() != null && bigQueryTableOptions.getBigQuerySchema() != null) {        pendingMessages.add("The BigQuery table might contain the example's output, " + "and it is not deleted automatically: " + bigQueryTableOptions.getProject() + ":" + bigQueryTableOptions.getBigQueryDataset() + "." + bigQueryTableOptions.getBigQueryTable());        pendingMessages.add("Please go to the Developers Console to delete it manually." + " Otherwise, you may be charged for its usage.");    }}
0

