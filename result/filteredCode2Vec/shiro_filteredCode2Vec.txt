public Cache<K, V> shiro_f0_0(String name) throws IllegalArgumentException, CacheException
{    if (!StringUtils.hasText(name)) {        throw new IllegalArgumentException("Cache name cannot be null or empty.");    }    Cache cache;    cache = caches.get(name);    if (cache == null) {        cache = createCache(name);        Cache existing = caches.putIfAbsent(name, cache);        if (existing != null) {            cache = existing;        }    }        return cache;}
public void shiro_f1_0() throws Exception
{    while (!caches.isEmpty()) {        for (Cache cache : caches.values()) {            LifecycleUtils.destroy(cache);        }        caches.clear();    }}
public String shiro_f2_0()
{    Collection<Cache> values = caches.values();    StringBuilder sb = new StringBuilder(getClass().getSimpleName()).append(" with ").append(caches.size()).append(" cache(s)): [");    int i = 0;    for (Cache cache : values) {        if (i > 0) {            sb.append(", ");        }        sb.append(cache.toString());        i++;    }    sb.append("]");    return sb.toString();}
public V shiro_f3_0(K key) throws CacheException
{    return map.get(key);}
public V shiro_f4_0(K key, V value) throws CacheException
{    return map.put(key, value);}
public V shiro_f5_0(K key) throws CacheException
{    return map.remove(key);}
public void shiro_f6_0() throws CacheException
{    map.clear();}
public int shiro_f7_0()
{    return map.size();}
public Set<K> shiro_f8_0()
{    Set<K> keys = map.keySet();    if (!keys.isEmpty()) {        return Collections.unmodifiableSet(keys);    }    return Collections.emptySet();}
public Collection<V> shiro_f9_0()
{    Collection<V> values = map.values();    if (!map.isEmpty()) {        return Collections.unmodifiableCollection(values);    }    return Collections.emptySet();}
public String shiro_f10_0()
{    return new StringBuilder("MapCache '").append(name).append("' (").append(map.size()).append(" entries)").toString();}
protected Cache shiro_f11_0(String name)
{    return new MapCache<Object, Object>(name, new SoftHashMap<Object, Object>());}
public boolean shiro_f12_0()
{    Collection<Section> sections = this.sections.values();    if (!sections.isEmpty()) {        for (Section section : sections) {            if (!section.isEmpty()) {                return false;            }        }    }    return true;}
public Set<String> shiro_f13_0()
{    return Collections.unmodifiableSet(sections.keySet());}
public Collection<Section> shiro_f14_0()
{    return Collections.unmodifiableCollection(sections.values());}
public Section shiro_f15_0(String sectionName)
{    String name = cleanName(sectionName);    return sections.get(name);}
public Section shiro_f16_0(String sectionName)
{    String name = cleanName(sectionName);    Section section = getSection(name);    if (section == null) {        section = new Section(name);        this.sections.put(name, section);    }    return section;}
public Section shiro_f17_0(String sectionName)
{    String name = cleanName(sectionName);    return this.sections.remove(name);}
private static String shiro_f18_0(String sectionName)
{    String name = StringUtils.clean(sectionName);    if (name == null) {        log.trace("Specified name was null or empty.  Defaulting to the default section (name = \"\")");        name = DEFAULT_SECTION_NAME;    }    return name;}
public void shiro_f19_0(String sectionName, String propertyName, String propertyValue)
{    String name = cleanName(sectionName);    Section section = getSection(name);    if (section == null) {        section = addSection(name);    }    section.put(propertyName, propertyValue);}
public String shiro_f20_0(String sectionName, String propertyName)
{    Section section = getSection(sectionName);    return section != null ? section.get(propertyName) : null;}
public String shiro_f21_0(String sectionName, String propertyName, String defaultValue)
{    String value = getSectionProperty(sectionName, propertyName);    return value != null ? value : defaultValue;}
public static Ini shiro_f22_0(String resourcePath) throws ConfigurationException
{    if (!StringUtils.hasLength(resourcePath)) {        throw new IllegalArgumentException("Resource Path argument cannot be null or empty.");    }    Ini ini = new Ini();    ini.loadFromPath(resourcePath);    return ini;}
public void shiro_f23_0(String resourcePath) throws ConfigurationException
{    InputStream is;    try {        is = ResourceUtils.getInputStreamForPath(resourcePath);    } catch (IOException e) {        throw new ConfigurationException(e);    }    load(is);}
public void shiro_f24_0(String iniConfig) throws ConfigurationException
{    load(new Scanner(iniConfig));}
public void shiro_f25_0(InputStream is) throws ConfigurationException
{    if (is == null) {        throw new NullPointerException("InputStream argument cannot be null.");    }    InputStreamReader isr;    try {        isr = new InputStreamReader(is, DEFAULT_CHARSET_NAME);    } catch (UnsupportedEncodingException e) {        throw new ConfigurationException(e);    }    load(isr);}
public void shiro_f26_1(Reader reader)
{    Scanner scanner = new Scanner(reader);    try {        load(scanner);    } finally {        try {            scanner.close();        } catch (Exception e) {                    }    }}
public void shiro_f27_0(Map<String, Section> m)
{    if (m != null) {        for (Entry<String, Section> entry : m.entrySet()) {            Section section = this.getSection(entry.getKey());            if (section == null) {                section = addSection(entry.getKey());            }            section.putAll(entry.getValue());        }    }}
private void shiro_f28_0(String name, StringBuilder content)
{    if (content.length() > 0) {        String contentString = content.toString();        String cleaned = StringUtils.clean(contentString);        if (cleaned != null) {            Section section = new Section(name, contentString);            if (!section.isEmpty()) {                sections.put(name, section);            }        }    }}
public void shiro_f29_1(Scanner scanner)
{    String sectionName = DEFAULT_SECTION_NAME;    StringBuilder sectionContent = new StringBuilder();    while (scanner.hasNextLine()) {        String rawLine = scanner.nextLine();        String line = StringUtils.clean(rawLine);        if (line == null || line.startsWith(COMMENT_POUND) || line.startsWith(COMMENT_SEMICOLON)) {                        continue;        }        String newSectionName = getSectionName(line);        if (newSectionName != null) {                        addSection(sectionName, sectionContent);                        sectionContent = new StringBuilder();            sectionName = newSectionName;            if (log.isDebugEnabled()) {                            }        } else {                        sectionContent.append(rawLine).append("\n");        }    }        addSection(sectionName, sectionContent);}
protected static boolean shiro_f30_0(String line)
{    String s = StringUtils.clean(line);    return s != null && s.startsWith(SECTION_PREFIX) && s.endsWith(SECTION_SUFFIX);}
protected static String shiro_f31_0(String line)
{    String s = StringUtils.clean(line);    if (isSectionHeader(s)) {        return cleanName(s.substring(1, s.length() - 1));    }    return null;}
public boolean shiro_f32_0(Object obj)
{    if (obj instanceof Ini) {        Ini ini = (Ini) obj;        return this.sections.equals(ini.sections);    }    return false;}
public int shiro_f33_0()
{    return this.sections.hashCode();}
public String shiro_f34_0()
{    if (this.sections == null || this.sections.isEmpty()) {        return "<empty INI>";    } else {        StringBuilder sb = new StringBuilder("sections=");        int i = 0;        for (Ini.Section section : this.sections.values()) {            if (i > 0) {                sb.append(",");            }            sb.append(section.toString());            i++;        }        return sb.toString();    }}
public int shiro_f35_0()
{    return this.sections.size();}
public boolean shiro_f36_0(Object key)
{    return this.sections.containsKey(key);}
public boolean shiro_f37_0(Object value)
{    return this.sections.containsValue(value);}
public Section shiro_f38_0(Object key)
{    return this.sections.get(key);}
public Section shiro_f39_0(String key, Section value)
{    return this.sections.put(key, value);}
public Section shiro_f40_0(Object key)
{    return this.sections.remove(key);}
public void shiro_f41_0(Map<? extends String, ? extends Section> m)
{    this.sections.putAll(m);}
public void shiro_f42_0()
{    this.sections.clear();}
public Set<String> shiro_f43_0()
{    return Collections.unmodifiableSet(this.sections.keySet());}
public Collection<Section> shiro_f44_0()
{    return Collections.unmodifiableCollection(this.sections.values());}
public Set<Entry<String, Section>> shiro_f45_0()
{    return Collections.unmodifiableSet(this.sections.entrySet());}
protected static boolean shiro_f46_0(String line)
{    if (!StringUtils.hasText(line)) {        return false;    }    int length = line.length();            int backslashCount = 0;    for (int i = length - 1; i > 0; i--) {        if (line.charAt(i) == ESCAPE_TOKEN) {            backslashCount++;        } else {            break;        }    }    return backslashCount % 2 != 0;}
private static boolean shiro_f47_0(char c)
{    return Character.isWhitespace(c) || c == ':' || c == '=';}
private static boolean shiro_f48_0(CharSequence s, int index)
{    return index > 0 && s.charAt(index - 1) == ESCAPE_TOKEN;}
protected static String[] shiro_f49_0(String keyValueLine)
{    String line = StringUtils.clean(keyValueLine);    if (line == null) {        return null;    }    StringBuilder keyBuffer = new StringBuilder();    StringBuilder valueBuffer = new StringBuilder();        boolean buildingKey = true;    for (int i = 0; i < line.length(); i++) {        char c = line.charAt(i);        if (buildingKey) {            if (isKeyValueSeparatorChar(c) && !isCharEscaped(line, i)) {                                buildingKey = false;            } else {                keyBuffer.append(c);            }        } else {            if (valueBuffer.length() == 0 && isKeyValueSeparatorChar(c) && !isCharEscaped(line, i)) {                        } else {                valueBuffer.append(c);            }        }    }    String key = StringUtils.clean(keyBuffer.toString());    String value = StringUtils.clean(valueBuffer.toString());    if (key == null || value == null) {        String msg = "Line argument must contain a key and a value.  Only one string token was found.";        throw new IllegalArgumentException(msg);    }    log.trace("Discovered key/value pair: {} = {}", key, value);    return new String[] { key, value };}
private static Map<String, String> shiro_f50_0(String content)
{    Map<String, String> props = new LinkedHashMap<String, String>();    String line;    StringBuilder lineBuffer = new StringBuilder();    Scanner scanner = new Scanner(content);    while (scanner.hasNextLine()) {        line = StringUtils.clean(scanner.nextLine());        if (isContinued(line)) {                        line = line.substring(0, line.length() - 1);            lineBuffer.append(line);            continue;        } else {            lineBuffer.append(line);        }        line = lineBuffer.toString();        lineBuffer = new StringBuilder();        String[] kvPair = splitKeyValue(line);        props.put(kvPair[0], kvPair[1]);    }    return props;}
public String shiro_f51_0()
{    return this.name;}
public void shiro_f52_0()
{    this.props.clear();}
public boolean shiro_f53_0(Object key)
{    return this.props.containsKey(key);}
public boolean shiro_f54_0(Object value)
{    return this.props.containsValue(value);}
public Set<Entry<String, String>> shiro_f55_0()
{    return this.props.entrySet();}
public String shiro_f56_0(Object key)
{    return this.props.get(key);}
public boolean shiro_f57_0()
{    return this.props.isEmpty();}
public Set<String> shiro_f58_0()
{    return this.props.keySet();}
public String shiro_f59_0(String key, String value)
{    return this.props.put(key, value);}
public void shiro_f60_0(Map<? extends String, ? extends String> m)
{    this.props.putAll(m);}
public String shiro_f61_0(Object key)
{    return this.props.remove(key);}
public int shiro_f62_0()
{    return this.props.size();}
public Collection<String> shiro_f63_0()
{    return this.props.values();}
public String shiro_f64_0()
{    String name = getName();    if (DEFAULT_SECTION_NAME.equals(name)) {        return "<default>";    }    return name;}
public boolean shiro_f65_0(Object obj)
{    if (obj instanceof Section) {        Section other = (Section) obj;        return getName().equals(other.getName()) && this.props.equals(other.props);    }    return false;}
public int shiro_f66_0()
{    return this.name.hashCode() * 31 + this.props.hashCode();}
public String shiro_f67_0(String value)
{    return (String) interpolator.interpolate(value);}
public ConfigurationInterpolator shiro_f68_0()
{    return interpolator;}
public String shiro_f69_0(String value)
{    return value;}
public String shiro_f70_0()
{    return beanName;}
public Object shiro_f71_0()
{    return bean;}
public Map<String, Object> shiro_f72_0()
{    return beanContext;}
public void shiro_f73_0(BeanEvent e)
{    String className = e.getClass().getSimpleName();    int i = className.lastIndexOf(SUFFIX);    String subclassPrefix = i > 0 ? className.substring(0, i) : className;    logger.trace("{} bean '{}' [{}]", new Object[] { subclassPrefix, e.getBeanName(), e.getBean() });}
private Map<String, Object> shiro_f74_0()
{    Map<String, Object> map = new LinkedHashMap<String, Object>();    map.put(EVENT_BUS_NAME, new DefaultEventBus());    return map;}
private void shiro_f75_0(Map<String, ?> objects)
{    if (!isEmpty(objects)) {        this.objects.putAll(objects);    }    EventBus found = findEventBus(this.objects);    Assert.notNull(found, "An " + EventBus.class.getName() + " instance must be present in the object defaults");    enableEvents(found);}
public Map<String, ?> shiro_f76_0()
{    return objects;}
public void shiro_f77_0(Map<String, ?> objects)
{    this.objects.clear();    this.objects.putAll(createDefaultObjectMap());    apply(objects);}
private void shiro_f78_0(EventBus eventBus)
{    Assert.notNull(eventBus, "EventBus argument cannot be null.");        for (Object subscriber : this.registeredEventSubscribers.values()) {        this.eventBus.unregister(subscriber);    }    this.registeredEventSubscribers.clear();    this.eventBus = eventBus;    for (Map.Entry<String, Object> entry : this.objects.entrySet()) {        enableEventsIfNecessary(entry.getValue(), entry.getKey());    }}
private void shiro_f79_0(Object bean, String name)
{    boolean applied = applyEventBusIfNecessary(bean);    if (!applied) {                if (isEventSubscriber(bean, name)) {                        this.eventBus.register(bean);            this.registeredEventSubscribers.put(name, bean);        }    }}
private boolean shiro_f80_0(Object bean, String name)
{    List annotatedMethods = ClassUtils.getAnnotatedMethods(bean.getClass(), Subscribe.class);    return !isEmpty(annotatedMethods);}
protected EventBus shiro_f81_0(Map<String, ?> objects)
{    if (isEmpty(objects)) {        return null;    }        Object value = objects.get(EVENT_BUS_NAME);    if (value != null && value instanceof EventBus) {        return (EventBus) value;    }        for (Object v : objects.values()) {        if (v instanceof EventBus) {            return (EventBus) v;        }    }    return null;}
private boolean shiro_f82_0(Object value)
{    if (value instanceof EventBusAware) {        ((EventBusAware) value).setEventBus(this.eventBus);        return true;    }    return false;}
public Object shiro_f83_0(String id)
{    return objects.get(id);}
public T shiro_f84_0(String id, Class<T> requiredType)
{    if (requiredType == null) {        throw new NullPointerException("requiredType argument cannot be null.");    }    Object bean = getBean(id);    if (bean == null) {        return null;    }    Assert.state(requiredType.isAssignableFrom(bean.getClass()), "Bean with id [" + id + "] is not of the required type [" + requiredType.getName() + "].");    return (T) bean;}
private String shiro_f85_0(String lhs)
{    Assert.notNull(lhs);    if (lhs.indexOf('.') < 0) {        return lhs;    }    String classSuffix = ".class";    int index = lhs.indexOf(classSuffix);    if (index >= 0) {        return lhs.substring(0, index);    }    return null;}
public Map<String, ?> shiro_f86_0(Map<String, String> kvPairs)
{    if (kvPairs != null && !kvPairs.isEmpty()) {        BeanConfigurationProcessor processor = new BeanConfigurationProcessor();        for (Map.Entry<String, String> entry : kvPairs.entrySet()) {            String lhs = entry.getKey();            String rhs = interpolator.interpolate(entry.getValue());            String beanId = parseBeanId(lhs);            if (beanId != null) {                                processor.add(new InstantiationStatement(beanId, rhs));            } else {                                processor.add(new AssignmentStatement(lhs, rhs));            }        }        processor.execute();    }        LifecycleUtils.init(objects.values());    return objects;}
public void shiro_f87_0()
{    final Map<String, Object> immutableObjects = Collections.unmodifiableMap(objects);        List<Map.Entry<String, ?>> entries = new ArrayList<Map.Entry<String, ?>>(objects.entrySet());    Collections.reverse(entries);    for (Map.Entry<String, ?> entry : entries) {        String id = entry.getKey();        Object bean = entry.getValue();                if (bean != this.eventBus) {                        LifecycleUtils.destroy(bean);            BeanEvent event = new DestroyedBeanEvent(id, bean, immutableObjects);            eventBus.publish(event);                        this.eventBus.unregister(bean);        }    }        LifecycleUtils.destroy(this.eventBus);}
protected void shiro_f88_1(Map<String, Object> objects, String name, String value)
{    Object currentInstance = objects.get(name);    if (currentInstance != null) {            }        Object instance;    try {        instance = ClassUtils.newInstance(value);        if (instance instanceof Nameable) {            ((Nameable) instance).setName(name);        }    } catch (Exception e) {        String msg = "Unable to instantiate class [" + value + "] for object named '" + name + "'.  " + "Please ensure you've specified the fully qualified class name correctly.";        throw new ConfigurationException(msg, e);    }    objects.put(name, instance);}
protected void shiro_f89_0(String key, String value, Map objects)
{    int index = key.indexOf('.');    if (index >= 0) {        String name = key.substring(0, index);        String property = key.substring(index + 1, key.length());        if (GLOBAL_PROPERTY_PREFIX.equalsIgnoreCase(name)) {            applyGlobalProperty(objects, property, value);        } else {            applySingleProperty(objects, name, property, value);        }    } else {        throw new IllegalArgumentException("All property keys must contain a '.' character. " + "(e.g. myBean.property = value)  These should already be separated out by buildObjects().");    }}
protected void shiro_f90_0(Map objects, String property, String value)
{    for (Object instance : objects.values()) {        try {            PropertyDescriptor pd = beanUtilsBean.getPropertyUtils().getPropertyDescriptor(instance, property);            if (pd != null) {                applyProperty(instance, property, value);            }        } catch (Exception e) {            String msg = "Error retrieving property descriptor for instance " + "of type [" + instance.getClass().getName() + "] " + "while setting property [" + property + "]";            throw new ConfigurationException(msg, e);        }    }}
protected void shiro_f91_0(Map objects, String name, String property, String value)
{    Object instance = objects.get(name);    if (property.equals("class")) {        throw new IllegalArgumentException("Property keys should not contain 'class' properties since these " + "should already be separated out by buildObjects().");    } else if (instance == null) {        String msg = "Configuration error.  Specified object [" + name + "] with property [" + property + "] without first defining that object's class.  Please first " + "specify the class property first, e.g. myObject = fully_qualified_class_name " + "and then define additional properties.";        throw new IllegalArgumentException(msg);    } else {        applyProperty(instance, property, value);    }}
protected boolean shiro_f92_0(String value)
{    return value != null && value.startsWith(OBJECT_REFERENCE_BEGIN_TOKEN);}
protected String shiro_f93_0(String referenceToken)
{    return referenceToken.substring(OBJECT_REFERENCE_BEGIN_TOKEN.length());}
protected Object shiro_f94_0(String id)
{    Object o = objects != null && !objects.isEmpty() ? objects.get(id) : null;    if (o == null) {        String msg = "The object with id [" + id + "] has not yet been defined and therefore cannot be " + "referenced.  Please ensure objects are defined in the order in which they should be " + "created and made available for future reference.";        throw new UnresolveableReferenceException(msg);    }    return o;}
protected String shiro_f95_0(String value)
{    if (value != null && value.startsWith(ESCAPED_OBJECT_REFERENCE_BEGIN_TOKEN)) {        return value.substring(ESCAPED_OBJECT_REFERENCE_BEGIN_TOKEN.length() - 1);    }    return value;}
protected Object shiro_f96_1(String reference)
{    String id = getId(reference);        final Object referencedObject = getReferencedObject(id);    if (referencedObject instanceof Factory) {        return ((Factory) referencedObject).getInstance();    }    return referencedObject;}
protected boolean shiro_f97_0(Object object, String propertyName, Class clazz)
{    if (clazz == null) {        throw new NullPointerException("type (class) argument cannot be null.");    }    try {        PropertyDescriptor descriptor = beanUtilsBean.getPropertyUtils().getPropertyDescriptor(object, propertyName);        if (descriptor == null) {            String msg = "Property '" + propertyName + "' does not exist for object of " + "type " + object.getClass().getName() + ".";            throw new ConfigurationException(msg);        }        Class propertyClazz = descriptor.getPropertyType();        return clazz.isAssignableFrom(propertyClazz);    } catch (ConfigurationException ce) {                throw ce;    } catch (Exception e) {        String msg = "Unable to determine if property [" + propertyName + "] represents a " + clazz.getName();        throw new ConfigurationException(msg, e);    }}
protected Set<?> shiro_f98_0(String sValue)
{    String[] tokens = StringUtils.split(sValue);    if (tokens == null || tokens.length <= 0) {        return null;    }        if (tokens.length == 1 && isReference(tokens[0])) {        Object reference = resolveReference(tokens[0]);        if (reference instanceof Set) {            return (Set) reference;        }    }    Set<String> setTokens = new LinkedHashSet<String>(Arrays.asList(tokens));        Set<Object> values = new LinkedHashSet<Object>(setTokens.size());    for (String token : setTokens) {        Object value = resolveValue(token);        values.add(value);    }    return values;}
protected Map<?, ?> shiro_f99_0(String sValue)
{    String[] tokens = StringUtils.split(sValue, StringUtils.DEFAULT_DELIMITER_CHAR, StringUtils.DEFAULT_QUOTE_CHAR, StringUtils.DEFAULT_QUOTE_CHAR, true, true);    if (tokens == null || tokens.length <= 0) {        return null;    }        if (tokens.length == 1 && isReference(tokens[0])) {        Object reference = resolveReference(tokens[0]);        if (reference instanceof Map) {            return (Map) reference;        }    }    Map<String, String> mapTokens = new LinkedHashMap<String, String>(tokens.length);    for (String token : tokens) {        String[] kvPair = StringUtils.split(token, MAP_KEY_VALUE_DELIMITER);        if (kvPair == null || kvPair.length != 2) {            String msg = "Map property value [" + sValue + "] contained key-value pair token [" + token + "] that does not properly split to a single key and pair.  This must be the " + "case for all map entries.";            throw new ConfigurationException(msg);        }        mapTokens.put(kvPair[0], kvPair[1]);    }        Map<Object, Object> map = new LinkedHashMap<Object, Object>(mapTokens.size());    for (Map.Entry<String, String> entry : mapTokens.entrySet()) {        Object key = resolveValue(entry.getKey());        Object value = resolveValue(entry.getValue());        map.put(key, value);    }    return map;}
protected Collection<?> shiro_f100_0(String sValue)
{    String[] tokens = StringUtils.split(sValue);    if (tokens == null || tokens.length <= 0) {        return null;    }        if (tokens.length == 1 && isReference(tokens[0])) {        Object reference = resolveReference(tokens[0]);        if (reference instanceof Collection) {            return (Collection) reference;        }    }        List<Object> values = new ArrayList<Object>(tokens.length);    for (String token : tokens) {        Object value = resolveValue(token);        values.add(value);    }    return values;}
protected List<?> shiro_f101_0(String sValue)
{    String[] tokens = StringUtils.split(sValue);    if (tokens == null || tokens.length <= 0) {        return null;    }        if (tokens.length == 1 && isReference(tokens[0])) {        Object reference = resolveReference(tokens[0]);        if (reference instanceof List) {            return (List) reference;        }    }        List<Object> values = new ArrayList<Object>(tokens.length);    for (String token : tokens) {        Object value = resolveValue(token);        values.add(value);    }    return values;}
protected byte[] shiro_f102_0(String sValue)
{    if (sValue == null) {        return null;    }    byte[] bytes;    if (sValue.startsWith(HEX_BEGIN_TOKEN)) {        String hex = sValue.substring(HEX_BEGIN_TOKEN.length());        bytes = Hex.decode(hex);    } else {                bytes = Base64.decode(sValue);    }    return bytes;}
protected Object shiro_f103_0(String stringValue)
{    Object value;    if (isReference(stringValue)) {        value = resolveReference(stringValue);    } else {        value = unescapeIfNecessary(stringValue);    }    return value;}
protected String shiro_f104_0(String stringValue)
{    if (stringValue == null) {        return null;    }        if (stringValue.equals("\"null\"")) {        return NULL_VALUE_TOKEN;    } else     if (stringValue.equals("\"\"\"\"")) {        return EMPTY_STRING_VALUE_TOKEN;    } else {        return stringValue;    }}
protected void shiro_f105_0(Object object, String propertyPath, Object value)
{    int mapBegin = propertyPath.indexOf(MAP_PROPERTY_BEGIN_TOKEN);    int mapEnd = -1;    String mapPropertyPath = null;    String keyString = null;    String remaining = null;    if (mapBegin >= 0) {                mapPropertyPath = propertyPath.substring(0, mapBegin);                mapEnd = propertyPath.indexOf(MAP_PROPERTY_END_TOKEN, mapBegin);                keyString = propertyPath.substring(mapBegin + 1, mapEnd);                if (propertyPath.length() > (mapEnd + 1)) {            remaining = propertyPath.substring(mapEnd + 1);            if (remaining.startsWith(".")) {                remaining = StringUtils.clean(remaining.substring(1));            }        }    }    if (remaining == null) {                if (keyString == null) {                        setProperty(object, propertyPath, value);        } else {                        if (isTypedProperty(object, mapPropertyPath, Map.class)) {                Map map = (Map) getProperty(object, mapPropertyPath);                Object mapKey = resolveValue(keyString);                                map.put(mapKey, value);            } else {                                int index = Integer.valueOf(keyString);                setIndexedProperty(object, mapPropertyPath, index, value);            }        }    } else {                        Object referencedValue = null;        if (isTypedProperty(object, mapPropertyPath, Map.class)) {            Map map = (Map) getProperty(object, mapPropertyPath);            Object mapKey = resolveValue(keyString);            referencedValue = map.get(mapKey);        } else {                        int index = Integer.valueOf(keyString);            referencedValue = getIndexedProperty(object, mapPropertyPath, index);        }        if (referencedValue == null) {            throw new ConfigurationException("Referenced map/array value '" + mapPropertyPath + "[" + keyString + "]' does not exist.");        }        applyProperty(referencedValue, remaining, value);    }}
private void shiro_f106_0(Object object, String propertyPath, Object value)
{    try {        if (log.isTraceEnabled()) {            log.trace("Applying property [{}] value [{}] on object of type [{}]", new Object[] { propertyPath, value, object.getClass().getName() });        }        beanUtilsBean.setProperty(object, propertyPath, value);    } catch (Exception e) {        String msg = "Unable to set property '" + propertyPath + "' with value [" + value + "] on object " + "of type " + (object != null ? object.getClass().getName() : null) + ".  If " + "'" + value + "' is a reference to another (previously defined) object, prefix it with " + "'" + OBJECT_REFERENCE_BEGIN_TOKEN + "' to indicate that the referenced " + "object should be used as the actual value.  " + "For example, " + OBJECT_REFERENCE_BEGIN_TOKEN + value;        throw new ConfigurationException(msg, e);    }}
private Object shiro_f107_0(Object object, String propertyPath)
{    try {        return beanUtilsBean.getPropertyUtils().getProperty(object, propertyPath);    } catch (Exception e) {        throw new ConfigurationException("Unable to access property '" + propertyPath + "'", e);    }}
private void shiro_f108_0(Object object, String propertyPath, int index, Object value)
{    try {        beanUtilsBean.getPropertyUtils().setIndexedProperty(object, propertyPath, index, value);    } catch (Exception e) {        throw new ConfigurationException("Unable to set array property '" + propertyPath + "'", e);    }}
private Object shiro_f109_0(Object object, String propertyPath, int index)
{    try {        return beanUtilsBean.getPropertyUtils().getIndexedProperty(object, propertyPath, index);    } catch (Exception e) {        throw new ConfigurationException("Unable to acquire array property '" + propertyPath + "'", e);    }}
protected boolean shiro_f110_0(String propertyPath)
{    return propertyPath.endsWith("" + MAP_PROPERTY_END_TOKEN);}
protected void shiro_f111_0(Object object, String propertyName, String stringValue)
{    Object value;    if (NULL_VALUE_TOKEN.equals(stringValue)) {        value = null;    } else if (EMPTY_STRING_VALUE_TOKEN.equals(stringValue)) {        value = StringUtils.EMPTY_STRING;    } else if (isIndexedPropertyAssignment(propertyName)) {        String checked = checkForNullOrEmptyLiteral(stringValue);        value = resolveValue(checked);    } else if (isTypedProperty(object, propertyName, Set.class)) {        value = toSet(stringValue);    } else if (isTypedProperty(object, propertyName, Map.class)) {        value = toMap(stringValue);    } else if (isTypedProperty(object, propertyName, List.class)) {        value = toList(stringValue);    } else if (isTypedProperty(object, propertyName, Collection.class)) {        value = toCollection(stringValue);    } else if (isTypedProperty(object, propertyName, byte[].class)) {        value = toBytes(stringValue);    } else if (isTypedProperty(object, propertyName, ByteSource.class)) {        byte[] bytes = toBytes(stringValue);        value = ByteSource.Util.bytes(bytes);    } else {        String checked = checkForNullOrEmptyLiteral(stringValue);        value = resolveValue(checked);    }    applyProperty(object, propertyName, value);}
private Interpolator shiro_f112_0()
{    if (ClassUtils.isAvailable("org.apache.commons.configuration2.interpol.ConfigurationInterpolator")) {        return new CommonsInterpolator();    }    return new DefaultInterpolator();}
public void shiro_f113_0(Interpolator interpolator)
{    this.interpolator = interpolator;}
public void shiro_f114_0(Statement statement)
{        statements.add(statement);    if (statement instanceof InstantiationStatement) {        InstantiationStatement is = (InstantiationStatement) statement;        beanConfigurations.add(new BeanConfiguration(is));    } else {        AssignmentStatement as = (AssignmentStatement) statement;                        boolean addedToConfig = false;        String beanName = as.getRootBeanName();        for (int i = beanConfigurations.size() - 1; i >= 0; i--) {            BeanConfiguration mostRecent = beanConfigurations.get(i);            String mostRecentBeanName = mostRecent.getBeanName();            if (beanName.equals(mostRecentBeanName)) {                mostRecent.add(as);                addedToConfig = true;                break;            }        }        if (!addedToConfig) {                                                            beanConfigurations.add(new BeanConfiguration(as));        }    }}
public void shiro_f115_0()
{    for (Statement statement : statements) {        statement.execute();        BeanConfiguration bd = statement.getBeanConfiguration();        if (bd.isExecuted()) {                        if (bd.getBeanName().equals(EVENT_BUS_NAME)) {                EventBus eventBus = (EventBus) bd.getBean();                enableEvents(eventBus);            }                        if (!bd.isGlobalConfig()) {                BeanEvent event = new ConfiguredBeanEvent(bd.getBeanName(), bd.getBean(), Collections.unmodifiableMap(objects));                eventBus.publish(event);            }                        LifecycleUtils.init(bd.getBean());                        if (!bd.isGlobalConfig()) {                BeanEvent event = new InitializedBeanEvent(bd.getBeanName(), bd.getBean(), Collections.unmodifiableMap(objects));                eventBus.publish(event);            }        }    }}
public String shiro_f116_0()
{    return this.beanName;}
public boolean shiro_f117_0()
{        return GLOBAL_PROPERTY_PREFIX.equals(getBeanName());}
public void shiro_f118_0(AssignmentStatement as)
{    as.setBeanConfiguration(this);    assignments.add(as);}
public void shiro_f119_0(Object bean)
{    this.bean = bean;}
public Object shiro_f120_0()
{    return this.bean;}
public boolean shiro_f121_0()
{    if (instantiationStatement != null && !instantiationStatement.isExecuted()) {        return false;    }    for (AssignmentStatement as : assignments) {        if (!as.isExecuted()) {            return false;        }    }    return true;}
public void shiro_f122_0(BeanConfiguration bd)
{    this.beanConfiguration = bd;}
public BeanConfiguration shiro_f123_0()
{    return this.beanConfiguration;}
public Object shiro_f124_0()
{    if (!isExecuted()) {        this.result = doExecute();        this.executed = true;    }    if (!getBeanConfiguration().isGlobalConfig()) {        Assert.notNull(this.bean, "Implementation must set the root bean for which it executed.");    }    return this.result;}
public Object shiro_f125_0()
{    return this.bean;}
protected void shiro_f126_0(Object bean)
{    this.bean = bean;    if (this.beanConfiguration.getBean() == null) {        this.beanConfiguration.setBean(bean);    }}
public Object shiro_f127_0()
{    return result;}
public boolean shiro_f128_0()
{    return executed;}
protected Object shiro_f129_0()
{    String beanName = this.lhs;    createNewInstance(objects, beanName, this.rhs);    Object instantiated = objects.get(beanName);    setBean(instantiated);                enableEventsIfNecessary(instantiated, beanName);    BeanEvent event = new InstantiatedBeanEvent(beanName, instantiated, Collections.unmodifiableMap(objects));    eventBus.publish(event);    return instantiated;}
protected Object shiro_f130_0()
{    applyProperty(lhs, rhs, objects);    Object bean = objects.get(this.rootBeanName);    setBean(bean);    return null;}
public String shiro_f131_0()
{    return this.rootBeanName;}
private static boolean shiro_f132_0(Map m)
{    return m == null || m.isEmpty();}
private static boolean shiro_f133_0(Collection c)
{    return c == null || c.isEmpty();}
protected Subject shiro_f134_0()
{    return SecurityUtils.getSubject();}
protected void shiro_f135_0(Class<? extends Annotation> annotationClass) throws IllegalArgumentException
{    if (annotationClass == null) {        String msg = "annotationClass argument cannot be null";        throw new IllegalArgumentException(msg);    }    this.annotationClass = annotationClass;}
public Class<? extends Annotation> shiro_f136_0()
{    return this.annotationClass;}
public AnnotationHandler shiro_f137_0()
{    return handler;}
public void shiro_f138_0(AnnotationHandler handler)
{    this.handler = handler;}
public AnnotationResolver shiro_f139_0()
{    return resolver;}
public void shiro_f140_0(AnnotationResolver resolver)
{    this.resolver = resolver;}
public boolean shiro_f141_0(MethodInvocation mi)
{    return getAnnotation(mi) != null;}
protected Annotation shiro_f142_0(MethodInvocation mi)
{    return getResolver().getAnnotation(mi, getHandler().getAnnotationClass());}
public Annotation shiro_f143_0(MethodInvocation mi, Class<? extends Annotation> clazz)
{    if (mi == null) {        throw new IllegalArgumentException("method argument cannot be null");    }    Method m = mi.getMethod();    if (m == null) {        String msg = MethodInvocation.class.getName() + " parameter incorrectly constructed.  getMethod() returned null";        throw new IllegalArgumentException(msg);    }    Annotation annotation = m.getAnnotation(clazz);    if (annotation == null) {        Object miThis = mi.getThis();                annotation = miThis != null ? miThis.getClass().getAnnotation(clazz) : null;    }    return annotation;}
protected Subject shiro_f144_0()
{    return SecurityUtils.getSubject();}
public void shiro_f145_0(Collection<AuthenticationListener> listeners)
{    if (listeners == null) {        this.listeners = new ArrayList<AuthenticationListener>();    } else {        this.listeners = listeners;    }}
public Collection<AuthenticationListener> shiro_f146_0()
{    return this.listeners;}
protected void shiro_f147_0(AuthenticationToken token, AuthenticationInfo info)
{    for (AuthenticationListener listener : this.listeners) {        listener.onSuccess(token, info);    }}
protected void shiro_f148_0(AuthenticationToken token, AuthenticationException ae)
{    for (AuthenticationListener listener : this.listeners) {        listener.onFailure(token, ae);    }}
protected void shiro_f149_0(PrincipalCollection principals)
{    for (AuthenticationListener listener : this.listeners) {        listener.onLogout(principals);    }}
public void shiro_f150_0(PrincipalCollection principals)
{    notifyLogout(principals);}
public String shiro_f152_0()
{    return host;}
public Object shiro_f153_0()
{    return token;}
public Object shiro_f154_0()
{    return token;}
public String shiro_f155_0()
{    return token;}
public boolean shiro_f156_0(AuthenticationToken token, AuthenticationInfo info)
{    return true;}
public String shiro_f157_0(Object plaintext)
{    Hash hash = hashPassword(plaintext);    checkHashFormatDurability();    return this.hashFormat.format(hash);}
public Hash shiro_f158_0(Object plaintext)
{    ByteSource plaintextBytes = createByteSource(plaintext);    if (plaintextBytes == null || plaintextBytes.isEmpty()) {        return null;    }    HashRequest request = createHashRequest(plaintextBytes);    return hashService.computeHash(request);}
public boolean shiro_f159_0(Object plaintext, Hash saved)
{    ByteSource plaintextBytes = createByteSource(plaintext);    if (saved == null || saved.isEmpty()) {        return plaintextBytes == null || plaintextBytes.isEmpty();    } else {        if (plaintextBytes == null || plaintextBytes.isEmpty()) {            return false;        }    }    HashRequest request = buildHashRequest(plaintextBytes, saved);    Hash computed = this.hashService.computeHash(request);    return saved.equals(computed);}
protected void shiro_f160_1()
{    if (!this.hashFormatWarned) {        HashFormat format = this.hashFormat;        if (!(format instanceof ParsableHashFormat) && log.isWarnEnabled()) {            String msg = "The configured hashFormat instance [" + format.getClass().getName() + "] is not a " + ParsableHashFormat.class.getName() + " implementation.  This is " + "required if you wish to support backwards compatibility for saved password checking (almost " + "always desirable).  Without a " + ParsableHashFormat.class.getSimpleName() + " instance, " + "any hashService configuration changes will break previously hashed/saved passwords.";                        this.hashFormatWarned = true;        }    }}
protected HashRequest shiro_f161_0(ByteSource plaintext)
{    return new HashRequest.Builder().setSource(plaintext).build();}
protected ByteSource shiro_f162_0(Object o)
{    return ByteSource.Util.bytes(o);}
public boolean shiro_f163_0(Object submittedPlaintext, String saved)
{    ByteSource plaintextBytes = createByteSource(submittedPlaintext);    if (saved == null || saved.length() == 0) {        return plaintextBytes == null || plaintextBytes.isEmpty();    } else {        if (plaintextBytes == null || plaintextBytes.isEmpty()) {            return false;        }    }                        HashFormat discoveredFormat = this.hashFormatFactory.getInstance(saved);    if (discoveredFormat != null && discoveredFormat instanceof ParsableHashFormat) {        ParsableHashFormat parsableHashFormat = (ParsableHashFormat) discoveredFormat;        Hash savedHash = parsableHashFormat.parse(saved);        return passwordsMatch(submittedPlaintext, savedHash);    }                                HashRequest request = createHashRequest(plaintextBytes);    Hash computed = this.hashService.computeHash(request);    String formatted = this.hashFormat.format(computed);    return saved.equals(formatted);}
protected HashRequest shiro_f164_0(ByteSource plaintext, Hash saved)
{        return new HashRequest.Builder().setSource(plaintext).setAlgorithmName(saved.getAlgorithmName()).setSalt(saved.getSalt()).setIterations(saved.getIterations()).build();}
public HashService shiro_f165_0()
{    return hashService;}
public void shiro_f166_0(HashService hashService)
{    this.hashService = hashService;}
public HashFormat shiro_f167_0()
{    return hashFormat;}
public void shiro_f168_0(HashFormat hashFormat)
{    this.hashFormat = hashFormat;}
public HashFormatFactory shiro_f169_0()
{    return hashFormatFactory;}
public void shiro_f170_0(HashFormatFactory hashFormatFactory)
{    this.hashFormatFactory = hashFormatFactory;}
public String shiro_f171_0()
{    return hashAlgorithm;}
public void shiro_f172_0(String hashAlgorithmName)
{    this.hashAlgorithm = hashAlgorithmName;}
public boolean shiro_f173_0()
{    return storedCredentialsHexEncoded;}
public void shiro_f174_0(boolean storedCredentialsHexEncoded)
{    this.storedCredentialsHexEncoded = storedCredentialsHexEncoded;}
public boolean shiro_f175_0()
{    return hashSalted;}
public void shiro_f176_0(boolean hashSalted)
{    this.hashSalted = hashSalted;}
public int shiro_f177_0()
{    return hashIterations;}
public void shiro_f178_0(int hashIterations)
{    if (hashIterations < 1) {        this.hashIterations = 1;    } else {        this.hashIterations = hashIterations;    }}
protected Object shiro_f179_0(AuthenticationToken token)
{    return token.getPrincipal();}
protected Object shiro_f180_0(AuthenticationInfo info)
{    Object credentials = info.getCredentials();    byte[] storedBytes = toBytes(credentials);    if (credentials instanceof String || credentials instanceof char[]) {                if (isStoredCredentialsHexEncoded()) {            storedBytes = Hex.decode(storedBytes);        } else {            storedBytes = Base64.decode(storedBytes);        }    }    AbstractHash hash = newHashInstance();    hash.setBytes(storedBytes);    return hash;}
public boolean shiro_f181_0(AuthenticationToken token, AuthenticationInfo info)
{    Object tokenHashedCredentials = hashProvidedCredentials(token, info);    Object accountCredentials = getCredentials(info);    return equals(tokenHashedCredentials, accountCredentials);}
protected Object shiro_f182_0(AuthenticationToken token, AuthenticationInfo info)
{    Object salt = null;    if (info instanceof SaltedAuthenticationInfo) {        salt = ((SaltedAuthenticationInfo) info).getCredentialsSalt();    } else {                if (isHashSalted()) {            salt = getSalt(token);        }    }    return hashProvidedCredentials(token.getCredentials(), salt, getHashIterations());}
private String shiro_f183_0() throws IllegalStateException
{    String hashAlgorithmName = getHashAlgorithmName();    if (hashAlgorithmName == null) {        String msg = "Required 'hashAlgorithmName' property has not been set.  This is required to execute " + "the hashing algorithm.";        throw new IllegalStateException(msg);    }    return hashAlgorithmName;}
protected Hash shiro_f184_0(Object credentials, Object salt, int hashIterations)
{    String hashAlgorithmName = assertHashAlgorithmName();    return new SimpleHash(hashAlgorithmName, credentials, salt, hashIterations);}
protected AbstractHash shiro_f185_0()
{    String hashAlgorithmName = assertHashAlgorithmName();    return new SimpleHash(hashAlgorithmName);}
public boolean shiro_f186_0(AuthenticationToken token, AuthenticationInfo info)
{    PasswordService service = ensurePasswordService();    Object submittedPassword = getSubmittedPassword(token);    Object storedCredentials = getStoredPassword(info);    assertStoredCredentialsType(storedCredentials);    if (storedCredentials instanceof Hash) {        Hash hashedPassword = (Hash) storedCredentials;        HashingPasswordService hashingService = assertHashingPasswordService(service);        return hashingService.passwordsMatch(submittedPassword, hashedPassword);    }        String formatted = (String) storedCredentials;    return passwordService.passwordsMatch(submittedPassword, formatted);}
private HashingPasswordService shiro_f187_0(PasswordService service)
{    if (service instanceof HashingPasswordService) {        return (HashingPasswordService) service;    }    String msg = "AuthenticationInfo's stored credentials are a Hash instance, but the " + "configured passwordService is not a " + HashingPasswordService.class.getName() + " instance.  This is required to perform Hash " + "object password comparisons.";    throw new IllegalStateException(msg);}
private PasswordService shiro_f188_0()
{    PasswordService service = getPasswordService();    if (service == null) {        String msg = "Required PasswordService has not been configured.";        throw new IllegalStateException(msg);    }    return service;}
protected Object shiro_f189_0(AuthenticationToken token)
{    return token != null ? token.getCredentials() : null;}
private void shiro_f190_0(Object credentials)
{    if (credentials instanceof String || credentials instanceof Hash) {        return;    }    String msg = "Stored account credentials are expected to be either a " + Hash.class.getName() + " instance or a formatted hash String.";    throw new IllegalArgumentException(msg);}
protected Object shiro_f191_0(AuthenticationInfo storedAccountInfo)
{    Object stored = storedAccountInfo != null ? storedAccountInfo.getCredentials() : null;        if (stored instanceof char[]) {        stored = new String((char[]) stored);    }    return stored;}
public PasswordService shiro_f192_0()
{    return passwordService;}
public void shiro_f193_0(PasswordService passwordService)
{    this.passwordService = passwordService;}
protected Object shiro_f194_0(AuthenticationToken token)
{    return token.getCredentials();}
protected Object shiro_f195_0(AuthenticationInfo info)
{    return info.getCredentials();}
protected boolean shiro_f196_1(Object tokenCredentials, Object accountCredentials)
{    if (log.isDebugEnabled()) {            }    if (isByteSource(tokenCredentials) && isByteSource(accountCredentials)) {        if (log.isDebugEnabled()) {                    }        byte[] tokenBytes = toBytes(tokenCredentials);        byte[] accountBytes = toBytes(accountCredentials);        return MessageDigest.isEqual(tokenBytes, accountBytes);    } else {        return accountCredentials.equals(tokenCredentials);    }}
public boolean shiro_f197_0(AuthenticationToken token, AuthenticationInfo info)
{    Object tokenCredentials = getCredentials(token);    Object accountCredentials = getCredentials(info);    return equals(tokenCredentials, accountCredentials);}
public AuthenticationInfo shiro_f198_0(Collection<? extends Realm> realms, AuthenticationToken token) throws AuthenticationException
{    return new SimpleAuthenticationInfo();}
public AuthenticationInfo shiro_f199_0(Realm realm, AuthenticationToken token, AuthenticationInfo aggregate) throws AuthenticationException
{    return aggregate;}
public AuthenticationInfo shiro_f200_0(Realm realm, AuthenticationToken token, AuthenticationInfo singleRealmInfo, AuthenticationInfo aggregateInfo, Throwable t) throws AuthenticationException
{    AuthenticationInfo info;    if (singleRealmInfo == null) {        info = aggregateInfo;    } else {        if (aggregateInfo == null) {            info = singleRealmInfo;        } else {            info = merge(singleRealmInfo, aggregateInfo);        }    }    return info;}
protected AuthenticationInfo shiro_f201_0(AuthenticationInfo info, AuthenticationInfo aggregate)
{    if (aggregate instanceof MergableAuthenticationInfo) {        ((MergableAuthenticationInfo) aggregate).merge(info);        return aggregate;    } else {        throw new IllegalArgumentException("Attempt to merge authentication info from multiple realms, but aggregate " + "AuthenticationInfo is not of type MergableAuthenticationInfo.");    }}
public AuthenticationInfo shiro_f202_0(AuthenticationToken token, AuthenticationInfo aggregate) throws AuthenticationException
{    return aggregate;}
public AuthenticationInfo shiro_f203_0(Realm realm, AuthenticationToken token, AuthenticationInfo info) throws AuthenticationException
{    if (!realm.supports(token)) {        String msg = "Realm [" + realm + "] of type [" + realm.getClass().getName() + "] does not support " + " the submitted AuthenticationToken [" + token + "].  The [" + getClass().getName() + "] implementation requires all configured realm(s) to support and be able to process the submitted " + "AuthenticationToken.";        throw new UnsupportedTokenException(msg);    }    return info;}
public AuthenticationInfo shiro_f204_1(Realm realm, AuthenticationToken token, AuthenticationInfo info, AuthenticationInfo aggregate, Throwable t) throws AuthenticationException
{    if (t != null) {        if (t instanceof AuthenticationException) {                        throw ((AuthenticationException) t);        } else {            String msg = "Unable to acquire account data from realm [" + realm + "].  The [" + getClass().getName() + " implementation requires all configured realm(s) to operate successfully " + "for a successful authentication.";            throw new AuthenticationException(msg, t);        }    }    if (info == null) {        String msg = "Realm [" + realm + "] could not find any associated account data for the submitted " + "AuthenticationToken [" + token + "].  The [" + getClass().getName() + "] implementation requires " + "all configured realm(s) to acquire valid account data for a submitted token during the " + "log-in process.";        throw new UnknownAccountException(msg);    }                merge(info, aggregate);    return aggregate;}
private static boolean shiro_f205_0(PrincipalCollection pc)
{    return pc == null || pc.isEmpty();}
public AuthenticationInfo shiro_f206_0(AuthenticationToken token, AuthenticationInfo aggregate) throws AuthenticationException
{        if (aggregate == null || isEmpty(aggregate.getPrincipals())) {        throw new AuthenticationException("Authentication token of type [" + token.getClass() + "] " + "could not be authenticated by any configured realms.  Please ensure that at least one realm can " + "authenticate these tokens.");    }    return aggregate;}
public AuthenticationInfo shiro_f207_0(Collection<? extends Realm> realms, AuthenticationToken token) throws AuthenticationException
{    return null;}
private static boolean shiro_f208_0(PrincipalCollection pc)
{    return pc == null || pc.isEmpty();}
protected AuthenticationInfo shiro_f209_0(AuthenticationInfo info, AuthenticationInfo aggregate)
{    if (aggregate != null && !isEmpty(aggregate.getPrincipals())) {        return aggregate;    }    return info != null ? info : aggregate;}
public void shiro_f210_0(Collection<Realm> realms)
{    this.realms = realms;}
protected Collection<Realm> shiro_f211_0()
{    return this.realms;}
public AuthenticationStrategy shiro_f212_0()
{    return authenticationStrategy;}
public void shiro_f213_0(AuthenticationStrategy authenticationStrategy)
{    this.authenticationStrategy = authenticationStrategy;}
protected void shiro_f214_0() throws IllegalStateException
{    Collection<Realm> realms = getRealms();    if (CollectionUtils.isEmpty(realms)) {        String msg = "Configuration error:  No realms have been configured!  One or more realms must be " + "present to execute an authentication attempt.";        throw new IllegalStateException(msg);    }}
protected AuthenticationInfo shiro_f215_0(Realm realm, AuthenticationToken token)
{    if (!realm.supports(token)) {        String msg = "Realm [" + realm + "] does not support authentication token [" + token + "].  Please ensure that the appropriate Realm implementation is " + "configured correctly or that the realm accepts AuthenticationTokens of this type.";        throw new UnsupportedTokenException(msg);    }    AuthenticationInfo info = realm.getAuthenticationInfo(token);    if (info == null) {        String msg = "Realm [" + realm + "] was unable to find account data for the " + "submitted AuthenticationToken [" + token + "].";        throw new UnknownAccountException(msg);    }    return info;}
protected AuthenticationInfo shiro_f216_1(Collection<Realm> realms, AuthenticationToken token)
{    AuthenticationStrategy strategy = getAuthenticationStrategy();    AuthenticationInfo aggregate = strategy.beforeAllAttempts(realms, token);    if (log.isTraceEnabled()) {        log.trace("Iterating through {} realms for PAM authentication", realms.size());    }    for (Realm realm : realms) {        aggregate = strategy.beforeAttempt(realm, token, aggregate);        if (realm.supports(token)) {            log.trace("Attempting to authenticate token [{}] using realm [{}]", token, realm);            AuthenticationInfo info = null;            Throwable t = null;            try {                info = realm.getAuthenticationInfo(token);            } catch (Throwable throwable) {                t = throwable;                if (log.isDebugEnabled()) {                    String msg = "Realm [" + realm + "] threw an exception during a multi-realm authentication attempt:";                                    }            }            aggregate = strategy.afterAttempt(realm, token, info, aggregate, t);        } else {                    }    }    aggregate = strategy.afterAllAttempts(token, aggregate);    return aggregate;}
protected AuthenticationInfo shiro_f217_0(AuthenticationToken authenticationToken) throws AuthenticationException
{    assertRealmsConfigured();    Collection<Realm> realms = getRealms();    if (realms.size() == 1) {        return doSingleRealmAuthentication(realms.iterator().next(), authenticationToken);    } else {        return doMultiRealmAuthentication(realms, authenticationToken);    }}
public void shiro_f218_0(PrincipalCollection principals)
{    super.onLogout(principals);    Collection<Realm> realms = getRealms();    if (!CollectionUtils.isEmpty(realms)) {        for (Realm realm : realms) {            if (realm instanceof LogoutAware) {                ((LogoutAware) realm).onLogout(principals);            }        }    }}
public PrincipalCollection shiro_f219_0()
{    return authcInfo.getPrincipals();}
public void shiro_f220_0(PrincipalCollection principals)
{    this.authcInfo.setPrincipals(principals);}
public Object shiro_f221_0()
{    return authcInfo.getCredentials();}
public void shiro_f222_0(Object credentials)
{    this.authcInfo.setCredentials(credentials);}
public ByteSource shiro_f223_0()
{    return this.authcInfo.getCredentialsSalt();}
public void shiro_f224_0(ByteSource salt)
{    this.authcInfo.setCredentialsSalt(salt);}
public Collection<String> shiro_f225_0()
{    return authzInfo.getRoles();}
public void shiro_f226_0(Set<String> roles)
{    this.authzInfo.setRoles(roles);}
public void shiro_f227_0(String role)
{    this.authzInfo.addRole(role);}
public void shiro_f228_0(Collection<String> roles)
{    this.authzInfo.addRoles(roles);}
public Collection<String> shiro_f229_0()
{    return authzInfo.getStringPermissions();}
public void shiro_f230_0(Set<String> permissions)
{    this.authzInfo.setStringPermissions(permissions);}
public void shiro_f231_0(String permission)
{    this.authzInfo.addStringPermission(permission);}
public void shiro_f232_0(Collection<String> permissions)
{    this.authzInfo.addStringPermissions(permissions);}
public Collection<Permission> shiro_f233_0()
{    return authzInfo.getObjectPermissions();}
public void shiro_f234_0(Set<Permission> permissions)
{    this.authzInfo.setObjectPermissions(permissions);}
public void shiro_f235_0(Permission permission)
{    this.authzInfo.addObjectPermission(permission);}
public void shiro_f236_0(Collection<Permission> permissions)
{    this.authzInfo.addObjectPermissions(permissions);}
public boolean shiro_f237_0()
{    return locked;}
public void shiro_f238_0(boolean locked)
{    this.locked = locked;}
public boolean shiro_f239_0()
{    return credentialsExpired;}
public void shiro_f240_0(boolean credentialsExpired)
{    this.credentialsExpired = credentialsExpired;}
public void shiro_f241_0(AuthenticationInfo info)
{    authcInfo.merge(info);        if (info instanceof SimpleAccount) {        SimpleAccount otherAccount = (SimpleAccount) info;        if (otherAccount.isLocked()) {            setLocked(true);        }        if (otherAccount.isCredentialsExpired()) {            setCredentialsExpired(true);        }    }}
public int shiro_f242_0()
{    return (getPrincipals() != null ? getPrincipals().hashCode() : 0);}
public boolean shiro_f243_0(Object o)
{    if (o == this) {        return true;    }    if (o instanceof SimpleAccount) {        SimpleAccount sa = (SimpleAccount) o;                return (getPrincipals() != null ? getPrincipals().equals(sa.getPrincipals()) : sa.getPrincipals() == null);    }    return false;}
public String shiro_f244_0()
{    return getPrincipals() != null ? getPrincipals().toString() : "empty";}
public PrincipalCollection shiro_f245_0()
{    return principals;}
public void shiro_f246_0(PrincipalCollection principals)
{    this.principals = principals;}
public Object shiro_f247_0()
{    return credentials;}
public void shiro_f248_0(Object credentials)
{    this.credentials = credentials;}
public ByteSource shiro_f249_0()
{    return credentialsSalt;}
public void shiro_f250_0(ByteSource salt)
{    this.credentialsSalt = salt;}
public void shiro_f251_0(AuthenticationInfo info)
{    if (info == null || info.getPrincipals() == null || info.getPrincipals().isEmpty()) {        return;    }    if (this.principals == null) {        this.principals = info.getPrincipals();    } else {        if (!(this.principals instanceof MutablePrincipalCollection)) {            this.principals = new SimplePrincipalCollection(this.principals);        }        ((MutablePrincipalCollection) this.principals).addAll(info.getPrincipals());    }        if (this.credentialsSalt == null && info instanceof SaltedAuthenticationInfo) {        this.credentialsSalt = ((SaltedAuthenticationInfo) info).getCredentialsSalt();    }    Object thisCredentials = getCredentials();    Object otherCredentials = info.getCredentials();    if (otherCredentials == null) {        return;    }    if (thisCredentials == null) {        this.credentials = otherCredentials;        return;    }    if (!(thisCredentials instanceof Collection)) {        Set newSet = new HashSet();        newSet.add(thisCredentials);        setCredentials(newSet);    }        Collection credentialCollection = (Collection) getCredentials();    if (otherCredentials instanceof Collection) {        credentialCollection.addAll((Collection) otherCredentials);    } else {        credentialCollection.add(otherCredentials);    }}
public boolean shiro_f252_0(Object o)
{    if (this == o)        return true;    if (!(o instanceof SimpleAuthenticationInfo))        return false;    SimpleAuthenticationInfo that = (SimpleAuthenticationInfo) o;        if (principals != null ? !principals.equals(that.principals) : that.principals != null)        return false;    return true;}
public int shiro_f253_0()
{    return (principals != null ? principals.hashCode() : 0);}
public String shiro_f254_0()
{    return principals.toString();}
public String shiro_f255_0()
{    return username;}
public void shiro_f256_0(String username)
{    this.username = username;}
public char[] shiro_f257_0()
{    return password;}
public void shiro_f258_0(char[] password)
{    this.password = password;}
public Object shiro_f259_0()
{    return getUsername();}
public Object shiro_f260_0()
{    return getPassword();}
public String shiro_f261_0()
{    return host;}
public void shiro_f262_0(String host)
{    this.host = host;}
public boolean shiro_f263_0()
{    return rememberMe;}
public void shiro_f264_0(boolean rememberMe)
{    this.rememberMe = rememberMe;}
public void shiro_f265_0()
{    this.username = null;    this.host = null;    this.rememberMe = false;    if (this.password != null) {        for (int i = 0; i < password.length; i++) {            this.password[i] = 0x00;        }        this.password = null;    }}
public String shiro_f266_0()
{    StringBuilder sb = new StringBuilder();    sb.append(getClass().getName());    sb.append(" - ");    sb.append(username);    sb.append(", rememberMe=").append(rememberMe);    if (host != null) {        sb.append(" (").append(host).append(")");    }    return sb.toString();}
public Collection<AuthorizingAnnotationMethodInterceptor> shiro_f267_0()
{    return methodInterceptors;}
public void shiro_f268_0(Collection<AuthorizingAnnotationMethodInterceptor> methodInterceptors)
{    this.methodInterceptors = methodInterceptors;}
protected void shiro_f269_0(MethodInvocation methodInvocation) throws AuthorizationException
{        Collection<AuthorizingAnnotationMethodInterceptor> aamis = getMethodInterceptors();    if (aamis != null && !aamis.isEmpty()) {        for (AuthorizingAnnotationMethodInterceptor aami : aamis) {            if (aami.supports(methodInvocation)) {                aami.assertAuthorized(methodInvocation);            }        }    }}
public void shiro_f270_0(Annotation a) throws UnauthenticatedException
{    if (a instanceof RequiresAuthentication && !getSubject().isAuthenticated()) {        throw new UnauthenticatedException("The current Subject is not authenticated.  Access denied.");    }}
public Object shiro_f271_0(MethodInvocation methodInvocation) throws Throwable
{    assertAuthorized(methodInvocation);    return methodInvocation.proceed();}
public void shiro_f272_0(MethodInvocation mi) throws AuthorizationException
{    try {        ((AuthorizingAnnotationHandler) getHandler()).assertAuthorized(getAnnotation(mi));    } catch (AuthorizationException ae) {                if (ae.getCause() == null)            ae.initCause(new AuthorizationException("Not authorized to invoke method: " + mi.getMethod()));        throw ae;    }}
public Object shiro_f273_0(MethodInvocation methodInvocation) throws Throwable
{    assertAuthorized(methodInvocation);    return methodInvocation.proceed();}
public void shiro_f274_0(Annotation a) throws AuthorizationException
{    if (a instanceof RequiresGuest && getSubject().getPrincipal() != null) {        throw new UnauthenticatedException("Attempting to perform a guest-only operation.  The current Subject is " + "not a guest (they have been authenticated or remembered from a previous login).  Access " + "denied.");    }}
protected String[] shiro_f275_0(Annotation a)
{    RequiresPermissions rpAnnotation = (RequiresPermissions) a;    return rpAnnotation.value();}
public void shiro_f276_0(Annotation a) throws AuthorizationException
{    if (!(a instanceof RequiresPermissions))        return;    RequiresPermissions rpAnnotation = (RequiresPermissions) a;    String[] perms = getAnnotationValue(a);    Subject subject = getSubject();    if (perms.length == 1) {        subject.checkPermission(perms[0]);        return;    }    if (Logical.AND.equals(rpAnnotation.logical())) {        getSubject().checkPermissions(perms);        return;    }    if (Logical.OR.equals(rpAnnotation.logical())) {                boolean hasAtLeastOnePermission = false;        for (String permission : perms) if (getSubject().isPermitted(permission))            hasAtLeastOnePermission = true;                if (!hasAtLeastOnePermission)            getSubject().checkPermission(perms[0]);    }}
public void shiro_f277_0(Annotation a) throws AuthorizationException
{    if (!(a instanceof RequiresRoles))        return;    RequiresRoles rrAnnotation = (RequiresRoles) a;    String[] roles = rrAnnotation.value();    if (roles.length == 1) {        getSubject().checkRole(roles[0]);        return;    }    if (Logical.AND.equals(rrAnnotation.logical())) {        getSubject().checkRoles(Arrays.asList(roles));        return;    }    if (Logical.OR.equals(rrAnnotation.logical())) {                boolean hasAtLeastOneRole = false;        for (String role : roles) if (getSubject().hasRole(role))            hasAtLeastOneRole = true;                if (!hasAtLeastOneRole)            getSubject().checkRole(roles[0]);    }}
public void shiro_f278_0(Annotation a) throws AuthorizationException
{    if (a instanceof RequiresUser && getSubject().getPrincipal() == null) {        throw new UnauthenticatedException("Attempting to perform a user-only operation.  The current Subject is " + "not a user (they haven't been authenticated or remembered from a previous login).  " + "Access denied.");    }}
public String shiro_f279_0()
{    return this.host;}
public void shiro_f280_0(String host)
{    this.host = host;}
public Collection<Realm> shiro_f281_0()
{    return this.realms;}
public void shiro_f282_0(Collection<Realm> realms)
{    this.realms = realms;    applyPermissionResolverToRealms();    applyRolePermissionResolverToRealms();}
public PermissionResolver shiro_f283_0()
{    return this.permissionResolver;}
public void shiro_f284_0(PermissionResolver permissionResolver)
{    this.permissionResolver = permissionResolver;    applyPermissionResolverToRealms();}
protected void shiro_f285_0()
{    PermissionResolver resolver = getPermissionResolver();    Collection<Realm> realms = getRealms();    if (resolver != null && realms != null && !realms.isEmpty()) {        for (Realm realm : realms) {            if (realm instanceof PermissionResolverAware) {                ((PermissionResolverAware) realm).setPermissionResolver(resolver);            }        }    }}
public RolePermissionResolver shiro_f286_0()
{    return this.rolePermissionResolver;}
public void shiro_f287_0(RolePermissionResolver rolePermissionResolver)
{    this.rolePermissionResolver = rolePermissionResolver;    applyRolePermissionResolverToRealms();}
protected void shiro_f288_0()
{    RolePermissionResolver resolver = getRolePermissionResolver();    Collection<Realm> realms = getRealms();    if (resolver != null && realms != null && !realms.isEmpty()) {        for (Realm realm : realms) {            if (realm instanceof RolePermissionResolverAware) {                ((RolePermissionResolverAware) realm).setRolePermissionResolver(resolver);            }        }    }}
protected void shiro_f289_0() throws IllegalStateException
{    Collection<Realm> realms = getRealms();    if (realms == null || realms.isEmpty()) {        String msg = "Configuration error:  No realms have been configured!  One or more realms must be " + "present to execute an authorization operation.";        throw new IllegalStateException(msg);    }}
public boolean shiro_f290_0(PrincipalCollection principals, String permission)
{    assertRealmsConfigured();    for (Realm realm : getRealms()) {        if (!(realm instanceof Authorizer))            continue;        if (((Authorizer) realm).isPermitted(principals, permission)) {            return true;        }    }    return false;}
public boolean shiro_f291_0(PrincipalCollection principals, Permission permission)
{    assertRealmsConfigured();    for (Realm realm : getRealms()) {        if (!(realm instanceof Authorizer))            continue;        if (((Authorizer) realm).isPermitted(principals, permission)) {            return true;        }    }    return false;}
public boolean[] shiro_f292_0(PrincipalCollection principals, String... permissions)
{    assertRealmsConfigured();    if (permissions != null && permissions.length > 0) {        boolean[] isPermitted = new boolean[permissions.length];        for (int i = 0; i < permissions.length; i++) {            isPermitted[i] = isPermitted(principals, permissions[i]);        }        return isPermitted;    }    return new boolean[0];}
public boolean[] shiro_f293_0(PrincipalCollection principals, List<Permission> permissions)
{    assertRealmsConfigured();    if (permissions != null && !permissions.isEmpty()) {        boolean[] isPermitted = new boolean[permissions.size()];        int i = 0;        for (Permission p : permissions) {            isPermitted[i++] = isPermitted(principals, p);        }        return isPermitted;    }    return new boolean[0];}
public boolean shiro_f294_0(PrincipalCollection principals, String... permissions)
{    assertRealmsConfigured();    if (permissions != null && permissions.length > 0) {        for (String perm : permissions) {            if (!isPermitted(principals, perm)) {                return false;            }        }    }    return true;}
public boolean shiro_f295_0(PrincipalCollection principals, Collection<Permission> permissions)
{    assertRealmsConfigured();    if (permissions != null && !permissions.isEmpty()) {        for (Permission permission : permissions) {            if (!isPermitted(principals, permission)) {                return false;            }        }    }    return true;}
public void shiro_f296_0(PrincipalCollection principals, String permission) throws AuthorizationException
{    assertRealmsConfigured();    if (!isPermitted(principals, permission)) {        throw new UnauthorizedException("Subject does not have permission [" + permission + "]");    }}
public void shiro_f297_0(PrincipalCollection principals, Permission permission) throws AuthorizationException
{    assertRealmsConfigured();    if (!isPermitted(principals, permission)) {        throw new UnauthorizedException("Subject does not have permission [" + permission + "]");    }}
public void shiro_f298_0(PrincipalCollection principals, String... permissions) throws AuthorizationException
{    assertRealmsConfigured();    if (permissions != null && permissions.length > 0) {        for (String perm : permissions) {            checkPermission(principals, perm);        }    }}
public void shiro_f299_0(PrincipalCollection principals, Collection<Permission> permissions) throws AuthorizationException
{    assertRealmsConfigured();    if (permissions != null) {        for (Permission permission : permissions) {            checkPermission(principals, permission);        }    }}
public boolean shiro_f300_0(PrincipalCollection principals, String roleIdentifier)
{    assertRealmsConfigured();    for (Realm realm : getRealms()) {        if (!(realm instanceof Authorizer))            continue;        if (((Authorizer) realm).hasRole(principals, roleIdentifier)) {            return true;        }    }    return false;}
public boolean[] shiro_f301_0(PrincipalCollection principals, List<String> roleIdentifiers)
{    assertRealmsConfigured();    if (roleIdentifiers != null && !roleIdentifiers.isEmpty()) {        boolean[] hasRoles = new boolean[roleIdentifiers.size()];        int i = 0;        for (String roleId : roleIdentifiers) {            hasRoles[i++] = hasRole(principals, roleId);        }        return hasRoles;    }    return new boolean[0];}
public boolean shiro_f302_0(PrincipalCollection principals, Collection<String> roleIdentifiers)
{    assertRealmsConfigured();    for (String roleIdentifier : roleIdentifiers) {        if (!hasRole(principals, roleIdentifier)) {            return false;        }    }    return true;}
public void shiro_f303_0(PrincipalCollection principals, String role) throws AuthorizationException
{    assertRealmsConfigured();    if (!hasRole(principals, role)) {        throw new UnauthorizedException("Subject does not have role [" + role + "]");    }}
public void shiro_f304_0(PrincipalCollection principals, Collection<String> roles) throws AuthorizationException
{        if (roles != null && !roles.isEmpty())        checkRoles(principals, roles.toArray(new String[roles.size()]));}
public void shiro_f305_0(PrincipalCollection principals, String... roles) throws AuthorizationException
{    assertRealmsConfigured();    if (roles != null) {        for (String role : roles) {            checkRole(principals, role);        }    }}
public boolean shiro_f306_0(Permission p)
{    return true;}
private void shiro_f307_0(String domain, String actions, String targets)
{    if (!StringUtils.hasText(domain)) {        throw new IllegalArgumentException("domain argument cannot be null or empty.");    }    StringBuilder sb = new StringBuilder(domain);    if (!StringUtils.hasText(actions)) {        if (StringUtils.hasText(targets)) {            sb.append(PART_DIVIDER_TOKEN).append(WILDCARD_TOKEN);        }    } else {        sb.append(PART_DIVIDER_TOKEN).append(actions);    }    if (StringUtils.hasText(targets)) {        sb.append(PART_DIVIDER_TOKEN).append(targets);    }    setParts(sb.toString());}
protected void shiro_f308_0(String domain, Set<String> actions, Set<String> targets)
{    String actionsString = StringUtils.toDelimitedString(actions, SUBPART_DIVIDER_TOKEN);    String targetsString = StringUtils.toDelimitedString(targets, SUBPART_DIVIDER_TOKEN);    encodeParts(domain, actionsString, targetsString);    this.domain = domain;    this.actions = actions;    this.targets = targets;}
protected String shiro_f309_0(Class<? extends DomainPermission> clazz)
{    String domain = clazz.getSimpleName().toLowerCase();        int index = domain.lastIndexOf("permission");    if (index != -1) {        domain = domain.substring(0, index);    }    return domain;}
public String shiro_f310_0()
{    return domain;}
protected void shiro_f311_0(String domain)
{    if (this.domain != null && this.domain.equals(domain)) {        return;    }    this.domain = domain;    setParts(domain, actions, targets);}
public Set<String> shiro_f312_0()
{    return actions;}
protected void shiro_f313_0(Set<String> actions)
{    if (this.actions != null && this.actions.equals(actions)) {        return;    }    this.actions = actions;    setParts(domain, actions, targets);}
public Set<String> shiro_f314_0()
{    return targets;}
protected void shiro_f315_0(Set<String> targets)
{    if (this.targets != null && this.targets.equals(targets)) {        return;    }    this.targets = targets;    setParts(domain, actions, targets);}
public String shiro_f316_0()
{    return this.permissionString;}
protected void shiro_f317_0(String wildcardString)
{    setParts(wildcardString, DEFAULT_CASE_SENSITIVE);}
protected void shiro_f318_0(String wildcardString, boolean caseSensitive)
{    wildcardString = StringUtils.clean(wildcardString);    if (wildcardString == null || wildcardString.isEmpty()) {        throw new IllegalArgumentException("Wildcard string cannot be null or empty. Make sure permission strings are properly formatted.");    }    if (!caseSensitive) {        wildcardString = wildcardString.toLowerCase();    }    List<String> parts = CollectionUtils.asList(wildcardString.split(PART_DIVIDER_TOKEN));    this.parts = new ArrayList<Set<String>>();    for (String part : parts) {        Set<String> subparts = CollectionUtils.asSet(part.split(SUBPART_DIVIDER_TOKEN));        if (subparts.isEmpty()) {            throw new IllegalArgumentException("Wildcard string cannot contain parts with only dividers. Make sure permission strings are properly formatted.");        }        this.parts.add(subparts);    }    if (this.parts.isEmpty()) {        throw new IllegalArgumentException("Wildcard string cannot contain only dividers. Make sure permission strings are properly formatted.");    }}
protected List<Set<String>> shiro_f319_0()
{    return this.parts;}
protected void shiro_f320_0(List<Set<String>> parts)
{    this.parts = parts;}
public boolean shiro_f321_0(Permission p)
{        if (!(p instanceof WildcardPermission)) {        return false;    }    WildcardPermission wp = (WildcardPermission) p;    List<Set<String>> otherParts = wp.getParts();    int i = 0;    for (Set<String> otherPart : otherParts) {                if (getParts().size() - 1 < i) {            return true;        } else {            Set<String> part = getParts().get(i);            if (!part.contains(WILDCARD_TOKEN) && !part.containsAll(otherPart)) {                return false;            }            i++;        }    }        for (; i < getParts().size(); i++) {        Set<String> part = getParts().get(i);        if (!part.contains(WILDCARD_TOKEN)) {            return false;        }    }    return true;}
public String shiro_f322_0()
{    StringBuilder buffer = new StringBuilder();    for (Set<String> part : parts) {        if (buffer.length() > 0) {            buffer.append(PART_DIVIDER_TOKEN);        }        Iterator<String> partIt = part.iterator();        while (partIt.hasNext()) {            buffer.append(partIt.next());            if (partIt.hasNext()) {                buffer.append(SUBPART_DIVIDER_TOKEN);            }        }    }    return buffer.toString();}
public boolean shiro_f323_0(Object o)
{    if (o instanceof WildcardPermission) {        WildcardPermission wp = (WildcardPermission) o;        return parts.equals(wp.parts);    }    return false;}
public int shiro_f324_0()
{    return parts.hashCode();}
public void shiro_f325_0(boolean state)
{    this.caseSensitive = state;}
public boolean shiro_f326_0()
{    return caseSensitive;}
public Permission shiro_f327_0(String permissionString)
{    return new WildcardPermission(permissionString, caseSensitive);}
public Set<String> shiro_f328_0()
{    return roles;}
public void shiro_f329_0(Set<String> roles)
{    this.roles = roles;}
public void shiro_f330_0(String role)
{    if (this.roles == null) {        this.roles = new HashSet<String>();    }    this.roles.add(role);}
public void shiro_f331_0(Collection<String> roles)
{    if (this.roles == null) {        this.roles = new HashSet<String>();    }    this.roles.addAll(roles);}
public Set<String> shiro_f332_0()
{    return stringPermissions;}
public void shiro_f333_0(Set<String> stringPermissions)
{    this.stringPermissions = stringPermissions;}
public void shiro_f334_0(String permission)
{    if (this.stringPermissions == null) {        this.stringPermissions = new HashSet<String>();    }    this.stringPermissions.add(permission);}
public void shiro_f335_0(Collection<String> permissions)
{    if (this.stringPermissions == null) {        this.stringPermissions = new HashSet<String>();    }    this.stringPermissions.addAll(permissions);}
public Set<Permission> shiro_f336_0()
{    return objectPermissions;}
public void shiro_f337_0(Set<Permission> objectPermissions)
{    this.objectPermissions = objectPermissions;}
public void shiro_f338_0(Permission permission)
{    if (this.objectPermissions == null) {        this.objectPermissions = new HashSet<Permission>();    }    this.objectPermissions.add(permission);}
public void shiro_f339_0(Collection<Permission> permissions)
{    if (this.objectPermissions == null) {        this.objectPermissions = new HashSet<Permission>();    }    this.objectPermissions.addAll(permissions);}
public String shiro_f340_0()
{    return name;}
public void shiro_f341_0(String name)
{    this.name = name;}
public Set<Permission> shiro_f342_0()
{    return permissions;}
public void shiro_f343_0(Set<Permission> permissions)
{    this.permissions = permissions;}
public void shiro_f344_0(Permission permission)
{    Set<Permission> permissions = getPermissions();    if (permissions == null) {        permissions = new LinkedHashSet<Permission>();        setPermissions(permissions);    }    permissions.add(permission);}
public void shiro_f345_0(Collection<Permission> perms)
{    if (perms != null && !perms.isEmpty()) {        Set<Permission> permissions = getPermissions();        if (permissions == null) {            permissions = new LinkedHashSet<Permission>(perms.size());            setPermissions(permissions);        }        permissions.addAll(perms);    }}
public boolean shiro_f346_0(Permission p)
{    Collection<Permission> perms = getPermissions();    if (perms != null && !perms.isEmpty()) {        for (Permission perm : perms) {            if (perm.implies(p)) {                return true;            }        }    }    return false;}
public int shiro_f347_0()
{    return (getName() != null ? getName().hashCode() : 0);}
public boolean shiro_f348_0(Object o)
{    if (o == this) {        return true;    }    if (o instanceof SimpleRole) {        SimpleRole sr = (SimpleRole) o;                return (getName() != null ? getName().equals(sr.getName()) : sr.getName() == null);    }    return false;}
public String shiro_f349_0()
{    return getName();}
public Executor shiro_f350_0()
{    return targetExecutor;}
public void shiro_f351_0(Executor targetExecutor)
{    this.targetExecutor = targetExecutor;}
protected Subject shiro_f352_0()
{    return SecurityUtils.getSubject();}
protected Runnable shiro_f353_0(Runnable r)
{    Subject subject = getSubject();    return subject.associateWith(r);}
public void shiro_f354_0(Runnable command)
{    Runnable associated = associateWithSubject(command);    getTargetExecutor().execute(associated);}
public ExecutorService shiro_f355_0()
{    return targetExecutorService;}
public void shiro_f356_0(ExecutorService targetExecutorService)
{    super.setTargetExecutor(targetExecutorService);    this.targetExecutorService = targetExecutorService;}
public void shiro_f357_0(Executor targetExecutor)
{    if (!(targetExecutor instanceof ExecutorService)) {        String msg = "The " + getClass().getName() + " implementation only accepts " + ExecutorService.class.getName() + " target instances.";        throw new IllegalArgumentException(msg);    }    super.setTargetExecutor(targetExecutor);}
public void shiro_f358_0()
{    this.targetExecutorService.shutdown();}
public List<Runnable> shiro_f359_0()
{    return this.targetExecutorService.shutdownNow();}
public boolean shiro_f360_0()
{    return this.targetExecutorService.isShutdown();}
public boolean shiro_f361_0()
{    return this.targetExecutorService.isTerminated();}
public boolean shiro_f362_0(long timeout, TimeUnit unit) throws InterruptedException
{    return this.targetExecutorService.awaitTermination(timeout, unit);}
protected Callable<T> shiro_f363_0(Callable<T> task)
{    Subject subject = getSubject();    return subject.associateWith(task);}
public Future<T> shiro_f364_0(Callable<T> task)
{    Callable<T> work = associateWithSubject(task);    return this.targetExecutorService.submit(work);}
public Future<T> shiro_f365_0(Runnable task, T result)
{    Runnable work = associateWithSubject(task);    return this.targetExecutorService.submit(work, result);}
public Future<?> shiro_f366_0(Runnable task)
{    Runnable work = associateWithSubject(task);    return this.targetExecutorService.submit(work);}
protected Collection<Callable<T>> shiro_f367_0(Collection<? extends Callable<T>> tasks)
{    Collection<Callable<T>> workItems = new ArrayList<Callable<T>>(tasks.size());    for (Callable<T> task : tasks) {        Callable<T> work = associateWithSubject(task);        workItems.add(work);    }    return workItems;}
public List<Future<T>> shiro_f368_0(Collection<? extends Callable<T>> tasks) throws InterruptedException
{    Collection<Callable<T>> workItems = associateWithSubject(tasks);    return this.targetExecutorService.invokeAll(workItems);}
public List<Future<T>> shiro_f369_0(Collection<? extends Callable<T>> tasks, long timeout, TimeUnit unit) throws InterruptedException
{    Collection<Callable<T>> workItems = associateWithSubject(tasks);    return this.targetExecutorService.invokeAll(workItems, timeout, unit);}
public T shiro_f370_0(Collection<? extends Callable<T>> tasks) throws InterruptedException, ExecutionException
{    Collection<Callable<T>> workItems = associateWithSubject(tasks);    return this.targetExecutorService.invokeAny(workItems);}
public T shiro_f371_0(Collection<? extends Callable<T>> tasks, long timeout, TimeUnit unit) throws InterruptedException, ExecutionException, TimeoutException
{    Collection<Callable<T>> workItems = associateWithSubject(tasks);    return this.targetExecutorService.invokeAny(workItems, timeout, unit);}
public ScheduledExecutorService shiro_f372_0()
{    return targetScheduledExecutorService;}
public void shiro_f373_0(ScheduledExecutorService targetScheduledExecutorService)
{    super.setTargetExecutorService(targetScheduledExecutorService);    this.targetScheduledExecutorService = targetScheduledExecutorService;}
public void shiro_f374_0(Executor targetExecutor)
{    if (!(targetExecutor instanceof ScheduledExecutorService)) {        String msg = "The " + getClass().getName() + " implementation only accepts " + ScheduledExecutorService.class.getName() + " target instances.";        throw new IllegalArgumentException(msg);    }    super.setTargetExecutorService((ScheduledExecutorService) targetExecutor);}
public void shiro_f375_0(ExecutorService targetExecutorService)
{    if (!(targetExecutorService instanceof ScheduledExecutorService)) {        String msg = "The " + getClass().getName() + " implementation only accepts " + ScheduledExecutorService.class.getName() + " target instances.";        throw new IllegalArgumentException(msg);    }    super.setTargetExecutorService(targetExecutorService);}
public ScheduledFuture<?> shiro_f376_0(Runnable command, long delay, TimeUnit unit)
{    Runnable work = associateWithSubject(command);    return this.targetScheduledExecutorService.schedule(work, delay, unit);}
public ScheduledFuture<V> shiro_f377_0(Callable<V> callable, long delay, TimeUnit unit)
{    Callable<V> work = associateWithSubject(callable);    return this.targetScheduledExecutorService.schedule(work, delay, unit);}
public ScheduledFuture<?> shiro_f378_0(Runnable command, long initialDelay, long period, TimeUnit unit)
{    Runnable work = associateWithSubject(command);    return this.targetScheduledExecutorService.scheduleAtFixedRate(work, initialDelay, period, unit);}
public ScheduledFuture<?> shiro_f379_0(Runnable command, long initialDelay, long delay, TimeUnit unit)
{    Runnable work = associateWithSubject(command);    return this.targetScheduledExecutorService.scheduleWithFixedDelay(work, initialDelay, delay, unit);}
public Ini shiro_f380_0()
{    return ini;}
public void shiro_f381_0(Ini ini)
{    this.ini = ini;}
protected Map<String, ?> shiro_f382_0()
{    return defaultBeans;}
public void shiro_f383_0(Map<String, ?> defaultBeans)
{    this.defaultBeans = defaultBeans;}
public static Ini shiro_f384_1()
{    Ini ini = null;    if (ResourceUtils.resourceExists(DEFAULT_INI_RESOURCE_PATH)) {                ini = new Ini();        ini.loadFromPath(DEFAULT_INI_RESOURCE_PATH);        if (CollectionUtils.isEmpty(ini)) {                    }    }    return ini;}
protected Ini shiro_f385_1()
{    Ini ini = getIni();    if (CollectionUtils.isEmpty(ini)) {                ini = loadDefaultClassPathIni();    }    return ini;}
public T shiro_f386_1()
{    Ini ini = resolveIni();    T instance;    if (CollectionUtils.isEmpty(ini)) {                instance = createDefaultInstance();        if (instance == null) {            String msg = getClass().getName() + " implementation did not return a default instance in " + "the event of a null/empty Ini configuration.  This is required to support the " + "Factory interface.  Please check your implementation.";            throw new IllegalStateException(msg);        }    } else {                instance = createInstance(ini);        if (instance == null) {            String msg = getClass().getName() + " implementation did not return a constructed instance from " + "the createInstance(Ini) method implementation.";            throw new IllegalStateException(msg);        }    }    return instance;}
public Map<String, ?> shiro_f387_0()
{    return this.builder != null ? Collections.unmodifiableMap(builder.getObjects()) : null;}
public void shiro_f388_0()
{    if (getReflectionBuilder() != null) {        getReflectionBuilder().destroy();    }}
private SecurityManager shiro_f389_0()
{    return getReflectionBuilder().getBean(SECURITY_MANAGER_NAME, SecurityManager.class);}
protected SecurityManager shiro_f390_0()
{    return new DefaultSecurityManager();}
protected SecurityManager shiro_f391_0(Ini ini)
{    if (CollectionUtils.isEmpty(ini)) {        throw new NullPointerException("Ini argument cannot be null or empty.");    }    SecurityManager securityManager = createSecurityManager(ini);    if (securityManager == null) {        String msg = SecurityManager.class + " instance cannot be null.";        throw new ConfigurationException(msg);    }    return securityManager;}
private SecurityManager shiro_f392_0(Ini ini)
{    return createSecurityManager(ini, getConfigSection(ini));}
private Ini.Section shiro_f393_0(Ini ini)
{    Ini.Section mainSection = ini.getSection(MAIN_SECTION_NAME);    if (CollectionUtils.isEmpty(mainSection)) {                mainSection = ini.getSection(Ini.DEFAULT_SECTION_NAME);    }    return mainSection;}
protected boolean shiro_f394_1(SecurityManager securityManager)
{    boolean autoApply = true;    if (securityManager instanceof RealmSecurityManager) {                RealmSecurityManager realmSecurityManager = (RealmSecurityManager) securityManager;        Collection<Realm> realms = realmSecurityManager.getRealms();        if (!CollectionUtils.isEmpty(realms)) {                        autoApply = false;        }    }    return autoApply;}
private SecurityManager shiro_f395_0(Ini ini, Ini.Section mainSection)
{    getReflectionBuilder().setObjects(createDefaults(ini, mainSection));    Map<String, ?> objects = buildInstances(mainSection);    SecurityManager securityManager = getSecurityManagerBean();    boolean autoApplyRealms = isAutoApplyRealms(securityManager);    if (autoApplyRealms) {                        Collection<Realm> realms = getRealms(objects);                if (!CollectionUtils.isEmpty(realms)) {            applyRealmsToSecurityManager(realms, securityManager);        }    }    return securityManager;}
protected Map<String, ?> shiro_f396_0(Ini ini, Ini.Section mainSection)
{    Map<String, Object> defaults = new LinkedHashMap<String, Object>();    SecurityManager securityManager = createDefaultInstance();    defaults.put(SECURITY_MANAGER_NAME, securityManager);    if (shouldImplicitlyCreateRealm(ini)) {        Realm realm = createRealm(ini);        if (realm != null) {            defaults.put(INI_REALM_NAME, realm);        }    }        Map<String, ?> defaultBeans = getDefaults();    if (!CollectionUtils.isEmpty(defaultBeans)) {        defaults.putAll(defaultBeans);    }    return defaults;}
private Map<String, ?> shiro_f397_0(Ini.Section section)
{    return getReflectionBuilder().buildObjects(section);}
private void shiro_f398_0(Collection<Realm> realms, RealmFactory factory)
{    LifecycleUtils.init(factory);    Collection<Realm> factoryRealms = factory.getRealms();        if (!CollectionUtils.isEmpty(factoryRealms)) {        realms.addAll(factoryRealms);    }}
private Collection<Realm> shiro_f399_1(Map<String, ?> instances)
{            List<Realm> realms = new ArrayList<Realm>();        for (Map.Entry<String, ?> entry : instances.entrySet()) {        String name = entry.getKey();        Object value = entry.getValue();        if (value instanceof RealmFactory) {            addToRealms(realms, (RealmFactory) value);        } else if (value instanceof Realm) {            Realm realm = (Realm) value;                        String existingName = realm.getName();            if (existingName == null || existingName.startsWith(realm.getClass().getName())) {                if (realm instanceof Nameable) {                    ((Nameable) realm).setName(name);                                    } else {                                    }            }            realms.add(realm);        }    }    return realms;}
private void shiro_f400_0(SecurityManager securityManager)
{    if (securityManager == null) {        throw new NullPointerException("securityManager instance cannot be null");    }    if (!(securityManager instanceof RealmSecurityManager)) {        String msg = "securityManager instance is not a " + RealmSecurityManager.class.getName() + " instance.  This is required to access or configure realms on the instance.";        throw new ConfigurationException(msg);    }}
protected void shiro_f401_0(Collection<Realm> realms, SecurityManager securityManager)
{    assertRealmSecurityManager(securityManager);    ((RealmSecurityManager) securityManager).setRealms(realms);}
protected boolean shiro_f402_0(Ini ini)
{    return !CollectionUtils.isEmpty(ini) && (!CollectionUtils.isEmpty(ini.getSection(IniRealm.ROLES_SECTION_NAME)) || !CollectionUtils.isEmpty(ini.getSection(IniRealm.USERS_SECTION_NAME)));}
protected Realm shiro_f403_0(Ini ini)
{        IniRealm realm = new IniRealm();    realm.setName(INI_REALM_NAME);        realm.setIni(ini);    return realm;}
public ReflectionBuilder shiro_f404_0()
{    return builder;}
public void shiro_f405_0(ReflectionBuilder builder)
{    this.builder = builder;}
public SecurityManager shiro_f406_0() throws IllegalStateException
{    SecurityManager securityManager = lookupSecurityManager();    if (securityManager == null) {        throw new IllegalStateException("No SecurityManager found in Environment.  This is an invalid " + "environment state.");    }    return securityManager;}
public void shiro_f407_0(SecurityManager securityManager)
{    if (securityManager == null) {        throw new IllegalArgumentException("Null SecurityManager instances are not allowed.");    }    String name = getSecurityManagerName();    setObject(name, securityManager);}
protected SecurityManager shiro_f408_0()
{    String name = getSecurityManagerName();    return getObject(name, SecurityManager.class);}
public String shiro_f409_0()
{    return securityManagerName;}
public void shiro_f410_0(String securityManagerName)
{    this.securityManagerName = securityManagerName;}
public Map<String, Object> shiro_f411_0()
{    return this.objects;}
public T shiro_f412_0(String name, Class<T> requiredType) throws RequiredTypeException
{    if (name == null) {        throw new NullPointerException("name parameter cannot be null.");    }    if (requiredType == null) {        throw new NullPointerException("requiredType parameter cannot be null.");    }    Object o = this.objects.get(name);    if (o == null) {        return null;    }    if (!requiredType.isInstance(o)) {        String msg = "Object named '" + name + "' is not of required type [" + requiredType.getName() + "].";        throw new RequiredTypeException(msg);    }    return (T) o;}
public void shiro_f413_0(String name, Object instance)
{    if (name == null) {        throw new NullPointerException("name parameter cannot be null.");    }    if (instance == null) {        this.objects.remove(name);    } else {        this.objects.put(name, instance);    }}
public void shiro_f414_0() throws Exception
{    LifecycleUtils.destroy(this.objects.values());}
public void shiro_f415_0(JndiTemplate jndiTemplate)
{    this.jndiTemplate = (jndiTemplate != null ? jndiTemplate : new JndiTemplate());}
public JndiTemplate shiro_f416_0()
{    return this.jndiTemplate;}
public void shiro_f417_0(Properties jndiEnvironment)
{    this.jndiTemplate = new JndiTemplate(jndiEnvironment);}
public Properties shiro_f418_0()
{    return this.jndiTemplate.getEnvironment();}
public void shiro_f419_0(boolean resourceRef)
{    this.resourceRef = resourceRef;}
public boolean shiro_f420_0()
{    return this.resourceRef;}
protected Object shiro_f421_0(String jndiName) throws NamingException
{    return lookup(jndiName, null);}
protected Object shiro_f422_1(String jndiName, Class requiredType) throws NamingException
{    if (jndiName == null) {        throw new IllegalArgumentException("jndiName argument must not be null");    }    String convertedName = convertJndiName(jndiName);    Object jndiObject;    try {        jndiObject = getJndiTemplate().lookup(convertedName, requiredType);    } catch (NamingException ex) {        if (!convertedName.equals(jndiName)) {                        if (log.isDebugEnabled()) {                            }            jndiObject = getJndiTemplate().lookup(jndiName, requiredType);        } else {            throw ex;        }    }        return jndiObject;}
protected String shiro_f423_0(String jndiName)
{        if (isResourceRef() && !jndiName.startsWith(CONTAINER_PREFIX) && jndiName.indexOf(':') == -1) {        jndiName = CONTAINER_PREFIX + jndiName;    }    return jndiName;}
public T shiro_f424_0()
{    try {        if (requiredType != null) {            return requiredType.cast(this.lookup(resourceName, requiredType));        } else {            return (T) this.lookup(resourceName);        }    } catch (NamingException e) {        final String typeName = requiredType != null ? requiredType.getName() : "object";        throw new IllegalStateException("Unable to look up " + typeName + " with jndi name '" + resourceName + "'.", e);    }}
public String shiro_f425_0()
{    return resourceName;}
public void shiro_f426_0(String resourceName)
{    this.resourceName = resourceName;}
public Class<? extends T> shiro_f427_0()
{    return requiredType;}
public void shiro_f428_0(Class<? extends T> requiredType)
{    this.requiredType = requiredType;}
public void shiro_f429_0(Properties environment)
{    this.environment = environment;}
public Properties shiro_f430_0()
{    return this.environment;}
public Object shiro_f431_1(JndiCallback contextCallback) throws NamingException
{    Context ctx = createInitialContext();    try {        return contextCallback.doInContext(ctx);    } finally {        try {            ctx.close();        } catch (NamingException ex) {                    }    }}
protected Context shiro_f432_0() throws NamingException
{    Properties env = getEnvironment();    Hashtable icEnv = null;    if (env != null) {        icEnv = new Hashtable(env.size());        for (Enumeration en = env.propertyNames(); en.hasMoreElements(); ) {            String key = (String) en.nextElement();            icEnv.put(key, env.getProperty(key));        }    }    return new InitialContext(icEnv);}
public Object shiro_f433_1(final String name) throws NamingException
{        return execute(new JndiCallback() {        public Object doInContext(Context ctx) throws NamingException {            Object located = ctx.lookup(name);            if (located == null) {                throw new NameNotFoundException("JNDI object with [" + name + "] not found: JNDI implementation returned null");            }            return located;        }    });}
public Object shiro_f434_0(Context ctx) throws NamingException
{    Object located = ctx.lookup(name);    if (located == null) {        throw new NameNotFoundException("JNDI object with [" + name + "] not found: JNDI implementation returned null");    }    return located;}
public Object shiro_f435_0(String name, Class requiredType) throws NamingException
{    Object jndiObject = lookup(name);    if (requiredType != null && !requiredType.isInstance(jndiObject)) {        String msg = "Jndi object acquired under name '" + name + "' is of type [" + jndiObject.getClass().getName() + "] and not assignable to the required type [" + requiredType.getName() + "].";        throw new NamingException(msg);    }    return jndiObject;}
public void shiro_f436_1(final String name, final Object object) throws NamingException
{        execute(new JndiCallback() {        public Object doInContext(Context ctx) throws NamingException {            ctx.bind(name, object);            return null;        }    });}
public Object shiro_f437_0(Context ctx) throws NamingException
{    ctx.bind(name, object);    return null;}
public void shiro_f438_1(final String name, final Object object) throws NamingException
{        execute(new JndiCallback() {        public Object doInContext(Context ctx) throws NamingException {            ctx.rebind(name, object);            return null;        }    });}
public Object shiro_f439_0(Context ctx) throws NamingException
{    ctx.rebind(name, object);    return null;}
public void shiro_f440_1(final String name) throws NamingException
{        execute(new JndiCallback() {        public Object doInContext(Context ctx) throws NamingException {            ctx.unbind(name);            return null;        }    });}
public Object shiro_f441_0(Context ctx) throws NamingException
{    ctx.unbind(name);    return null;}
public Serializer<PrincipalCollection> shiro_f442_0()
{    return serializer;}
public void shiro_f443_0(Serializer<PrincipalCollection> serializer)
{    this.serializer = serializer;}
public CipherService shiro_f444_0()
{    return cipherService;}
public void shiro_f445_0(CipherService cipherService)
{    this.cipherService = cipherService;}
public byte[] shiro_f446_0()
{    return encryptionCipherKey;}
public void shiro_f447_0(byte[] encryptionCipherKey)
{    this.encryptionCipherKey = encryptionCipherKey;}
public byte[] shiro_f448_0()
{    return decryptionCipherKey;}
public void shiro_f449_0(byte[] decryptionCipherKey)
{    this.decryptionCipherKey = decryptionCipherKey;}
public byte[] shiro_f450_0()
{        return getEncryptionCipherKey();}
public void shiro_f451_0(byte[] cipherKey)
{            setEncryptionCipherKey(cipherKey);    setDecryptionCipherKey(cipherKey);}
protected boolean shiro_f452_0(AuthenticationToken token)
{    return token != null && (token instanceof RememberMeAuthenticationToken) && ((RememberMeAuthenticationToken) token).isRememberMe();}
public void shiro_f453_1(Subject subject, AuthenticationToken token, AuthenticationInfo info)
{        forgetIdentity(subject);        if (isRememberMe(token)) {        rememberIdentity(subject, token, info);    } else {        if (log.isDebugEnabled()) {                    }    }}
public void shiro_f454_0(Subject subject, AuthenticationToken token, AuthenticationInfo authcInfo)
{    PrincipalCollection principals = getIdentityToRemember(subject, authcInfo);    rememberIdentity(subject, principals);}
protected PrincipalCollection shiro_f455_0(Subject subject, AuthenticationInfo info)
{    return info.getPrincipals();}
protected void shiro_f456_0(Subject subject, PrincipalCollection accountPrincipals)
{    byte[] bytes = convertPrincipalsToBytes(accountPrincipals);    rememberSerializedIdentity(subject, bytes);}
protected byte[] shiro_f457_0(PrincipalCollection principals)
{    byte[] bytes = serialize(principals);    if (getCipherService() != null) {        bytes = encrypt(bytes);    }    return bytes;}
public PrincipalCollection shiro_f458_0(SubjectContext subjectContext)
{    PrincipalCollection principals = null;    try {        byte[] bytes = getRememberedSerializedIdentity(subjectContext);                if (bytes != null && bytes.length > 0) {            principals = convertBytesToPrincipals(bytes, subjectContext);        }    } catch (RuntimeException re) {        principals = onRememberedPrincipalFailure(re, subjectContext);    }    return principals;}
protected PrincipalCollection shiro_f459_0(byte[] bytes, SubjectContext subjectContext)
{    if (getCipherService() != null) {        bytes = decrypt(bytes);    }    return deserialize(bytes);}
protected PrincipalCollection shiro_f460_1(RuntimeException e, SubjectContext context)
{    if (log.isWarnEnabled()) {        String message = "There was a failure while trying to retrieve remembered principals.  This could be due to a " + "configuration problem or corrupted principals.  This could also be due to a recently " + "changed encryption key, if you are using a shiro.ini file, this property would be " + "'securityManager.rememberMeManager.cipherKey' see: http://shiro.apache.org/web.html#Web-RememberMeServices. " + "The remembered identity will be forgotten and not used for this request.";            }    forgetIdentity(context);        throw e;}
protected byte[] shiro_f461_0(byte[] serialized)
{    byte[] value = serialized;    CipherService cipherService = getCipherService();    if (cipherService != null) {        ByteSource byteSource = cipherService.encrypt(serialized, getEncryptionCipherKey());        value = byteSource.getBytes();    }    return value;}
protected byte[] shiro_f462_0(byte[] encrypted)
{    byte[] serialized = encrypted;    CipherService cipherService = getCipherService();    if (cipherService != null) {        ByteSource byteSource = cipherService.decrypt(encrypted, getDecryptionCipherKey());        serialized = byteSource.getBytes();    }    return serialized;}
protected byte[] shiro_f463_0(PrincipalCollection principals)
{    return getSerializer().serialize(principals);}
protected PrincipalCollection shiro_f464_0(byte[] serializedIdentity)
{    return getSerializer().deserialize(serializedIdentity);}
public void shiro_f465_0(Subject subject, AuthenticationToken token, AuthenticationException ae)
{    forgetIdentity(subject);}
public void shiro_f466_0(Subject subject)
{    forgetIdentity(subject);}
public Authenticator shiro_f467_0()
{    return authenticator;}
public void shiro_f468_0(Authenticator authenticator) throws IllegalArgumentException
{    if (authenticator == null) {        String msg = "Authenticator argument cannot be null.";        throw new IllegalArgumentException(msg);    }    this.authenticator = authenticator;}
protected void shiro_f469_0()
{    super.afterRealmsSet();    if (this.authenticator instanceof ModularRealmAuthenticator) {        ((ModularRealmAuthenticator) this.authenticator).setRealms(getRealms());    }}
public AuthenticationInfo shiro_f470_0(AuthenticationToken token) throws AuthenticationException
{    return this.authenticator.authenticate(token);}
public void shiro_f471_0()
{    LifecycleUtils.destroy(getAuthenticator());    this.authenticator = null;    super.destroy();}
public Authorizer shiro_f472_0()
{    return authorizer;}
public void shiro_f473_0(Authorizer authorizer)
{    if (authorizer == null) {        String msg = "Authorizer argument cannot be null.";        throw new IllegalArgumentException(msg);    }    this.authorizer = authorizer;}
protected void shiro_f474_0()
{    super.afterRealmsSet();    if (this.authorizer instanceof ModularRealmAuthorizer) {        ((ModularRealmAuthorizer) this.authorizer).setRealms(getRealms());    }}
public void shiro_f475_0()
{    LifecycleUtils.destroy(getAuthorizer());    this.authorizer = null;    super.destroy();}
public boolean shiro_f476_0(PrincipalCollection principals, String permissionString)
{    return this.authorizer.isPermitted(principals, permissionString);}
public boolean shiro_f477_0(PrincipalCollection principals, Permission permission)
{    return this.authorizer.isPermitted(principals, permission);}
public boolean[] shiro_f478_0(PrincipalCollection principals, String... permissions)
{    return this.authorizer.isPermitted(principals, permissions);}
public boolean[] shiro_f479_0(PrincipalCollection principals, List<Permission> permissions)
{    return this.authorizer.isPermitted(principals, permissions);}
public boolean shiro_f480_0(PrincipalCollection principals, String... permissions)
{    return this.authorizer.isPermittedAll(principals, permissions);}
public boolean shiro_f481_0(PrincipalCollection principals, Collection<Permission> permissions)
{    return this.authorizer.isPermittedAll(principals, permissions);}
public void shiro_f482_0(PrincipalCollection principals, String permission) throws AuthorizationException
{    this.authorizer.checkPermission(principals, permission);}
public void shiro_f483_0(PrincipalCollection principals, Permission permission) throws AuthorizationException
{    this.authorizer.checkPermission(principals, permission);}
public void shiro_f484_0(PrincipalCollection principals, String... permissions) throws AuthorizationException
{    this.authorizer.checkPermissions(principals, permissions);}
public void shiro_f485_0(PrincipalCollection principals, Collection<Permission> permissions) throws AuthorizationException
{    this.authorizer.checkPermissions(principals, permissions);}
public boolean shiro_f486_0(PrincipalCollection principals, String roleIdentifier)
{    return this.authorizer.hasRole(principals, roleIdentifier);}
public boolean[] shiro_f487_0(PrincipalCollection principals, List<String> roleIdentifiers)
{    return this.authorizer.hasRoles(principals, roleIdentifiers);}
public boolean shiro_f488_0(PrincipalCollection principals, Collection<String> roleIdentifiers)
{    return this.authorizer.hasAllRoles(principals, roleIdentifiers);}
public void shiro_f489_0(PrincipalCollection principals, String role) throws AuthorizationException
{    this.authorizer.checkRole(principals, role);}
public void shiro_f490_0(PrincipalCollection principals, Collection<String> roles) throws AuthorizationException
{    this.authorizer.checkRoles(principals, roles);}
public void shiro_f491_0(PrincipalCollection principals, String... roles) throws AuthorizationException
{    this.authorizer.checkRoles(principals, roles);}
public CacheManager shiro_f492_0()
{    return cacheManager;}
public void shiro_f493_0(CacheManager cacheManager)
{    this.cacheManager = cacheManager;    afterCacheManagerSet();}
protected void shiro_f494_0()
{    applyEventBusToCacheManager();}
public EventBus shiro_f495_0()
{    return eventBus;}
public void shiro_f496_0(EventBus eventBus)
{    this.eventBus = eventBus;    afterEventBusSet();}
protected void shiro_f497_0()
{    if (this.eventBus != null && this.cacheManager != null && this.cacheManager instanceof EventBusAware) {        ((EventBusAware) this.cacheManager).setEventBus(this.eventBus);    }}
protected void shiro_f498_0()
{    applyEventBusToCacheManager();}
public void shiro_f499_0()
{    LifecycleUtils.destroy(getCacheManager());    this.cacheManager = null;    LifecycleUtils.destroy(getEventBus());    this.eventBus = new DefaultEventBus();}
public SubjectFactory shiro_f500_0()
{    return subjectFactory;}
public void shiro_f501_0(SubjectFactory subjectFactory)
{    this.subjectFactory = subjectFactory;}
public SubjectDAO shiro_f502_0()
{    return subjectDAO;}
public void shiro_f503_0(SubjectDAO subjectDAO)
{    this.subjectDAO = subjectDAO;}
public RememberMeManager shiro_f504_0()
{    return rememberMeManager;}
public void shiro_f505_0(RememberMeManager rememberMeManager)
{    this.rememberMeManager = rememberMeManager;}
protected SubjectContext shiro_f506_0()
{    return new DefaultSubjectContext();}
protected Subject shiro_f507_0(AuthenticationToken token, AuthenticationInfo info, Subject existing)
{    SubjectContext context = createSubjectContext();    context.setAuthenticated(true);    context.setAuthenticationToken(token);    context.setAuthenticationInfo(info);    context.setSecurityManager(this);    if (existing != null) {        context.setSubject(existing);    }    return createSubject(context);}
protected void shiro_f508_0(Subject subject)
{    save(subject);}
protected void shiro_f509_1(AuthenticationToken token, AuthenticationInfo info, Subject subject)
{    RememberMeManager rmm = getRememberMeManager();    if (rmm != null) {        try {            rmm.onSuccessfulLogin(subject, token, info);        } catch (Exception e) {            if (log.isWarnEnabled()) {                String msg = "Delegate RememberMeManager instance of type [" + rmm.getClass().getName() + "] threw an exception during onSuccessfulLogin.  RememberMe services will not be " + "performed for account [" + info + "].";                            }        }    } else {        if (log.isTraceEnabled()) {            log.trace("This " + getClass().getName() + " instance does not have a " + "[" + RememberMeManager.class.getName() + "] instance configured.  RememberMe services " + "will not be performed for account [" + info + "].");        }    }}
protected void shiro_f510_1(AuthenticationToken token, AuthenticationException ex, Subject subject)
{    RememberMeManager rmm = getRememberMeManager();    if (rmm != null) {        try {            rmm.onFailedLogin(subject, token, ex);        } catch (Exception e) {            if (log.isWarnEnabled()) {                String msg = "Delegate RememberMeManager instance of type [" + rmm.getClass().getName() + "] threw an exception during onFailedLogin for AuthenticationToken [" + token + "].";                            }        }    }}
protected void shiro_f511_1(Subject subject)
{    RememberMeManager rmm = getRememberMeManager();    if (rmm != null) {        try {            rmm.onLogout(subject);        } catch (Exception e) {            if (log.isWarnEnabled()) {                String msg = "Delegate RememberMeManager instance of type [" + rmm.getClass().getName() + "] threw an exception during onLogout for subject with principals [" + (subject != null ? subject.getPrincipals() : null) + "]";                            }        }    }}
public Subject shiro_f512_1(Subject subject, AuthenticationToken token) throws AuthenticationException
{    AuthenticationInfo info;    try {        info = authenticate(token);    } catch (AuthenticationException ae) {        try {            onFailedLogin(token, ae, subject);        } catch (Exception e) {            if (log.isInfoEnabled()) {                            }        }                throw ae;    }    Subject loggedIn = createSubject(token, info, subject);    onSuccessfulLogin(token, info, loggedIn);    return loggedIn;}
protected void shiro_f513_0(AuthenticationToken token, AuthenticationInfo info, Subject subject)
{    rememberMeSuccessfulLogin(token, info, subject);}
protected void shiro_f514_0(AuthenticationToken token, AuthenticationException ae, Subject subject)
{    rememberMeFailedLogin(token, ae, subject);}
protected void shiro_f515_0(Subject subject)
{    rememberMeLogout(subject);}
protected SubjectContext shiro_f516_0(SubjectContext subjectContext)
{    return new DefaultSubjectContext(subjectContext);}
public Subject shiro_f517_0(SubjectContext subjectContext)
{        SubjectContext context = copy(subjectContext);        context = ensureSecurityManager(context);                context = resolveSession(context);            context = resolvePrincipals(context);    Subject subject = doCreateSubject(context);                    save(subject);    return subject;}
protected Subject shiro_f518_0(SubjectContext context)
{    return getSubjectFactory().createSubject(context);}
protected void shiro_f519_0(Subject subject)
{    this.subjectDAO.save(subject);}
protected void shiro_f520_0(Subject subject)
{    this.subjectDAO.delete(subject);}
protected SubjectContext shiro_f521_0(SubjectContext context)
{    if (context.resolveSecurityManager() != null) {        log.trace("Context already contains a SecurityManager instance.  Returning.");        return context;    }    log.trace("No SecurityManager found in context.  Adding self reference.");    context.setSecurityManager(this);    return context;}
protected SubjectContext shiro_f522_1(SubjectContext context)
{    if (context.resolveSession() != null) {                return context;    }    try {                        Session session = resolveContextSession(context);        if (session != null) {            context.setSession(session);        }    } catch (InvalidSessionException e) {            }    return context;}
protected Session shiro_f523_0(SubjectContext context) throws InvalidSessionException
{    SessionKey key = getSessionKey(context);    if (key != null) {        return getSession(key);    }    return null;}
protected SessionKey shiro_f524_0(SubjectContext context)
{    Serializable sessionId = context.getSessionId();    if (sessionId != null) {        return new DefaultSessionKey(sessionId);    }    return null;}
private static boolean shiro_f525_0(PrincipalCollection pc)
{    return pc == null || pc.isEmpty();}
protected SubjectContext shiro_f526_1(SubjectContext context)
{    PrincipalCollection principals = context.resolvePrincipals();    if (isEmpty(principals)) {        log.trace("No identity (PrincipalCollection) found in the context.  Looking for a remembered identity.");        principals = getRememberedIdentity(context);        if (!isEmpty(principals)) {                        context.setPrincipals(principals);                                                                                                                } else {            log.trace("No remembered identity found.  Returning original context.");        }    }    return context;}
protected SessionContext shiro_f527_0(SubjectContext subjectContext)
{    DefaultSessionContext sessionContext = new DefaultSessionContext();    if (!CollectionUtils.isEmpty(subjectContext)) {        sessionContext.putAll(subjectContext);    }    Serializable sessionId = subjectContext.getSessionId();    if (sessionId != null) {        sessionContext.setSessionId(sessionId);    }    String host = subjectContext.resolveHost();    if (host != null) {        sessionContext.setHost(host);    }    return sessionContext;}
public void shiro_f528_1(Subject subject)
{    if (subject == null) {        throw new IllegalArgumentException("Subject method argument cannot be null.");    }    beforeLogout(subject);    PrincipalCollection principals = subject.getPrincipals();    if (principals != null && !principals.isEmpty()) {        if (log.isDebugEnabled()) {                    }        Authenticator authc = getAuthenticator();        if (authc instanceof LogoutAware) {            ((LogoutAware) authc).onLogout(principals);        }    }    try {        delete(subject);    } catch (Exception e) {        if (log.isDebugEnabled()) {            String msg = "Unable to cleanly unbind Subject.  Ignoring (logging out).";                    }    } finally {        try {            stopSession(subject);        } catch (Exception e) {            if (log.isDebugEnabled()) {                String msg = "Unable to cleanly stop Session for Subject [" + subject.getPrincipal() + "] " + "Ignoring (logging out).";                            }        }    }}
protected void shiro_f529_0(Subject subject)
{    Session s = subject.getSession(false);    if (s != null) {        s.stop();    }}
protected void shiro_f530_0(Subject subject)
{    delete(subject);}
protected PrincipalCollection shiro_f531_1(SubjectContext subjectContext)
{    RememberMeManager rmm = getRememberMeManager();    if (rmm != null) {        try {            return rmm.getRememberedPrincipals(subjectContext);        } catch (Exception e) {            if (log.isWarnEnabled()) {                String msg = "Delegate RememberMeManager instance of type [" + rmm.getClass().getName() + "] threw an exception during getRememberedPrincipals().";                            }        }    }    return null;}
public boolean shiro_f532_0(Subject subject)
{    return (subject != null && subject.getSession(false) != null) || isSessionStorageEnabled();}
public boolean shiro_f533_0()
{    return sessionStorageEnabled;}
public void shiro_f534_0(boolean sessionStorageEnabled)
{    this.sessionStorageEnabled = sessionStorageEnabled;}
protected boolean shiro_f535_0(Subject subject)
{    return getSessionStorageEvaluator().isSessionStorageEnabled(subject);}
public SessionStorageEvaluator shiro_f536_0()
{    return sessionStorageEvaluator;}
public void shiro_f537_0(SessionStorageEvaluator sessionStorageEvaluator)
{    this.sessionStorageEvaluator = sessionStorageEvaluator;}
public Subject shiro_f538_0(Subject subject)
{    if (isSessionStorageEnabled(subject)) {        saveToSession(subject);    } else {        log.trace("Session storage of subject state for Subject [{}] has been disabled: identity and " + "authentication state are expected to be initialized on every request or invocation.", subject);    }    return subject;}
protected void shiro_f539_0(Subject subject)
{        mergePrincipals(subject);    mergeAuthenticationState(subject);}
private static boolean shiro_f540_0(PrincipalCollection pc)
{    return pc == null || pc.isEmpty();}
protected void shiro_f541_0(Subject subject)
{        PrincipalCollection currentPrincipals = null;        if (subject.isRunAs() && subject instanceof DelegatingSubject) {        try {            Field field = DelegatingSubject.class.getDeclaredField("principals");            field.setAccessible(true);            currentPrincipals = (PrincipalCollection) field.get(subject);        } catch (Exception e) {            throw new IllegalStateException("Unable to access DelegatingSubject principals property.", e);        }    }    if (currentPrincipals == null || currentPrincipals.isEmpty()) {        currentPrincipals = subject.getPrincipals();    }    Session session = subject.getSession(false);    if (session == null) {        if (!isEmpty(currentPrincipals)) {            session = subject.getSession();            session.setAttribute(DefaultSubjectContext.PRINCIPALS_SESSION_KEY, currentPrincipals);        }        } else {        PrincipalCollection existingPrincipals = (PrincipalCollection) session.getAttribute(DefaultSubjectContext.PRINCIPALS_SESSION_KEY);        if (isEmpty(currentPrincipals)) {            if (!isEmpty(existingPrincipals)) {                session.removeAttribute(DefaultSubjectContext.PRINCIPALS_SESSION_KEY);            }                } else {            if (!currentPrincipals.equals(existingPrincipals)) {                session.setAttribute(DefaultSubjectContext.PRINCIPALS_SESSION_KEY, currentPrincipals);            }                }    }}
protected void shiro_f542_0(Subject subject)
{    Session session = subject.getSession(false);    if (session == null) {        if (subject.isAuthenticated()) {            session = subject.getSession();            session.setAttribute(DefaultSubjectContext.AUTHENTICATED_SESSION_KEY, Boolean.TRUE);        }        } else {        Boolean existingAuthc = (Boolean) session.getAttribute(DefaultSubjectContext.AUTHENTICATED_SESSION_KEY);        if (subject.isAuthenticated()) {            if (existingAuthc == null || !existingAuthc) {                session.setAttribute(DefaultSubjectContext.AUTHENTICATED_SESSION_KEY, Boolean.TRUE);            }                } else {            if (existingAuthc != null) {                                session.removeAttribute(DefaultSubjectContext.AUTHENTICATED_SESSION_KEY);            }                }    }}
protected void shiro_f543_0(Subject subject)
{    Session session = subject.getSession(false);    if (session != null) {        session.removeAttribute(DefaultSubjectContext.AUTHENTICATED_SESSION_KEY);        session.removeAttribute(DefaultSubjectContext.PRINCIPALS_SESSION_KEY);    }}
public void shiro_f544_0(Subject subject)
{    removeFromSession(subject);}
public Subject shiro_f545_0(SubjectContext context)
{    SecurityManager securityManager = context.resolveSecurityManager();    Session session = context.resolveSession();    boolean sessionCreationEnabled = context.isSessionCreationEnabled();    PrincipalCollection principals = context.resolvePrincipals();    boolean authenticated = context.resolveAuthenticated();    String host = context.resolveHost();    return new DelegatingSubject(principals, authenticated, host, session, sessionCreationEnabled, securityManager);}
protected Subject shiro_f546_0(PrincipalCollection principals, boolean authenticated, String host, Session session, SecurityManager securityManager)
{    return new DelegatingSubject(principals, authenticated, host, session, true, securityManager);}
public void shiro_f547_0(Realm realm)
{    if (realm == null) {        throw new IllegalArgumentException("Realm argument cannot be null");    }    Collection<Realm> realms = new ArrayList<Realm>(1);    realms.add(realm);    setRealms(realms);}
public void shiro_f548_0(Collection<Realm> realms)
{    if (realms == null) {        throw new IllegalArgumentException("Realms collection argument cannot be null.");    }    if (realms.isEmpty()) {        throw new IllegalArgumentException("Realms collection argument cannot be empty.");    }    this.realms = realms;    afterRealmsSet();}
protected void shiro_f549_0()
{    applyCacheManagerToRealms();    applyEventBusToRealms();}
public Collection<Realm> shiro_f550_0()
{    return realms;}
protected void shiro_f551_0()
{    CacheManager cacheManager = getCacheManager();    Collection<Realm> realms = getRealms();    if (cacheManager != null && realms != null && !realms.isEmpty()) {        for (Realm realm : realms) {            if (realm instanceof CacheManagerAware) {                ((CacheManagerAware) realm).setCacheManager(cacheManager);            }        }    }}
protected void shiro_f552_0()
{    EventBus eventBus = getEventBus();    Collection<Realm> realms = getRealms();    if (eventBus != null && realms != null && !realms.isEmpty()) {        for (Realm realm : realms) {            if (realm instanceof EventBusAware) {                ((EventBusAware) realm).setEventBus(eventBus);            }        }    }}
protected void shiro_f553_0()
{    super.afterCacheManagerSet();    applyCacheManagerToRealms();}
protected void shiro_f554_0()
{    super.afterEventBusSet();    applyEventBusToRealms();}
public void shiro_f555_0()
{    LifecycleUtils.destroy(getRealms());    this.realms = null;    super.destroy();}
public void shiro_f556_0(SessionManager sessionManager)
{    this.sessionManager = sessionManager;    afterSessionManagerSet();}
protected void shiro_f557_0()
{    applyCacheManagerToSessionManager();    applyEventBusToSessionManager();}
public SessionManager shiro_f558_0()
{    return this.sessionManager;}
protected void shiro_f559_0()
{    super.afterCacheManagerSet();    applyCacheManagerToSessionManager();}
protected void shiro_f560_0()
{    super.afterEventBusSet();    applyEventBusToSessionManager();}
protected void shiro_f561_0()
{    if (this.sessionManager instanceof CacheManagerAware) {        ((CacheManagerAware) this.sessionManager).setCacheManager(getCacheManager());    }}
protected void shiro_f562_0()
{    EventBus eventBus = getEventBus();    if (eventBus != null && this.sessionManager instanceof EventBusAware) {        ((EventBusAware) this.sessionManager).setEventBus(eventBus);    }}
public Session shiro_f563_0(SessionContext context) throws AuthorizationException
{    return this.sessionManager.start(context);}
public Session shiro_f564_0(SessionKey key) throws SessionException
{    return this.sessionManager.getSession(key);}
public void shiro_f565_0()
{    LifecycleUtils.destroy(getSessionManager());    this.sessionManager = null;    super.destroy();}
public void shiro_f566_0(Map<String, String> groupRolesMap)
{    this.groupRolesMap = groupRolesMap;}
protected AuthenticationInfo shiro_f567_0(AuthenticationToken token, LdapContextFactory ldapContextFactory) throws NamingException
{    UsernamePasswordToken upToken = (UsernamePasswordToken) token;        LdapContext ctx = null;    try {        ctx = ldapContextFactory.getLdapContext(upToken.getUsername(), String.valueOf(upToken.getPassword()));    } finally {        LdapUtils.closeContext(ctx);    }    return buildAuthenticationInfo(upToken.getUsername(), upToken.getPassword());}
protected AuthenticationInfo shiro_f568_0(String username, char[] password)
{    return new SimpleAuthenticationInfo(username, password, getName());}
protected AuthorizationInfo shiro_f569_0(PrincipalCollection principals, LdapContextFactory ldapContextFactory) throws NamingException
{    String username = (String) getAvailablePrincipal(principals);        LdapContext ldapContext = ldapContextFactory.getSystemLdapContext();    Set<String> roleNames;    try {        roleNames = getRoleNamesForUser(username, ldapContext);    } finally {        LdapUtils.closeContext(ldapContext);    }    return buildAuthorizationInfo(roleNames);}
protected AuthorizationInfo shiro_f570_0(Set<String> roleNames)
{    return new SimpleAuthorizationInfo(roleNames);}
protected Set<String> shiro_f571_1(String username, LdapContext ldapContext) throws NamingException
{    Set<String> roleNames;    roleNames = new LinkedHashSet<String>();    SearchControls searchCtls = new SearchControls();    searchCtls.setSearchScope(SearchControls.SUBTREE_SCOPE);    String userPrincipalName = username;    if (principalSuffix != null) {        userPrincipalName += principalSuffix;    }    Object[] searchArguments = new Object[] { userPrincipalName };    NamingEnumeration answer = ldapContext.search(searchBase, searchFilter, searchArguments, searchCtls);    while (answer.hasMoreElements()) {        SearchResult sr = (SearchResult) answer.next();        if (log.isDebugEnabled()) {                    }        Attributes attrs = sr.getAttributes();        if (attrs != null) {            NamingEnumeration ae = attrs.getAll();            while (ae.hasMore()) {                Attribute attr = (Attribute) ae.next();                if (attr.getID().equals("memberOf")) {                    Collection<String> groupNames = LdapUtils.getAllAttributeValues(attr);                    if (log.isDebugEnabled()) {                                            }                    Collection<String> rolesForGroups = getRoleNamesForGroups(groupNames);                    roleNames.addAll(rolesForGroups);                }            }        }    }    return roleNames;}
protected Collection<String> shiro_f572_1(Collection<String> groupNames)
{    Set<String> roleNames = new HashSet<String>(groupNames.size());    if (groupRolesMap != null) {        for (String groupName : groupNames) {            String strRoleNames = groupRolesMap.get(groupName);            if (strRoleNames != null) {                for (String roleName : strRoleNames.split(ROLE_NAMES_DELIMETER)) {                    if (log.isDebugEnabled()) {                                            }                    roleNames.add(roleName);                }            }        }    }    return roleNames;}
public CredentialsMatcher shiro_f573_0()
{    return credentialsMatcher;}
public void shiro_f574_0(CredentialsMatcher credentialsMatcher)
{    this.credentialsMatcher = credentialsMatcher;}
public Class shiro_f575_0()
{    return authenticationTokenClass;}
public void shiro_f576_0(Class<? extends AuthenticationToken> authenticationTokenClass)
{    this.authenticationTokenClass = authenticationTokenClass;}
public void shiro_f577_0(Cache<Object, AuthenticationInfo> authenticationCache)
{    this.authenticationCache = authenticationCache;}
public Cache<Object, AuthenticationInfo> shiro_f578_0()
{    return this.authenticationCache;}
public String shiro_f579_0()
{    return this.authenticationCacheName;}
public void shiro_f580_0(String authenticationCacheName)
{    this.authenticationCacheName = authenticationCacheName;}
public boolean shiro_f581_0()
{    return this.authenticationCachingEnabled && isCachingEnabled();}
public void shiro_f582_0(boolean authenticationCachingEnabled)
{    this.authenticationCachingEnabled = authenticationCachingEnabled;    if (authenticationCachingEnabled) {        setCachingEnabled(true);    }}
public void shiro_f583_0(String name)
{    super.setName(name);    String authcCacheName = this.authenticationCacheName;    if (authcCacheName != null && authcCacheName.startsWith(getClass().getName())) {                        this.authenticationCacheName = name + DEFAULT_AUTHENTICATION_CACHE_SUFFIX;    }}
public boolean shiro_f584_0(AuthenticationToken token)
{    return token != null && getAuthenticationTokenClass().isAssignableFrom(token.getClass());}
public final void shiro_f585_0()
{        getAvailableAuthenticationCache();    onInit();}
protected void shiro_f586_0()
{}
protected void shiro_f587_0()
{        getAvailableAuthenticationCache();}
private Cache<Object, AuthenticationInfo> shiro_f588_0()
{    Cache<Object, AuthenticationInfo> cache = getAuthenticationCache();    boolean authcCachingEnabled = isAuthenticationCachingEnabled();    if (cache == null && authcCachingEnabled) {        cache = getAuthenticationCacheLazy();    }    return cache;}
private Cache<Object, AuthenticationInfo> shiro_f589_1()
{    if (this.authenticationCache == null) {        log.trace("No authenticationCache instance set.  Checking for a cacheManager...");        CacheManager cacheManager = getCacheManager();        if (cacheManager != null) {            String cacheName = getAuthenticationCacheName();                        this.authenticationCache = cacheManager.getCache(cacheName);        }    }    return this.authenticationCache;}
private AuthenticationInfo shiro_f590_0(AuthenticationToken token)
{    AuthenticationInfo info = null;    Cache<Object, AuthenticationInfo> cache = getAvailableAuthenticationCache();    if (cache != null && token != null) {        log.trace("Attempting to retrieve the AuthenticationInfo from cache.");        Object key = getAuthenticationCacheKey(token);        info = cache.get(key);        if (info == null) {            log.trace("No AuthorizationInfo found in cache for key [{}]", key);        } else {            log.trace("Found cached AuthorizationInfo for key [{}]", key);        }    }    return info;}
private void shiro_f591_1(AuthenticationToken token, AuthenticationInfo info)
{    if (!isAuthenticationCachingEnabled(token, info)) {                        return;    }    Cache<Object, AuthenticationInfo> cache = getAvailableAuthenticationCache();    if (cache != null) {        Object key = getAuthenticationCacheKey(token);        cache.put(key, info);        log.trace("Cached AuthenticationInfo for continued authentication.  key=[{}], value=[{}].", key, info);    }}
protected boolean shiro_f592_0(AuthenticationToken token, AuthenticationInfo info)
{    return isAuthenticationCachingEnabled();}
public final AuthenticationInfo shiro_f593_1(AuthenticationToken token) throws AuthenticationException
{    AuthenticationInfo info = getCachedAuthenticationInfo(token);    if (info == null) {                info = doGetAuthenticationInfo(token);                if (token != null && info != null) {            cacheAuthenticationInfoIfPossible(token, info);        }    } else {            }    if (info != null) {        assertCredentialsMatch(token, info);    } else {            }    return info;}
protected void shiro_f594_0(AuthenticationToken token, AuthenticationInfo info) throws AuthenticationException
{    CredentialsMatcher cm = getCredentialsMatcher();    if (cm != null) {        if (!cm.doCredentialsMatch(token, info)) {                        String msg = "Submitted credentials for token [" + token + "] did not match the expected credentials.";            throw new IncorrectCredentialsException(msg);        }    } else {        throw new AuthenticationException("A CredentialsMatcher must be configured in order to verify " + "credentials during authentication.  If you do not wish for credentials to be examined, you " + "can configure an " + AllowAllCredentialsMatcher.class.getName() + " instance.");    }}
protected Object shiro_f595_0(AuthenticationToken token)
{    return token != null ? token.getPrincipal() : null;}
protected Object shiro_f596_0(PrincipalCollection principals)
{    return getAvailablePrincipal(principals);}
protected void shiro_f597_0(PrincipalCollection principals)
{    super.doClearCache(principals);    clearCachedAuthenticationInfo(principals);}
private static boolean shiro_f598_0(PrincipalCollection pc)
{    return pc == null || pc.isEmpty();}
protected void shiro_f599_0(PrincipalCollection principals)
{    if (!isEmpty(principals)) {        Cache<Object, AuthenticationInfo> cache = getAvailableAuthenticationCache();                if (cache != null) {            Object key = getAuthenticationCacheKey(principals);            cache.remove(key);        }    }}
public void shiro_f600_0(String name)
{    super.setName(name);    String authzCacheName = this.authorizationCacheName;    if (authzCacheName != null && authzCacheName.startsWith(getClass().getName())) {                        this.authorizationCacheName = name + DEFAULT_AUTHORIZATION_CACHE_SUFFIX;    }}
public void shiro_f601_0(Cache<Object, AuthorizationInfo> authorizationCache)
{    this.authorizationCache = authorizationCache;}
public Cache<Object, AuthorizationInfo> shiro_f602_0()
{    return this.authorizationCache;}
public String shiro_f603_0()
{    return authorizationCacheName;}
public void shiro_f604_0(String authorizationCacheName)
{    this.authorizationCacheName = authorizationCacheName;}
public boolean shiro_f605_0()
{    return isCachingEnabled() && authorizationCachingEnabled;}
public void shiro_f606_0(boolean authenticationCachingEnabled)
{    this.authorizationCachingEnabled = authenticationCachingEnabled;    if (authenticationCachingEnabled) {        setCachingEnabled(true);    }}
public PermissionResolver shiro_f607_0()
{    return permissionResolver;}
public void shiro_f608_0(PermissionResolver permissionResolver)
{    if (permissionResolver == null)        throw new IllegalArgumentException("Null PermissionResolver is not allowed");    this.permissionResolver = permissionResolver;}
public RolePermissionResolver shiro_f609_0()
{    return permissionRoleResolver;}
public void shiro_f610_0(RolePermissionResolver permissionRoleResolver)
{    this.permissionRoleResolver = permissionRoleResolver;}
protected void shiro_f611_0()
{    super.onInit();        getAvailableAuthorizationCache();}
protected void shiro_f612_0()
{    super.afterCacheManagerSet();        getAvailableAuthorizationCache();}
private Cache<Object, AuthorizationInfo> shiro_f613_1()
{    if (this.authorizationCache == null) {        if (log.isDebugEnabled()) {                    }        CacheManager cacheManager = getCacheManager();        if (cacheManager != null) {            String cacheName = getAuthorizationCacheName();            if (log.isDebugEnabled()) {                            }            this.authorizationCache = cacheManager.getCache(cacheName);        } else {            if (log.isDebugEnabled()) {                            }        }    }    return this.authorizationCache;}
private Cache<Object, AuthorizationInfo> shiro_f614_0()
{    Cache<Object, AuthorizationInfo> cache = getAuthorizationCache();    if (cache == null && isAuthorizationCachingEnabled()) {        cache = getAuthorizationCacheLazy();    }    return cache;}
protected AuthorizationInfo shiro_f615_0(PrincipalCollection principals)
{    if (principals == null) {        return null;    }    AuthorizationInfo info = null;    if (log.isTraceEnabled()) {        log.trace("Retrieving AuthorizationInfo for principals [" + principals + "]");    }    Cache<Object, AuthorizationInfo> cache = getAvailableAuthorizationCache();    if (cache != null) {        if (log.isTraceEnabled()) {            log.trace("Attempting to retrieve the AuthorizationInfo from cache.");        }        Object key = getAuthorizationCacheKey(principals);        info = cache.get(key);        if (log.isTraceEnabled()) {            if (info == null) {                log.trace("No AuthorizationInfo found in cache for principals [" + principals + "]");            } else {                log.trace("AuthorizationInfo found in cache for principals [" + principals + "]");            }        }    }    if (info == null) {                info = doGetAuthorizationInfo(principals);                if (info != null && cache != null) {            if (log.isTraceEnabled()) {                log.trace("Caching authorization info for principals: [" + principals + "].");            }            Object key = getAuthorizationCacheKey(principals);            cache.put(key, info);        }    }    return info;}
protected Object shiro_f616_0(PrincipalCollection principals)
{    return principals;}
protected void shiro_f617_0(PrincipalCollection principals)
{    if (principals == null) {        return;    }    Cache<Object, AuthorizationInfo> cache = getAvailableAuthorizationCache();        if (cache != null) {        Object key = getAuthorizationCacheKey(principals);        cache.remove(key);    }}
protected Collection<Permission> shiro_f618_0(AuthorizationInfo info)
{    Set<Permission> permissions = new HashSet<Permission>();    if (info != null) {        Collection<Permission> perms = info.getObjectPermissions();        if (!CollectionUtils.isEmpty(perms)) {            permissions.addAll(perms);        }        perms = resolvePermissions(info.getStringPermissions());        if (!CollectionUtils.isEmpty(perms)) {            permissions.addAll(perms);        }        perms = resolveRolePermissions(info.getRoles());        if (!CollectionUtils.isEmpty(perms)) {            permissions.addAll(perms);        }    }    if (permissions.isEmpty()) {        return Collections.emptySet();    } else {        return Collections.unmodifiableSet(permissions);    }}
private Collection<Permission> shiro_f619_0(Collection<String> stringPerms)
{    Collection<Permission> perms = Collections.emptySet();    PermissionResolver resolver = getPermissionResolver();    if (resolver != null && !CollectionUtils.isEmpty(stringPerms)) {        perms = new LinkedHashSet<Permission>(stringPerms.size());        for (String strPermission : stringPerms) {            if (StringUtils.clean(strPermission) != null) {                Permission permission = resolver.resolvePermission(strPermission);                perms.add(permission);            }        }    }    return perms;}
private Collection<Permission> shiro_f620_0(Collection<String> roleNames)
{    Collection<Permission> perms = Collections.emptySet();    RolePermissionResolver resolver = getRolePermissionResolver();    if (resolver != null && !CollectionUtils.isEmpty(roleNames)) {        perms = new LinkedHashSet<Permission>(roleNames.size());        for (String roleName : roleNames) {            Collection<Permission> resolved = resolver.resolvePermissionsInRole(roleName);            if (!CollectionUtils.isEmpty(resolved)) {                perms.addAll(resolved);            }        }    }    return perms;}
public boolean shiro_f621_0(PrincipalCollection principals, String permission)
{    Permission p = getPermissionResolver().resolvePermission(permission);    return isPermitted(principals, p);}
public boolean shiro_f622_0(PrincipalCollection principals, Permission permission)
{    AuthorizationInfo info = getAuthorizationInfo(principals);    return isPermitted(permission, info);}
protected boolean shiro_f623_0(Permission permission, AuthorizationInfo info)
{    Collection<Permission> perms = getPermissions(info);    if (perms != null && !perms.isEmpty()) {        for (Permission perm : perms) {            if (perm.implies(permission)) {                return true;            }        }    }    return false;}
public boolean[] shiro_f624_0(PrincipalCollection subjectIdentifier, String... permissions)
{    List<Permission> perms = new ArrayList<Permission>(permissions.length);    for (String permString : permissions) {        perms.add(getPermissionResolver().resolvePermission(permString));    }    return isPermitted(subjectIdentifier, perms);}
public boolean[] shiro_f625_0(PrincipalCollection principals, List<Permission> permissions)
{    AuthorizationInfo info = getAuthorizationInfo(principals);    return isPermitted(permissions, info);}
protected boolean[] shiro_f626_0(List<Permission> permissions, AuthorizationInfo info)
{    boolean[] result;    if (permissions != null && !permissions.isEmpty()) {        int size = permissions.size();        result = new boolean[size];        int i = 0;        for (Permission p : permissions) {            result[i++] = isPermitted(p, info);        }    } else {        result = new boolean[0];    }    return result;}
public boolean shiro_f627_0(PrincipalCollection subjectIdentifier, String... permissions)
{    if (permissions != null && permissions.length > 0) {        Collection<Permission> perms = new ArrayList<Permission>(permissions.length);        for (String permString : permissions) {            perms.add(getPermissionResolver().resolvePermission(permString));        }        return isPermittedAll(subjectIdentifier, perms);    }    return false;}
public boolean shiro_f628_0(PrincipalCollection principal, Collection<Permission> permissions)
{    AuthorizationInfo info = getAuthorizationInfo(principal);    return info != null && isPermittedAll(permissions, info);}
protected boolean shiro_f629_0(Collection<Permission> permissions, AuthorizationInfo info)
{    if (permissions != null && !permissions.isEmpty()) {        for (Permission p : permissions) {            if (!isPermitted(p, info)) {                return false;            }        }    }    return true;}
public void shiro_f630_0(PrincipalCollection subjectIdentifier, String permission) throws AuthorizationException
{    Permission p = getPermissionResolver().resolvePermission(permission);    checkPermission(subjectIdentifier, p);}
public void shiro_f631_0(PrincipalCollection principal, Permission permission) throws AuthorizationException
{    AuthorizationInfo info = getAuthorizationInfo(principal);    checkPermission(permission, info);}
protected void shiro_f632_0(Permission permission, AuthorizationInfo info)
{    if (!isPermitted(permission, info)) {        String msg = "User is not permitted [" + permission + "]";        throw new UnauthorizedException(msg);    }}
public void shiro_f633_0(PrincipalCollection subjectIdentifier, String... permissions) throws AuthorizationException
{    if (permissions != null) {        for (String permString : permissions) {            checkPermission(subjectIdentifier, permString);        }    }}
public void shiro_f634_0(PrincipalCollection principal, Collection<Permission> permissions) throws AuthorizationException
{    AuthorizationInfo info = getAuthorizationInfo(principal);    checkPermissions(permissions, info);}
protected void shiro_f635_0(Collection<Permission> permissions, AuthorizationInfo info)
{    if (permissions != null && !permissions.isEmpty()) {        for (Permission p : permissions) {            checkPermission(p, info);        }    }}
public boolean shiro_f636_0(PrincipalCollection principal, String roleIdentifier)
{    AuthorizationInfo info = getAuthorizationInfo(principal);    return hasRole(roleIdentifier, info);}
protected boolean shiro_f637_0(String roleIdentifier, AuthorizationInfo info)
{    return info != null && info.getRoles() != null && info.getRoles().contains(roleIdentifier);}
public boolean[] shiro_f638_0(PrincipalCollection principal, List<String> roleIdentifiers)
{    AuthorizationInfo info = getAuthorizationInfo(principal);    boolean[] result = new boolean[roleIdentifiers != null ? roleIdentifiers.size() : 0];    if (info != null) {        result = hasRoles(roleIdentifiers, info);    }    return result;}
protected boolean[] shiro_f639_0(List<String> roleIdentifiers, AuthorizationInfo info)
{    boolean[] result;    if (roleIdentifiers != null && !roleIdentifiers.isEmpty()) {        int size = roleIdentifiers.size();        result = new boolean[size];        int i = 0;        for (String roleName : roleIdentifiers) {            result[i++] = hasRole(roleName, info);        }    } else {        result = new boolean[0];    }    return result;}
public boolean shiro_f640_0(PrincipalCollection principal, Collection<String> roleIdentifiers)
{    AuthorizationInfo info = getAuthorizationInfo(principal);    return info != null && hasAllRoles(roleIdentifiers, info);}
private boolean shiro_f641_0(Collection<String> roleIdentifiers, AuthorizationInfo info)
{    if (roleIdentifiers != null && !roleIdentifiers.isEmpty()) {        for (String roleName : roleIdentifiers) {            if (!hasRole(roleName, info)) {                return false;            }        }    }    return true;}
public void shiro_f642_0(PrincipalCollection principal, String role) throws AuthorizationException
{    AuthorizationInfo info = getAuthorizationInfo(principal);    checkRole(role, info);}
protected void shiro_f643_0(String role, AuthorizationInfo info)
{    if (!hasRole(role, info)) {        String msg = "User does not have role [" + role + "]";        throw new UnauthorizedException(msg);    }}
public void shiro_f644_0(PrincipalCollection principal, Collection<String> roles) throws AuthorizationException
{    AuthorizationInfo info = getAuthorizationInfo(principal);    checkRoles(roles, info);}
public void shiro_f645_0(PrincipalCollection principal, String... roles) throws AuthorizationException
{    checkRoles(principal, Arrays.asList(roles));}
protected void shiro_f646_0(Collection<String> roles, AuthorizationInfo info)
{    if (roles != null && !roles.isEmpty()) {        for (String roleName : roles) {            checkRole(roleName, info);        }    }}
protected void shiro_f647_0(PrincipalCollection principals)
{    super.doClearCache(principals);    clearCachedAuthorizationInfo(principals);}
public CacheManager shiro_f648_0()
{    return this.cacheManager;}
public void shiro_f649_0(CacheManager cacheManager)
{    this.cacheManager = cacheManager;    afterCacheManagerSet();}
public boolean shiro_f650_0()
{    return cachingEnabled;}
public void shiro_f651_0(boolean cachingEnabled)
{    this.cachingEnabled = cachingEnabled;}
public String shiro_f652_0()
{    return name;}
public void shiro_f653_0(String name)
{    this.name = name;}
protected void shiro_f654_0()
{}
public void shiro_f655_0(PrincipalCollection principals)
{    clearCache(principals);}
private static boolean shiro_f656_0(PrincipalCollection pc)
{    return pc == null || pc.isEmpty();}
protected void shiro_f657_0(PrincipalCollection principals)
{    if (!isEmpty(principals)) {        doClearCache(principals);        log.trace("Cleared cache entries for account with principals [{}]", principals);    }}
protected void shiro_f658_0(PrincipalCollection principals)
{}
protected Object shiro_f659_0(PrincipalCollection principals)
{    Object primary = null;    if (!isEmpty(principals)) {        Collection thisPrincipals = principals.fromRealm(getName());        if (!CollectionUtils.isEmpty(thisPrincipals)) {            primary = thisPrincipals.iterator().next();        } else {                        primary = principals.getPrimaryPrincipal();        }    }    return primary;}
public void shiro_f660_0(DataSource dataSource)
{    this.dataSource = dataSource;}
public void shiro_f661_0(String authenticationQuery)
{    this.authenticationQuery = authenticationQuery;}
public void shiro_f662_0(String userRolesQuery)
{    this.userRolesQuery = userRolesQuery;}
public void shiro_f663_0(String permissionsQuery)
{    this.permissionsQuery = permissionsQuery;}
public void shiro_f664_0(boolean permissionsLookupEnabled)
{    this.permissionsLookupEnabled = permissionsLookupEnabled;}
public void shiro_f665_0(SaltStyle saltStyle)
{    this.saltStyle = saltStyle;    if (saltStyle == SaltStyle.COLUMN && authenticationQuery.equals(DEFAULT_AUTHENTICATION_QUERY)) {        authenticationQuery = DEFAULT_SALTED_AUTHENTICATION_QUERY;    }}
public void shiro_f666_0(boolean saltIsBase64Encoded)
{    this.saltIsBase64Encoded = saltIsBase64Encoded;}
protected AuthenticationInfo shiro_f667_1(AuthenticationToken token) throws AuthenticationException
{    UsernamePasswordToken upToken = (UsernamePasswordToken) token;    String username = upToken.getUsername();        if (username == null) {        throw new AccountException("Null usernames are not allowed by this realm.");    }    Connection conn = null;    SimpleAuthenticationInfo info = null;    try {        conn = dataSource.getConnection();        String password = null;        String salt = null;        switch(saltStyle) {            case NO_SALT:                password = getPasswordForUser(conn, username)[0];                break;            case CRYPT:                                throw new ConfigurationException("Not implemented yet");                        case COLUMN:                String[] queryResults = getPasswordForUser(conn, username);                password = queryResults[0];                salt = queryResults[1];                break;            case EXTERNAL:                password = getPasswordForUser(conn, username)[0];                salt = getSaltForUser(username);        }        if (password == null) {            throw new UnknownAccountException("No account found for user [" + username + "]");        }        info = new SimpleAuthenticationInfo(username, password.toCharArray(), getName());        if (salt != null) {            if (saltStyle == SaltStyle.COLUMN && saltIsBase64Encoded) {                info.setCredentialsSalt(ByteSource.Util.bytes(Base64.decode(salt)));            } else {                info.setCredentialsSalt(ByteSource.Util.bytes(salt));            }        }    } catch (SQLException e) {        final String message = "There was a SQL error while authenticating user [" + username + "]";        if (log.isErrorEnabled()) {                    }                throw new AuthenticationException(message, e);    } finally {        JdbcUtils.closeConnection(conn);    }    return info;}
private String[] shiro_f668_0(Connection conn, String username) throws SQLException
{    String[] result;    boolean returningSeparatedSalt = false;    switch(saltStyle) {        case NO_SALT:        case CRYPT:        case EXTERNAL:            result = new String[1];            break;        default:            result = new String[2];            returningSeparatedSalt = true;    }    PreparedStatement ps = null;    ResultSet rs = null;    try {        ps = conn.prepareStatement(authenticationQuery);        ps.setString(1, username);                rs = ps.executeQuery();                boolean foundResult = false;        while (rs.next()) {                        if (foundResult) {                throw new AuthenticationException("More than one user row found for user [" + username + "]. Usernames must be unique.");            }            result[0] = rs.getString(1);            if (returningSeparatedSalt) {                result[1] = rs.getString(2);            }            foundResult = true;        }    } finally {        JdbcUtils.closeResultSet(rs);        JdbcUtils.closeStatement(ps);    }    return result;}
protected AuthorizationInfo shiro_f669_1(PrincipalCollection principals)
{        if (principals == null) {        throw new AuthorizationException("PrincipalCollection method argument cannot be null.");    }    String username = (String) getAvailablePrincipal(principals);    Connection conn = null;    Set<String> roleNames = null;    Set<String> permissions = null;    try {        conn = dataSource.getConnection();                roleNames = getRoleNamesForUser(conn, username);        if (permissionsLookupEnabled) {            permissions = getPermissions(conn, username, roleNames);        }    } catch (SQLException e) {        final String message = "There was a SQL error while authorizing user [" + username + "]";        if (log.isErrorEnabled()) {                    }                throw new AuthorizationException(message, e);    } finally {        JdbcUtils.closeConnection(conn);    }    SimpleAuthorizationInfo info = new SimpleAuthorizationInfo(roleNames);    info.setStringPermissions(permissions);    return info;}
protected Set<String> shiro_f670_1(Connection conn, String username) throws SQLException
{    PreparedStatement ps = null;    ResultSet rs = null;    Set<String> roleNames = new LinkedHashSet<String>();    try {        ps = conn.prepareStatement(userRolesQuery);        ps.setString(1, username);                rs = ps.executeQuery();                while (rs.next()) {            String roleName = rs.getString(1);                        if (roleName != null) {                roleNames.add(roleName);            } else {                if (log.isWarnEnabled()) {                                    }            }        }    } finally {        JdbcUtils.closeResultSet(rs);        JdbcUtils.closeStatement(ps);    }    return roleNames;}
protected Set<String> shiro_f671_0(Connection conn, String username, Collection<String> roleNames) throws SQLException
{    PreparedStatement ps = null;    Set<String> permissions = new LinkedHashSet<String>();    try {        ps = conn.prepareStatement(permissionsQuery);        for (String roleName : roleNames) {            ps.setString(1, roleName);            ResultSet rs = null;            try {                                rs = ps.executeQuery();                                while (rs.next()) {                    String permissionString = rs.getString(1);                                        permissions.add(permissionString);                }            } finally {                JdbcUtils.closeResultSet(rs);            }        }    } finally {        JdbcUtils.closeStatement(ps);    }    return permissions;}
protected String shiro_f672_0(String username)
{    return username;}
public Collection<String> shiro_f673_0()
{    return jndiNames;}
public void shiro_f674_0(Collection<String> jndiNames)
{    this.jndiNames = jndiNames;}
public void shiro_f675_0(String commaDelimited) throws IllegalStateException
{    String arg = StringUtils.clean(commaDelimited);    if (arg == null) {        String msg = "One or more comma-delimited jndi names must be specified for the " + getClass().getName() + " to locate Realms.";        throw new IllegalStateException(msg);    }    String[] names = StringUtils.tokenizeToStringArray(arg, ",");    setJndiNames(Arrays.asList(names));}
public Collection<Realm> shiro_f676_0() throws IllegalStateException
{    Collection<String> jndiNames = getJndiNames();    if (jndiNames == null || jndiNames.isEmpty()) {        String msg = "One or more jndi names must be specified for the " + getClass().getName() + " to locate Realms.";        throw new IllegalStateException(msg);    }    List<Realm> realms = new ArrayList<Realm>(jndiNames.size());    for (String name : jndiNames) {        try {            Realm realm = (Realm) lookup(name, Realm.class);            realms.add(realm);        } catch (Exception e) {            throw new IllegalStateException("Unable to look up realm with jndi name '" + name + "'.", e);        }    }    return realms.isEmpty() ? null : realms;}
public void shiro_f677_0(String principalSuffix)
{    this.principalSuffix = principalSuffix;}
public void shiro_f678_0(String searchBase)
{    this.searchBase = searchBase;}
public void shiro_f679_0(String url)
{    this.url = url;}
public void shiro_f680_0(String systemUsername)
{    this.systemUsername = systemUsername;}
public void shiro_f681_0(String systemPassword)
{    this.systemPassword = systemPassword;}
public void shiro_f682_0(LdapContextFactory ldapContextFactory)
{    this.ldapContextFactory = ldapContextFactory;}
public void shiro_f683_0(String searchFilter)
{    this.searchFilter = searchFilter;}
protected void shiro_f684_0()
{    super.onInit();    ensureContextFactory();}
private LdapContextFactory shiro_f685_1()
{    if (this.ldapContextFactory == null) {        if (log.isDebugEnabled()) {                    }        DefaultLdapContextFactory defaultFactory = new DefaultLdapContextFactory();        defaultFactory.setPrincipalSuffix(this.principalSuffix);        defaultFactory.setSearchBase(this.searchBase);        defaultFactory.setUrl(this.url);        defaultFactory.setSystemUsername(this.systemUsername);        defaultFactory.setSystemPassword(this.systemPassword);        this.ldapContextFactory = defaultFactory;    }    return this.ldapContextFactory;}
protected AuthenticationInfo shiro_f686_0(AuthenticationToken token) throws AuthenticationException
{    AuthenticationInfo info;    try {        info = queryForAuthenticationInfo(token, ensureContextFactory());    } catch (javax.naming.AuthenticationException e) {        throw new AuthenticationException("LDAP authentication failed.", e);    } catch (NamingException e) {        String msg = "LDAP naming error while attempting to authenticate user.";        throw new AuthenticationException(msg, e);    }    return info;}
protected AuthorizationInfo shiro_f687_0(PrincipalCollection principals)
{    AuthorizationInfo info;    try {        info = queryForAuthorizationInfo(principals, ensureContextFactory());    } catch (NamingException e) {        String msg = "LDAP naming error while attempting to retrieve authorization for user [" + principals + "].";        throw new AuthorizationException(msg, e);    }    return info;}
public void shiro_f688_0(String authentication)
{    this.authentication = authentication;}
public void shiro_f689_0(String principalSuffix)
{    this.principalSuffix = principalSuffix;}
public void shiro_f690_0(String searchBase)
{    this.searchBase = searchBase;}
public void shiro_f691_0(String contextFactoryClassName)
{    this.contextFactoryClassName = contextFactoryClassName;}
public void shiro_f692_0(String url)
{    this.url = url;}
public void shiro_f693_0(String referral)
{    this.referral = referral;}
public void shiro_f694_0(String systemUsername)
{    this.systemUsername = systemUsername;}
public void shiro_f695_0(String systemPassword)
{    this.systemPassword = systemPassword;}
public void shiro_f696_0(boolean usePooling)
{    this.usePooling = usePooling;}
public void shiro_f697_0(Map<String, String> additionalEnvironment)
{    this.additionalEnvironment = additionalEnvironment;}
public LdapContext shiro_f698_0() throws NamingException
{    return getLdapContext(systemUsername, systemPassword);}
public LdapContext shiro_f699_0(String username, String password) throws NamingException
{    if (username != null && principalSuffix != null) {        username += principalSuffix;    }    return getLdapContext((Object) username, password);}
public LdapContext shiro_f700_1(Object principal, Object credentials) throws NamingException
{    if (url == null) {        throw new IllegalStateException("An LDAP URL must be specified of the form ldap://<hostname>:<port>");    }    Hashtable<String, Object> env = new Hashtable<String, Object>();    env.put(Context.SECURITY_AUTHENTICATION, authentication);    if (principal != null) {        env.put(Context.SECURITY_PRINCIPAL, principal);    }    if (credentials != null) {        env.put(Context.SECURITY_CREDENTIALS, credentials);    }    env.put(Context.INITIAL_CONTEXT_FACTORY, contextFactoryClassName);    env.put(Context.PROVIDER_URL, url);    env.put(Context.REFERRAL, referral);        if (usePooling && principal != null && principal.equals(systemUsername)) {                env.put(SUN_CONNECTION_POOLING_PROPERTY, "true");    }    if (additionalEnvironment != null) {        env.putAll(additionalEnvironment);    }    if (log.isDebugEnabled()) {            }        validateAuthenticationInfo(env);    return createLdapContext(env);}
protected LdapContext shiro_f701_0(Hashtable env) throws NamingException
{    return new InitialLdapContext(env, null);}
private void shiro_f702_0(Hashtable<String, Object> environment) throws AuthenticationException
{        if (SIMPLE_AUTHENTICATION_MECHANISM_NAME.equals(environment.get(Context.SECURITY_AUTHENTICATION))) {                if (environment.get(Context.SECURITY_PRINCIPAL) != null && StringUtils.hasText(String.valueOf(environment.get(Context.SECURITY_PRINCIPAL)))) {            Object credentials = environment.get(Context.SECURITY_CREDENTIALS);                        if (credentials == null ||             (credentials instanceof byte[] && ((byte[]) credentials).length <= 0) ||             (credentials instanceof char[] && ((char[]) credentials).length <= 0) || (String.class.isInstance(credentials) && !StringUtils.hasText(String.valueOf(credentials)))) {                throw new javax.naming.AuthenticationException("LDAP Simple authentication requires both a " + "principal and credentials.");            }        }    }}
protected String shiro_f703_0()
{    return userDnPrefix;}
protected String shiro_f704_0()
{    return userDnSuffix;}
public void shiro_f705_1(String template) throws IllegalArgumentException
{    if (!StringUtils.hasText(template)) {        String msg = "User DN template cannot be null or empty.";        throw new IllegalArgumentException(msg);    }    int index = template.indexOf(USERDN_SUBSTITUTION_TOKEN);    if (index < 0) {        String msg = "User DN template must contain the '" + USERDN_SUBSTITUTION_TOKEN + "' replacement token to understand where to " + "insert the runtime authentication principal.";        throw new IllegalArgumentException(msg);    }    String prefix = template.substring(0, index);    String suffix = template.substring(prefix.length() + USERDN_SUBSTITUTION_TOKEN.length());    if (log.isDebugEnabled()) {            }    this.userDnPrefix = prefix;    this.userDnSuffix = suffix;}
public String shiro_f706_0()
{    return getUserDn(USERDN_SUBSTITUTION_TOKEN);}
protected String shiro_f707_1(String principal) throws IllegalArgumentException, IllegalStateException
{    if (!StringUtils.hasText(principal)) {        throw new IllegalArgumentException("User principal cannot be null or empty for User DN construction.");    }    String prefix = getUserDnPrefix();    String suffix = getUserDnSuffix();    if (prefix == null && suffix == null) {                return principal;    }    int prefixLength = prefix != null ? prefix.length() : 0;    int suffixLength = suffix != null ? suffix.length() : 0;    StringBuilder sb = new StringBuilder(prefixLength + principal.length() + suffixLength);    if (prefixLength > 0) {        sb.append(prefix);    }    sb.append(principal);    if (suffixLength > 0) {        sb.append(suffix);    }    return sb.toString();}
public void shiro_f708_0(LdapContextFactory contextFactory)
{    this.contextFactory = contextFactory;}
public LdapContextFactory shiro_f709_0()
{    return this.contextFactory;}
protected AuthenticationInfo shiro_f710_0(AuthenticationToken token) throws AuthenticationException
{    AuthenticationInfo info;    try {        info = queryForAuthenticationInfo(token, getContextFactory());    } catch (AuthenticationNotSupportedException e) {        String msg = "Unsupported configured authentication mechanism";        throw new UnsupportedAuthenticationMechanismException(msg, e);    } catch (javax.naming.AuthenticationException e) {        throw new AuthenticationException("LDAP authentication failed.", e);    } catch (NamingException e) {        String msg = "LDAP naming error while attempting to authenticate user.";        throw new AuthenticationException(msg, e);    }    return info;}
protected AuthorizationInfo shiro_f711_0(PrincipalCollection principals)
{    AuthorizationInfo info;    try {        info = queryForAuthorizationInfo(principals, getContextFactory());    } catch (NamingException e) {        String msg = "LDAP naming error while attempting to retrieve authorization for user [" + principals + "].";        throw new AuthorizationException(msg, e);    }    return info;}
protected Object shiro_f712_0(AuthenticationToken token)
{    Object principal = token.getPrincipal();    if (principal instanceof String) {        String sPrincipal = (String) principal;        return getUserDn(sPrincipal);    }    return principal;}
protected AuthenticationInfo shiro_f713_1(AuthenticationToken token, LdapContextFactory ldapContextFactory) throws NamingException
{    Object principal = token.getPrincipal();    Object credentials = token.getCredentials();        principal = getLdapPrincipal(token);    LdapContext ctx = null;    try {        ctx = ldapContextFactory.getLdapContext(principal, credentials);                return createAuthenticationInfo(token, principal, credentials, ctx);    } finally {        LdapUtils.closeContext(ctx);    }}
protected AuthenticationInfo shiro_f714_0(AuthenticationToken token, Object ldapPrincipal, Object ldapCredentials, LdapContext ldapContext) throws NamingException
{    return new SimpleAuthenticationInfo(token.getPrincipal(), token.getCredentials(), getName());}
protected AuthorizationInfo shiro_f715_0(PrincipalCollection principals, LdapContextFactory ldapContextFactory) throws NamingException
{    return null;}
public void shiro_f716_0(String authenticationMechanism)
{    setEnvironmentProperty(Context.SECURITY_AUTHENTICATION, authenticationMechanism);}
public String shiro_f717_0()
{    return (String) getEnvironmentProperty(Context.SECURITY_AUTHENTICATION);}
public void shiro_f718_0(String contextFactoryClassName)
{    setEnvironmentProperty(Context.INITIAL_CONTEXT_FACTORY, contextFactoryClassName);}
public String shiro_f719_0()
{    return (String) getEnvironmentProperty(Context.INITIAL_CONTEXT_FACTORY);}
public Map shiro_f720_0()
{    return this.environment;}
public void shiro_f721_0(Map env)
{    this.environment = env;}
private Object shiro_f722_0(String name)
{    return this.environment.get(name);}
private void shiro_f723_0(String name, String value)
{    if (StringUtils.hasText(value)) {        this.environment.put(name, value);    } else {        this.environment.remove(name);    }}
public boolean shiro_f724_0()
{    return poolingEnabled;}
public void shiro_f725_0(boolean poolingEnabled)
{    this.poolingEnabled = poolingEnabled;}
public void shiro_f726_0(String referral)
{    setEnvironmentProperty(Context.REFERRAL, referral);}
public String shiro_f727_0()
{    return (String) getEnvironmentProperty(Context.REFERRAL);}
public void shiro_f728_0(String url)
{    setEnvironmentProperty(Context.PROVIDER_URL, url);}
public String shiro_f729_0()
{    return (String) getEnvironmentProperty(Context.PROVIDER_URL);}
public void shiro_f730_0(String systemPassword)
{    this.systemPassword = systemPassword;}
public String shiro_f731_0()
{    return this.systemPassword;}
public void shiro_f732_0(String systemUsername)
{    this.systemUsername = systemUsername;}
public String shiro_f733_0()
{    return systemUsername;}
public LdapContext shiro_f734_0() throws NamingException
{    return getLdapContext((Object) getSystemUsername(), getSystemPassword());}
public LdapContext shiro_f735_0(String username, String password) throws NamingException
{    return getLdapContext((Object) username, password);}
protected boolean shiro_f736_0(Object principal)
{    return isPoolingEnabled() && principal != null && principal.equals(getSystemUsername());}
public LdapContext shiro_f737_1(Object principal, Object credentials) throws NamingException, IllegalStateException
{    String url = getUrl();    if (url == null) {        throw new IllegalStateException("An LDAP URL must be specified of the form ldap://<hostname>:<port>");    }            Hashtable<String, Object> env = new Hashtable<String, Object>(this.environment);    Object authcMech = getAuthenticationMechanism();    if (authcMech == null && (principal != null || credentials != null)) {                                                env.put(Context.SECURITY_AUTHENTICATION, SIMPLE_AUTHENTICATION_MECHANISM_NAME);    }    if (principal != null) {        env.put(Context.SECURITY_PRINCIPAL, principal);    }    if (credentials != null) {        env.put(Context.SECURITY_CREDENTIALS, credentials);    }    boolean pooling = isPoolingConnections(principal);    if (pooling) {        env.put(SUN_CONNECTION_POOLING_PROPERTY, "true");    }    if (log.isDebugEnabled()) {            }        validateAuthenticationInfo(env);    return createLdapContext(env);}
protected LdapContext shiro_f738_0(Hashtable env) throws NamingException
{    return new InitialLdapContext(env, null);}
protected void shiro_f739_0(Hashtable<String, Object> environment) throws AuthenticationException
{        if (SIMPLE_AUTHENTICATION_MECHANISM_NAME.equals(environment.get(Context.SECURITY_AUTHENTICATION))) {                if (environment.get(Context.SECURITY_PRINCIPAL) != null && StringUtils.hasText(String.valueOf(environment.get(Context.SECURITY_PRINCIPAL)))) {            Object credentials = environment.get(Context.SECURITY_CREDENTIALS);                        if (credentials == null ||             (credentials instanceof byte[] && ((byte[]) credentials).length <= 0) ||             (credentials instanceof char[] && ((char[]) credentials).length <= 0) || (String.class.isInstance(credentials) && !StringUtils.hasText(String.valueOf(credentials)))) {                throw new javax.naming.AuthenticationException("LDAP Simple authentication requires both a " + "principal and credentials.");            }        }    }}
public static void shiro_f740_1(LdapContext ctx)
{    try {        if (ctx != null) {            ctx.close();        }    } catch (NamingException e) {            }}
public static Collection<String> shiro_f741_0(Attribute attr) throws NamingException
{    Set<String> values = new HashSet<String>();    NamingEnumeration ne = null;    try {        ne = attr.getAll();        while (ne.hasMore()) {            String value = (String) ne.next();            values.add(value);        }    } finally {        closeEnumeration(ne);    }    return values;}
public static void shiro_f742_1(NamingEnumeration ne)
{    try {        if (ne != null) {            ne.close();        }    } catch (NamingException e) {            }}
protected SimpleAccount shiro_f743_0(String username)
{    USERS_LOCK.readLock().lock();    try {        return this.users.get(username);    } finally {        USERS_LOCK.readLock().unlock();    }}
public boolean shiro_f744_0(String username)
{    return getUser(username) != null;}
public void shiro_f745_0(String username, String password)
{    addAccount(username, password, (String[]) null);}
public void shiro_f746_0(String username, String password, String... roles)
{    Set<String> roleNames = CollectionUtils.asSet(roles);    SimpleAccount account = new SimpleAccount(username, password, getName(), roleNames, null);    add(account);}
protected String shiro_f747_0(SimpleAccount account)
{    return getUsername(account.getPrincipals());}
protected String shiro_f748_0(PrincipalCollection principals)
{    return getAvailablePrincipal(principals).toString();}
protected void shiro_f749_0(SimpleAccount account)
{    String username = getUsername(account);    USERS_LOCK.writeLock().lock();    try {        this.users.put(username, account);    } finally {        USERS_LOCK.writeLock().unlock();    }}
protected SimpleRole shiro_f750_0(String rolename)
{    ROLES_LOCK.readLock().lock();    try {        return roles.get(rolename);    } finally {        ROLES_LOCK.readLock().unlock();    }}
public boolean shiro_f751_0(String name)
{    return getRole(name) != null;}
public void shiro_f752_0(String name)
{    add(new SimpleRole(name));}
protected void shiro_f753_0(SimpleRole role)
{    ROLES_LOCK.writeLock().lock();    try {        roles.put(role.getName(), role);    } finally {        ROLES_LOCK.writeLock().unlock();    }}
protected static Set<String> shiro_f754_0(String delimited, String delimiter)
{    if (delimited == null || delimited.trim().equals("")) {        return null;    }    Set<String> values = new HashSet<String>();    String[] rolenamesArray = delimited.split(delimiter);    for (String s : rolenamesArray) {        String trimmed = s.trim();        if (trimmed.length() > 0) {            values.add(trimmed);        }    }    return values;}
protected AuthenticationInfo shiro_f755_0(AuthenticationToken token) throws AuthenticationException
{    UsernamePasswordToken upToken = (UsernamePasswordToken) token;    SimpleAccount account = getUser(upToken.getUsername());    if (account != null) {        if (account.isLocked()) {            throw new LockedAccountException("Account [" + account + "] is locked.");        }        if (account.isCredentialsExpired()) {            String msg = "The credentials for account [" + account + "] are expired";            throw new ExpiredCredentialsException(msg);        }    }    return account;}
protected AuthorizationInfo shiro_f756_0(PrincipalCollection principals)
{    String username = getUsername(principals);    USERS_LOCK.readLock().lock();    try {        return this.users.get(username);    } finally {        USERS_LOCK.readLock().unlock();    }}
public String shiro_f757_0()
{    return resourcePath;}
public void shiro_f758_0(String resourcePath)
{    this.resourcePath = resourcePath;}
public Ini shiro_f759_0()
{    return ini;}
public void shiro_f760_0(Ini ini)
{    this.ini = ini;}
protected void shiro_f761_1()
{    super.onInit();            Ini ini = getIni();    String resourcePath = getResourcePath();    if (!CollectionUtils.isEmpty(this.users) || !CollectionUtils.isEmpty(this.roles)) {        if (!CollectionUtils.isEmpty(ini)) {                    }        if (StringUtils.hasText(resourcePath)) {                    }                return;    }    if (CollectionUtils.isEmpty(ini)) {                if (StringUtils.hasText(resourcePath)) {                        ini = Ini.fromResourcePath(resourcePath);            if (!CollectionUtils.isEmpty(ini)) {                setIni(ini);            }        }    }    if (CollectionUtils.isEmpty(ini)) {        String msg = "Ini instance and/or resourcePath resulted in null or empty Ini configuration.  Cannot " + "load account data.";        throw new IllegalStateException(msg);    }    processDefinitions(ini);}
private void shiro_f762_1(Ini ini)
{    if (CollectionUtils.isEmpty(ini)) {                return;    }    Ini.Section rolesSection = ini.getSection(ROLES_SECTION_NAME);    if (!CollectionUtils.isEmpty(rolesSection)) {                processRoleDefinitions(rolesSection);    }    Ini.Section usersSection = ini.getSection(USERS_SECTION_NAME);    if (!CollectionUtils.isEmpty(usersSection)) {                processUserDefinitions(usersSection);    } else {            }}
public void shiro_f763_0(boolean useXmlFormat)
{    this.useXmlFormat = useXmlFormat;}
public void shiro_f764_0(String resourcePath)
{    this.resourcePath = resourcePath;}
public void shiro_f765_0(int reloadIntervalSeconds)
{    this.reloadIntervalSeconds = reloadIntervalSeconds;}
public void shiro_f766_0()
{    super.onInit();        afterRoleCacheSet();}
protected void shiro_f767_0()
{    loadProperties();        if (this.resourcePath.startsWith(ResourceUtils.FILE_PREFIX) && scheduler == null) {        startReloadThread();    }}
public void shiro_f768_1()
{    try {        if (scheduler != null) {            scheduler.shutdown();        }    } catch (Exception e) {        if (log.isInfoEnabled()) {                    }    } finally {        scheduler = null;    }}
protected void shiro_f769_0()
{    if (this.reloadIntervalSeconds > 0) {        this.scheduler = Executors.newSingleThreadScheduledExecutor();        ((ScheduledExecutorService) this.scheduler).scheduleAtFixedRate(this, reloadIntervalSeconds, reloadIntervalSeconds, TimeUnit.SECONDS);    }}
public void shiro_f770_1()
{    try {        reloadPropertiesIfNecessary();    } catch (Exception e) {        if (log.isErrorEnabled()) {                    }    }}
private void shiro_f771_1()
{    if (resourcePath == null || resourcePath.length() == 0) {        throw new IllegalStateException("The resourcePath property is not set.  " + "It must be set prior to this realm being initialized.");    }    if (log.isDebugEnabled()) {            }    Properties properties = loadProperties(resourcePath);    createRealmEntitiesFromProperties(properties);}
private Properties shiro_f772_1(String resourcePath)
{    Properties props = new Properties();    InputStream is = null;    try {        if (log.isDebugEnabled()) {                    }        is = ResourceUtils.getInputStreamForPath(resourcePath);        if (useXmlFormat) {            if (log.isDebugEnabled()) {                            }            props.loadFromXML(is);        } else {            if (log.isDebugEnabled()) {                            }            props.load(is);        }    } catch (IOException e) {        throw new ShiroException("Error reading properties path [" + resourcePath + "].  " + "Initializing of the realm from this file failed.", e);    } finally {        ResourceUtils.close(is);    }    return props;}
private void shiro_f773_0()
{    if (isSourceModified()) {        restart();    }}
private boolean shiro_f774_0()
{        return this.resourcePath.startsWith(ResourceUtils.FILE_PREFIX) && isFileModified();}
private boolean shiro_f775_0()
{        String fileNameWithoutPrefix = this.resourcePath.substring(this.resourcePath.indexOf(":") + 1);    File propertyFile = new File(fileNameWithoutPrefix);    long currentLastModified = propertyFile.lastModified();    if (currentLastModified > this.fileLastModified) {        this.fileLastModified = currentLastModified;        return true;    } else {        return false;    }}
private void shiro_f776_1()
{    if (resourcePath == null || resourcePath.length() == 0) {        throw new IllegalStateException("The resourcePath property is not set.  " + "It must be set prior to this realm being initialized.");    }    if (log.isDebugEnabled()) {            }    try {        destroy();    } catch (Exception e) {        }    init();}
private void shiro_f777_0(Properties properties)
{    StringBuilder userDefs = new StringBuilder();    StringBuilder roleDefs = new StringBuilder();    Enumeration<String> propNames = (Enumeration<String>) properties.propertyNames();    while (propNames.hasMoreElements()) {        String key = propNames.nextElement().trim();        String value = properties.getProperty(key).trim();        if (log.isTraceEnabled()) {            log.trace("Processing properties line - key: [" + key + "], value: [" + value + "].");        }        if (isUsername(key)) {            String username = getUsername(key);            userDefs.append(username).append(" = ").append(value).append("\n");        } else if (isRolename(key)) {            String rolename = getRolename(key);            roleDefs.append(rolename).append(" = ").append(value).append("\n");        } else {            String msg = "Encountered unexpected key/value pair.  All keys must be prefixed with either '" + USERNAME_PREFIX + "' or '" + ROLENAME_PREFIX + "'.";            throw new IllegalStateException(msg);        }    }    setUserDefinitions(userDefs.toString());    setRoleDefinitions(roleDefs.toString());    processDefinitions();}
protected String shiro_f778_0(String key, String prefix)
{    return key.substring(prefix.length(), key.length());}
protected boolean shiro_f779_0(String key)
{    return key != null && key.startsWith(USERNAME_PREFIX);}
protected boolean shiro_f780_0(String key)
{    return key != null && key.startsWith(ROLENAME_PREFIX);}
protected String shiro_f781_0(String key)
{    return getName(key, USERNAME_PREFIX);}
protected String shiro_f782_0(String key)
{    return getName(key, ROLENAME_PREFIX);}
protected void shiro_f783_0()
{    super.onInit();    processDefinitions();}
public String shiro_f784_0()
{    return userDefinitions;}
public void shiro_f785_0(String userDefinitions)
{    this.userDefinitions = userDefinitions;}
public String shiro_f786_0()
{    return roleDefinitions;}
public void shiro_f787_0(String roleDefinitions)
{    this.roleDefinitions = roleDefinitions;}
protected void shiro_f788_0()
{    try {        processRoleDefinitions();        processUserDefinitions();    } catch (ParseException e) {        String msg = "Unable to parse user and/or role definitions.";        throw new ConfigurationException(msg, e);    }}
protected void shiro_f789_0() throws ParseException
{    String roleDefinitions = getRoleDefinitions();    if (roleDefinitions == null) {        return;    }    Map<String, String> roleDefs = toMap(toLines(roleDefinitions));    processRoleDefinitions(roleDefs);}
protected void shiro_f790_0(Map<String, String> roleDefs)
{    if (roleDefs == null || roleDefs.isEmpty()) {        return;    }    for (String rolename : roleDefs.keySet()) {        String value = roleDefs.get(rolename);        SimpleRole role = getRole(rolename);        if (role == null) {            role = new SimpleRole(rolename);            add(role);        }        Set<Permission> permissions = PermissionUtils.resolveDelimitedPermissions(value, getPermissionResolver());        role.setPermissions(permissions);    }}
protected void shiro_f791_0() throws ParseException
{    String userDefinitions = getUserDefinitions();    if (userDefinitions == null) {        return;    }    Map<String, String> userDefs = toMap(toLines(userDefinitions));    processUserDefinitions(userDefs);}
protected void shiro_f792_0(Map<String, String> userDefs)
{    if (userDefs == null || userDefs.isEmpty()) {        return;    }    for (String username : userDefs.keySet()) {        String value = userDefs.get(username);        String[] passwordAndRolesArray = StringUtils.split(value);        String password = passwordAndRolesArray[0];        SimpleAccount account = getUser(username);        if (account == null) {            account = new SimpleAccount(username, password, getName());            add(account);        }        account.setCredentials(password);        if (passwordAndRolesArray.length > 1) {            for (int i = 1; i < passwordAndRolesArray.length; i++) {                String rolename = passwordAndRolesArray[i];                account.addRole(rolename);                SimpleRole role = getRole(rolename);                if (role != null) {                    account.addObjectPermissions(role.getPermissions());                }            }        } else {            account.setRoles(null);        }    }}
protected static Set<String> shiro_f793_0(String s)
{    LinkedHashSet<String> set = new LinkedHashSet<String>();    Scanner scanner = new Scanner(s);    while (scanner.hasNextLine()) {        set.add(scanner.nextLine());    }    return set;}
protected static Map<String, String> shiro_f794_0(Collection<String> keyValuePairs) throws ParseException
{    if (keyValuePairs == null || keyValuePairs.isEmpty()) {        return null;    }    Map<String, String> pairs = new HashMap<String, String>();    for (String pairString : keyValuePairs) {        String[] pair = StringUtils.splitKeyValue(pairString);        if (pair != null) {            pairs.put(pair[0].trim(), pair[1].trim());        }    }    return pairs;}
public static Subject shiro_f795_0()
{    Subject subject = ThreadContext.getSubject();    if (subject == null) {        subject = (new Subject.Builder()).buildSubject();        ThreadContext.bind(subject);    }    return subject;}
public static void shiro_f796_0(SecurityManager securityManager)
{    SecurityUtils.securityManager = securityManager;}
public static SecurityManager shiro_f797_0() throws UnavailableSecurityManagerException
{    SecurityManager securityManager = ThreadContext.getSecurityManager();    if (securityManager == null) {        securityManager = SecurityUtils.securityManager;    }    if (securityManager == null) {        String msg = "No SecurityManager accessible to the calling code, either bound to the " + ThreadContext.class.getName() + " or as a vm static singleton.  This is an invalid application " + "configuration.";        throw new UnavailableSecurityManagerException(msg);    }    return securityManager;}
public void shiro_f798_0(Collection<SessionListener> listeners)
{    this.listeners = listeners != null ? listeners : new ArrayList<SessionListener>();}
public Collection<SessionListener> shiro_f799_0()
{    return this.listeners;}
protected EventBus shiro_f800_0()
{    return eventBus;}
public void shiro_f801_0(EventBus eventBus)
{    this.eventBus = eventBus;}
protected void shiro_f802_0(Object event)
{    if (this.eventBus != null) {        this.eventBus.publish(event);    }}
public Session shiro_f803_0(SessionContext context)
{    Session session = createSession(context);    applyGlobalSessionTimeout(session);    onStart(session, context);    notifyStart(session);        return createExposedSession(session, context);}
protected void shiro_f804_0(Session session)
{    session.setTimeout(getGlobalSessionTimeout());    onChange(session);}
protected void shiro_f805_0(Session session, SessionContext context)
{}
public Session shiro_f806_0(SessionKey key) throws SessionException
{    Session session = lookupSession(key);    return session != null ? createExposedSession(session, key) : null;}
private Session shiro_f807_0(SessionKey key) throws SessionException
{    if (key == null) {        throw new NullPointerException("SessionKey argument cannot be null.");    }    return doGetSession(key);}
private Session shiro_f808_0(SessionKey key) throws SessionException
{    Session session = lookupSession(key);    if (session == null) {        String msg = "Unable to locate required Session instance based on SessionKey [" + key + "].";        throw new UnknownSessionException(msg);    }    return session;}
protected Session shiro_f809_0(Session session, SessionContext context)
{    return new DelegatingSession(this, new DefaultSessionKey(session.getId()));}
protected Session shiro_f810_0(Session session, SessionKey key)
{    return new DelegatingSession(this, new DefaultSessionKey(session.getId()));}
protected Session shiro_f811_0(Session session)
{    return new ImmutableProxiedSession(session);}
protected void shiro_f812_0(Session session)
{    for (SessionListener listener : this.listeners) {        listener.onStart(session);    }}
protected void shiro_f813_0(Session session)
{    Session forNotification = beforeInvalidNotification(session);    for (SessionListener listener : this.listeners) {        listener.onStop(forNotification);    }}
protected void shiro_f814_0(Session session)
{    Session forNotification = beforeInvalidNotification(session);    for (SessionListener listener : this.listeners) {        listener.onExpiration(forNotification);    }}
public Date shiro_f815_0(SessionKey key)
{    return lookupRequiredSession(key).getStartTimestamp();}
public Date shiro_f816_0(SessionKey key)
{    return lookupRequiredSession(key).getLastAccessTime();}
public long shiro_f817_0(SessionKey key) throws InvalidSessionException
{    return lookupRequiredSession(key).getTimeout();}
public void shiro_f818_0(SessionKey key, long maxIdleTimeInMillis) throws InvalidSessionException
{    Session s = lookupRequiredSession(key);    s.setTimeout(maxIdleTimeInMillis);    onChange(s);}
public void shiro_f819_0(SessionKey key) throws InvalidSessionException
{    Session s = lookupRequiredSession(key);    s.touch();    onChange(s);}
public String shiro_f820_0(SessionKey key)
{    return lookupRequiredSession(key).getHost();}
public Collection<Object> shiro_f821_0(SessionKey key)
{    Collection<Object> c = lookupRequiredSession(key).getAttributeKeys();    if (!CollectionUtils.isEmpty(c)) {        return Collections.unmodifiableCollection(c);    }    return Collections.emptySet();}
public Object shiro_f822_0(SessionKey sessionKey, Object attributeKey) throws InvalidSessionException
{    return lookupRequiredSession(sessionKey).getAttribute(attributeKey);}
public void shiro_f823_0(SessionKey sessionKey, Object attributeKey, Object value) throws InvalidSessionException
{    if (value == null) {        removeAttribute(sessionKey, attributeKey);    } else {        Session s = lookupRequiredSession(sessionKey);        s.setAttribute(attributeKey, value);        onChange(s);    }}
public Object shiro_f824_0(SessionKey sessionKey, Object attributeKey) throws InvalidSessionException
{    Session s = lookupRequiredSession(sessionKey);    Object removed = s.removeAttribute(attributeKey);    if (removed != null) {        onChange(s);    }    return removed;}
public boolean shiro_f825_0(SessionKey key)
{    try {        checkValid(key);        return true;    } catch (InvalidSessionException e) {        return false;    }}
public void shiro_f826_1(SessionKey key) throws InvalidSessionException
{    Session session = lookupRequiredSession(key);    try {        if (log.isDebugEnabled()) {                    }        session.stop();        onStop(session, key);        notifyStop(session);    } finally {        afterStopped(session);    }}
protected void shiro_f827_0(Session session, SessionKey key)
{    onStop(session);}
protected void shiro_f828_0(Session session)
{    onChange(session);}
protected void shiro_f829_0(Session session)
{}
public void shiro_f830_0(SessionKey key) throws InvalidSessionException
{        lookupRequiredSession(key);}
protected void shiro_f831_0(Session s)
{}
public long shiro_f832_0()
{    return this.globalSessionTimeout;}
public void shiro_f833_0(long globalSessionTimeout)
{    this.globalSessionTimeout = globalSessionTimeout;}
public boolean shiro_f834_0()
{    return sessionValidationSchedulerEnabled;}
public void shiro_f835_0(boolean sessionValidationSchedulerEnabled)
{    this.sessionValidationSchedulerEnabled = sessionValidationSchedulerEnabled;}
public void shiro_f836_0(SessionValidationScheduler sessionValidationScheduler)
{    this.sessionValidationScheduler = sessionValidationScheduler;}
public SessionValidationScheduler shiro_f837_0()
{    return sessionValidationScheduler;}
private void shiro_f838_0()
{    SessionValidationScheduler scheduler = getSessionValidationScheduler();    if (isSessionValidationSchedulerEnabled() && (scheduler == null || !scheduler.isEnabled())) {        enableSessionValidation();    }}
public void shiro_f839_0(long sessionValidationInterval)
{    this.sessionValidationInterval = sessionValidationInterval;}
public long shiro_f840_0()
{    return sessionValidationInterval;}
protected final Session shiro_f841_0(final SessionKey key) throws InvalidSessionException
{    enableSessionValidationIfNecessary();    log.trace("Attempting to retrieve session with key {}", key);    Session s = retrieveSession(key);    if (s != null) {        validate(s, key);    }    return s;}
protected Session shiro_f842_0(SessionContext context) throws AuthorizationException
{    enableSessionValidationIfNecessary();    return doCreateSession(context);}
protected void shiro_f843_0(Session session, SessionKey key) throws InvalidSessionException
{    try {        doValidate(session);    } catch (ExpiredSessionException ese) {        onExpiration(session, ese, key);        throw ese;    } catch (InvalidSessionException ise) {        onInvalidation(session, ise, key);        throw ise;    }}
protected void shiro_f844_0(Session s, ExpiredSessionException ese, SessionKey key)
{    log.trace("Session with id [{}] has expired.", s.getId());    try {        onExpiration(s);        notifyExpiration(s);    } finally {        afterExpired(s);    }}
protected void shiro_f845_0(Session session)
{    onChange(session);}
protected void shiro_f846_0(Session session)
{}
protected void shiro_f847_0(Session s, InvalidSessionException ise, SessionKey key)
{    if (ise instanceof ExpiredSessionException) {        onExpiration(s, (ExpiredSessionException) ise, key);        return;    }    log.trace("Session with id [{}] is invalid.", s.getId());    try {        onStop(s);        notifyStop(s);    } finally {        afterStopped(s);    }}
protected void shiro_f848_0(Session session) throws InvalidSessionException
{    if (session instanceof ValidatingSession) {        ((ValidatingSession) session).validate();    } else {        String msg = "The " + getClass().getName() + " implementation only supports validating " + "Session implementations of the " + ValidatingSession.class.getName() + " interface.  " + "Please either implement this interface in your session implementation or override the " + AbstractValidatingSessionManager.class.getName() + ".doValidate(Session) method to perform validation.";        throw new IllegalStateException(msg);    }}
protected long shiro_f849_0(Session session)
{    return session.getTimeout();}
protected SessionValidationScheduler shiro_f850_1()
{    ExecutorServiceSessionValidationScheduler scheduler;    if (log.isDebugEnabled()) {            }    scheduler = new ExecutorServiceSessionValidationScheduler(this);    scheduler.setInterval(getSessionValidationInterval());    if (log.isTraceEnabled()) {        log.trace("Created default SessionValidationScheduler instance of type [" + scheduler.getClass().getName() + "].");    }    return scheduler;}
protected synchronized void shiro_f851_1()
{    SessionValidationScheduler scheduler = getSessionValidationScheduler();    if (scheduler == null) {        scheduler = createSessionValidationScheduler();        setSessionValidationScheduler(scheduler);    }        if (!scheduler.isEnabled()) {        if (log.isInfoEnabled()) {                    }        scheduler.enableSessionValidation();        afterSessionValidationEnabled();    }}
protected void shiro_f852_0()
{}
protected synchronized void shiro_f853_1()
{    beforeSessionValidationDisabled();    SessionValidationScheduler scheduler = getSessionValidationScheduler();    if (scheduler != null) {        try {            scheduler.disableSessionValidation();            if (log.isInfoEnabled()) {                            }        } catch (Exception e) {            if (log.isDebugEnabled()) {                String msg = "Unable to disable SessionValidationScheduler.  Ignoring (shutting down)...";                            }        }        LifecycleUtils.destroy(scheduler);        setSessionValidationScheduler(null);    }}
protected void shiro_f854_0()
{}
public void shiro_f855_0()
{    disableSessionValidation();}
public void shiro_f856_1()
{    if (log.isInfoEnabled()) {            }    int invalidCount = 0;    Collection<Session> activeSessions = getActiveSessions();    if (activeSessions != null && !activeSessions.isEmpty()) {        for (Session s : activeSessions) {            try {                                                SessionKey key = new DefaultSessionKey(s.getId());                validate(s, key);            } catch (InvalidSessionException e) {                if (log.isDebugEnabled()) {                    boolean expired = (e instanceof ExpiredSessionException);                    String msg = "Invalidated session with id [" + s.getId() + "]" + (expired ? " (expired)" : " (stopped)");                                    }                invalidCount++;            }        }    }    if (log.isInfoEnabled()) {        String msg = "Finished session validation.";        if (invalidCount > 0) {            msg += "  [" + invalidCount + "] sessions were stopped.";        } else {            msg += "  No sessions were stopped.";        }            }}
public String shiro_f857_0()
{    return getTypedValue(HOST, String.class);}
public void shiro_f858_0(String host)
{    if (StringUtils.hasText(host)) {        put(HOST, host);    }}
public Serializable shiro_f859_0()
{    return getTypedValue(SESSION_ID, Serializable.class);}
public void shiro_f860_0(Serializable sessionId)
{    nullSafePut(SESSION_ID, sessionId);}
public void shiro_f861_0(Serializable sessionId)
{    this.sessionId = sessionId;}
public Serializable shiro_f862_0()
{    return this.sessionId;}
public void shiro_f863_0(SessionDAO sessionDAO)
{    this.sessionDAO = sessionDAO;    applyCacheManagerToSessionDAO();}
public SessionDAO shiro_f864_0()
{    return this.sessionDAO;}
public SessionFactory shiro_f865_0()
{    return sessionFactory;}
public void shiro_f866_0(SessionFactory sessionFactory)
{    this.sessionFactory = sessionFactory;}
public boolean shiro_f867_0()
{    return deleteInvalidSessions;}
public void shiro_f868_0(boolean deleteInvalidSessions)
{    this.deleteInvalidSessions = deleteInvalidSessions;}
public void shiro_f869_0(CacheManager cacheManager)
{    this.cacheManager = cacheManager;    applyCacheManagerToSessionDAO();}
private void shiro_f870_0()
{    if (this.cacheManager != null && this.sessionDAO != null && this.sessionDAO instanceof CacheManagerAware) {        ((CacheManagerAware) this.sessionDAO).setCacheManager(this.cacheManager);    }}
protected Session shiro_f871_0(SessionContext context)
{    Session s = newSessionInstance(context);    if (log.isTraceEnabled()) {        log.trace("Creating session for host {}", s.getHost());    }    create(s);    return s;}
protected Session shiro_f872_0(SessionContext context)
{    return getSessionFactory().createSession(context);}
protected void shiro_f873_1(Session session)
{    if (log.isDebugEnabled()) {            }    sessionDAO.create(session);}
protected void shiro_f874_0(Session session)
{    if (session instanceof SimpleSession) {        SimpleSession ss = (SimpleSession) session;        Date stopTs = ss.getStopTimestamp();        ss.setLastAccessTime(stopTs);    }    onChange(session);}
protected void shiro_f875_0(Session session)
{    if (isDeleteInvalidSessions()) {        delete(session);    }}
protected void shiro_f876_0(Session session)
{    if (session instanceof SimpleSession) {        ((SimpleSession) session).setExpired(true);    }    onChange(session);}
protected void shiro_f877_0(Session session)
{    if (isDeleteInvalidSessions()) {        delete(session);    }}
protected void shiro_f878_0(Session session)
{    sessionDAO.update(session);}
protected Session shiro_f879_1(SessionKey sessionKey) throws UnknownSessionException
{    Serializable sessionId = getSessionId(sessionKey);    if (sessionId == null) {                return null;    }    Session s = retrieveSessionFromDataSource(sessionId);    if (s == null) {                String msg = "Could not find session with ID [" + sessionId + "]";        throw new UnknownSessionException(msg);    }    return s;}
protected Serializable shiro_f880_0(SessionKey sessionKey)
{    return sessionKey.getSessionId();}
protected Session shiro_f881_0(Serializable sessionId) throws UnknownSessionException
{    return sessionDAO.readSession(sessionId);}
protected void shiro_f882_0(Session session)
{    sessionDAO.delete(session);}
protected Collection<Session> shiro_f883_0()
{    Collection<Session> active = sessionDAO.getActiveSessions();    return active != null ? active : Collections.<Session>emptySet();}
public Serializable shiro_f884_0()
{    return key.getSessionId();}
public Date shiro_f885_0()
{    if (startTimestamp == null) {        startTimestamp = sessionManager.getStartTimestamp(key);    }    return startTimestamp;}
public Date shiro_f886_0()
{        return sessionManager.getLastAccessTime(key);}
public long shiro_f887_0() throws InvalidSessionException
{    return sessionManager.getTimeout(key);}
public void shiro_f888_0(long maxIdleTimeInMillis) throws InvalidSessionException
{    sessionManager.setTimeout(key, maxIdleTimeInMillis);}
public String shiro_f889_0()
{    if (host == null) {        host = sessionManager.getHost(key);    }    return host;}
public void shiro_f890_0() throws InvalidSessionException
{    sessionManager.touch(key);}
public void shiro_f891_0() throws InvalidSessionException
{    sessionManager.stop(key);}
public Collection<Object> shiro_f892_0() throws InvalidSessionException
{    return sessionManager.getAttributeKeys(key);}
public Object shiro_f893_0(Object attributeKey) throws InvalidSessionException
{    return sessionManager.getAttribute(this.key, attributeKey);}
public void shiro_f894_0(Object attributeKey, Object value) throws InvalidSessionException
{    if (value == null) {        removeAttribute(attributeKey);    } else {        sessionManager.setAttribute(this.key, attributeKey, value);    }}
public Object shiro_f895_0(Object attributeKey) throws InvalidSessionException
{    return sessionManager.removeAttribute(this.key, attributeKey);}
public SessionIdGenerator shiro_f896_0()
{    return sessionIdGenerator;}
public void shiro_f897_0(SessionIdGenerator sessionIdGenerator)
{    this.sessionIdGenerator = sessionIdGenerator;}
protected Serializable shiro_f898_0(Session session)
{    if (this.sessionIdGenerator == null) {        String msg = "sessionIdGenerator attribute has not been configured.";        throw new IllegalStateException(msg);    }    return this.sessionIdGenerator.generateId(session);}
public Serializable shiro_f899_0(Session session)
{    Serializable sessionId = doCreate(session);    verifySessionId(sessionId);    return sessionId;}
private void shiro_f900_0(Serializable sessionId)
{    if (sessionId == null) {        String msg = "sessionId returned from doCreate implementation is null.  Please verify the implementation.";        throw new IllegalStateException(msg);    }}
protected void shiro_f901_0(Session session, Serializable sessionId)
{    ((SimpleSession) session).setId(sessionId);}
public Session shiro_f902_0(Serializable sessionId) throws UnknownSessionException
{    Session s = doReadSession(sessionId);    if (s == null) {        throw new UnknownSessionException("There is no session with id [" + sessionId + "]");    }    return s;}
public void shiro_f903_0(CacheManager cacheManager)
{    this.cacheManager = cacheManager;}
public CacheManager shiro_f904_0()
{    return cacheManager;}
public String shiro_f905_0()
{    return activeSessionsCacheName;}
public void shiro_f906_0(String activeSessionsCacheName)
{    this.activeSessionsCacheName = activeSessionsCacheName;}
public Cache<Serializable, Session> shiro_f907_0()
{    return this.activeSessions;}
public void shiro_f908_0(Cache<Serializable, Session> cache)
{    this.activeSessions = cache;}
private Cache<Serializable, Session> shiro_f909_0()
{    if (this.activeSessions == null) {        this.activeSessions = createActiveSessionsCache();    }    return activeSessions;}
protected Cache<Serializable, Session> shiro_f910_0()
{    Cache<Serializable, Session> cache = null;    CacheManager mgr = getCacheManager();    if (mgr != null) {        String name = getActiveSessionsCacheName();        cache = mgr.getCache(name);    }    return cache;}
public Serializable shiro_f911_0(Session session)
{    Serializable sessionId = super.create(session);    cache(session, sessionId);    return sessionId;}
protected Session shiro_f912_0(Serializable sessionId)
{    Session cached = null;    if (sessionId != null) {        Cache<Serializable, Session> cache = getActiveSessionsCacheLazy();        if (cache != null) {            cached = getCachedSession(sessionId, cache);        }    }    return cached;}
protected Session shiro_f913_0(Serializable sessionId, Cache<Serializable, Session> cache)
{    return cache.get(sessionId);}
protected void shiro_f914_0(Session session, Serializable sessionId)
{    if (session == null || sessionId == null) {        return;    }    Cache<Serializable, Session> cache = getActiveSessionsCacheLazy();    if (cache == null) {        return;    }    cache(session, sessionId, cache);}
protected void shiro_f915_0(Session session, Serializable sessionId, Cache<Serializable, Session> cache)
{    cache.put(sessionId, session);}
public Session shiro_f916_0(Serializable sessionId) throws UnknownSessionException
{    Session s = getCachedSession(sessionId);    if (s == null) {        s = super.readSession(sessionId);    }    return s;}
public void shiro_f917_0(Session session) throws UnknownSessionException
{    doUpdate(session);    if (session instanceof ValidatingSession) {        if (((ValidatingSession) session).isValid()) {            cache(session, session.getId());        } else {            uncache(session);        }    } else {        cache(session, session.getId());    }}
public void shiro_f918_0(Session session)
{    uncache(session);    doDelete(session);}
protected void shiro_f919_0(Session session)
{    if (session == null) {        return;    }    Serializable id = session.getId();    if (id == null) {        return;    }    Cache<Serializable, Session> cache = getActiveSessionsCacheLazy();    if (cache != null) {        cache.remove(id);    }}
public Collection<Session> shiro_f920_0()
{    Cache<Serializable, Session> cache = getActiveSessionsCacheLazy();    if (cache != null) {        return cache.values();    } else {        return Collections.emptySet();    }}
protected Cache<Serializable, Session> shiro_f921_0(String name) throws CacheException
{    return new MapCache<Serializable, Session>(name, new ConcurrentHashMap<Serializable, Session>());}
protected Serializable shiro_f922_0(Session session)
{    Serializable sessionId = generateSessionId(session);    assignSessionId(session, sessionId);    return sessionId;}
protected Session shiro_f923_0(Serializable sessionId)
{        return null;}
protected void shiro_f924_0(Session session)
{}
protected void shiro_f925_0(Session session)
{}
public Serializable shiro_f926_0(Session session)
{    return UUID.randomUUID().toString();}
protected Serializable shiro_f927_0(Session session)
{    Serializable sessionId = generateSessionId(session);    assignSessionId(session, sessionId);    storeSession(sessionId, session);    return sessionId;}
protected Session shiro_f928_0(Serializable id, Session session)
{    if (id == null) {        throw new NullPointerException("id argument cannot be null.");    }    return sessions.putIfAbsent(id, session);}
protected Session shiro_f929_0(Serializable sessionId)
{    return sessions.get(sessionId);}
public void shiro_f930_0(Session session) throws UnknownSessionException
{    storeSession(session.getId(), session);}
public void shiro_f931_0(Session session)
{    if (session == null) {        throw new NullPointerException("session argument cannot be null.");    }    Serializable id = session.getId();    if (id != null) {        sessions.remove(id);    }}
public Collection<Session> shiro_f932_0()
{    Collection<Session> values = sessions.values();    if (CollectionUtils.isEmpty(values)) {        return Collections.emptySet();    } else {        return Collections.unmodifiableCollection(values);    }}
public Random shiro_f933_0()
{    return this.random;}
public void shiro_f934_0(Random random)
{    this.random = random;}
public Serializable shiro_f935_0(Session session)
{        return Long.toString(getRandom().nextLong());}
public ValidatingSessionManager shiro_f936_0()
{    return sessionManager;}
public void shiro_f937_0(ValidatingSessionManager sessionManager)
{    this.sessionManager = sessionManager;}
public long shiro_f938_0()
{    return interval;}
public void shiro_f939_0(long interval)
{    this.interval = interval;}
public boolean shiro_f940_0()
{    return this.enabled;}
public void shiro_f941_0(String threadNamePrefix)
{    this.threadNamePrefix = threadNamePrefix;}
public String shiro_f942_0()
{    return this.threadNamePrefix;}
public void shiro_f943_0()
{    if (this.interval > 0l) {        this.service = Executors.newSingleThreadScheduledExecutor(new ThreadFactory() {            private final AtomicInteger count = new AtomicInteger(1);            public Thread newThread(Runnable r) {                Thread thread = new Thread(r);                thread.setDaemon(true);                thread.setName(threadNamePrefix + count.getAndIncrement());                return thread;            }        });        this.service.scheduleAtFixedRate(this, interval, interval, TimeUnit.MILLISECONDS);    }    this.enabled = true;}
public Thread shiro_f944_0(Runnable r)
{    Thread thread = new Thread(r);    thread.setDaemon(true);    thread.setName(threadNamePrefix + count.getAndIncrement());    return thread;}
public void shiro_f945_1()
{    if (log.isDebugEnabled()) {            }    long startTime = System.currentTimeMillis();    this.sessionManager.validateSessions();    long stopTime = System.currentTimeMillis();    if (log.isDebugEnabled()) {            }}
public void shiro_f946_0()
{    if (this.service != null) {        this.service.shutdownNow();    }    this.enabled = false;}
protected void shiro_f947_0() throws InvalidSessionException
{    String msg = "This session is immutable and read-only - it cannot be altered.  This is usually because " + "the session has been stopped or expired already.";    throw new InvalidSessionException(msg);}
public void shiro_f948_0(long maxIdleTimeInMillis) throws InvalidSessionException
{    throwImmutableException();}
public void shiro_f949_0() throws InvalidSessionException
{    throwImmutableException();}
public void shiro_f950_0() throws InvalidSessionException
{    throwImmutableException();}
public void shiro_f951_0(Object key, Object value) throws InvalidSessionException
{    throwImmutableException();}
public Object shiro_f952_0(Object key) throws InvalidSessionException
{    throwImmutableException();        throw new InternalError("This code should never execute - please report this as a bug!");}
public Serializable shiro_f953_0()
{    return this.id;}
public void shiro_f954_0(Serializable id)
{    this.id = id;}
public Date shiro_f955_0()
{    return startTimestamp;}
public void shiro_f956_0(Date startTimestamp)
{    this.startTimestamp = startTimestamp;}
public Date shiro_f957_0()
{    return stopTimestamp;}
public void shiro_f958_0(Date stopTimestamp)
{    this.stopTimestamp = stopTimestamp;}
public Date shiro_f959_0()
{    return lastAccessTime;}
public void shiro_f960_0(Date lastAccessTime)
{    this.lastAccessTime = lastAccessTime;}
public boolean shiro_f961_0()
{    return expired;}
public void shiro_f962_0(boolean expired)
{    this.expired = expired;}
public long shiro_f963_0()
{    return timeout;}
public void shiro_f964_0(long timeout)
{    this.timeout = timeout;}
public String shiro_f965_0()
{    return host;}
public void shiro_f966_0(String host)
{    this.host = host;}
public Map<Object, Object> shiro_f967_0()
{    return attributes;}
public void shiro_f968_0(Map<Object, Object> attributes)
{    this.attributes = attributes;}
public void shiro_f969_0()
{    this.lastAccessTime = new Date();}
public void shiro_f970_0()
{    if (this.stopTimestamp == null) {        this.stopTimestamp = new Date();    }}
protected boolean shiro_f971_0()
{    return getStopTimestamp() != null;}
protected void shiro_f972_0()
{    stop();    this.expired = true;}
public boolean shiro_f973_0()
{    return !isStopped() && !isExpired();}
protected boolean shiro_f974_0()
{    if (isExpired()) {        return true;    }    long timeout = getTimeout();    if (timeout >= 0l) {        Date lastAccessTime = getLastAccessTime();        if (lastAccessTime == null) {            String msg = "session.lastAccessTime for session with id [" + getId() + "] is null.  This value must be set at " + "least once, preferably at least upon instantiation.  Please check the " + getClass().getName() + " implementation and ensure " + "this value will be set (perhaps in the constructor?)";            throw new IllegalStateException(msg);        }                                                long expireTimeMillis = System.currentTimeMillis() - timeout;        Date expireTime = new Date(expireTimeMillis);        return lastAccessTime.before(expireTime);    } else {        if (log.isTraceEnabled()) {            log.trace("No timeout for session with id [" + getId() + "].  Session is not considered expired.");        }    }    return false;}
public void shiro_f975_0() throws InvalidSessionException
{        if (isStopped()) {                String msg = "Session with id [" + getId() + "] has been " + "explicitly stopped.  No further interaction under this session is " + "allowed.";        throw new StoppedSessionException(msg);    }        if (isTimedOut()) {        expire();                Date lastAccessTime = getLastAccessTime();        long timeout = getTimeout();        Serializable sessionId = getId();        DateFormat df = DateFormat.getInstance();        String msg = "Session with id [" + sessionId + "] has expired. " + "Last access time: " + df.format(lastAccessTime) + ".  Current time: " + df.format(new Date()) + ".  Session timeout is set to " + timeout / MILLIS_PER_SECOND + " seconds (" + timeout / MILLIS_PER_MINUTE + " minutes)";        if (log.isTraceEnabled()) {            log.trace(msg);        }        throw new ExpiredSessionException(msg);    }}
private Map<Object, Object> shiro_f976_0()
{    Map<Object, Object> attributes = getAttributes();    if (attributes == null) {        attributes = new HashMap<Object, Object>();        setAttributes(attributes);    }    return attributes;}
public Collection<Object> shiro_f977_0() throws InvalidSessionException
{    Map<Object, Object> attributes = getAttributes();    if (attributes == null) {        return Collections.emptySet();    }    return attributes.keySet();}
public Object shiro_f978_0(Object key)
{    Map<Object, Object> attributes = getAttributes();    if (attributes == null) {        return null;    }    return attributes.get(key);}
public void shiro_f979_0(Object key, Object value)
{    if (value == null) {        removeAttribute(key);    } else {        getAttributesLazy().put(key, value);    }}
public Object shiro_f980_0(Object key)
{    Map<Object, Object> attributes = getAttributes();    if (attributes == null) {        return null;    } else {        return attributes.remove(key);    }}
public boolean shiro_f981_0(Object obj)
{    if (this == obj) {        return true;    }    if (obj instanceof SimpleSession) {        SimpleSession other = (SimpleSession) obj;        Serializable thisId = getId();        Serializable otherId = other.getId();        if (thisId != null && otherId != null) {            return thisId.equals(otherId);        } else {                        return onEquals(other);        }    }    return false;}
protected boolean shiro_f982_0(SimpleSession ss)
{    return (getStartTimestamp() != null ? getStartTimestamp().equals(ss.getStartTimestamp()) : ss.getStartTimestamp() == null) && (getStopTimestamp() != null ? getStopTimestamp().equals(ss.getStopTimestamp()) : ss.getStopTimestamp() == null) && (getLastAccessTime() != null ? getLastAccessTime().equals(ss.getLastAccessTime()) : ss.getLastAccessTime() == null) && (getTimeout() == ss.getTimeout()) && (isExpired() == ss.isExpired()) && (getHost() != null ? getHost().equals(ss.getHost()) : ss.getHost() == null) && (getAttributes() != null ? getAttributes().equals(ss.getAttributes()) : ss.getAttributes() == null);}
public int shiro_f983_0()
{    Serializable id = getId();    if (id != null) {        return id.hashCode();    }    int hashCode = getStartTimestamp() != null ? getStartTimestamp().hashCode() : 0;    hashCode = 31 * hashCode + (getStopTimestamp() != null ? getStopTimestamp().hashCode() : 0);    hashCode = 31 * hashCode + (getLastAccessTime() != null ? getLastAccessTime().hashCode() : 0);    hashCode = 31 * hashCode + Long.valueOf(Math.max(getTimeout(), 0)).hashCode();    hashCode = 31 * hashCode + Boolean.valueOf(isExpired()).hashCode();    hashCode = 31 * hashCode + (getHost() != null ? getHost().hashCode() : 0);    hashCode = 31 * hashCode + (getAttributes() != null ? getAttributes().hashCode() : 0);    return hashCode;}
public String shiro_f984_0()
{    StringBuilder sb = new StringBuilder();    sb.append(getClass().getName()).append(",id=").append(getId());    return sb.toString();}
private void shiro_f985_0(ObjectOutputStream out) throws IOException
{    out.defaultWriteObject();    short alteredFieldsBitMask = getAlteredFieldsBitMask();    out.writeShort(alteredFieldsBitMask);    if (id != null) {        out.writeObject(id);    }    if (startTimestamp != null) {        out.writeObject(startTimestamp);    }    if (stopTimestamp != null) {        out.writeObject(stopTimestamp);    }    if (lastAccessTime != null) {        out.writeObject(lastAccessTime);    }    if (timeout != 0l) {        out.writeLong(timeout);    }    if (expired) {        out.writeBoolean(expired);    }    if (host != null) {        out.writeUTF(host);    }    if (!CollectionUtils.isEmpty(attributes)) {        out.writeObject(attributes);    }}
private void shiro_f986_0(ObjectInputStream in) throws IOException, ClassNotFoundException
{    in.defaultReadObject();    short bitMask = in.readShort();    if (isFieldPresent(bitMask, ID_BIT_MASK)) {        this.id = (Serializable) in.readObject();    }    if (isFieldPresent(bitMask, START_TIMESTAMP_BIT_MASK)) {        this.startTimestamp = (Date) in.readObject();    }    if (isFieldPresent(bitMask, STOP_TIMESTAMP_BIT_MASK)) {        this.stopTimestamp = (Date) in.readObject();    }    if (isFieldPresent(bitMask, LAST_ACCESS_TIME_BIT_MASK)) {        this.lastAccessTime = (Date) in.readObject();    }    if (isFieldPresent(bitMask, TIMEOUT_BIT_MASK)) {        this.timeout = in.readLong();    }    if (isFieldPresent(bitMask, EXPIRED_BIT_MASK)) {        this.expired = in.readBoolean();    }    if (isFieldPresent(bitMask, HOST_BIT_MASK)) {        this.host = in.readUTF();    }    if (isFieldPresent(bitMask, ATTRIBUTES_BIT_MASK)) {        this.attributes = (Map<Object, Object>) in.readObject();    }}
private short shiro_f987_0()
{    int bitMask = 0;    bitMask = id != null ? bitMask | ID_BIT_MASK : bitMask;    bitMask = startTimestamp != null ? bitMask | START_TIMESTAMP_BIT_MASK : bitMask;    bitMask = stopTimestamp != null ? bitMask | STOP_TIMESTAMP_BIT_MASK : bitMask;    bitMask = lastAccessTime != null ? bitMask | LAST_ACCESS_TIME_BIT_MASK : bitMask;    bitMask = timeout != 0l ? bitMask | TIMEOUT_BIT_MASK : bitMask;    bitMask = expired ? bitMask | EXPIRED_BIT_MASK : bitMask;    bitMask = host != null ? bitMask | HOST_BIT_MASK : bitMask;    bitMask = !CollectionUtils.isEmpty(attributes) ? bitMask | ATTRIBUTES_BIT_MASK : bitMask;    return (short) bitMask;}
private static boolean shiro_f988_0(short bitMask, int fieldBitMask)
{    return (bitMask & fieldBitMask) != 0;}
public Session shiro_f989_0(SessionContext initData)
{    if (initData != null) {        String host = initData.getHost();        if (host != null) {            return new SimpleSession(host);        }    }    return new SimpleSession();}
public Serializable shiro_f990_0()
{    return delegate.getId();}
public Date shiro_f991_0()
{    return delegate.getStartTimestamp();}
public Date shiro_f992_0()
{    return delegate.getLastAccessTime();}
public long shiro_f993_0() throws InvalidSessionException
{    return delegate.getTimeout();}
public void shiro_f994_0(long maxIdleTimeInMillis) throws InvalidSessionException
{    delegate.setTimeout(maxIdleTimeInMillis);}
public String shiro_f995_0()
{    return delegate.getHost();}
public void shiro_f996_0() throws InvalidSessionException
{    delegate.touch();}
public void shiro_f997_0() throws InvalidSessionException
{    delegate.stop();}
public Collection<Object> shiro_f998_0() throws InvalidSessionException
{    return delegate.getAttributeKeys();}
public Object shiro_f999_0(Object key) throws InvalidSessionException
{    return delegate.getAttribute(key);}
public void shiro_f1000_0(Object key, Object value) throws InvalidSessionException
{    delegate.setAttribute(key, value);}
public Object shiro_f1001_0(Object key) throws InvalidSessionException
{    return delegate.removeAttribute(key);}
public void shiro_f1002_0(Session session)
{}
public void shiro_f1003_0(Session session)
{}
public void shiro_f1004_0(Session session)
{}
protected Collection shiro_f1005_0(String realmName)
{    if (realmPrincipals == null) {        realmPrincipals = new LinkedHashMap<String, Set>();    }    Set principals = realmPrincipals.get(realmName);    if (principals == null) {        principals = new LinkedHashSet();        realmPrincipals.put(realmName, principals);    }    return principals;}
public Object shiro_f1006_0()
{    if (isEmpty()) {        return null;    }    return iterator().next();}
public void shiro_f1007_0(Object principal, String realmName)
{    if (realmName == null) {        throw new IllegalArgumentException("realmName argument cannot be null.");    }    if (principal == null) {        throw new IllegalArgumentException("principal argument cannot be null.");    }    this.cachedToString = null;    getPrincipalsLazy(realmName).add(principal);}
public void shiro_f1008_0(Collection principals, String realmName)
{    if (realmName == null) {        throw new IllegalArgumentException("realmName argument cannot be null.");    }    if (principals == null) {        throw new IllegalArgumentException("principals argument cannot be null.");    }    if (principals.isEmpty()) {        throw new IllegalArgumentException("principals argument cannot be an empty collection.");    }    this.cachedToString = null;    getPrincipalsLazy(realmName).addAll(principals);}
public void shiro_f1009_0(PrincipalCollection principals)
{    if (principals.getRealmNames() != null) {        for (String realmName : principals.getRealmNames()) {            for (Object principal : principals.fromRealm(realmName)) {                add(principal, realmName);            }        }    }}
public T shiro_f1010_0(Class<T> type)
{    if (realmPrincipals == null || realmPrincipals.isEmpty()) {        return null;    }    Collection<Set> values = realmPrincipals.values();    for (Set set : values) {        for (Object o : set) {            if (type.isAssignableFrom(o.getClass())) {                return (T) o;            }        }    }    return null;}
public Collection<T> shiro_f1011_0(Class<T> type)
{    if (realmPrincipals == null || realmPrincipals.isEmpty()) {        return Collections.EMPTY_SET;    }    Set<T> typed = new LinkedHashSet<T>();    Collection<Set> values = realmPrincipals.values();    for (Set set : values) {        for (Object o : set) {            if (type.isAssignableFrom(o.getClass())) {                typed.add((T) o);            }        }    }    if (typed.isEmpty()) {        return Collections.EMPTY_SET;    }    return Collections.unmodifiableSet(typed);}
public List shiro_f1012_0()
{    Set all = asSet();    if (all.isEmpty()) {        return Collections.EMPTY_LIST;    }    return Collections.unmodifiableList(new ArrayList(all));}
public Set shiro_f1013_0()
{    if (realmPrincipals == null || realmPrincipals.isEmpty()) {        return Collections.EMPTY_SET;    }    Set aggregated = new LinkedHashSet();    Collection<Set> values = realmPrincipals.values();    for (Set set : values) {        aggregated.addAll(set);    }    if (aggregated.isEmpty()) {        return Collections.EMPTY_SET;    }    return Collections.unmodifiableSet(aggregated);}
public Collection shiro_f1014_0(String realmName)
{    if (realmPrincipals == null || realmPrincipals.isEmpty()) {        return Collections.EMPTY_SET;    }    Set principals = realmPrincipals.get(realmName);    if (principals == null || principals.isEmpty()) {        principals = Collections.EMPTY_SET;    }    return Collections.unmodifiableSet(principals);}
public Set<String> shiro_f1015_0()
{    if (realmPrincipals == null) {        return null;    } else {        return realmPrincipals.keySet();    }}
public boolean shiro_f1016_0()
{    return realmPrincipals == null || realmPrincipals.isEmpty();}
public void shiro_f1017_0()
{    this.cachedToString = null;    if (realmPrincipals != null) {        realmPrincipals.clear();        realmPrincipals = null;    }}
public Iterator shiro_f1018_0()
{    return asSet().iterator();}
public boolean shiro_f1019_0(Object o)
{    if (o == this) {        return true;    }    if (o instanceof SimplePrincipalCollection) {        SimplePrincipalCollection other = (SimplePrincipalCollection) o;        return this.realmPrincipals != null ? this.realmPrincipals.equals(other.realmPrincipals) : other.realmPrincipals == null;    }    return false;}
public int shiro_f1020_0()
{    if (this.realmPrincipals != null && !realmPrincipals.isEmpty()) {        return realmPrincipals.hashCode();    }    return super.hashCode();}
public String shiro_f1021_0()
{    if (this.cachedToString == null) {        Set<Object> principals = asSet();        if (!CollectionUtils.isEmpty(principals)) {            this.cachedToString = StringUtils.toString(principals.toArray());        } else {            this.cachedToString = "empty";        }    }    return this.cachedToString;}
private void shiro_f1022_0(ObjectOutputStream out) throws IOException
{    out.defaultWriteObject();    boolean principalsExist = !CollectionUtils.isEmpty(realmPrincipals);    out.writeBoolean(principalsExist);    if (principalsExist) {        out.writeObject(realmPrincipals);    }}
private void shiro_f1023_0(ObjectInputStream in) throws IOException, ClassNotFoundException
{    in.defaultReadObject();    boolean principalsExist = in.readBoolean();    if (principalsExist) {        this.realmPrincipals = (Map<String, Set>) in.readObject();    }}
public int shiro_f1024_0()
{    return CollectionUtils.size(this.combinedPrincipals);}
protected Map<String, Object> shiro_f1025_0()
{    if (this.combinedPrincipals == null) {        this.combinedPrincipals = new HashMap<String, Object>();    }    return this.combinedPrincipals;}
public boolean shiro_f1026_0(Object o)
{    return this.combinedPrincipals != null && this.combinedPrincipals.containsKey(o);}
public boolean shiro_f1027_0(Object o)
{    return this.combinedPrincipals != null && this.combinedPrincipals.containsKey(o);}
public Object shiro_f1028_0(Object o)
{    return this.combinedPrincipals != null && this.combinedPrincipals.containsKey(o);}
public Object shiro_f1029_0(String s, Object o)
{    return ensureCombinedPrincipals().put(s, o);}
public Object shiro_f1030_0(Object o)
{    return this.combinedPrincipals != null ? this.combinedPrincipals.remove(o) : null;}
public void shiro_f1031_0(Map<? extends String, ?> map)
{    if (!CollectionUtils.isEmpty(map)) {        ensureCombinedPrincipals().putAll(map);    }}
public Set<String> shiro_f1032_0()
{    return CollectionUtils.isEmpty(this.combinedPrincipals) ? Collections.<String>emptySet() : Collections.unmodifiableSet(this.combinedPrincipals.keySet());}
public Collection<Object> shiro_f1033_0()
{    return CollectionUtils.isEmpty(this.combinedPrincipals) ? Collections.emptySet() : Collections.unmodifiableCollection(this.combinedPrincipals.values());}
public Set<Entry<String, Object>> shiro_f1034_0()
{    return CollectionUtils.isEmpty(this.combinedPrincipals) ? Collections.<Entry<String, Object>>emptySet() : Collections.unmodifiableSet(this.combinedPrincipals.entrySet());}
public void shiro_f1035_0()
{    this.realmPrincipals = null;    this.combinedPrincipals = null;}
public Object shiro_f1036_0()
{        return !CollectionUtils.isEmpty(this.combinedPrincipals) ? this.combinedPrincipals.values().iterator().next() : null;}
public T shiro_f1037_0(Class<T> type)
{    if (CollectionUtils.isEmpty(this.combinedPrincipals)) {        return null;    }    for (Object value : this.combinedPrincipals.values()) {        if (type.isInstance(value)) {            return type.cast(value);        }    }    return null;}
public Collection<T> shiro_f1038_0(Class<T> type)
{    if (CollectionUtils.isEmpty(this.combinedPrincipals)) {        return Collections.emptySet();    }    Collection<T> instances = null;    for (Object value : this.combinedPrincipals.values()) {        if (type.isInstance(value)) {            if (instances == null) {                instances = new ArrayList<T>();            }            instances.add(type.cast(value));        }    }    return instances != null ? instances : Collections.<T>emptyList();}
public List shiro_f1039_0()
{    if (CollectionUtils.isEmpty(this.combinedPrincipals)) {        return Collections.emptyList();    }    List<Object> list = new ArrayList<Object>(this.combinedPrincipals.size());    list.addAll(this.combinedPrincipals.values());    return list;}
public Set shiro_f1040_0()
{    if (CollectionUtils.isEmpty(this.combinedPrincipals)) {        return Collections.emptySet();    }    Set<Object> set = new HashSet<Object>(this.combinedPrincipals.size());    set.addAll(this.combinedPrincipals.values());    return set;}
public Collection shiro_f1041_0(String realmName)
{    if (CollectionUtils.isEmpty(this.realmPrincipals)) {        return Collections.emptySet();    }    Map<String, Object> principals = this.realmPrincipals.get(realmName);    if (CollectionUtils.isEmpty(principals)) {        return Collections.emptySet();    }    return Collections.unmodifiableCollection(principals.values());}
public Set<String> shiro_f1042_0()
{    if (CollectionUtils.isEmpty(this.realmPrincipals)) {        return Collections.emptySet();    }    return Collections.unmodifiableSet(this.realmPrincipals.keySet());}
public boolean shiro_f1043_0()
{    return CollectionUtils.isEmpty(this.combinedPrincipals);}
public Iterator shiro_f1044_0()
{    return asList().iterator();}
public Map<String, Object> shiro_f1045_0(String name)
{    if (this.realmPrincipals == null) {        return null;    }    Map<String, Object> principals = this.realmPrincipals.get(name);    if (principals == null) {        return null;    }    return Collections.unmodifiableMap(principals);}
public Map<String, Object> shiro_f1046_0(String realmName, Map<String, Object> principals)
{    if (realmName == null) {        throw new NullPointerException("realmName argument cannot be null.");    }    if (this.realmPrincipals == null) {        if (!CollectionUtils.isEmpty(principals)) {            this.realmPrincipals = new HashMap<String, Map<String, Object>>();            return this.realmPrincipals.put(realmName, new HashMap<String, Object>(principals));        } else {            return null;        }    } else {        Map<String, Object> existingPrincipals = this.realmPrincipals.remove(realmName);        if (!CollectionUtils.isEmpty(principals)) {            this.realmPrincipals.put(realmName, new HashMap<String, Object>(principals));        }        return existingPrincipals;    }}
public Object shiro_f1047_0(String realmName, String principalName, Object principal)
{    if (realmName == null) {        throw new NullPointerException("realmName argument cannot be null.");    }    if (principalName == null) {        throw new NullPointerException(("principalName argument cannot be null."));    }    if (principal == null) {        return removeRealmPrincipal(realmName, principalName);    }    if (this.realmPrincipals == null) {        this.realmPrincipals = new HashMap<String, Map<String, Object>>();    }    Map<String, Object> principals = this.realmPrincipals.get(realmName);    if (principals == null) {        principals = new HashMap<String, Object>();        this.realmPrincipals.put(realmName, principals);    }    return principals.put(principalName, principal);}
public Object shiro_f1048_0(String realmName, String principalName)
{    if (realmName == null) {        throw new NullPointerException("realmName argument cannot be null.");    }    if (principalName == null) {        throw new NullPointerException(("principalName argument cannot be null."));    }    if (this.realmPrincipals == null) {        return null;    }    Map<String, Object> principals = this.realmPrincipals.get(realmName);    if (principals != null) {        return principals.get(principalName);    }    return null;}
public Object shiro_f1049_0(String realmName, String principalName)
{    if (realmName == null) {        throw new NullPointerException("realmName argument cannot be null.");    }    if (principalName == null) {        throw new NullPointerException(("principalName argument cannot be null."));    }    if (this.realmPrincipals == null) {        return null;    }    Map<String, Object> principals = this.realmPrincipals.get(realmName);    if (principals != null) {        return principals.remove(principalName);    }    return null;}
protected SubjectContext shiro_f1050_0()
{    return new DefaultSubjectContext();}
protected SubjectContext shiro_f1051_0()
{    return this.subjectContext;}
public Builder shiro_f1052_0(Serializable sessionId)
{    if (sessionId != null) {        this.subjectContext.setSessionId(sessionId);    }    return this;}
public Builder shiro_f1053_0(String host)
{    if (StringUtils.hasText(host)) {        this.subjectContext.setHost(host);    }    return this;}
public Builder shiro_f1054_0(Session session)
{    if (session != null) {        this.subjectContext.setSession(session);    }    return this;}
public Builder shiro_f1055_0(PrincipalCollection principals)
{    if (principals != null && !principals.isEmpty()) {        this.subjectContext.setPrincipals(principals);    }    return this;}
public Builder shiro_f1056_0(boolean enabled)
{    this.subjectContext.setSessionCreationEnabled(enabled);    return this;}
public Builder shiro_f1057_0(boolean authenticated)
{    this.subjectContext.setAuthenticated(authenticated);    return this;}
public Builder shiro_f1058_0(String attributeKey, Object attributeValue)
{    if (attributeKey == null) {        String msg = "Subject context map key cannot be null.";        throw new IllegalArgumentException(msg);    }    if (attributeValue == null) {        this.subjectContext.remove(attributeKey);    } else {        this.subjectContext.put(attributeKey, attributeValue);    }    return this;}
public Subject shiro_f1059_0()
{    return this.securityManager.createSubject(this.subjectContext);}
public SecurityManager shiro_f1060_0()
{    return getTypedValue(SECURITY_MANAGER, SecurityManager.class);}
public void shiro_f1061_0(SecurityManager securityManager)
{    nullSafePut(SECURITY_MANAGER, securityManager);}
public SecurityManager shiro_f1062_1()
{    SecurityManager securityManager = getSecurityManager();    if (securityManager == null) {        if (log.isDebugEnabled()) {                    }        try {            securityManager = SecurityUtils.getSecurityManager();        } catch (UnavailableSecurityManagerException e) {            if (log.isDebugEnabled()) {                            }        }    }    return securityManager;}
public Serializable shiro_f1063_0()
{    return getTypedValue(SESSION_ID, Serializable.class);}
public void shiro_f1064_0(Serializable sessionId)
{    nullSafePut(SESSION_ID, sessionId);}
public Subject shiro_f1065_0()
{    return getTypedValue(SUBJECT, Subject.class);}
public void shiro_f1066_0(Subject subject)
{    nullSafePut(SUBJECT, subject);}
public PrincipalCollection shiro_f1067_0()
{    return getTypedValue(PRINCIPALS, PrincipalCollection.class);}
private static boolean shiro_f1068_0(PrincipalCollection pc)
{    return pc == null || pc.isEmpty();}
public void shiro_f1069_0(PrincipalCollection principals)
{    if (!isEmpty(principals)) {        put(PRINCIPALS, principals);    }}
public PrincipalCollection shiro_f1070_0()
{    PrincipalCollection principals = getPrincipals();    if (isEmpty(principals)) {                AuthenticationInfo info = getAuthenticationInfo();        if (info != null) {            principals = info.getPrincipals();        }    }    if (isEmpty(principals)) {        Subject subject = getSubject();        if (subject != null) {            principals = subject.getPrincipals();        }    }    if (isEmpty(principals)) {                Session session = resolveSession();        if (session != null) {            principals = (PrincipalCollection) session.getAttribute(PRINCIPALS_SESSION_KEY);        }    }    return principals;}
public Session shiro_f1071_0()
{    return getTypedValue(SESSION, Session.class);}
public void shiro_f1072_0(Session session)
{    nullSafePut(SESSION, session);}
public Session shiro_f1073_0()
{    Session session = getSession();    if (session == null) {                Subject existingSubject = getSubject();        if (existingSubject != null) {            session = existingSubject.getSession(false);        }    }    return session;}
public boolean shiro_f1074_0()
{    Boolean val = getTypedValue(SESSION_CREATION_ENABLED, Boolean.class);    return val == null || val;}
public void shiro_f1075_0(boolean enabled)
{    nullSafePut(SESSION_CREATION_ENABLED, enabled);}
public boolean shiro_f1076_0()
{    Boolean authc = getTypedValue(AUTHENTICATED, Boolean.class);    return authc != null && authc;}
public void shiro_f1077_0(boolean authc)
{    put(AUTHENTICATED, authc);}
public boolean shiro_f1078_0()
{    Boolean authc = getTypedValue(AUTHENTICATED, Boolean.class);    if (authc == null) {                        AuthenticationInfo info = getAuthenticationInfo();        authc = info != null;    }    if (!authc) {                Session session = resolveSession();        if (session != null) {            Boolean sessionAuthc = (Boolean) session.getAttribute(AUTHENTICATED_SESSION_KEY);            authc = sessionAuthc != null && sessionAuthc;        }    }    return authc;}
public AuthenticationInfo shiro_f1079_0()
{    return getTypedValue(AUTHENTICATION_INFO, AuthenticationInfo.class);}
public void shiro_f1080_0(AuthenticationInfo info)
{    nullSafePut(AUTHENTICATION_INFO, info);}
public AuthenticationToken shiro_f1081_0()
{    return getTypedValue(AUTHENTICATION_TOKEN, AuthenticationToken.class);}
public void shiro_f1082_0(AuthenticationToken token)
{    nullSafePut(AUTHENTICATION_TOKEN, token);}
public String shiro_f1083_0()
{    return getTypedValue(HOST, String.class);}
public void shiro_f1084_0(String host)
{    if (StringUtils.hasText(host)) {        put(HOST, host);    }}
public String shiro_f1085_0()
{    String host = getHost();    if (host == null) {                AuthenticationToken token = getAuthenticationToken();        if (token instanceof HostAuthenticationToken) {            host = ((HostAuthenticationToken) token).getHost();        }    }    if (host == null) {        Session session = resolveSession();        if (session != null) {            host = session.getHost();        }    }    return host;}
protected Session shiro_f1086_0(Session session)
{    if (session == null) {        throw new IllegalArgumentException("session cannot be null");    }    return new StoppingAwareProxiedSession(session, this);}
public SecurityManager shiro_f1087_0()
{    return securityManager;}
private static boolean shiro_f1088_0(PrincipalCollection pc)
{    return pc == null || pc.isEmpty();}
protected boolean shiro_f1089_0()
{    return !isEmpty(getPrincipals());}
public String shiro_f1090_0()
{    return this.host;}
private Object shiro_f1091_0(PrincipalCollection principals)
{    if (!isEmpty(principals)) {        return principals.getPrimaryPrincipal();    }    return null;}
public Object shiro_f1092_0()
{    return getPrimaryPrincipal(getPrincipals());}
public PrincipalCollection shiro_f1093_0()
{    List<PrincipalCollection> runAsPrincipals = getRunAsPrincipalsStack();    return CollectionUtils.isEmpty(runAsPrincipals) ? this.principals : runAsPrincipals.get(0);}
public boolean shiro_f1094_0(String permission)
{    return hasPrincipals() && securityManager.isPermitted(getPrincipals(), permission);}
public boolean shiro_f1095_0(Permission permission)
{    return hasPrincipals() && securityManager.isPermitted(getPrincipals(), permission);}
public boolean[] shiro_f1096_0(String... permissions)
{    if (hasPrincipals()) {        return securityManager.isPermitted(getPrincipals(), permissions);    } else {        return new boolean[permissions.length];    }}
public boolean[] shiro_f1097_0(List<Permission> permissions)
{    if (hasPrincipals()) {        return securityManager.isPermitted(getPrincipals(), permissions);    } else {        return new boolean[permissions.size()];    }}
public boolean shiro_f1098_0(String... permissions)
{    return hasPrincipals() && securityManager.isPermittedAll(getPrincipals(), permissions);}
public boolean shiro_f1099_0(Collection<Permission> permissions)
{    return hasPrincipals() && securityManager.isPermittedAll(getPrincipals(), permissions);}
protected void shiro_f1100_0() throws AuthorizationException
{    if (!hasPrincipals()) {        String msg = "This subject is anonymous - it does not have any identifying principals and " + "authorization operations require an identity to check against.  A Subject instance will " + "acquire these identifying principals automatically after a successful login is performed " + "be executing " + Subject.class.getName() + ".login(AuthenticationToken) or when 'Remember Me' " + "functionality is enabled by the SecurityManager.  This exception can also occur when a " + "previously logged-in Subject has logged out which " + "makes it anonymous again.  Because an identity is currently not known due to any of these " + "conditions, authorization is denied.";        throw new UnauthenticatedException(msg);    }}
public void shiro_f1101_0(String permission) throws AuthorizationException
{    assertAuthzCheckPossible();    securityManager.checkPermission(getPrincipals(), permission);}
public void shiro_f1102_0(Permission permission) throws AuthorizationException
{    assertAuthzCheckPossible();    securityManager.checkPermission(getPrincipals(), permission);}
public void shiro_f1103_0(String... permissions) throws AuthorizationException
{    assertAuthzCheckPossible();    securityManager.checkPermissions(getPrincipals(), permissions);}
public void shiro_f1104_0(Collection<Permission> permissions) throws AuthorizationException
{    assertAuthzCheckPossible();    securityManager.checkPermissions(getPrincipals(), permissions);}
public boolean shiro_f1105_0(String roleIdentifier)
{    return hasPrincipals() && securityManager.hasRole(getPrincipals(), roleIdentifier);}
public boolean[] shiro_f1106_0(List<String> roleIdentifiers)
{    if (hasPrincipals()) {        return securityManager.hasRoles(getPrincipals(), roleIdentifiers);    } else {        return new boolean[roleIdentifiers.size()];    }}
public boolean shiro_f1107_0(Collection<String> roleIdentifiers)
{    return hasPrincipals() && securityManager.hasAllRoles(getPrincipals(), roleIdentifiers);}
public void shiro_f1108_0(String role) throws AuthorizationException
{    assertAuthzCheckPossible();    securityManager.checkRole(getPrincipals(), role);}
public void shiro_f1109_0(String... roleIdentifiers) throws AuthorizationException
{    assertAuthzCheckPossible();    securityManager.checkRoles(getPrincipals(), roleIdentifiers);}
public void shiro_f1110_0(Collection<String> roles) throws AuthorizationException
{    assertAuthzCheckPossible();    securityManager.checkRoles(getPrincipals(), roles);}
public void shiro_f1111_0(AuthenticationToken token) throws AuthenticationException
{    clearRunAsIdentitiesInternal();    Subject subject = securityManager.login(this, token);    PrincipalCollection principals;    String host = null;    if (subject instanceof DelegatingSubject) {        DelegatingSubject delegating = (DelegatingSubject) subject;                principals = delegating.principals;        host = delegating.host;    } else {        principals = subject.getPrincipals();    }    if (principals == null || principals.isEmpty()) {        String msg = "Principals returned from securityManager.login( token ) returned a null or " + "empty value.  This value must be non null and populated with one or more elements.";        throw new IllegalStateException(msg);    }    this.principals = principals;    this.authenticated = true;    if (token instanceof HostAuthenticationToken) {        host = ((HostAuthenticationToken) token).getHost();    }    if (host != null) {        this.host = host;    }    Session session = subject.getSession(false);    if (session != null) {        this.session = decorate(session);    } else {        this.session = null;    }}
public boolean shiro_f1112_0()
{    return authenticated && hasPrincipals();}
public boolean shiro_f1113_0()
{    PrincipalCollection principals = getPrincipals();    return principals != null && !principals.isEmpty() && !isAuthenticated();}
protected boolean shiro_f1114_0()
{    return this.sessionCreationEnabled;}
public Session shiro_f1115_0()
{    return getSession(true);}
public Session shiro_f1116_0(boolean create)
{    if (log.isTraceEnabled()) {        log.trace("attempting to get session; create = " + create + "; session is null = " + (this.session == null) + "; session has id = " + (this.session != null && session.getId() != null));    }    if (this.session == null && create) {                if (!isSessionCreationEnabled()) {            String msg = "Session creation has been disabled for the current subject.  This exception indicates " + "that there is either a programming error (using a session when it should never be " + "used) or that Shiro's configuration needs to be adjusted to allow Sessions to be created " + "for the current Subject.  See the " + DisabledSessionException.class.getName() + " JavaDoc " + "for more.";            throw new DisabledSessionException(msg);        }        log.trace("Starting session for host {}", getHost());        SessionContext sessionContext = createSessionContext();        Session session = this.securityManager.start(sessionContext);        this.session = decorate(session);    }    return this.session;}
protected SessionContext shiro_f1117_0()
{    SessionContext sessionContext = new DefaultSessionContext();    if (StringUtils.hasText(host)) {        sessionContext.setHost(host);    }    return sessionContext;}
private void shiro_f1118_1()
{        try {        clearRunAsIdentities();    } catch (SessionException se) {            }}
public void shiro_f1119_0()
{    try {        clearRunAsIdentitiesInternal();        this.securityManager.logout(this);    } finally {        this.session = null;        this.principals = null;        this.authenticated = false;                        }}
private void shiro_f1120_0()
{    this.session = null;}
public V shiro_f1121_0(Callable<V> callable) throws ExecutionException
{    Callable<V> associated = associateWith(callable);    try {        return associated.call();    } catch (Throwable t) {        throw new ExecutionException(t);    }}
public void shiro_f1122_0(Runnable runnable)
{    Runnable associated = associateWith(runnable);    associated.run();}
public Callable<V> shiro_f1123_0(Callable<V> callable)
{    return new SubjectCallable<V>(this, callable);}
public Runnable shiro_f1124_0(Runnable runnable)
{    if (runnable instanceof Thread) {        String msg = "This implementation does not support Thread arguments because of JDK ThreadLocal " + "inheritance mechanisms required by Shiro.  Instead, the method argument should be a non-Thread " + "Runnable and the return value from this method can then be given to an ExecutorService or " + "another Thread.";        throw new UnsupportedOperationException(msg);    }    return new SubjectRunnable(this, runnable);}
public void shiro_f1125_0() throws InvalidSessionException
{    super.stop();    owner.sessionStopped();}
public void shiro_f1126_0(PrincipalCollection principals)
{    if (!hasPrincipals()) {        String msg = "This subject does not yet have an identity.  Assuming the identity of another " + "Subject is only allowed for Subjects with an existing identity.  Try logging this subject in " + "first, or using the " + Subject.Builder.class.getName() + " to build ad hoc Subject instances " + "with identities as necessary.";        throw new IllegalStateException(msg);    }    pushIdentity(principals);}
public boolean shiro_f1127_0()
{    List<PrincipalCollection> stack = getRunAsPrincipalsStack();    return !CollectionUtils.isEmpty(stack);}
public PrincipalCollection shiro_f1128_0()
{    PrincipalCollection previousPrincipals = null;    List<PrincipalCollection> stack = getRunAsPrincipalsStack();    int stackSize = stack != null ? stack.size() : 0;    if (stackSize > 0) {        if (stackSize == 1) {            previousPrincipals = this.principals;        } else {                        assert stack != null;            previousPrincipals = stack.get(1);        }    }    return previousPrincipals;}
public PrincipalCollection shiro_f1129_0()
{    return popIdentity();}
private List<PrincipalCollection> shiro_f1130_0()
{    Session session = getSession(false);    if (session != null) {        return (List<PrincipalCollection>) session.getAttribute(RUN_AS_PRINCIPALS_SESSION_KEY);    }    return null;}
private void shiro_f1131_0()
{    Session session = getSession(false);    if (session != null) {        session.removeAttribute(RUN_AS_PRINCIPALS_SESSION_KEY);    }}
private void shiro_f1132_0(PrincipalCollection principals) throws NullPointerException
{    if (isEmpty(principals)) {        String msg = "Specified Subject principals cannot be null or empty for 'run as' functionality.";        throw new NullPointerException(msg);    }    List<PrincipalCollection> stack = getRunAsPrincipalsStack();    if (stack == null) {        stack = new CopyOnWriteArrayList<PrincipalCollection>();    }    stack.add(0, principals);    Session session = getSession();    session.setAttribute(RUN_AS_PRINCIPALS_SESSION_KEY, stack);}
private PrincipalCollection shiro_f1133_0()
{    PrincipalCollection popped = null;    List<PrincipalCollection> stack = getRunAsPrincipalsStack();    if (!CollectionUtils.isEmpty(stack)) {        popped = stack.remove(0);        Session session;        if (!CollectionUtils.isEmpty(stack)) {                        session = getSession();            session.setAttribute(RUN_AS_PRINCIPALS_SESSION_KEY, stack);        } else {                        clearRunAsIdentities();        }    }    return popped;}
public V shiro_f1134_0() throws Exception
{    try {        threadState.bind();        return doCall(this.callable);    } finally {        threadState.restore();    }}
protected V shiro_f1135_0(Callable<V> target) throws Exception
{    return target.call();}
public void shiro_f1136_0()
{    try {        threadState.bind();        doRun(this.runnable);    } finally {        threadState.restore();    }}
protected void shiro_f1137_0(Runnable runnable)
{    runnable.run();}
protected Subject shiro_f1138_0()
{    return this.subject;}
public void shiro_f1139_0()
{    SecurityManager securityManager = this.securityManager;    if (securityManager == null) {                securityManager = ThreadContext.getSecurityManager();    }    this.originalResources = ThreadContext.getResources();    ThreadContext.remove();    ThreadContext.bind(this.subject);    if (securityManager != null) {        ThreadContext.bind(securityManager);    }}
public void shiro_f1140_0()
{    ThreadContext.remove();    if (!CollectionUtils.isEmpty(this.originalResources)) {        ThreadContext.setResources(this.originalResources);    }}
public void shiro_f1141_0()
{    ThreadContext.remove();}
public boolean shiro_f1142_0()
{    return singleton;}
public void shiro_f1143_0(boolean singleton)
{    this.singleton = singleton;}
public T shiro_f1144_0()
{    T instance;    if (isSingleton()) {        if (this.singletonInstance == null) {            this.singletonInstance = createInstance();        }        instance = this.singletonInstance;    } else {        instance = createInstance();    }    if (instance == null) {        String msg = "Factory 'createInstance' implementation returned a null object.";        throw new IllegalStateException(msg);    }    return instance;}
public void shiro_f1145_0(String pathSeparator)
{    this.pathSeparator = (pathSeparator != null ? pathSeparator : DEFAULT_PATH_SEPARATOR);}
public boolean shiro_f1146_0(String path)
{    return (path.indexOf('*') != -1 || path.indexOf('?') != -1);}
public boolean shiro_f1147_0(String pattern, String source)
{    return match(pattern, source);}
public boolean shiro_f1148_0(String pattern, String path)
{    return doMatch(pattern, path, true);}
public boolean shiro_f1149_0(String pattern, String path)
{    return doMatch(pattern, path, false);}
protected boolean shiro_f1150_0(String pattern, String path, boolean fullMatch)
{    if (path.startsWith(this.pathSeparator) != pattern.startsWith(this.pathSeparator)) {        return false;    }    String[] pattDirs = StringUtils.tokenizeToStringArray(pattern, this.pathSeparator);    String[] pathDirs = StringUtils.tokenizeToStringArray(path, this.pathSeparator);    int pattIdxStart = 0;    int pattIdxEnd = pattDirs.length - 1;    int pathIdxStart = 0;    int pathIdxEnd = pathDirs.length - 1;        while (pattIdxStart <= pattIdxEnd && pathIdxStart <= pathIdxEnd) {        String patDir = pattDirs[pattIdxStart];        if ("**".equals(patDir)) {            break;        }        if (!matchStrings(patDir, pathDirs[pathIdxStart])) {            return false;        }        pattIdxStart++;        pathIdxStart++;    }    if (pathIdxStart > pathIdxEnd) {                if (pattIdxStart > pattIdxEnd) {            return (pattern.endsWith(this.pathSeparator) ? path.endsWith(this.pathSeparator) : !path.endsWith(this.pathSeparator));        }        if (!fullMatch) {            return true;        }        if (pattIdxStart == pattIdxEnd && pattDirs[pattIdxStart].equals("*") && path.endsWith(this.pathSeparator)) {            return true;        }        for (int i = pattIdxStart; i <= pattIdxEnd; i++) {            if (!pattDirs[i].equals("**")) {                return false;            }        }        return true;    } else if (pattIdxStart > pattIdxEnd) {                return false;    } else if (!fullMatch && "**".equals(pattDirs[pattIdxStart])) {                return true;    }        while (pattIdxStart <= pattIdxEnd && pathIdxStart <= pathIdxEnd) {        String patDir = pattDirs[pattIdxEnd];        if (patDir.equals("**")) {            break;        }        if (!matchStrings(patDir, pathDirs[pathIdxEnd])) {            return false;        }        pattIdxEnd--;        pathIdxEnd--;    }    if (pathIdxStart > pathIdxEnd) {                for (int i = pattIdxStart; i <= pattIdxEnd; i++) {            if (!pattDirs[i].equals("**")) {                return false;            }        }        return true;    }    while (pattIdxStart != pattIdxEnd && pathIdxStart <= pathIdxEnd) {        int patIdxTmp = -1;        for (int i = pattIdxStart + 1; i <= pattIdxEnd; i++) {            if (pattDirs[i].equals("**")) {                patIdxTmp = i;                break;            }        }        if (patIdxTmp == pattIdxStart + 1) {                        pattIdxStart++;            continue;        }                        int patLength = (patIdxTmp - pattIdxStart - 1);        int strLength = (pathIdxEnd - pathIdxStart + 1);        int foundIdx = -1;        strLoop: for (int i = 0; i <= strLength - patLength; i++) {            for (int j = 0; j < patLength; j++) {                String subPat = (String) pattDirs[pattIdxStart + j + 1];                String subStr = (String) pathDirs[pathIdxStart + i + j];                if (!matchStrings(subPat, subStr)) {                    continue strLoop;                }            }            foundIdx = pathIdxStart + i;            break;        }        if (foundIdx == -1) {            return false;        }        pattIdxStart = patIdxTmp;        pathIdxStart = foundIdx + patLength;    }    for (int i = pattIdxStart; i <= pattIdxEnd; i++) {        if (!pattDirs[i].equals("**")) {            return false;        }    }    return true;}
private boolean shiro_f1151_0(String pattern, String str)
{    char[] patArr = pattern.toCharArray();    char[] strArr = str.toCharArray();    int patIdxStart = 0;    int patIdxEnd = patArr.length - 1;    int strIdxStart = 0;    int strIdxEnd = strArr.length - 1;    char ch;    boolean containsStar = false;    for (char aPatArr : patArr) {        if (aPatArr == '*') {            containsStar = true;            break;        }    }    if (!containsStar) {                if (patIdxEnd != strIdxEnd) {                        return false;        }        for (int i = 0; i <= patIdxEnd; i++) {            ch = patArr[i];            if (ch != '?') {                if (ch != strArr[i]) {                                        return false;                }            }        }                return true;    }    if (patIdxEnd == 0) {                return true;    }        while ((ch = patArr[patIdxStart]) != '*' && strIdxStart <= strIdxEnd) {        if (ch != '?') {            if (ch != strArr[strIdxStart]) {                                return false;            }        }        patIdxStart++;        strIdxStart++;    }    if (strIdxStart > strIdxEnd) {                for (int i = patIdxStart; i <= patIdxEnd; i++) {            if (patArr[i] != '*') {                return false;            }        }        return true;    }        while ((ch = patArr[patIdxEnd]) != '*' && strIdxStart <= strIdxEnd) {        if (ch != '?') {            if (ch != strArr[strIdxEnd]) {                                return false;            }        }        patIdxEnd--;        strIdxEnd--;    }    if (strIdxStart > strIdxEnd) {                for (int i = patIdxStart; i <= patIdxEnd; i++) {            if (patArr[i] != '*') {                return false;            }        }        return true;    }        while (patIdxStart != patIdxEnd && strIdxStart <= strIdxEnd) {        int patIdxTmp = -1;        for (int i = patIdxStart + 1; i <= patIdxEnd; i++) {            if (patArr[i] == '*') {                patIdxTmp = i;                break;            }        }        if (patIdxTmp == patIdxStart + 1) {                        patIdxStart++;            continue;        }                        int patLength = (patIdxTmp - patIdxStart - 1);        int strLength = (strIdxEnd - strIdxStart + 1);        int foundIdx = -1;        strLoop: for (int i = 0; i <= strLength - patLength; i++) {            for (int j = 0; j < patLength; j++) {                ch = patArr[patIdxStart + j + 1];                if (ch != '?') {                    if (ch != strArr[strIdxStart + i + j]) {                        continue strLoop;                    }                }            }            foundIdx = strIdxStart + i;            break;        }        if (foundIdx == -1) {            return false;        }        patIdxStart = patIdxTmp;        strIdxStart = foundIdx + patLength;    }        for (int i = patIdxStart; i <= patIdxEnd; i++) {        if (patArr[i] != '*') {            return false;        }    }    return true;}
public String shiro_f1152_0(String pattern, String path)
{    String[] patternParts = StringUtils.tokenizeToStringArray(pattern, this.pathSeparator);    String[] pathParts = StringUtils.tokenizeToStringArray(path, this.pathSeparator);    StringBuilder buffer = new StringBuilder();        int puts = 0;    for (int i = 0; i < patternParts.length; i++) {        String patternPart = patternParts[i];        if ((patternPart.indexOf('*') > -1 || patternPart.indexOf('?') > -1) && pathParts.length >= i + 1) {            if (puts > 0 || (i == 0 && !pattern.startsWith(this.pathSeparator))) {                buffer.append(this.pathSeparator);            }            buffer.append(pathParts[i]);            puts++;        }    }        for (int i = patternParts.length; i < pathParts.length; i++) {        if (puts > 0 || i > 0) {            buffer.append(this.pathSeparator);        }        buffer.append(pathParts[i]);    }    return buffer.toString();}
public static Set<E> shiro_f1153_0(E... elements)
{    if (elements == null || elements.length == 0) {        return Collections.emptySet();    }    if (elements.length == 1) {        return Collections.singleton(elements[0]);    }    LinkedHashSet<E> set = new LinkedHashSet<E>(elements.length * 4 / 3 + 1);    Collections.addAll(set, elements);    return set;}
public static boolean shiro_f1154_0(Collection c)
{    return c == null || c.isEmpty();}
public static boolean shiro_f1155_0(Map m)
{    return m == null || m.isEmpty();}
public static int shiro_f1156_0(Collection c)
{    return c != null ? c.size() : 0;}
public static int shiro_f1157_0(Map m)
{    return m != null ? m.size() : 0;}
public static boolean shiro_f1158_0(PrincipalCollection principals)
{    return principals == null || principals.isEmpty();}
public static List<E> shiro_f1159_0(E... elements)
{    if (elements == null || elements.length == 0) {        return Collections.emptyList();    }        return Arrays.asList(elements);}
 static int shiro_f1160_0(int arraySize)
{    return (int) Math.min(5L + arraySize + (arraySize / 10), Integer.MAX_VALUE);}
public static String shiro_f1161_0()
{    return version;}
public static int shiro_f1162_0()
{    return majorVersion;}
public static boolean shiro_f1163_0()
{    return getMajorVersion() >= JAVA_14;}
public static boolean shiro_f1164_0()
{    return getMajorVersion() >= JAVA_15;}
public static boolean shiro_f1165_0()
{    return getMajorVersion() >= JAVA_16;}
public static void shiro_f1166_1(Connection connection)
{    if (connection != null) {        try {            connection.close();        } catch (SQLException ex) {            if (log.isDebugEnabled()) {                            }        } catch (Throwable ex) {            if (log.isDebugEnabled()) {                            }        }    }}
public static void shiro_f1167_1(Statement statement)
{    if (statement != null) {        try {            statement.close();        } catch (SQLException ex) {            if (log.isDebugEnabled()) {                            }        } catch (Throwable ex) {            if (log.isDebugEnabled()) {                            }        }    }}
public static void shiro_f1168_1(ResultSet rs)
{    if (rs != null) {        try {            rs.close();        } catch (SQLException ex) {            if (log.isDebugEnabled()) {                            }        } catch (Throwable ex) {            if (log.isDebugEnabled()) {                            }        }    }}
protected E shiro_f1169_0(String key, Class<E> type)
{    E found = null;    Object o = backingMap.get(key);    if (o != null) {        if (!type.isAssignableFrom(o.getClass())) {            String msg = "Invalid object found in SubjectContext Map under key [" + key + "].  Expected type " + "was [" + type.getName() + "], but the object under that key is of type " + "[" + o.getClass().getName() + "].";            throw new IllegalArgumentException(msg);        }        found = (E) o;    }    return found;}
protected void shiro_f1170_0(String key, Object value)
{    if (value != null) {        put(key, value);    }}
public int shiro_f1171_0()
{    return backingMap.size();}
public boolean shiro_f1172_0()
{    return backingMap.isEmpty();}
public boolean shiro_f1173_0(Object o)
{    return backingMap.containsKey(o);}
public boolean shiro_f1174_0(Object o)
{    return backingMap.containsValue(o);}
public Object shiro_f1175_0(Object o)
{    return backingMap.get(o);}
public Object shiro_f1176_0(String s, Object o)
{    return backingMap.put(s, o);}
public Object shiro_f1177_0(Object o)
{    return backingMap.remove(o);}
public void shiro_f1178_0(Map<? extends String, ?> map)
{    backingMap.putAll(map);}
public void shiro_f1179_0()
{    backingMap.clear();}
public Set<String> shiro_f1180_0()
{    return Collections.unmodifiableSet(backingMap.keySet());}
public Collection<Object> shiro_f1181_0()
{    return Collections.unmodifiableCollection(backingMap.values());}
public Set<Entry<String, Object>> shiro_f1182_0()
{    return Collections.unmodifiableSet(backingMap.entrySet());}
public static Set<Permission> shiro_f1183_0(String s, PermissionResolver permissionResolver)
{    Set<String> permStrings = toPermissionStrings(s);    return resolvePermissions(permStrings, permissionResolver);}
public static Set<String> shiro_f1184_0(String permissionsString)
{    String[] tokens = StringUtils.split(permissionsString);    if (tokens != null && tokens.length > 0) {        return new LinkedHashSet<String>(Arrays.asList(tokens));    }    return null;}
public static Set<Permission> shiro_f1185_0(Collection<String> permissionStrings, PermissionResolver permissionResolver)
{    Set<Permission> permissions = new LinkedHashSet<Permission>(permissionStrings.size());    for (String permissionString : permissionStrings) {        permissions.add(permissionResolver.resolvePermission(permissionString));    }    return permissions;}
public boolean shiro_f1186_0(String pattern, String source)
{    if (pattern == null) {        throw new IllegalArgumentException("pattern argument cannot be null.");    }    Pattern p = Pattern.compile(pattern);    Matcher m = p.matcher(source);    return m.matches();}
public static Map<Object, Object> shiro_f1187_0()
{    if (resources.get() == null) {        return Collections.emptyMap();    } else {        return new HashMap<Object, Object>(resources.get());    }}
public static void shiro_f1188_0(Map<Object, Object> newResources)
{    if (CollectionUtils.isEmpty(newResources)) {        return;    }    ensureResourcesInitialized();    resources.get().clear();    resources.get().putAll(newResources);}
private static Object shiro_f1189_0(Object key)
{    Map<Object, Object> perThreadResources = resources.get();    return perThreadResources != null ? perThreadResources.get(key) : null;}
private static void shiro_f1190_0()
{    if (resources.get() == null) {        resources.set(new HashMap<Object, Object>());    }}
public static Object shiro_f1191_0(Object key)
{    if (log.isTraceEnabled()) {        String msg = "get() - in thread [" + Thread.currentThread().getName() + "]";        log.trace(msg);    }    Object value = getValue(key);    if ((value != null) && log.isTraceEnabled()) {        String msg = "Retrieved value of type [" + value.getClass().getName() + "] for key [" + key + "] " + "bound to thread [" + Thread.currentThread().getName() + "]";        log.trace(msg);    }    return value;}
public static void shiro_f1192_0(Object key, Object value)
{    if (key == null) {        throw new IllegalArgumentException("key cannot be null");    }    if (value == null) {        remove(key);        return;    }    ensureResourcesInitialized();    resources.get().put(key, value);    if (log.isTraceEnabled()) {        String msg = "Bound value of type [" + value.getClass().getName() + "] for key [" + key + "] to thread " + "[" + Thread.currentThread().getName() + "]";        log.trace(msg);    }}
public static Object shiro_f1193_0(Object key)
{    Map<Object, Object> perThreadResources = resources.get();    Object value = perThreadResources != null ? perThreadResources.remove(key) : null;    if ((value != null) && log.isTraceEnabled()) {        String msg = "Removed value of type [" + value.getClass().getName() + "] for key [" + key + "]" + "from thread [" + Thread.currentThread().getName() + "]";        log.trace(msg);    }    return value;}
public static void shiro_f1194_0()
{    resources.remove();}
public static SecurityManager shiro_f1195_0()
{    return (SecurityManager) get(SECURITY_MANAGER_KEY);}
public static void shiro_f1196_0(SecurityManager securityManager)
{    if (securityManager != null) {        put(SECURITY_MANAGER_KEY, securityManager);    }}
public static SecurityManager shiro_f1197_0()
{    return (SecurityManager) remove(SECURITY_MANAGER_KEY);}
public static Subject shiro_f1198_0()
{    return (Subject) get(SUBJECT_KEY);}
public static void shiro_f1199_0(Subject subject)
{    if (subject != null) {        put(SUBJECT_KEY, subject);    }}
public static Subject shiro_f1200_0()
{    return (Subject) remove(SUBJECT_KEY);}
protected Map<Object, Object> shiro_f1201_0(Map<Object, Object> parentValue)
{    if (parentValue != null) {        return (Map<Object, Object>) ((HashMap<Object, Object>) parentValue).clone();    } else {        return null;    }}
public void shiro_f1202_0()
{}
public void shiro_f1203_0()
{}
public void shiro_f1204_0() throws SecurityException, NoSuchMethodException
{    MyFixture myFixture = new MyFixture();    MethodInvocation methodInvocation = createMock(MethodInvocation.class);    Method method = MyFixture.class.getDeclaredMethod("operateThis");    expect(methodInvocation.getMethod()).andReturn(method);    expect(methodInvocation.getThis()).andReturn(myFixture);    replay(methodInvocation);    assertNotNull(annotationResolver.getAnnotation(methodInvocation, RequiresRoles.class));}
public void shiro_f1205_0() throws SecurityException, NoSuchMethodException
{    MethodInvocation methodInvocation = createMock(MethodInvocation.class);    Method method = MyFixture.class.getDeclaredMethod("operateThat");    expect(methodInvocation.getMethod()).andReturn(method);    replay(methodInvocation);    assertNotNull(annotationResolver.getAnnotation(methodInvocation, RequiresUser.class));}
public void shiro_f1206_0() throws SecurityException, NoSuchMethodException
{    MethodInvocation methodInvocation = createMock(MethodInvocation.class);    Method method = MyFixture.class.getDeclaredMethod("operateThis");    expect(methodInvocation.getMethod()).andReturn(method);    expect(methodInvocation.getThis()).andReturn(null);    replay(methodInvocation);    assertNull(annotationResolver.getAnnotation(methodInvocation, RequiresUser.class));}
private AbstractAuthenticator shiro_f1207_0()
{    return new AbstractAuthenticator() {        protected AuthenticationInfo doAuthenticate(AuthenticationToken token) throws AuthenticationException {            return null;        }    };}
protected AuthenticationInfo shiro_f1208_0(AuthenticationToken token) throws AuthenticationException
{    return null;}
private AbstractAuthenticator shiro_f1209_0()
{    return new AbstractAuthenticator() {        protected AuthenticationInfo doAuthenticate(AuthenticationToken token) throws AuthenticationException {            return info;        }    };}
protected AuthenticationInfo shiro_f1210_0(AuthenticationToken token) throws AuthenticationException
{    return info;}
private AuthenticationToken shiro_f1211_0()
{    return new UsernamePasswordToken("user1", "secret");}
public void shiro_f1212_0()
{    abstractAuthenticator = createAuthcReturnValidAuthcInfo();}
public void shiro_f1213_0()
{    abstractAuthenticator = new AbstractAuthenticator() {        protected AuthenticationInfo doAuthenticate(AuthenticationToken token) throws AuthenticationException {            return info;        }    };}
protected AuthenticationInfo shiro_f1214_0(AuthenticationToken token) throws AuthenticationException
{    return info;}
public void shiro_f1215_0()
{    abstractAuthenticator.authenticate(null);}
public void shiro_f1216_0()
{    abstractAuthenticator = createAuthcReturnNull();    abstractAuthenticator.authenticate(newToken());}
public void shiro_f1217_0()
{    AuthenticationInfo authcInfo = abstractAuthenticator.authenticate(newToken());    assertNotNull(authcInfo);}
public void shiro_f1218_0()
{    AuthenticationListener mockListener = createMock(AuthenticationListener.class);    abstractAuthenticator.getAuthenticationListeners().add(mockListener);    AuthenticationToken token = newToken();    mockListener.onSuccess(token, info);    replay(mockListener);    abstractAuthenticator.authenticate(token);    verify(mockListener);}
public void shiro_f1219_0()
{    AuthenticationListener mockListener = createMock(AuthenticationListener.class);    AuthenticationToken token = newToken();    final AuthenticationException ae = new AuthenticationException("dummy exception to test notification");    abstractAuthenticator = new AbstractAuthenticator() {        protected AuthenticationInfo doAuthenticate(AuthenticationToken token) throws AuthenticationException {            throw ae;        }    };    abstractAuthenticator.getAuthenticationListeners().add(mockListener);    mockListener.onFailure(token, ae);    replay(mockListener);    boolean exceptionThrown = false;    try {        abstractAuthenticator.authenticate(token);    } catch (AuthenticationException e) {        exceptionThrown = true;        assertEquals(e, ae);    }    verify(mockListener);    if (!exceptionThrown) {        fail("An AuthenticationException should have been thrown during the notifyFailure test case.");    }}
protected AuthenticationInfo shiro_f1220_0(AuthenticationToken token) throws AuthenticationException
{    throw ae;}
public void shiro_f1221_0()
{    abstractAuthenticator = new AbstractAuthenticator() {        protected AuthenticationInfo doAuthenticate(AuthenticationToken token) throws AuthenticationException {            throw new IllegalArgumentException("not an AuthenticationException subclass");        }    };    AuthenticationToken token = newToken();    abstractAuthenticator.authenticate(token);}
protected AuthenticationInfo shiro_f1222_0(AuthenticationToken token) throws AuthenticationException
{    throw new IllegalArgumentException("not an AuthenticationException subclass");}
public void shiro_f1223_0()
{    Logger logger = Logger.getLogger(AbstractAuthenticator.class);        ByteArrayOutputStream out = new ByteArrayOutputStream();    Layout layout = new SimpleLayout();    Appender appender = new WriterAppender(layout, out);    logger.addAppender(appender);    final String expectedExceptionMessage = "exception thrown for test logExceptionAfterDoAuthenticateThrowsNonAuthenticationException";    abstractAuthenticator = new AbstractAuthenticator() {        protected AuthenticationInfo doAuthenticate(AuthenticationToken token) throws AuthenticationException {            throw new IllegalArgumentException(expectedExceptionMessage);        }    };    AuthenticationToken token = newToken();    try {        abstractAuthenticator.authenticate(token);        fail("the expected AuthenticationException was not thrown");    } catch (AuthenticationException expectedException) {    }    String logMsg = out.toString();    assertTrue(logMsg.contains("WARN"));    assertTrue(logMsg.contains("java.lang.IllegalArgumentException: " + expectedExceptionMessage));    logger.removeAppender(appender);}
protected AuthenticationInfo shiro_f1224_0(AuthenticationToken token) throws AuthenticationException
{    throw new IllegalArgumentException(expectedExceptionMessage);}
protected Class shiro_f1225_0()
{    return ConcurrentAccessException.class;}
public void shiro_f1226_0()
{    CredentialsMatcher matcher = (CredentialsMatcher) ClassUtils.newInstance(getMatcherClass());    byte[] hashed = hash("password").getBytes();    AuthenticationInfo account = new SimpleAuthenticationInfo("username", hashed, "realmName");    AuthenticationToken token = new UsernamePasswordToken("username", "password");    assertTrue(matcher.doCredentialsMatch(token, account));}
public void shiro_f1227_0()
{    assertTrue(new AllowAllCredentialsMatcher().doCredentialsMatch(null, null));}
public void shiro_f1228_0()
{        HashedCredentialsMatcher matcher = new HashedCredentialsMatcher(Sha1Hash.ALGORITHM_NAME);        ByteSource salt = new SecureRandomNumberGenerator().nextBytes();    Object hashedPassword = new Sha1Hash("password", salt);    SimpleAuthenticationInfo account = new SimpleAuthenticationInfo("username", hashedPassword, salt, "realmName");        AuthenticationToken token = new UsernamePasswordToken("username", "password");        assertTrue(matcher.doCredentialsMatch(token, account));}
public void shiro_f1229_0()
{    HashedCredentialsMatcher matcher = new HashedCredentialsMatcher(Sha1Hash.ALGORITHM_NAME);        final String username = "username";    final String password = "password";    final Object hashedPassword = new Sha1Hash(password).getBytes();    AuthenticationInfo account = new AuthenticationInfo() {        public PrincipalCollection getPrincipals() {            return new SimplePrincipalCollection(username, "realmName");        }        public Object getCredentials() {            return hashedPassword;        }    };        AuthenticationToken token = new UsernamePasswordToken("username", "password");        assertTrue(matcher.doCredentialsMatch(token, account));}
public PrincipalCollection shiro_f1230_0()
{    return new SimplePrincipalCollection(username, "realmName");}
public Object shiro_f1231_0()
{    return hashedPassword;}
public void shiro_f1232_0()
{    HashedCredentialsMatcher matcher = new HashedCredentialsMatcher(Sha1Hash.ALGORITHM_NAME);        matcher.setHashSalted(true);            final String username = "username";    final String password = "password";    final Object hashedPassword = new Sha1Hash(password, username).getBytes();    AuthenticationInfo account = new AuthenticationInfo() {        public PrincipalCollection getPrincipals() {            return new SimplePrincipalCollection(username, "realmName");        }        public Object getCredentials() {            return hashedPassword;        }    };        AuthenticationToken token = new UsernamePasswordToken("username", "password");        assertTrue(matcher.doCredentialsMatch(token, account));}
public PrincipalCollection shiro_f1233_0()
{    return new SimplePrincipalCollection(username, "realmName");}
public Object shiro_f1234_0()
{    return hashedPassword;}
public Class<? extends HashedCredentialsMatcher> shiro_f1235_0()
{    return Md2CredentialsMatcher.class;}
public AbstractHash shiro_f1236_0(Object credentials)
{    return new Md2Hash(credentials);}
public Class<? extends HashedCredentialsMatcher> shiro_f1237_0()
{    return Md5CredentialsMatcher.class;}
public AbstractHash shiro_f1238_0(Object credentials)
{    return new Md5Hash(credentials);}
public Class<? extends HashedCredentialsMatcher> shiro_f1239_0()
{    return Sha1CredentialsMatcher.class;}
public AbstractHash shiro_f1240_0(Object credentials)
{    return new Sha1Hash(credentials);}
public Class<? extends HashedCredentialsMatcher> shiro_f1241_0()
{    return Sha256CredentialsMatcher.class;}
public AbstractHash shiro_f1242_0(Object credentials)
{    return new Sha256Hash(credentials);}
public Class<? extends HashedCredentialsMatcher> shiro_f1243_0()
{    return Sha384CredentialsMatcher.class;}
public AbstractHash shiro_f1244_0(Object credentials)
{    return new Sha384Hash(credentials);}
public Class<? extends HashedCredentialsMatcher> shiro_f1245_0()
{    return Sha512CredentialsMatcher.class;}
public AbstractHash shiro_f1246_0(Object credentials)
{    return new Sha512Hash(credentials);}
protected Class shiro_f1247_0()
{    return ExcessiveAttemptsException.class;}
protected Class shiro_f1248_0()
{    return ExpiredCredentialsException.class;}
protected Class shiro_f1249_0()
{    return IncorrectCredentialsException.class;}
protected Class shiro_f1250_0()
{    return LockedAccountException.class;}
public void shiro_f1251_0()
{    strategy = new AllSuccessfulStrategy();}
public void shiro_f1252_0()
{    AuthenticationInfo info = strategy.beforeAllAttempts(null, null);    assertNotNull(info);}
public void shiro_f1253_0()
{    new SimpleAccountRealm();}
public void shiro_f1254_0()
{    Realm notSupportingRealm = new AuthorizingRealm() {        public boolean supports(AuthenticationToken token) {            return false;        }        protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException {            return null;        }        protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principal) {            return null;        }    };    strategy.beforeAttempt(notSupportingRealm, null, null);}
public boolean shiro_f1255_0(AuthenticationToken token)
{    return false;}
protected AuthenticationInfo shiro_f1256_0(AuthenticationToken token) throws AuthenticationException
{    return null;}
protected AuthorizationInfo shiro_f1257_0(PrincipalCollection principal)
{    return null;}
public void shiro_f1258_0()
{    strategy = new FirstSuccessfulStrategy();}
public void shiro_f1259_0()
{    AuthenticationInfo authenticationInfo = strategy.beforeAllAttempts(null, null);    assertNull(authenticationInfo);}
public void shiro_f1260_0()
{    AuthenticationInfo aggregate = new MergableAuthenticationInfo() {        @Override        public void merge(AuthenticationInfo info) {        }        @Override        public PrincipalCollection getPrincipals() {            return new SimplePrincipalCollection("principals", "realmName");        }        @Override        public Object getCredentials() {            return null;        }    };    AuthenticationInfo mergeResult = strategy.merge(new SimpleAuthenticationInfo(), aggregate);    assertEquals(aggregate, mergeResult);}
public void shiro_f1261_0(AuthenticationInfo info)
{}
public PrincipalCollection shiro_f1262_0()
{    return new SimplePrincipalCollection("principals", "realmName");}
public Object shiro_f1263_0()
{    return null;}
public void shiro_f1264_0()
{    AuthenticationInfo aggregate = new MergableAuthenticationInfo() {        @Override        public void merge(AuthenticationInfo info) {        }        @Override        public PrincipalCollection getPrincipals() {            return new SimplePrincipalCollection();        }        @Override        public Object getCredentials() {            return null;        }    };    AuthenticationInfo authInfo = new SimpleAuthenticationInfo();    AuthenticationInfo mergeResult = strategy.merge(authInfo, aggregate);    assertEquals(authInfo, mergeResult);}
public void shiro_f1265_0(AuthenticationInfo info)
{}
public PrincipalCollection shiro_f1266_0()
{    return new SimplePrincipalCollection();}
public Object shiro_f1267_0()
{    return null;}
public void shiro_f1268_0()
{    SimpleAuthenticationInfo aggregate = new SimpleAuthenticationInfo();    SimpleAuthenticationInfo local = new SimpleAuthenticationInfo();    aggregate.merge(local);}
public void shiro_f1269_0()
{    SimpleAuthenticationInfo aggregate = new SimpleAuthenticationInfo();    SimpleAuthenticationInfo local = new SimpleAuthenticationInfo("username", "password", "testRealm");    aggregate.merge(local);}
public void shiro_f1270_0()
{    SimpleAuthenticationInfo aggregate = new SimpleAuthenticationInfo();        PrincipalCollection principalCollection = new PrincipalCollection() {        @SuppressWarnings("unchecked")        public List asList() {            return null;        }        @SuppressWarnings("unchecked")        public Set asSet() {            return null;        }        public <T> Collection<T> byType(Class<T> type) {            return null;        }        @SuppressWarnings("unchecked")        public Collection fromRealm(String realmName) {            Collection<Object> principals = new HashSet<Object>();            principals.add("testprincipal");            return principals;        }        public Object getPrimaryPrincipal() {            return null;        }        public Set<String> getRealmNames() {            Set<String> realms = new HashSet<String>();            realms.add("testrealm");            return realms;        }        public boolean isEmpty() {            return false;        }        public <T> T oneByType(Class<T> type) {            return null;        }        @SuppressWarnings("unchecked")        public Iterator iterator() {            return null;        }    };    aggregate.setPrincipals(principalCollection);    SimpleAuthenticationInfo local = new SimpleAuthenticationInfo("username", "password", "testRealm");    aggregate.merge(local);    assertEquals(2, aggregate.getPrincipals().asList().size());}
public List shiro_f1271_0()
{    return null;}
public Set shiro_f1272_0()
{    return null;}
public Collection<T> shiro_f1273_0(Class<T> type)
{    return null;}
public Collection shiro_f1274_0(String realmName)
{    Collection<Object> principals = new HashSet<Object>();    principals.add("testprincipal");    return principals;}
public Object shiro_f1275_0()
{    return null;}
public Set<String> shiro_f1276_0()
{    Set<String> realms = new HashSet<String>();    realms.add("testrealm");    return realms;}
public boolean shiro_f1277_0()
{    return false;}
public T shiro_f1278_0(Class<T> type)
{    return null;}
public Iterator shiro_f1279_0()
{    return null;}
protected Class shiro_f1280_0()
{    return UnknownAccountException.class;}
public void shiro_f1281_0() throws Throwable
{    PermissionAnnotationHandler handler = new PermissionAnnotationHandler();    Annotation requiresPermissionAnnotation = new RequiresPermissions() {        public String[] value() {            return new String[] { "test:test" };        }        public Class<? extends Annotation> annotationType() {            return RequiresPermissions.class;        }        public Logical logical() {            return Logical.AND;        }    };    handler.assertAuthorized(requiresPermissionAnnotation);}
public String[] shiro_f1282_0()
{    return new String[] { "test:test" };}
public Class<? extends Annotation> shiro_f1283_0()
{    return RequiresPermissions.class;}
public Logical shiro_f1284_0()
{    return Logical.AND;}
public void shiro_f1285_0() throws Throwable
{    PermissionAnnotationHandler handler = new PermissionAnnotationHandler();    Annotation requiresPermissionAnnotation = new RequiresPermissions() {        public String[] value() {            return new String[] { "test:test", "test2:test2" };        }        public Class<? extends Annotation> annotationType() {            return RequiresPermissions.class;        }        public Logical logical() {            return Logical.AND;        }    };    handler.assertAuthorized(requiresPermissionAnnotation);}
public String[] shiro_f1286_0()
{    return new String[] { "test:test", "test2:test2" };}
public Class<? extends Annotation> shiro_f1287_0()
{    return RequiresPermissions.class;}
public Logical shiro_f1288_0()
{    return Logical.AND;}
public void shiro_f1289_0() throws Throwable
{    RoleAnnotationHandler handler = new RoleAnnotationHandler();    Annotation requiresRolesAnnotation = new RequiresRoles() {        public String[] value() {            return new String[] { "blah" };        }        public Class<? extends Annotation> annotationType() {            return RequiresRoles.class;        }        public Logical logical() {            return Logical.AND;        }    };    handler.assertAuthorized(requiresRolesAnnotation);}
public String[] shiro_f1290_0()
{    return new String[] { "blah" };}
public Class<? extends Annotation> shiro_f1291_0()
{    return RequiresRoles.class;}
public Logical shiro_f1292_0()
{    return Logical.AND;}
public void shiro_f1293_0() throws Throwable
{    RoleAnnotationHandler handler = new RoleAnnotationHandler();    Annotation requiresRolesAnnotation = new RequiresRoles() {        public String[] value() {            return new String[] { "blah", "blah2" };        }        public Class<? extends Annotation> annotationType() {            return RequiresRoles.class;        }        public Logical logical() {            return Logical.AND;        }    };    handler.assertAuthorized(requiresRolesAnnotation);}
public String[] shiro_f1294_0()
{    return new String[] { "blah", "blah2" };}
public Class<? extends Annotation> shiro_f1295_0()
{    return RequiresRoles.class;}
public Logical shiro_f1296_0()
{    return Logical.AND;}
public void shiro_f1297_0() throws Throwable
{    subject = createMock(Subject.class);    expect(subject.hasRole("blah")).andReturn(true);    expect(subject.hasRole("blah2")).andReturn(false);    replay(subject);    RoleAnnotationHandler handler = new RoleAnnotationHandler() {        @Override        protected Subject getSubject() {            return subject;        }    };    Annotation requiresRolesAnnotation = new RequiresRoles() {        public String[] value() {            return new String[] { "blah", "blah2" };        }        public Class<? extends Annotation> annotationType() {            return RequiresRoles.class;        }        public Logical logical() {            return Logical.OR;        }    };    handler.assertAuthorized(requiresRolesAnnotation);}
protected Subject shiro_f1298_0()
{    return subject;}
public String[] shiro_f1299_0()
{    return new String[] { "blah", "blah2" };}
public Class<? extends Annotation> shiro_f1300_0()
{    return RequiresRoles.class;}
public Logical shiro_f1301_0()
{    return Logical.OR;}
protected Class shiro_f1302_0()
{    return AuthorizationException.class;}
protected Class shiro_f1303_0()
{    return HostUnauthorizedException.class;}
public void shiro_f1304_0()
{    Collection<Realm> realms = new ArrayList<Realm>();    realms.add(new MockAuthorizingRealm());    realms.add(new MockAuthorizingRealm());        for (Realm realm : realms) {        assertNull(((AuthorizingRealm) realm).getRolePermissionResolver());    }    ModularRealmAuthorizer modRealmAuthz = new ModularRealmAuthorizer();    modRealmAuthz.setRealms(realms);        for (Realm realm : realms) {        assertNull(((AuthorizingRealm) realm).getRolePermissionResolver());    }        RolePermissionResolver rolePermissionResolver = new RolePermissionResolver() {        public Collection<Permission> resolvePermissionsInRole(String roleString) {            return null;        }    };    modRealmAuthz.setRolePermissionResolver(rolePermissionResolver);        for (Realm realm : realms) {                assertTrue(((AuthorizingRealm) realm).getRolePermissionResolver() == rolePermissionResolver);    }        MockAuthorizingRealm mockRealm = new MockAuthorizingRealm();    realms.add(mockRealm);    modRealmAuthz.setRealms(realms);    assertTrue(((AuthorizingRealm) mockRealm).getRolePermissionResolver() == rolePermissionResolver);}
public Collection<Permission> shiro_f1305_0(String roleString)
{    return null;}
protected AuthorizationInfo shiro_f1306_0(PrincipalCollection principals)
{    return null;}
protected AuthenticationInfo shiro_f1307_0(AuthenticationToken token) throws AuthenticationException
{    return null;}
public void shiro_f1308_0()
{    assertTrue(new AllPermission().implies(null));}
public void shiro_f1309_0()
{    assertTrue(new AllPermission().implies(new AllPermission()));}
public void shiro_f1310_0()
{    DomainPermission p;    List<Set<String>> parts;    Set<String> set;    String entry;        p = new DomainPermission();        assertTrue("domain".equals(p.getDomain()));        set = p.getActions();    assertNull(set);        set = p.getTargets();    assertNull(set);        parts = p.getParts();    assertEquals("Number of parts", 1, parts.size());    set = parts.get(0);    assertEquals(1, set.size());    entry = set.iterator().next();    assertEquals("domain", entry);}
public void shiro_f1311_0()
{    DomainPermission p;    List<Set<String>> parts;    Set<String> set;    Iterator<String> iterator;    String entry;        p = new DomainPermission("action1");        assertEquals("domain", p.getDomain());        set = p.getActions();    assertNotNull(set);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("action1", entry);        set = p.getTargets();    assertNull(set);        parts = p.getParts();    assertEquals(2, parts.size());    set = parts.get(0);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("domain", entry);    set = parts.get(1);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("action1", entry);}
public void shiro_f1312_0()
{    DomainPermission p;    List<Set<String>> parts;    Set<String> set;    Iterator<String> iterator;    String entry;        p = new DomainPermission("action1,action2,action3");        assertEquals("domain", p.getDomain());        set = p.getActions();    assertNotNull(set);    assertEquals(3, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("action1", entry);    entry = iterator.next();    assertEquals("action2", entry);    entry = iterator.next();    assertEquals("action3", entry);        set = p.getTargets();    assertNull(set);        parts = p.getParts();    assertEquals(2, parts.size());    set = parts.get(0);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("domain", entry);    set = parts.get(1);    assertEquals(3, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("action1", entry);    entry = iterator.next();    assertEquals("action2", entry);    entry = iterator.next();    assertEquals("action3", entry);}
public void shiro_f1313_0()
{    DomainPermission p;    List<Set<String>> parts;    Set<String> set;    Iterator<String> iterator;    String entry;        p = new DomainPermission("action1", "target1");        assertEquals("domain", p.getDomain());        set = p.getActions();    assertNotNull(set);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("action1", entry);        set = p.getTargets();    assertNotNull(set);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("target1", entry);        parts = p.getParts();    assertEquals(3, parts.size());    set = parts.get(0);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("domain", entry);    set = parts.get(1);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("action1", entry);    set = parts.get(2);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("target1", entry);}
public void shiro_f1314_0()
{    DomainPermission p;    List<Set<String>> parts;    Set<String> set;    Iterator<String> iterator;    String entry;        p = new DomainPermission("action1,action2,action3", "target1,target2,target3");        assertEquals("domain", p.getDomain());        set = p.getActions();    assertNotNull(set);    assertEquals(3, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("action1", entry);    entry = iterator.next();    assertEquals("action2", entry);    entry = iterator.next();    assertEquals("action3", entry);        set = p.getTargets();    assertNotNull(set);    assertEquals(3, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("target1", entry);    entry = iterator.next();    assertEquals("target2", entry);    entry = iterator.next();    assertEquals("target3", entry);        parts = p.getParts();    assertEquals(3, parts.size());    set = parts.get(0);    assertEquals(1, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("domain", entry);    set = parts.get(1);    assertEquals(3, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("action1", entry);    entry = iterator.next();    assertEquals("action2", entry);    entry = iterator.next();    assertEquals("action3", entry);    set = parts.get(2);    assertEquals(3, set.size());    iterator = set.iterator();    entry = iterator.next();    assertEquals("target1", entry);    entry = iterator.next();    assertEquals("target2", entry);    entry = iterator.next();    assertEquals("target3", entry);}
public void shiro_f1315_0()
{    WildcardPermissionResolver resolver = new WildcardPermissionResolver();    assertFalse("Default sensitivity should be false", resolver.isCaseSensitive());    /* this is a round-about test as permissions don't store case sensitivity just lower case         the string. */    WildcardPermission permission = (WildcardPermission) resolver.resolvePermission("Foo:*");    assertEquals("string should be lowercase", "foo:*", permission.toString());}
public void shiro_f1316_0()
{    WildcardPermissionResolver resolver = new WildcardPermissionResolver(true);    assertTrue("Sensitivity should be true", resolver.isCaseSensitive());    /* this is a round-about test as permissions don't store case sensitivity just lower case         the string. */    WildcardPermission permission = (WildcardPermission) resolver.resolvePermission("Foo:*");    assertEquals("string should be mixed case", "Foo:*", permission.toString());}
public void shiro_f1317_0()
{    WildcardPermissionResolver resolver = new WildcardPermissionResolver(false);    assertFalse("Sensitivity should be false", resolver.isCaseSensitive());    /* this is a round-about test as permissions don't store case sensitivity just lower case         the string. */    WildcardPermission permission = (WildcardPermission) resolver.resolvePermission("Foo:*");    assertEquals("string should be lowercase", "foo:*", permission.toString());}
public void shiro_f1318_0()
{    WildcardPermissionResolver resolver = new WildcardPermissionResolver();    assertFalse("Default sensitivity should be false", resolver.isCaseSensitive());    resolver.setCaseSensitive(true);    assertTrue("Sensitivity should be true", resolver.isCaseSensitive());    resolver.setCaseSensitive(false);    assertFalse("Sensitivity should be false", resolver.isCaseSensitive());}
public void shiro_f1319_0()
{    new WildcardPermission(null);}
public void shiro_f1320_0()
{    new WildcardPermission("");}
public void shiro_f1321_0()
{    new WildcardPermission("   ");}
public void shiro_f1322_0()
{    new WildcardPermission("::,,::,:");}
public void shiro_f1323_0()
{    WildcardPermission p1, p2;        p1 = new WildcardPermission("something");    p2 = new WildcardPermission("something");    assertTrue(p1.implies(p2));    assertTrue(p2.implies(p1));        p1 = new WildcardPermission("something");    p2 = new WildcardPermission("SOMETHING");    assertTrue(p1.implies(p2));    assertTrue(p2.implies(p1));        p1 = new WildcardPermission("something");    p2 = new WildcardPermission("else");    assertFalse(p1.implies(p2));    assertFalse(p2.implies(p1));        p1 = new WildcardPermission("BLAHBLAH", false);    p2 = new WildcardPermission("BLAHBLAH", false);    assertTrue(p1.implies(p2));    assertTrue(p2.implies(p1));        p1 = new WildcardPermission("BLAHBLAH", false);    p2 = new WildcardPermission("bLAHBLAH", false);    assertTrue(p1.implies(p2));    assertTrue(p2.implies(p1));        p1 = new WildcardPermission("BLAHBLAH", false);    p2 = new WildcardPermission("whatwhat", false);    assertFalse(p1.implies(p2));    assertFalse(p2.implies(p1));}
public void shiro_f1324_0()
{    WildcardPermission p1, p2, p3;    p1 = new WildcardPermission("one,two");    p2 = new WildcardPermission("one");    assertTrue(p1.implies(p2));    assertFalse(p2.implies(p1));    p1 = new WildcardPermission("one,two,three");    p2 = new WildcardPermission("one,three");    assertTrue(p1.implies(p2));    assertFalse(p2.implies(p1));    p1 = new WildcardPermission("one,two:one,two,three");    p2 = new WildcardPermission("one:three");    p3 = new WildcardPermission("one:two,three");    assertTrue(p1.implies(p2));    assertFalse(p2.implies(p1));    assertTrue(p1.implies(p3));    assertFalse(p2.implies(p3));    assertTrue(p3.implies(p2));    p1 = new WildcardPermission("one,two,three:one,two,three:one,two");    p2 = new WildcardPermission("one:three:two");    assertTrue(p1.implies(p2));    assertFalse(p2.implies(p1));    p1 = new WildcardPermission("one");    p2 = new WildcardPermission("one:two,three,four");    p3 = new WildcardPermission("one:two,three,four:five:six:seven");    assertTrue(p1.implies(p2));    assertTrue(p1.implies(p3));    assertFalse(p2.implies(p1));    assertFalse(p3.implies(p1));    assertTrue(p2.implies(p3));}
public void shiro_f1325_0()
{    WildcardPermission p6 = new WildcardPermission("one,two:three,four");    WildcardPermission p6DiffOrder = new WildcardPermission("two,one:four,three");    assertTrue(p6.equals(p6DiffOrder));}
public void shiro_f1326_0()
{    WildcardPermission p1, p2, p3, p4, p5, p6, p7, p8, p9;    p1 = new WildcardPermission("*");    p2 = new WildcardPermission("one");    p3 = new WildcardPermission("one:two");    p4 = new WildcardPermission("one,two:three,four");    p5 = new WildcardPermission("one,two:three,four,five:six:seven,eight");    assertTrue(p1.implies(p2));    assertTrue(p1.implies(p3));    assertTrue(p1.implies(p4));    assertTrue(p1.implies(p5));    p1 = new WildcardPermission("newsletter:*");    p2 = new WildcardPermission("newsletter:read");    p3 = new WildcardPermission("newsletter:read,write");    p4 = new WildcardPermission("newsletter:*");    p5 = new WildcardPermission("newsletter:*:*");    p6 = new WildcardPermission("newsletter:*:read");    p7 = new WildcardPermission("newsletter:write:*");    p8 = new WildcardPermission("newsletter:read,write:*");    p9 = new WildcardPermission("newsletter");    assertTrue(p1.implies(p2));    assertTrue(p1.implies(p3));    assertTrue(p1.implies(p4));    assertTrue(p1.implies(p5));    assertTrue(p1.implies(p6));    assertTrue(p1.implies(p7));    assertTrue(p1.implies(p8));    assertTrue(p1.implies(p9));    p1 = new WildcardPermission("newsletter:*:*");    assertTrue(p1.implies(p2));    assertTrue(p1.implies(p3));    assertTrue(p1.implies(p4));    assertTrue(p1.implies(p5));    assertTrue(p1.implies(p6));    assertTrue(p1.implies(p7));    assertTrue(p1.implies(p8));    assertTrue(p1.implies(p9));    p1 = new WildcardPermission("newsletter:*:*:*");    assertTrue(p1.implies(p2));    assertTrue(p1.implies(p3));    assertTrue(p1.implies(p4));    assertTrue(p1.implies(p5));    assertTrue(p1.implies(p6));    assertTrue(p1.implies(p7));    assertTrue(p1.implies(p8));    assertTrue(p1.implies(p9));    p1 = new WildcardPermission("newsletter");    assertTrue(p1.implies(p2));    assertTrue(p1.implies(p3));    assertTrue(p1.implies(p4));    assertTrue(p1.implies(p5));    assertTrue(p1.implies(p6));    assertTrue(p1.implies(p7));    assertTrue(p1.implies(p8));    assertTrue(p1.implies(p9));    p1 = new WildcardPermission("newsletter:*:read");    p2 = new WildcardPermission("newsletter:123:read");    p3 = new WildcardPermission("newsletter:123,456:read,write");    p4 = new WildcardPermission("newsletter:read");    p5 = new WildcardPermission("newsletter:read,write");    p6 = new WildcardPermission("newsletter:123:read:write");    assertTrue(p1.implies(p2));    assertFalse(p1.implies(p3));    assertFalse(p1.implies(p4));    assertFalse(p1.implies(p5));    assertTrue(p1.implies(p6));    p1 = new WildcardPermission("newsletter:*:read:*");    assertTrue(p1.implies(p2));    assertTrue(p1.implies(p6));}
public void shiro_f1327_0()
{    WildcardPermission p1 = new WildcardPermission("*");    WildcardPermission p2 = new WildcardPermission("one");    WildcardPermission p3 = new WildcardPermission("one:two");    WildcardPermission p4 = new WildcardPermission("one,two:three,four");    WildcardPermission p5 = new WildcardPermission("one,two:three,four,five:six:seven,eight");    assertTrue("*".equals(p1.toString()));    assertTrue(p1.equals(new WildcardPermission(p1.toString())));    assertTrue("one".equals(p2.toString()));    assertTrue(p2.equals(new WildcardPermission(p2.toString())));    assertTrue("one:two".equals(p3.toString()));    assertTrue(p3.equals(new WildcardPermission(p3.toString())));    assertTrue("one,two:three,four".equals(p4.toString()));    assertTrue(p4.equals(new WildcardPermission(p4.toString())));    assertTrue("one,two:three,four,five:six:seven,eight".equals(p5.toString()));    assertTrue(p5.equals(new WildcardPermission(p5.toString())));}
public void shiro_f1328_0()
{    WildcardPermission p1, p2, p3, p4;    p1 = new WildcardPermission("one");    p2 = new WildcardPermission("one:*");    p3 = new WildcardPermission("one:*:*");    p4 = new WildcardPermission("one:read");    assertTrue(p1.implies(p2));    assertTrue(p1.implies(p3));    assertTrue(p1.implies(p4));    assertTrue(p2.implies(p1));    assertTrue(p2.implies(p3));    assertTrue(p2.implies(p4));    assertTrue(p3.implies(p1));    assertTrue(p3.implies(p2));    assertTrue(p3.implies(p4));    assertFalse(p4.implies(p1));    assertFalse(p4.implies(p2));    assertFalse(p4.implies(p3));}
protected Class shiro_f1329_0()
{    return UnauthenticatedException.class;}
protected Class shiro_f1330_0()
{    return UnauthorizedException.class;}
public void shiro_f1331_0()
{    ExecutorService mockExecutorService = createNiceMock(ExecutorService.class);    expect(mockExecutorService.submit(isA(SubjectRunnable.class))).andReturn(new DummyFuture());    replay(mockExecutorService);    final SubjectAwareExecutorService executor = new SubjectAwareExecutorService(mockExecutorService);    Runnable testRunnable = new Runnable() {        public void run() {            System.out.println("Hello World");        }    };    executor.submit(testRunnable);    verify(mockExecutorService);}
public void shiro_f1332_0()
{    System.out.println("Hello World");}
public boolean shiro_f1333_0(boolean b)
{    return false;}
public boolean shiro_f1334_0()
{    return false;}
public boolean shiro_f1335_0()
{    return true;}
public V shiro_f1336_0() throws InterruptedException, ExecutionException
{    return null;}
public V shiro_f1337_0(long l, TimeUnit timeUnit) throws InterruptedException, ExecutionException, TimeoutException
{    return null;}
public void shiro_f1338_0()
{    Executor targetMockExecutor = createNiceMock(Executor.class);            targetMockExecutor.execute(isA(SubjectRunnable.class));    replay(targetMockExecutor);    final SubjectAwareExecutor executor = new SubjectAwareExecutor(targetMockExecutor);    Runnable work = new Runnable() {        public void run() {            System.out.println("Hello World");        }    };    executor.execute(work);    verify(targetMockExecutor);}
public void shiro_f1339_0()
{    System.out.println("Hello World");}
protected Cache shiro_f1340_0(String name) throws CacheException
{    return new HashMapCache<K, V>(name);}
public void shiro_f1341_0()
{    ClassUtils.newInstance(getExceptionClass());}
public void shiro_f1342_0() throws Exception
{    ClassUtils.newInstance(getExceptionClass(), "Msg");}
public void shiro_f1343_0() throws Exception
{    ClassUtils.newInstance(getExceptionClass(), new Throwable());}
public void shiro_f1344_0()
{    ClassUtils.newInstance(getExceptionClass(), "Msg", new Throwable());}
protected Class shiro_f1345_0()
{    return SerializationException.class;}
public void shiro_f1346_0() throws Exception
{    final String name = "my/jndi/resource";    final String returnValue = "jndiString";    JndiObjectFactory<String> underTest = new JndiObjectFactory<String>() {        @Override        protected Object lookup(String jndiName, Class requiredType) throws NamingException {            assertEquals(name, jndiName);            assertEquals(String.class, requiredType);            return new String(returnValue);        }    };    underTest.setRequiredType(String.class);    underTest.setResourceName(name);    assertEquals(returnValue, underTest.getInstance());}
protected Object shiro_f1347_0(String jndiName, Class requiredType) throws NamingException
{    assertEquals(name, jndiName);    assertEquals(String.class, requiredType);    return new String(returnValue);}
public void shiro_f1348_0() throws Exception
{    final String name = "my/jndi/resource";    final String returnValue = "jndiString";    JndiObjectFactory<String> underTest = new JndiObjectFactory<String>() {        @Override        protected Object lookup(String jndiName) throws NamingException {            assertEquals(name, jndiName);            return new String(returnValue);        }    };    underTest.setResourceName(name);    assertEquals(returnValue, underTest.getInstance());}
protected Object shiro_f1349_0(String jndiName) throws NamingException
{    assertEquals(name, jndiName);    return new String(returnValue);}
public void shiro_f1350_0() throws Exception
{    final String name = "my/jndi/resource";    JndiObjectFactory<String> underTest = new JndiObjectFactory<String>() {        @Override        protected Object lookup(String jndiName, Class requiredType) throws NamingException {            throw new NamingException("No resource named " + jndiName);        }    };    underTest.setResourceName(name);    underTest.setRequiredType(String.class);    underTest.getInstance();}
protected Object shiro_f1351_0(String jndiName, Class requiredType) throws NamingException
{    throw new NamingException("No resource named " + jndiName);}
public void shiro_f1352_0() throws Exception
{    final String name = "my/jndi/resource";    JndiObjectFactory<String> underTest = new JndiObjectFactory<String>() {        @Override        protected Object lookup(String jndiName) throws NamingException {            throw new NamingException("No resource named " + jndiName);        }    };    underTest.setResourceName(name);    underTest.getInstance();}
protected Object shiro_f1353_0(String jndiName) throws NamingException
{    throw new NamingException("No resource named " + jndiName);}
public void shiro_f1354_0()
{    AbstractRememberMeManager rmm = new DummyRememberMeManager();            PrincipalCollection principals = rmm.getRememberedPrincipals(new DefaultSubjectContext());    assertNull(principals);        rmm = new DummyRememberMeManager() {        @Override        protected byte[] getRememberedSerializedIdentity(SubjectContext subjectContext) {            return null;        }    };    principals = rmm.getRememberedPrincipals(new DefaultSubjectContext());    assertNull(principals);}
protected byte[] shiro_f1355_0(SubjectContext subjectContext)
{    return null;}
public void shiro_f1356_0(SubjectContext subjectContext)
{}
protected void shiro_f1357_0(Subject subject)
{}
protected void shiro_f1358_0(Subject subject, byte[] serialized)
{}
protected byte[] shiro_f1359_0(SubjectContext subjectContext)
{    return new byte[0];}
public void shiro_f1360_0()
{    ThreadContext.remove();}
protected Subject shiro_f1361_0(SecurityManager securityManager)
{    Subject subject = new Subject.Builder(securityManager).buildSubject();    threadState = new SubjectThreadState(subject);    threadState.bind();    return subject;}
public void shiro_f1362_0()
{    sm = new DefaultSecurityManager();    Ini ini = new Ini();    Ini.Section section = ini.addSection(IniRealm.USERS_SECTION_NAME);    section.put("guest", "guest, guest");    section.put("lonestarr", "vespa, goodguy");    sm.setRealm(new IniRealm(ini));    SecurityUtils.setSecurityManager(sm);}
public void shiro_f1363_0()
{    SecurityUtils.setSecurityManager(null);    sm.destroy();    super.tearDown();}
public void shiro_f1364_0()
{    Subject subject = SecurityUtils.getSubject();    AuthenticationToken token = new UsernamePasswordToken("guest", "guest");    subject.login(token);    assertTrue(subject.isAuthenticated());    assertTrue("guest".equals(subject.getPrincipal()));    assertTrue(subject.hasRole("guest"));    Session session = subject.getSession();    session.setAttribute("key", "value");    assertEquals(session.getAttribute("key"), "value");    subject.logout();    assertNull(subject.getSession(false));    assertNull(subject.getPrincipal());    assertNull(subject.getPrincipals());}
public void shiro_f1365_0()
{    Subject subject = SecurityUtils.getSubject();    Session session = subject.getSession();    Serializable origSessionId = session.getId();    String key = "foo";    String value1 = "bar";    session.setAttribute(key, value1);    assertEquals(value1, session.getAttribute(key));        session.setTimeout(50);    try {        Thread.sleep(150);    } catch (InterruptedException e) {        }    try {        session.setTimeout(AbstractValidatingSessionManager.DEFAULT_GLOBAL_SESSION_TIMEOUT);        fail("Session should have expired.");    } catch (ExpiredSessionException expected) {    }}
public void shiro_f1366_0()
{    Subject subject = SecurityUtils.getSubject();    AuthenticationToken token = new UsernamePasswordToken("guest", "guest");    subject.login(token);    assertTrue(subject.isAuthenticated());    assertTrue("guest".equals(subject.getPrincipal()));    assertTrue(subject.hasRole("guest"));    Session session = subject.getSession();    Serializable firstSessionId = session.getId();    session.setAttribute("key", "value");    assertEquals(session.getAttribute("key"), "value");    subject.logout();    assertNull(subject.getSession(false));    assertNull(subject.getPrincipal());    assertNull(subject.getPrincipals());    subject.login(new UsernamePasswordToken("lonestarr", "vespa"));    assertTrue(subject.isAuthenticated());    assertTrue("lonestarr".equals(subject.getPrincipal()));    assertTrue(subject.hasRole("goodguy"));    assertNotNull(subject.getSession());    assertFalse(firstSessionId.equals(subject.getSession().getId()));    subject.logout();    assertNull(subject.getSession(false));    assertNull(subject.getPrincipal());    assertNull(subject.getPrincipals());}
public void shiro_f1367_0()
{        SecurityUtils.setSecurityManager(null);    try {        SecurityUtils.getSecurityManager();    } catch (UnavailableSecurityManagerException e) {        assertTrue(e.getMessage().startsWith("No SecurityManager accessible"));    }        DelegatingSubject subject = (DelegatingSubject) (new Subject.Builder(sm)).buildSubject();        AuthenticationToken token = new UsernamePasswordToken("guest", "guest");    subject.login(token);    assertEquals(sm, subject.getSecurityManager());}
public void shiro_f1368_0()
{    ThreadContext.remove();}
public void shiro_f1369_0()
{    ThreadContext.remove();}
public void shiro_f1370_0()
{    DefaultSecurityManager sm = new DefaultSecurityManager();    Ini ini = new Ini();    Ini.Section section = ini.addSection(IniRealm.USERS_SECTION_NAME);    section.put("guest", "guest");    sm.setRealm(new IniRealm(ini));    SecurityUtils.setSecurityManager(sm);    try {        Subject subject = SecurityUtils.getSubject();        AuthenticationToken token = new UsernamePasswordToken("guest", "guest");        subject.login(token);        subject.getSession().setAttribute("key", "value");        assertTrue(subject.getSession().getAttribute("key").equals("value"));        subject = SecurityUtils.getSubject();        assertTrue(subject.isAuthenticated());        assertTrue(subject.getSession().getAttribute("key").equals("value"));    } finally {        sm.destroy();                SecurityUtils.setSecurityManager(null);    }}
public void shiro_f1371_0()
{    ThreadContext.remove();    realm = new TestActiveDirectoryRealm();    securityManager = new DefaultSecurityManager(realm);    SecurityUtils.setSecurityManager(securityManager);}
public void shiro_f1372_0()
{    SecurityUtils.setSecurityManager(null);    securityManager.destroy();    ThreadContext.remove();}
public void shiro_f1373_0()
{    String localhost = "localhost";    Subject subject = SecurityUtils.getSubject();    subject.login(new UsernamePasswordToken(USERNAME, PASSWORD, localhost));    assertTrue(subject.isAuthenticated());    assertTrue(subject.hasRole(ROLE));    UsernamePrincipal usernamePrincipal = subject.getPrincipals().oneByType(UsernamePrincipal.class);    assertTrue(usernamePrincipal.getUsername().equals(USERNAME));    UserIdPrincipal userIdPrincipal = subject.getPrincipals().oneByType(UserIdPrincipal.class);    assertTrue(userIdPrincipal.getUserId() == USER_ID);    assertTrue(realm.hasRole(subject.getPrincipals(), ROLE));    subject.logout();}
public boolean shiro_f1374_0(AuthenticationToken object, AuthenticationInfo object1)
{    return true;}
protected AuthenticationInfo shiro_f1375_0(AuthenticationToken token) throws AuthenticationException
{    SimpleAccount account = (SimpleAccount) super.doGetAuthenticationInfo(token);    if (account != null) {        SimplePrincipalCollection principals = new SimplePrincipalCollection();        principals.add(new UserIdPrincipal(USER_ID), getName());        principals.add(new UsernamePrincipal(USERNAME), getName());        account.setPrincipals(principals);    }    return account;}
protected AuthorizationInfo shiro_f1376_0(PrincipalCollection principals)
{    Set<String> roles = new HashSet<String>();    roles.add(ROLE);    return new SimpleAuthorizationInfo(roles);}
protected AuthenticationInfo shiro_f1377_0(AuthenticationToken token, LdapContextFactory ldapContextFactory) throws NamingException
{    return new SimpleAccount(token.getPrincipal(), token.getCredentials(), getName());}
public void shiro_f1378_0()
{    realm = new AllowAllRealm();}
public void shiro_f1379_0()
{    realm = null;}
public void shiro_f1380_0()
{    AuthenticationInfo info = realm.getAuthenticationInfo(new UsernamePasswordToken(USERNAME, PASSWORD, localhost));    assertNotNull(info);    assertTrue(realm.hasRole(info.getPrincipals(), ROLE));    Object principal = info.getPrincipals().getPrimaryPrincipal();    assertTrue(principal instanceof UserIdPrincipal);    UsernamePrincipal usernamePrincipal = info.getPrincipals().oneByType(UsernamePrincipal.class);    assertTrue(usernamePrincipal.getUsername().equals(USERNAME));    UserIdPrincipal userIdPrincipal = info.getPrincipals().oneByType(UserIdPrincipal.class);    assertTrue(userIdPrincipal.getUserId() == USER_ID);    String stringPrincipal = info.getPrincipals().oneByType(String.class);    assertTrue(stringPrincipal.equals(USER_ID + USERNAME));}
public void shiro_f1381_0()
{    AuthorizingRealm realm = new AllowAllRealm() {        @Override        protected AuthenticationInfo buildAuthenticationInfo(Object principal, Object credentials) {            String username = (String) principal;            UsernamePrincipal customPrincipal = new UsernamePrincipal(username);            return new SimpleAccount(customPrincipal, credentials, getName());        }    };    AuthenticationInfo info = realm.getAuthenticationInfo(new UsernamePasswordToken(USERNAME, PASSWORD, localhost));    assertNotNull(info);    assertTrue(realm.hasRole(info.getPrincipals(), ROLE));    Object principal = info.getPrincipals().getPrimaryPrincipal();    assertTrue(principal instanceof UsernamePrincipal);    assertEquals(USERNAME, ((UsernamePrincipal) principal).getUsername());}
protected AuthenticationInfo shiro_f1382_0(Object principal, Object credentials)
{    String username = (String) principal;    UsernamePrincipal customPrincipal = new UsernamePrincipal(username);    return new SimpleAccount(customPrincipal, credentials, getName());}
public void shiro_f1383_0()
{    AuthorizingRealm realm = new AuthorizingRealm() {        protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) {            return null;        }        protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException {            return null;        }    };    Principal principal = new UsernamePrincipal("blah");    PrincipalCollection pCollection = new SimplePrincipalCollection(principal, "nullAuthzRealm");    List<Permission> permList = new ArrayList<Permission>();    permList.add(new WildcardPermission("stringPerm1"));    permList.add(new WildcardPermission("stringPerm2"));    List<String> roleList = new ArrayList<String>();    roleList.add("role1");    roleList.add("role2");    boolean thrown = false;    try {        realm.checkPermission(pCollection, "stringPermission");    } catch (UnauthorizedException e) {        thrown = true;    }    assertTrue(thrown);    thrown = false;    try {        realm.checkPermission(pCollection, new WildcardPermission("stringPermission"));    } catch (UnauthorizedException e) {        thrown = true;    }    assertTrue(thrown);    thrown = false;    try {        realm.checkPermissions(pCollection, "stringPerm1", "stringPerm2");    } catch (UnauthorizedException e) {        thrown = true;    }    assertTrue(thrown);    thrown = false;    try {        realm.checkPermissions(pCollection, permList);    } catch (UnauthorizedException e) {        thrown = true;    }    assertTrue(thrown);    thrown = false;    try {        realm.checkRole(pCollection, "role1");    } catch (UnauthorizedException e) {        thrown = true;    }    assertTrue(thrown);    thrown = false;    try {        realm.checkRoles(pCollection, roleList);    } catch (UnauthorizedException e) {        thrown = true;    }    assertTrue(thrown);    assertFalse(realm.hasAllRoles(pCollection, roleList));    assertFalse(realm.hasRole(pCollection, "role1"));    assertArrayEquals(new boolean[] { false, false }, realm.hasRoles(pCollection, roleList));    assertFalse(realm.isPermitted(pCollection, "perm1"));    assertFalse(realm.isPermitted(pCollection, new WildcardPermission("perm1")));    assertArrayEquals(new boolean[] { false, false }, realm.isPermitted(pCollection, "perm1", "perm2"));    assertArrayEquals(new boolean[] { false, false }, realm.isPermitted(pCollection, permList));    assertFalse(realm.isPermittedAll(pCollection, "perm1", "perm2"));    assertFalse(realm.isPermittedAll(pCollection, permList));}
protected AuthorizationInfo shiro_f1384_0(PrincipalCollection principals)
{    return null;}
protected AuthenticationInfo shiro_f1385_0(AuthenticationToken token) throws AuthenticationException
{    return null;}
public void shiro_f1386_0()
{    Principal principal = new UsernamePrincipal("rolePermResolver");    PrincipalCollection pCollection = new SimplePrincipalCollection(principal, "testRealmWithRolePermissionResolver");    AuthorizingRealm realm = new AllowAllRealm();    realm.setRolePermissionResolver(new RolePermissionResolver() {        public Collection<Permission> resolvePermissionsInRole(String roleString) {            Collection<Permission> permissions = new HashSet<Permission>();            if (roleString.equals(ROLE)) {                permissions.add(new WildcardPermission(ROLE + ":perm1"));                permissions.add(new WildcardPermission(ROLE + ":perm2"));                permissions.add(new WildcardPermission("other:*:foo"));            }            return permissions;        }    });    assertTrue(realm.hasRole(pCollection, ROLE));    assertTrue(realm.isPermitted(pCollection, ROLE + ":perm1"));    assertTrue(realm.isPermitted(pCollection, ROLE + ":perm2"));    assertFalse(realm.isPermitted(pCollection, ROLE + ":perm3"));    assertTrue(realm.isPermitted(pCollection, "other:bar:foo"));}
public Collection<Permission> shiro_f1387_0(String roleString)
{    Collection<Permission> permissions = new HashSet<Permission>();    if (roleString.equals(ROLE)) {        permissions.add(new WildcardPermission(ROLE + ":perm1"));        permissions.add(new WildcardPermission(ROLE + ":perm2"));        permissions.add(new WildcardPermission("other:*:foo"));    }    return permissions;}
public void shiro_f1388_0()
{    Principal principal = new UsernamePrincipal("rolePermResolver");    PrincipalCollection pCollection = new SimplePrincipalCollection(principal, "testRealmWithRolePermissionResolver");    AuthorizingRealm realm = new AllowAllRealm();    realm.setRolePermissionResolver(new RolePermissionResolver() {        public Collection<Permission> resolvePermissionsInRole(String roleString) {            Collection<Permission> permissions = new HashSet<Permission>();            if (roleString.equals(ROLE)) {                permissions.add(new WildcardPermission(ROLE + ":perm1"));                permissions.add(new WildcardPermission(ROLE + ":perm2"));                permissions.add(new WildcardPermission(ROLE + ": "));                permissions.add(new WildcardPermission(ROLE + ":\t"));                permissions.add(new WildcardPermission("other:*:foo"));            }            return permissions;        }    });    realm.setPermissionResolver(new WildcardPermissionResolver());    SimpleAuthorizationInfo authorizationInfo = (SimpleAuthorizationInfo) realm.getAuthorizationInfo(pCollection);    assertNotNull(authorizationInfo);    authorizationInfo.addStringPermission("");    authorizationInfo.addStringPermission(" ");    authorizationInfo.addStringPermission("\t");    authorizationInfo.addStringPermission(null);    Collection<Permission> permissions = realm.getPermissions(authorizationInfo);    assertEquals(permissions.size(), 4);}
public Collection<Permission> shiro_f1389_0(String roleString)
{    Collection<Permission> permissions = new HashSet<Permission>();    if (roleString.equals(ROLE)) {        permissions.add(new WildcardPermission(ROLE + ":perm1"));        permissions.add(new WildcardPermission(ROLE + ":perm2"));        permissions.add(new WildcardPermission(ROLE + ": "));        permissions.add(new WildcardPermission(ROLE + ":\t"));        permissions.add(new WildcardPermission("other:*:foo"));    }    return permissions;}
private void shiro_f1390_0(boolean[] expected, boolean[] actual)
{    if (expected.length != actual.length) {        fail("Expected array of length [" + expected.length + "] but received array of length [" + actual.length + "]");    }    for (int i = 0; i < expected.length; i++) {        if (expected[i] != actual[i]) {            fail("Expected index [" + i + "] to be [" + expected[i] + "] but was [" + actual[i] + "]");        }    }}
protected AuthenticationInfo shiro_f1391_0(AuthenticationToken token) throws AuthenticationException
{    return buildAuthenticationInfo(token.getPrincipal(), token.getCredentials());}
protected AuthorizationInfo shiro_f1392_0(PrincipalCollection principals)
{    Set<String> roles = new HashSet<String>();    roles.add(ROLE);    return new SimpleAuthorizationInfo(roles);}
protected AuthenticationInfo shiro_f1393_0(Object principal, Object credentials)
{    Collection<Object> principals = new ArrayList<Object>(3);    principals.add(new UserIdPrincipal(USER_ID));    principals.add(new UsernamePrincipal(USERNAME));    principals.add(USER_ID + USERNAME);    return new SimpleAuthenticationInfo(principals, PASSWORD, getName());}
public void shiro_f1394_0()
{    ThreadContext.remove();    Ini config = new Ini();    config.setSectionProperty("main", "myRealm", "org.apache.shiro.realm.jdbc.JdbcRealm");    config.setSectionProperty("main", "myRealmCredentialsMatcher", "org.apache.shiro.authc.credential.Sha256CredentialsMatcher");    config.setSectionProperty("main", "myRealm.credentialsMatcher", "$myRealmCredentialsMatcher");    config.setSectionProperty("main", "securityManager.sessionManager.sessionValidationSchedulerEnabled", "false");    IniSecurityManagerFactory factory = new IniSecurityManagerFactory(config);    securityManager = (DefaultSecurityManager) factory.createInstance();    SecurityUtils.setSecurityManager(securityManager);        createRealm(name.getMethodName());}
public void shiro_f1395_0()
{    final String testName = name.getMethodName();    shutDown(testName);    SecurityUtils.setSecurityManager(null);    securityManager.destroy();    ThreadContext.remove();}
public void shiro_f1396_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createDefaultSchema(testMethodName, false);    realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, plainTextPassword);    currentUser.login(token);    currentUser.logout();}
public void shiro_f1397_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createDefaultSchema(testMethodName, false);    realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, "passwrd");    try {        currentUser.login(token);    } catch (IncorrectCredentialsException ex) {        }}
public void shiro_f1398_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createDefaultSchema(testMethodName, false);    realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);    Connection conn = dsMap.get(testMethodName).getConnection();    Statement sql = conn.createStatement();    sql.executeUpdate("insert into users values ('" + username + "', 'dupe')");    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, "passwrd");    try {        currentUser.login(token);    } catch (AuthenticationException ex) {        }}
public void shiro_f1399_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createSaltColumnSchema(testMethodName, false);    realm.setSaltStyle(JdbcRealm.SaltStyle.COLUMN);    realm.setSaltIsBase64Encoded(false);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, plainTextPassword);    currentUser.login(token);    currentUser.logout();}
public void shiro_f1400_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createSaltColumnSchema(testMethodName, true);    realm.setSaltStyle(JdbcRealm.SaltStyle.COLUMN);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, plainTextPassword);    currentUser.login(token);    currentUser.logout();}
public void shiro_f1401_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createSaltColumnSchema(testMethodName, false);    realm.setSaltStyle(JdbcRealm.SaltStyle.COLUMN);    realm.setSaltIsBase64Encoded(false);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, "passwrd");    try {        currentUser.login(token);    } catch (IncorrectCredentialsException ex) {        }}
public void shiro_f1402_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createSaltColumnSchema(testMethodName, true);    realm.setSaltStyle(JdbcRealm.SaltStyle.COLUMN);    realm.setSaltIsBase64Encoded(false);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, "passwrd");    try {        currentUser.login(token);    } catch (IncorrectCredentialsException ex) {        }}
public void shiro_f1403_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createDefaultSchema(testMethodName, true);    realm.setSaltStyle(JdbcRealm.SaltStyle.EXTERNAL);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, plainTextPassword);    currentUser.login(token);    currentUser.logout();}
public void shiro_f1404_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createDefaultSchema(testMethodName, true);    realm.setSaltStyle(JdbcRealm.SaltStyle.EXTERNAL);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, "passwrd");    try {        currentUser.login(token);    } catch (IncorrectCredentialsException ex) {        }}
public void shiro_f1405_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createDefaultSchema(testMethodName, false);    realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, plainTextPassword);    currentUser.login(token);    Assert.assertTrue(currentUser.hasRole(testRole));}
public void shiro_f1406_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createDefaultSchema(testMethodName, false);    realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, plainTextPassword);    currentUser.login(token);    Assert.assertFalse(currentUser.hasRole("Game Overall Director"));}
public void shiro_f1407_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createDefaultSchema(testMethodName, false);    realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);    realm.setPermissionsLookupEnabled(true);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, plainTextPassword);    currentUser.login(token);    Assert.assertTrue(currentUser.isPermitted(testPermissionString));}
public void shiro_f1408_0() throws Exception
{    String testMethodName = name.getMethodName();    JdbcRealm realm = realmMap.get(testMethodName);    createDefaultSchema(testMethodName, false);    realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);    realm.setPermissionsLookupEnabled(true);    Subject.Builder builder = new Subject.Builder(securityManager);    Subject currentUser = builder.buildSubject();    UsernamePasswordToken token = new UsernamePasswordToken(username, plainTextPassword);    currentUser.login(token);    Assert.assertFalse(currentUser.isPermitted("testDomain:testTarget:specialAction"));}
protected void shiro_f1409_0(String testMethodName)
{    JdbcRealm realm = (JdbcRealm) securityManager.getRealms().iterator().next();    realmMap.put(testMethodName, realm);}
protected void shiro_f1410_0(String testName)
{    Connection conn = null;    Statement sql = null;    DataSource ds = dsMap.get(testName);    try {        Connection c = ds.getConnection();        Statement s = c.createStatement();        s.executeUpdate("SHUTDOWN");    } catch (SQLException ex) {        } finally {        JdbcUtils.closeStatement(sql);        JdbcUtils.closeConnection(conn);        dsMap.remove(testName);        realmMap.remove(testName);    }}
protected void shiro_f1411_0(String testName, boolean salted)
{    JDBCDataSource ds = new JDBCDataSource();    ds.setDatabase("jdbc:hsqldb:mem:" + name);    ds.setUser("SA");    ds.setPassword("");    Connection conn = null;    Statement sql = null;    try {        conn = ds.getConnection();        sql = conn.createStatement();        sql.executeUpdate("create table users (username varchar(20), password varchar(100))");        Sha256Hash sha256Hash = salted ? new Sha256Hash(plainTextPassword, salt) : new Sha256Hash(plainTextPassword);        String password = sha256Hash.toHex();        sql.executeUpdate("insert into users values ('" + username + "', '" + password + "')");    } catch (SQLException ex) {        Assert.fail("Exception creating test database");    } finally {        JdbcUtils.closeStatement(sql);        JdbcUtils.closeConnection(conn);    }    createRolesAndPermissions(ds);    realmMap.get(testName).setDataSource(ds);    dsMap.put(testName, ds);}
protected void shiro_f1412_0(String testName, boolean base64EncodeSalt)
{    JDBCDataSource ds = new JDBCDataSource();    ds.setDatabase("jdbc:hsqldb:mem:" + name);    ds.setUser("SA");    ds.setPassword("");    Connection conn = null;    Statement sql = null;    try {        conn = ds.getConnection();        sql = conn.createStatement();        sql.executeUpdate("create table users (username varchar(20), password varchar(100), password_salt varchar(20))");        Sha256Hash sha256Hash = new Sha256Hash(plainTextPassword, salt);        String password = sha256Hash.toHex();        String maybeBase64EncodedSalt = base64EncodeSalt ? Base64.encodeToString(CodecSupport.toBytes(salt)) : salt;        sql.executeUpdate("insert into users values ('" + username + "', '" + password + "', '" + maybeBase64EncodedSalt + "')");    } catch (SQLException ex) {        Assert.fail("Exception creating test database");    } finally {        JdbcUtils.closeStatement(sql);        JdbcUtils.closeConnection(conn);    }    createRolesAndPermissions(ds);    realmMap.get(testName).setDataSource(ds);    dsMap.put(testName, ds);}
protected void shiro_f1413_0(DataSource ds)
{    Connection conn = null;    ;    Statement sql = null;    try {        conn = ds.getConnection();        sql = conn.createStatement();        sql.executeUpdate("create table user_roles (username varchar(20), role_name varchar(20))");        sql.executeUpdate("insert into user_roles values ('" + username + "', '" + testRole + "')");        sql.executeUpdate("create table roles_permissions (role_name varchar(20), permission varchar(40))");        sql.executeUpdate("insert into roles_permissions values ('" + testRole + "', '" + testPermissionString + "')");    } catch (SQLException ex) {        Assert.fail("Exception adding test role and permission");    } finally {        JdbcUtils.closeStatement(sql);        JdbcUtils.closeConnection(conn);    }}
public void shiro_f1414_0()
{    factory = new DefaultLdapContextFactory() {                @Override        protected LdapContext createLdapContext(Hashtable env) throws NamingException {            return createNiceMock(LdapContext.class);        }    };}
protected LdapContext shiro_f1415_0(Hashtable env) throws NamingException
{    return createNiceMock(LdapContext.class);}
public void shiro_f1416_0() throws NamingException
{    factory = new DefaultLdapContextFactory();        String brokenHost = UUID.randomUUID().toString();    factory.setUrl("ldap://" + brokenHost + ":389");    factory.getLdapContext((Object) "foo", "bar");}
public void shiro_f1417_0() throws NamingException
{    factory.getLdapContext((Object) "foo", "bar");}
public void shiro_f1418_0() throws NamingException
{    factory.setUrl("ldap://localhost:389");    factory.getLdapContext((Object) "jcoder", "");}
public void shiro_f1419_0() throws NamingException
{    factory.setUrl("ldap://localhost:389");    factory.getLdapContext((Object) "jcoder", new char[0]);}
public void shiro_f1420_0() throws NamingException
{    factory.setUrl("ldap://localhost:389");    factory.getLdapContext((Object) "jcoder", new byte[0]);}
public void shiro_f1421_0() throws NamingException
{    factory.setUrl("ldap://localhost:389");    factory.getLdapContext((Object) "jcoder", null);}
protected DefaultLdapRealm shiro_f1422_0()
{    return new DefaultLdapRealm();}
public void shiro_f1423_0()
{    realm = getNewRealmUnderTest();}
public void shiro_f1424_0()
{    assertTrue(realm.getCredentialsMatcher() instanceof AllowAllCredentialsMatcher);    assertEquals(AuthenticationToken.class, realm.getAuthenticationTokenClass());    assertTrue(realm.getContextFactory() instanceof JndiLdapContextFactory);}
public void shiro_f1425_0()
{    realm.setUserDnTemplate(null);}
public void shiro_f1426_0()
{    realm.setUserDnTemplate("  ");}
public void shiro_f1427_0()
{    realm.setUserDnTemplate("uid=,ou=users,dc=mycompany,dc=com");}
public void shiro_f1428_0()
{    String template = "uid={0},ou=users,dc=mycompany,dc=com";    realm.setUserDnTemplate(template);    assertEquals(template, realm.getUserDnTemplate());}
public void shiro_f1429_0() throws NamingException
{    realm.setUserDnTemplate("uid={0},ou=users,dc=mycompany,dc=com");    LdapContextFactory factory = createMock(LdapContextFactory.class);    realm.setContextFactory(factory);    Object expectedPrincipal = "uid=jsmith,ou=users,dc=mycompany,dc=com";    expect(factory.getLdapContext(eq(expectedPrincipal), isA(Object.class))).andReturn(createNiceMock(LdapContext.class));    replay(factory);    realm.getAuthenticationInfo(new UsernamePasswordToken("jsmith", "secret"));    verify(factory);}
public void shiro_f1430_0() throws NamingException
{    realm.setUserDnTemplate("uid={0},ou=users,dc=mycompany,dc=com");    LdapContextFactory factory = createMock(LdapContextFactory.class);    realm.setContextFactory(factory);    expect(factory.getLdapContext(isA(Object.class), isA(Object.class))).andThrow(new javax.naming.AuthenticationException("LDAP Authentication failed."));    replay(factory);    realm.getAuthenticationInfo(new UsernamePasswordToken("jsmith", "secret"));}
public void shiro_f1431_0() throws NamingException
{    realm.setUserDnTemplate("uid={0},ou=users,dc=mycompany,dc=com");    LdapContextFactory factory = createMock(LdapContextFactory.class);    realm.setContextFactory(factory);    expect(factory.getLdapContext(isA(Object.class), isA(Object.class))).andThrow(new NamingException("Communication error."));    replay(factory);    realm.getAuthenticationInfo(new UsernamePasswordToken("jsmith", "secret"));}
public void shiro_f1432_0() throws NamingException
{    realm.setUserDnTemplate("uid={0},ou=users,dc=mycompany,dc=com");    LdapContextFactory factory = createMock(LdapContextFactory.class);    realm.setContextFactory(factory);    final UUID userId = UUID.randomUUID();        expect(factory.getLdapContext(eq(userId), isA(Object.class))).andReturn(createNiceMock(LdapContext.class));    replay(factory);    realm.getAuthenticationInfo(new AuthenticationToken() {        public Object getPrincipal() {            return userId;        }        public Object getCredentials() {            return "secret";        }    });    verify(factory);}
public Object shiro_f1433_0()
{    return userId;}
public Object shiro_f1434_0()
{    return "secret";}
public void shiro_f1435_0()
{    realm.getUserDn(null);}
public void shiro_f1436_0()
{    realm = new DefaultLdapRealm() {        @Override        protected String getUserDnPrefix() {            return null;        }        @Override        protected String getUserDnSuffix() {            return null;        }    };    String principal = "foo";    String userDn = realm.getUserDn(principal);    assertEquals(principal, userDn);}
protected String shiro_f1437_0()
{    return null;}
protected String shiro_f1438_0()
{    return null;}
public void shiro_f1439_0()
{    factory = new JndiLdapContextFactory() {                @Override        protected LdapContext createLdapContext(Hashtable env) throws NamingException {            return createNiceMock(LdapContext.class);        }    };}
protected LdapContext shiro_f1440_0(Hashtable env) throws NamingException
{    return createNiceMock(LdapContext.class);}
public void shiro_f1441_0() throws NamingException
{    factory = new JndiLdapContextFactory();        String brokenHost = UUID.randomUUID().toString();    factory.setUrl("ldap://" + brokenHost + ":389");    factory.getLdapContext((Object) "foo", "bar");}
public void shiro_f1442_0()
{    String mech = "MD5-DIGEST";    factory.setAuthenticationMechanism(mech);    assertEquals(mech, factory.getAuthenticationMechanism());}
public void shiro_f1443_0()
{    String referral = "throw";    factory.setReferral(referral);    assertEquals(referral, factory.getReferral());}
public void shiro_f1444_0()
{    assertEquals(JndiLdapContextFactory.DEFAULT_CONTEXT_FACTORY_CLASS_NAME, factory.getContextFactoryClassName());}
public void shiro_f1445_0()
{    factory.setAuthenticationMechanism("MD5-DIGEST");    factory.setAuthenticationMechanism(null);    assertNull(factory.getAuthenticationMechanism());}
public void shiro_f1446_0()
{    Map<String, String> map = new HashMap<String, String>();    map.put("foo", "bar");    factory.setEnvironment(map);    assertEquals("bar", factory.getEnvironment().get("foo"));}
public void shiro_f1447_0() throws NamingException
{    factory.getLdapContext((Object) "foo", "bar");}
public void shiro_f1448_0() throws NamingException
{    factory = new JndiLdapContextFactory() {        @Override        protected LdapContext createLdapContext(Hashtable env) throws NamingException {            assertEquals("ldap://localhost:389", env.get(Context.PROVIDER_URL));            assertEquals("foo", env.get(Context.SECURITY_PRINCIPAL));            assertEquals("bar", env.get(Context.SECURITY_CREDENTIALS));            assertEquals("simple", env.get(Context.SECURITY_AUTHENTICATION));            assertNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));            return createNiceMock(LdapContext.class);        }    };    factory.setUrl("ldap://localhost:389");    factory.getLdapContext((Object) "foo", "bar");}
protected LdapContext shiro_f1449_0(Hashtable env) throws NamingException
{    assertEquals("ldap://localhost:389", env.get(Context.PROVIDER_URL));    assertEquals("foo", env.get(Context.SECURITY_PRINCIPAL));    assertEquals("bar", env.get(Context.SECURITY_CREDENTIALS));    assertEquals("simple", env.get(Context.SECURITY_AUTHENTICATION));    assertNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));    return createNiceMock(LdapContext.class);}
public void shiro_f1450_0() throws NamingException
{    factory = new JndiLdapContextFactory() {        @Override        protected LdapContext createLdapContext(Hashtable env) throws NamingException {            assertEquals("ldap://localhost:389", env.get(Context.PROVIDER_URL));            assertEquals("foo", env.get(Context.SECURITY_PRINCIPAL));            assertEquals("bar", env.get(Context.SECURITY_CREDENTIALS));            assertEquals("simple", env.get(Context.SECURITY_AUTHENTICATION));            assertNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));            return createNiceMock(LdapContext.class);        }    };    factory.setUrl("ldap://localhost:389");    factory.getLdapContext("foo", "bar");}
protected LdapContext shiro_f1451_0(Hashtable env) throws NamingException
{    assertEquals("ldap://localhost:389", env.get(Context.PROVIDER_URL));    assertEquals("foo", env.get(Context.SECURITY_PRINCIPAL));    assertEquals("bar", env.get(Context.SECURITY_CREDENTIALS));    assertEquals("simple", env.get(Context.SECURITY_AUTHENTICATION));    assertNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));    return createNiceMock(LdapContext.class);}
public void shiro_f1452_0() throws NamingException
{    factory = new JndiLdapContextFactory() {        @Override        protected LdapContext createLdapContext(Hashtable env) throws NamingException {            assertEquals("ldap://localhost:389", env.get(Context.PROVIDER_URL));            assertEquals("foo", env.get(Context.SECURITY_PRINCIPAL));            assertEquals("bar", env.get(Context.SECURITY_CREDENTIALS));            assertEquals("simple", env.get(Context.SECURITY_AUTHENTICATION));            assertNotNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));            return createNiceMock(LdapContext.class);        }    };    factory.setSystemUsername("foo");    factory.setSystemPassword("bar");    factory.setUrl("ldap://localhost:389");    factory.getSystemLdapContext();}
protected LdapContext shiro_f1453_0(Hashtable env) throws NamingException
{    assertEquals("ldap://localhost:389", env.get(Context.PROVIDER_URL));    assertEquals("foo", env.get(Context.SECURITY_PRINCIPAL));    assertEquals("bar", env.get(Context.SECURITY_CREDENTIALS));    assertEquals("simple", env.get(Context.SECURITY_AUTHENTICATION));    assertNotNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));    return createNiceMock(LdapContext.class);}
public void shiro_f1454_0() throws NamingException
{    factory = new JndiLdapContextFactory() {        @Override        protected LdapContext createLdapContext(Hashtable env) throws NamingException {            assertEquals("ldap://localhost:389", env.get(Context.PROVIDER_URL));            assertEquals("foo", env.get(Context.SECURITY_PRINCIPAL));            assertEquals("bar", env.get(Context.SECURITY_CREDENTIALS));            assertEquals("simple", env.get(Context.SECURITY_AUTHENTICATION));            assertNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));            return createNiceMock(LdapContext.class);        }    };    factory.setSystemUsername("foo");    factory.setSystemPassword("bar");    factory.setPoolingEnabled(false);    factory.setUrl("ldap://localhost:389");    factory.getSystemLdapContext();}
protected LdapContext shiro_f1455_0(Hashtable env) throws NamingException
{    assertEquals("ldap://localhost:389", env.get(Context.PROVIDER_URL));    assertEquals("foo", env.get(Context.SECURITY_PRINCIPAL));    assertEquals("bar", env.get(Context.SECURITY_CREDENTIALS));    assertEquals("simple", env.get(Context.SECURITY_AUTHENTICATION));    assertNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));    return createNiceMock(LdapContext.class);}
public void shiro_f1456_0() throws NamingException
{    factory.setUrl("ldap://localhost:389");    factory.getLdapContext((Object) "jcoder", "");}
public void shiro_f1457_0() throws NamingException
{    factory.setUrl("ldap://localhost:389");    factory.getLdapContext((Object) "jcoder", new char[0]);}
public void shiro_f1458_0() throws NamingException
{    factory.setUrl("ldap://localhost:389");    factory.getLdapContext((Object) "jcoder", new byte[0]);}
public void shiro_f1459_0() throws NamingException
{    factory.setUrl("ldap://localhost:389");    factory.getLdapContext((Object) "jcoder", null);}
protected DefaultLdapRealm shiro_f1460_0()
{    return new JndiLdapRealm();}
public void shiro_f1461_0()
{    JndiLdapRealm realm = new JndiLdapRealm() {        @Override        protected String getUserDnPrefix() {            return null;        }        @Override        protected String getUserDnSuffix() {            return null;        }    };    String principal = "foo";    String userDn = realm.getUserDn(principal);    assertEquals(principal, userDn);}
protected String shiro_f1462_0()
{    return null;}
protected String shiro_f1463_0()
{    return null;}
public void shiro_f1464_0()
{    IniRealm realm = new IniRealm((Ini) null);}
public void shiro_f1465_0()
{    new IniRealm(new Ini());}
public void shiro_f1466_0()
{    new IniRealm().init();}
public void shiro_f1467_0()
{    IniRealm realm = new IniRealm();    realm.setResourcePath("classpath:org/apache/shiro/realm/text/IniRealmTest.simple.ini");    realm.init();    assertTrue(realm.roleExists("admin"));    UsernamePasswordToken token = new UsernamePasswordToken("user1", "user1");    AuthenticationInfo info = realm.getAuthenticationInfo(token);    assertNotNull(info);    assertTrue(realm.hasRole(info.getPrincipals(), "admin"));}
public void shiro_f1468_0()
{    IniRealm realm = new IniRealm();    realm.setResourcePath("classpath:org/apache/shiro/realm/text/IniRealmTest.noUsers.ini");    realm.init();    assertTrue(realm.roleExists("admin"));}
private void shiro_f1469_0()
{    StringBuilder roleDefinitions = new StringBuilder().append("role1 = role1_permission1\n").append("role2 = role2_persission1, role2_permission2\n");    realm.setRoleDefinitions(roleDefinitions.toString());}
private void shiro_f1470_0()
{    StringBuilder userDefinitions = new StringBuilder();    for (int i = 1; i < 3; i++) {        userDefinitions.append(String.format("user%1$d = user%1$d_password, role1, role2%n", i));    }    realm.setUserDefinitions(userDefinitions.toString());}
private void shiro_f1471_0()
{    realm = new TestRealm() {        /*             * Demonstrates that a lock can't be obtained on the realm by a read thread until after             * the lock is released.             */        public void test(Thread runnable) throws InterruptedException {                        USERS_LOCK.writeLock().lock();            try {                ROLES_LOCK.writeLock().lock();                try {                                        runnable.start();                    Thread.sleep(500);                                        realm.onInit();                } finally {                    ROLES_LOCK.writeLock().unlock();                }            } finally {                USERS_LOCK.writeLock().unlock();            }        }    };    setRoles();    setUsers();}
public void shiro_f1472_0(Thread runnable) throws InterruptedException
{        USERS_LOCK.writeLock().lock();    try {        ROLES_LOCK.writeLock().lock();        try {                        runnable.start();            Thread.sleep(500);                        realm.onInit();        } finally {            ROLES_LOCK.writeLock().unlock();        }    } finally {        USERS_LOCK.writeLock().unlock();    }}
private void shiro_f1473_0(Runnable runnable) throws InterruptedException
{    TestThread testThread = new TestThread(runnable);    Thread testTask = new Thread(testThread);    realm.test(testTask);    testTask.join(500);        testThread.test();}
public void shiro_f1474_0() throws InterruptedException
{    setUpForReadConfigurationTest();    executeTest(new Runnable() {        public void run() {            assertTrue("role not found when it was expected", realm.roleExists("role1"));            assertTrue("user not found when it was expected", realm.accountExists("user1"));        }    });}
public void shiro_f1475_0()
{    assertTrue("role not found when it was expected", realm.roleExists("role1"));    assertTrue("user not found when it was expected", realm.accountExists("user1"));}
public void shiro_f1476_0() throws InterruptedException
{    setUpForReadConfigurationTest();    executeTest(new Runnable() {        public void run() {            PrincipalCollection principalCollection = new SimplePrincipalCollection("user1", "realm1");            assertTrue("principal doesn't have role when it should", realm.hasRole(principalCollection, "role2"));            assertTrue("principal doesn't have all roles when it should", realm.hasAllRoles(principalCollection, Arrays.asList(new String[] { "role1", "role2" })));        }    });}
public void shiro_f1477_0()
{    PrincipalCollection principalCollection = new SimplePrincipalCollection("user1", "realm1");    assertTrue("principal doesn't have role when it should", realm.hasRole(principalCollection, "role2"));    assertTrue("principal doesn't have all roles when it should", realm.hasAllRoles(principalCollection, Arrays.asList(new String[] { "role1", "role2" })));}
public void shiro_f1478_0() throws InterruptedException
{    setUpForReadConfigurationTest();    executeTest(new Runnable() {        public void run() {            PrincipalCollection principalCollection = new SimplePrincipalCollection("user1", "realm1");            try {                realm.checkRoles(principalCollection, new String[] { "role1", "role2" });            } catch (AuthorizationException ae) {                fail("principal doesn't have all roles when it should");            }        }    });}
public void shiro_f1479_0()
{    PrincipalCollection principalCollection = new SimplePrincipalCollection("user1", "realm1");    try {        realm.checkRoles(principalCollection, new String[] { "role1", "role2" });    } catch (AuthorizationException ae) {        fail("principal doesn't have all roles when it should");    }}
public void shiro_f1480_0() throws InterruptedException
{    setUpForReadConfigurationTest();    executeTest(new Runnable() {        public void run() {            PrincipalCollection principalCollection = new SimplePrincipalCollection("user1", "realm1");            try {                realm.checkPermission(principalCollection, "role1_permission1");                realm.checkPermissions(principalCollection, new String[] { "role1_permission1", "role2_permission2" });            } catch (AuthorizationException ae) {                fail("principal doesn't have permission when it should");            }        }    });}
public void shiro_f1481_0()
{    PrincipalCollection principalCollection = new SimplePrincipalCollection("user1", "realm1");    try {        realm.checkPermission(principalCollection, "role1_permission1");        realm.checkPermissions(principalCollection, new String[] { "role1_permission1", "role2_permission2" });    } catch (AuthorizationException ae) {        fail("principal doesn't have permission when it should");    }}
public void shiro_f1482_0() throws InterruptedException
{    setUpForReadConfigurationTest();    executeTest(new Runnable() {        public void run() {            PrincipalCollection principalCollection = new SimplePrincipalCollection("user1", "realm1");            assertTrue("permission not permitted when it should be", realm.isPermitted(principalCollection, "role1_permission1"));            assertTrue("permission not permitted when it should be", realm.isPermittedAll(principalCollection, new String[] { "role1_permission1", "role2_permission2" }));        }    });}
public void shiro_f1483_0()
{    PrincipalCollection principalCollection = new SimplePrincipalCollection("user1", "realm1");    assertTrue("permission not permitted when it should be", realm.isPermitted(principalCollection, "role1_permission1"));    assertTrue("permission not permitted when it should be", realm.isPermittedAll(principalCollection, new String[] { "role1_permission1", "role2_permission2" }));}
public void shiro_f1484_0() throws InterruptedException
{    realm = new TestRealm() {        public void test(Thread runnable) throws InterruptedException {                                    ROLES_LOCK.writeLock().lock();            try {                runnable.start();                Thread.sleep(500);                                assertFalse("role exists when it shouldn't", realm.roleExists("role1"));            } finally {                ROLES_LOCK.writeLock().unlock();            }        }    };        TestThread testThread = new TestThread(new Runnable() {        public void run() {            try {                realm.processRoleDefinitions();            } catch (ParseException e) {                fail("Unable to parse role definitions");            }        }    });    setRoles();    Thread testTask = new Thread(testThread);    realm.test(testTask);    testTask.join(500);    assertTrue("role doesn't exist when it should", realm.roleExists("role1"));    testThread.test();}
public void shiro_f1485_0(Thread runnable) throws InterruptedException
{            ROLES_LOCK.writeLock().lock();    try {        runnable.start();        Thread.sleep(500);                assertFalse("role exists when it shouldn't", realm.roleExists("role1"));    } finally {        ROLES_LOCK.writeLock().unlock();    }}
public void shiro_f1486_0()
{    try {        realm.processRoleDefinitions();    } catch (ParseException e) {        fail("Unable to parse role definitions");    }}
public void shiro_f1487_0() throws InterruptedException
{    realm = new TestRealm() {        public void test(Thread runnable) throws InterruptedException {                                    USERS_LOCK.writeLock().lock();            try {                runnable.start();                Thread.sleep(500);                                assertFalse("account exists when it shouldn't", realm.accountExists("user1"));            } finally {                USERS_LOCK.writeLock().unlock();            }        }    };    TestThread testThread = new TestThread(new Runnable() {        public void run() {            try {                realm.processUserDefinitions();            } catch (ParseException e) {                fail("Unable to parse user definitions");            }        }    });    setUsers();    Thread testTask = new Thread(testThread);    realm.test(testTask);    testTask.join(500);    assertTrue("account doesn't exist when it should", realm.accountExists("user1"));    testThread.test();}
public void shiro_f1488_0(Thread runnable) throws InterruptedException
{            USERS_LOCK.writeLock().lock();    try {        runnable.start();        Thread.sleep(500);                assertFalse("account exists when it shouldn't", realm.accountExists("user1"));    } finally {        USERS_LOCK.writeLock().unlock();    }}
public void shiro_f1489_0()
{    try {        realm.processUserDefinitions();    } catch (ParseException e) {        fail("Unable to parse user definitions");    }}
public void shiro_f1490_0()
{    try {        test.run();    } catch (AssertionError ae) {        this.ae = ae;    }}
public void shiro_f1491_0()
{    if (ae != null)        throw ae;}
public int shiro_f1492_0()
{    return userId;}
public String shiro_f1493_0()
{    return String.valueOf(userId);}
public String shiro_f1494_0()
{    return username;}
public String shiro_f1495_0()
{    return String.valueOf(username);}
public void shiro_f1496_0()
{    final SimpleSession validSession = new SimpleSession();    validSession.setId(1);    final SimpleSession invalidSession = new SimpleSession();        Calendar cal = Calendar.getInstance();    Long expiredTimeout = AbstractSessionManager.DEFAULT_GLOBAL_SESSION_TIMEOUT + 1;    cal.add(Calendar.MILLISECOND, -(expiredTimeout.intValue()));    Date past = cal.getTime();    invalidSession.setStartTimestamp(past);    invalidSession.setLastAccessTime(past);    invalidSession.setId(2);    final AtomicInteger expirationCount = new AtomicInteger();    SessionListener sessionListener = new SessionListenerAdapter() {        @Override        public void onExpiration(Session session) {            expirationCount.incrementAndGet();        }    };    AbstractValidatingSessionManager sessionManager = new AbstractValidatingSessionManager() {        @Override        protected Session retrieveSession(SessionKey key) throws UnknownSessionException {            throw new UnsupportedOperationException("Should not be called in this test.");        }        @Override        protected Session doCreateSession(SessionContext initData) throws AuthorizationException {            throw new UnsupportedOperationException("Should not be called in this test.");        }        @Override        protected Collection<Session> getActiveSessions() {            Collection<Session> sessions = new ArrayList<Session>(2);            sessions.add(validSession);            sessions.add(invalidSession);            return sessions;        }    };    sessionManager.setSessionListeners(Arrays.asList(sessionListener));    sessionManager.validateSessions();    assertEquals(1, expirationCount.intValue());}
public void shiro_f1497_0(Session session)
{    expirationCount.incrementAndGet();}
protected Session shiro_f1498_0(SessionKey key) throws UnknownSessionException
{    throw new UnsupportedOperationException("Should not be called in this test.");}
protected Session shiro_f1499_0(SessionContext initData) throws AuthorizationException
{    throw new UnsupportedOperationException("Should not be called in this test.");}
protected Collection<Session> shiro_f1500_0()
{    Collection<Session> sessions = new ArrayList<Session>(2);    sessions.add(validSession);    sessions.add(invalidSession);    return sessions;}
public void shiro_f1501_0() throws Exception
{    SessionListener sessionListener = new SessionListener() {        public void onStart(Session session) {            session.setAttribute("I love", "Romania");        }        public void onStop(Session session) {            tryToCleanSession(session);        }        public void onExpiration(Session session) {            tryToCleanSession(session);        }        private void tryToCleanSession(Session session) {            Collection<Object> keys = session.getAttributeKeys();            for (Object key : keys) {                session.removeAttribute(key);            }        }    };    DefaultSessionManager sessionManager = new DefaultSessionManager();    sessionManager.setSessionListeners(Arrays.asList(sessionListener));    Session session = sessionManager.start(null);    assertEquals(1, sessionManager.getActiveSessions().size());    session.setTimeout(0L);        Thread.sleep(1);    sessionManager.validateSessions();    assertEquals(0, sessionManager.getActiveSessions().size());}
public void shiro_f1502_0(Session session)
{    session.setAttribute("I love", "Romania");}
public void shiro_f1503_0(Session session)
{    tryToCleanSession(session);}
public void shiro_f1504_0(Session session)
{    tryToCleanSession(session);}
private void shiro_f1505_0(Session session)
{    Collection<Object> keys = session.getAttributeKeys();    for (Object key : keys) {        session.removeAttribute(key);    }}
public void shiro_f1506_0()
{    ThreadContext.remove();    sm = new DefaultSessionManager();}
public void shiro_f1507_0()
{    sm.destroy();    ThreadContext.remove();}
public void shiro_f1508_0(long millis)
{    try {        Thread.sleep(millis);    } catch (InterruptedException e) {        throw new IllegalStateException(e);    }}
public void shiro_f1509_0()
{    long timeout = 1000;    sm.setGlobalSessionTimeout(timeout);    Session session = sm.start(null);    assertNotNull(session);    assertNotNull(session.getId());    assertEquals(session.getTimeout(), timeout);}
public void shiro_f1510_0()
{    final boolean[] started = new boolean[1];    SessionListener listener = new SessionListenerAdapter() {        public void onStart(Session session) {            started[0] = true;        }    };    sm.getSessionListeners().add(listener);    sm.start(null);    assertTrue(started[0]);}
public void shiro_f1511_0(Session session)
{    started[0] = true;}
public void shiro_f1512_0()
{    final boolean[] stopped = new boolean[1];    SessionListener listener = new SessionListenerAdapter() {        public void onStop(Session session) {            stopped[0] = true;        }    };    sm.getSessionListeners().add(listener);    Session session = sm.start(null);    sm.stop(new DefaultSessionKey(session.getId()));    assertTrue(stopped[0]);}
public void shiro_f1513_0(Session session)
{    stopped[0] = true;}
public void shiro_f1514_0()
{    final boolean[] stopped = new boolean[1];    final String[] value = new String[1];    SessionListener listener = new SessionListenerAdapter() {        public void onStop(Session session) {            stopped[0] = true;            value[0] = (String) session.getAttribute("foo");        }    };    sm.getSessionListeners().add(listener);    Session session = sm.start(null);    session.setAttribute("foo", "bar");    sm.stop(new DefaultSessionKey(session.getId()));    assertTrue(stopped[0]);    assertEquals("bar", value[0]);}
public void shiro_f1515_0(Session session)
{    stopped[0] = true;    value[0] = (String) session.getAttribute("foo");}
public void shiro_f1516_0()
{    final boolean[] expired = new boolean[1];    SessionListener listener = new SessionListenerAdapter() {        public void onExpiration(Session session) {            expired[0] = true;        }    };    sm.getSessionListeners().add(listener);    sm.setGlobalSessionTimeout(100);    Session session = sm.start(null);    sleep(150);    try {        sm.checkValid(new DefaultSessionKey(session.getId()));        fail("check should have thrown an exception.");    } catch (InvalidSessionException expected) {        }    assertTrue(expired[0]);}
public void shiro_f1517_0(Session session)
{    expired[0] = true;}
public void shiro_f1518_0()
{    sm.setGlobalSessionTimeout(100);    SessionDAO sessionDAO = createMock(SessionDAO.class);    sm.setSessionDAO(sessionDAO);    String sessionId1 = UUID.randomUUID().toString();    final SimpleSession session1 = new SimpleSession();    session1.setId(sessionId1);    final Session[] activeSession = new SimpleSession[] { session1 };    sm.setSessionFactory(new SessionFactory() {        public Session createSession(SessionContext initData) {            return activeSession[0];        }    });    expect(sessionDAO.create(eq(session1))).andReturn(sessionId1);    sessionDAO.update(eq(session1));    expectLastCall().anyTimes();    replay(sessionDAO);    Session session = sm.start(null);    assertNotNull(session);    verify(sessionDAO);    reset(sessionDAO);    expect(sessionDAO.readSession(sessionId1)).andReturn(session1).anyTimes();    sessionDAO.update(eq(session1));    replay(sessionDAO);    sm.setTimeout(new DefaultSessionKey(sessionId1), 1);    verify(sessionDAO);    reset(sessionDAO);    sleep(20);    expect(sessionDAO.readSession(sessionId1)).andReturn(session1);        sessionDAO.update(eq(session1));    sessionDAO.delete(session1);    replay(sessionDAO);        try {        sm.getTimeout(new DefaultSessionKey(sessionId1));        fail("Session with id [" + sessionId1 + "] should have expired due to timeout.");    } catch (ExpiredSessionException expected) {        }        verify(sessionDAO);}
public Session shiro_f1519_0(SessionContext initData)
{    return activeSession[0];}
public void shiro_f1520_0()
{            ExecutorServiceSessionValidationScheduler sessionValidationScheduler = new ExecutorServiceSessionValidationScheduler();    DefaultSessionManager sessionManager = new DefaultSessionManager();    sessionManager.setSessionValidationScheduler(sessionValidationScheduler);        try {        Session session = sessionManager.start(null);                assertTrue("sessionValidationScheduler was not enabled", sessionValidationScheduler.isEnabled());    } finally {                sessionManager.destroy();    }}
public static T shiro_f1521_0(long timeout)
{    EasyMock.reportMatcher(new SessionTimeoutMatcher(timeout));    return null;}
public void shiro_f1522_0(StringBuffer buffer)
{    buffer.append("eqSession(timeout=").append(this.timeout).append(")");}
public boolean shiro_f1523_0(Object o)
{    return o instanceof Session && ((Session) o).getTimeout() == this.timeout;}
public void shiro_f1524_0()
{    ThreadContext.remove();    sm = new DefaultSessionManager();    this.session = new DelegatingSession(sm, new DefaultSessionKey(sm.start(null).getId()));}
public void shiro_f1525_0()
{    sm.destroy();    ThreadContext.remove();}
public void shiro_f1526_0(long millis)
{    try {        Thread.sleep(millis);    } catch (InterruptedException e) {        throw new IllegalStateException(e);    }}
public void shiro_f1527_0()
{    Serializable origId = session.getId();    assertEquals(session.getTimeout(), AbstractSessionManager.DEFAULT_GLOBAL_SESSION_TIMEOUT);    session.touch();    session.setTimeout(100);    assertEquals(100, session.getTimeout());    sleep(150);    try {        session.getTimeout();        fail("Session should have expired.");    } catch (ExpiredSessionException expected) {    }}
public void shiro_f1528_0() throws Exception
{    SimpleSession session = new SimpleSession();    long timeout = session.getTimeout();    Date start = session.getStartTimestamp();    Date lastAccess = session.getLastAccessTime();    SimpleSession deserialized = serializeAndDeserialize(session);    assertEquals(timeout, deserialized.getTimeout());    assertEquals(start, deserialized.getStartTimestamp());    assertEquals(lastAccess, deserialized.getLastAccessTime());}
public void shiro_f1529_0() throws IOException, ClassNotFoundException
{    SimpleSession session = new SimpleSession("localhost");    assertEquals("localhost", serializeAndDeserialize(session).getHost());}
public void shiro_f1530_0() throws IOException, ClassNotFoundException
{    SimpleSession session = new SimpleSession();    session.setExpired(true);    assertTrue(serializeAndDeserialize(session).isExpired());}
private SimpleSession shiro_f1531_0(SimpleSession session) throws IOException, ClassNotFoundException
{    ByteArrayOutputStream serialized = new ByteArrayOutputStream();    ObjectOutputStream serializer = new ObjectOutputStream(serialized);    serializer.writeObject(session);    serializer.close();    return (SimpleSession) new ObjectInputStream(new ByteArrayInputStream(serialized.toByteArray())).readObject();}
public void shiro_f1532_0()
{    ThreadContext.remove();}
public void shiro_f1533_0()
{    ThreadContext.remove();}
public void shiro_f1534_0()
{    String key = "testKey";    String value = "testValue";    DefaultSecurityManager sm = new DefaultSecurityManager();    DelegatingSubject subject = new DelegatingSubject(sm);    Session session = subject.getSession();    session.setAttribute(key, value);    assertTrue(session.getAttribute(key).equals(value));    Serializable firstSessionId = session.getId();    assertNotNull(firstSessionId);    session.stop();    session = subject.getSession();    assertNotNull(session);    assertNull(session.getAttribute(key));    Serializable secondSessionId = session.getId();    assertNotNull(secondSessionId);    assertFalse(firstSessionId.equals(secondSessionId));    subject.logout();    sm.destroy();}
public void shiro_f1535_0()
{    String username = "jsmith";    SecurityManager securityManager = createNiceMock(SecurityManager.class);    PrincipalCollection identity = new SimplePrincipalCollection(username, "testRealm");    final Subject sourceSubject = new DelegatingSubject(identity, true, null, null, securityManager);    assertNull(ThreadContext.getSubject());    assertNull(ThreadContext.getSecurityManager());    Callable<String> callable = new Callable<String>() {        public String call() throws Exception {            Subject callingSubject = SecurityUtils.getSubject();            assertNotNull(callingSubject);            assertNotNull(SecurityUtils.getSecurityManager());            assertEquals(callingSubject, sourceSubject);            return "Hello " + callingSubject.getPrincipal();        }    };    String response = sourceSubject.execute(callable);    assertNotNull(response);    assertEquals("Hello " + username, response);    assertNull(ThreadContext.getSubject());    assertNull(ThreadContext.getSecurityManager());}
public String shiro_f1536_0() throws Exception
{    Subject callingSubject = SecurityUtils.getSubject();    assertNotNull(callingSubject);    assertNotNull(SecurityUtils.getSecurityManager());    assertEquals(callingSubject, sourceSubject);    return "Hello " + callingSubject.getPrincipal();}
public void shiro_f1537_0()
{    String username = "jsmith";    SecurityManager securityManager = createNiceMock(SecurityManager.class);    PrincipalCollection identity = new SimplePrincipalCollection(username, "testRealm");    final Subject sourceSubject = new DelegatingSubject(identity, true, null, null, securityManager);    assertNull(ThreadContext.getSubject());    assertNull(ThreadContext.getSecurityManager());    Runnable runnable = new Runnable() {        public void run() {            Subject callingSubject = SecurityUtils.getSubject();            assertNotNull(callingSubject);            assertNotNull(SecurityUtils.getSecurityManager());            assertEquals(callingSubject, sourceSubject);        }    };    sourceSubject.execute(runnable);    assertNull(ThreadContext.getSubject());    assertNull(ThreadContext.getSecurityManager());}
public void shiro_f1538_0()
{    Subject callingSubject = SecurityUtils.getSubject();    assertNotNull(callingSubject);    assertNotNull(SecurityUtils.getSecurityManager());    assertEquals(callingSubject, sourceSubject);}
public void shiro_f1539_0()
{    Ini ini = new Ini();    Ini.Section users = ini.addSection("users");    users.put("user1", "user1,role1");    users.put("user2", "user2,role2");    users.put("user3", "user3,role3");    IniSecurityManagerFactory factory = new IniSecurityManagerFactory(ini);    SecurityManager sm = factory.getInstance();        Subject subject = new Subject.Builder(sm).buildSubject();    subject.login(new UsernamePasswordToken("user1", "user1"));    assertFalse(subject.isRunAs());    assertEquals("user1", subject.getPrincipal());    assertTrue(subject.hasRole("role1"));    assertFalse(subject.hasRole("role2"));    assertFalse(subject.hasRole("role3"));        assertNull(subject.getPreviousPrincipals());        subject.runAs(new SimplePrincipalCollection("user2", IniSecurityManagerFactory.INI_REALM_NAME));    assertTrue(subject.isRunAs());    assertEquals("user2", subject.getPrincipal());    assertTrue(subject.hasRole("role2"));    assertFalse(subject.hasRole("role1"));    assertFalse(subject.hasRole("role3"));        PrincipalCollection previous = subject.getPreviousPrincipals();    assertFalse(previous == null || previous.isEmpty());    assertTrue(previous.getPrimaryPrincipal().equals("user1"));        subject.runAs(new SimplePrincipalCollection("user3", IniSecurityManagerFactory.INI_REALM_NAME));    assertTrue(subject.isRunAs());    assertEquals("user3", subject.getPrincipal());    assertTrue(subject.hasRole("role3"));    assertFalse(subject.hasRole("role1"));    assertFalse(subject.hasRole("role2"));        previous = subject.getPreviousPrincipals();    assertFalse(previous == null || previous.isEmpty());    assertTrue(previous.getPrimaryPrincipal().equals("user2"));        subject.releaseRunAs();        assertTrue(subject.isRunAs());    assertEquals("user2", subject.getPrincipal());    assertTrue(subject.hasRole("role2"));    assertFalse(subject.hasRole("role1"));    assertFalse(subject.hasRole("role3"));        previous = subject.getPreviousPrincipals();    assertFalse(previous == null || previous.isEmpty());    assertTrue(previous.getPrimaryPrincipal().equals("user1"));        subject.releaseRunAs();        assertFalse(subject.isRunAs());    assertEquals("user1", subject.getPrincipal());    assertTrue(subject.hasRole("role1"));    assertFalse(subject.hasRole("role2"));    assertFalse(subject.hasRole("role3"));        assertNull(subject.getPreviousPrincipals());    subject.logout();    LifecycleUtils.destroy(sm);}
public void shiro_f1540_0()
{    SimplePrincipalCollection principalCollection = new SimplePrincipalCollection();    principalCollection.add("frank", "realm1");    principalCollection.add("johnny", "realm1");    principalCollection.add("Alberto", "realm2");    PrincipalCollection underTest = principalCollection;        System.out.println(principalCollection);}
protected void shiro_f1541_0(Subject subject)
{    clearSubject();    subjectThreadState = createThreadState(subject);    subjectThreadState.bind();}
protected Subject shiro_f1542_0()
{    return SecurityUtils.getSubject();}
protected ThreadState shiro_f1543_0(Subject subject)
{    return new SubjectThreadState(subject);}
protected void shiro_f1544_0()
{    doClearSubject();}
private static void shiro_f1545_0()
{    if (subjectThreadState != null) {        subjectThreadState.clear();        subjectThreadState = null;    }}
protected static void shiro_f1546_0(SecurityManager securityManager)
{    SecurityUtils.setSecurityManager(securityManager);}
protected static SecurityManager shiro_f1547_0()
{    return SecurityUtils.getSecurityManager();}
public static void shiro_f1548_0()
{    doClearSubject();    try {        SecurityManager securityManager = getSecurityManager();        LifecycleUtils.destroy(securityManager);    } catch (UnavailableSecurityManagerException e) {                }    setSecurityManager(null);}
public static void shiro_f1549_0()
{                Factory<SecurityManager> factory = new IniSecurityManagerFactory("classpath:test.shiro.ini");    setSecurityManager(factory.getInstance());}
public void shiro_f1550_0()
{        Subject subjectUnderTest = new Subject.Builder(getSecurityManager()).buildSubject();        setSubject(subjectUnderTest);}
public void shiro_f1551_0()
{        clearSubject();}
public void shiro_f1552_0()
{            Subject subjectUnderTest = createNiceMock(Subject.class);    expect(subjectUnderTest.isAuthenticated()).andReturn(true);        setSubject(subjectUnderTest);}
public void shiro_f1553_0()
{        clearSubject();}
protected static SecurityManager shiro_f1554_0()
{    Ini ini = new Ini();    ini.setSectionProperty("users", "test", "test");    return new DefaultSecurityManager(new IniRealm(ini));}
protected void shiro_f1555_0(SecurityManager sm)
{    LifecycleUtils.destroy(sm);}
protected SecurityManager shiro_f1556_0()
{    SecurityManager sm = createTestSecurityManager();    ThreadContext.bind(sm);    return sm;}
protected Subject shiro_f1557_0()
{    SecurityManager sm = ThreadContext.getSecurityManager();    if (sm == null) {        createAndBindTestSecurityManager();    }    return SecurityUtils.getSubject();}
public void shiro_f1558_0()
{    createAndBindTestSubject();}
public void shiro_f1559_0()
{    ThreadContext.remove();}
public void shiro_f1560_0()
{    PatternMatcher pm = new RegExPatternMatcher();    String pattern = "a*b";    String test = "aaaaaaab";        Pattern.compile(pattern);    assertTrue(pm.matches(pattern, test));}
public void shiro_f1561_0()
{    String line = null;    String[] split = StringUtils.split(line);    assertNull(split);}
public void shiro_f1562_0()
{    String line = "shall,we,play,a,game?";    String[] split = StringUtils.split(line);    assertNotNull(split);    assertTrue(split.length == 5);    assertEquals("shall", split[0]);    assertEquals("we", split[1]);    assertEquals("play", split[2]);    assertEquals("a", split[3]);    assertEquals("game?", split[4]);}
public void shiro_f1563_0()
{    String line = "shall,we ,    play, a,game?";    String[] split = StringUtils.split(line);    assertNotNull(split);    assertTrue(split.length == 5);    assertEquals("shall", split[0]);    assertEquals("we", split[1]);    assertEquals("play", split[2]);    assertEquals("a", split[3]);    assertEquals("game?", split[4]);}
public void shiro_f1564_0()
{    String line = "shall, \"we, play\", a, game?";    String[] split = StringUtils.split(line);    assertNotNull(split);    assertTrue(split.length == 4);    assertEquals("shall", split[0]);    assertEquals("we, play", split[1]);    assertEquals("a", split[2]);    assertEquals("game?", split[3]);}
public void shiro_f1565_0()
{    String line = "authc, test[blah], test[1,2,3], test[]";    String[] split = StringUtils.split(line, ',', '[', ']', false, true);    assertNotNull(split);    assertTrue(split.length == 4);    assertEquals("authc", split[0]);    assertEquals("testblah", split[1]);    assertEquals("test1,2,3", split[2]);    assertEquals("test", split[3]);}
public void shiro_f1566_0()
{    String line = "authc, test[blah], test[1,2,3], test[]";    String[] split = StringUtils.split(line, ',', '[', ']', true, true);    assertNotNull(split);    assertTrue(split.length == 4);    assertEquals("authc", split[0]);    assertEquals("test[blah]", split[1]);    assertEquals("test[1,2,3]", split[2]);    assertEquals("test[]", split[3]);}
public void shiro_f1567_0()
{    String line = "authc, test[blah], test[\"1,2,3\"], test[]";    String[] split = StringUtils.split(line);    assertNotNull(split);    assertTrue(split.length == 4);    assertEquals("authc", split[0]);    assertEquals("test[blah]", split[1]);    assertEquals("test[1,2,3]", split[2]);    assertEquals("test[]", split[3]);}
public void shiro_f1568_0()
{    String line = "shall, \"\"\"we, play\", a, \"\"\"game?";    String[] split = StringUtils.split(line);    assertNotNull(split);    assertTrue(split.length == 4);    assertEquals("shall", split[0]);    assertEquals("\"we, play", split[1]);    assertEquals("a", split[2]);    assertEquals("\"game?", split[3]);}
public Key shiro_f1569_0()
{    return generateNewKey(getKeySize());}
public Key shiro_f1570_0(int keyBitSize)
{    KeyGenerator kg;    try {        kg = KeyGenerator.getInstance(getAlgorithmName());    } catch (NoSuchAlgorithmException e) {        String msg = "Unable to acquire " + getAlgorithmName() + " algorithm.  This is required to function.";        throw new IllegalStateException(msg, e);    }    kg.init(keyBitSize);    return kg.generateKey();}
public String shiro_f1571_0()
{    return modeName;}
public void shiro_f1572_0(String modeName)
{    this.modeName = modeName;        this.transformationString = null;}
public void shiro_f1573_0(OperationMode mode)
{    setModeName(mode.name());}
public String shiro_f1574_0()
{    return paddingSchemeName;}
public void shiro_f1575_0(String paddingSchemeName)
{    this.paddingSchemeName = paddingSchemeName;        this.transformationString = null;}
public void shiro_f1576_0(PaddingScheme paddingScheme)
{    setPaddingSchemeName(paddingScheme.getTransformationName());}
public int shiro_f1577_0()
{    return blockSize;}
public void shiro_f1578_0(int blockSize)
{    this.blockSize = Math.max(DEFAULT_BLOCK_SIZE, blockSize);        this.transformationString = null;}
public String shiro_f1579_0()
{    return streamingModeName;}
private boolean shiro_f1580_0(String modeName)
{    return modeName != null && !modeName.equalsIgnoreCase(OperationMode.ECB.name()) && !modeName.equalsIgnoreCase(OperationMode.NONE.name());}
public void shiro_f1581_0(String streamingModeName)
{    if (!isModeStreamingCompatible(streamingModeName)) {        String msg = "mode [" + streamingModeName + "] is not a valid operation mode for block cipher streaming.";        throw new IllegalArgumentException(msg);    }    this.streamingModeName = streamingModeName;        this.streamingTransformationString = null;}
public void shiro_f1582_0(OperationMode mode)
{    setStreamingModeName(mode.name());}
public String shiro_f1583_0()
{    return streamingPaddingSchemeName;}
public void shiro_f1584_0(String streamingPaddingSchemeName)
{    this.streamingPaddingSchemeName = streamingPaddingSchemeName;        this.streamingTransformationString = null;}
public void shiro_f1585_0(PaddingScheme scheme)
{    setStreamingPaddingSchemeName(scheme.getTransformationName());}
public int shiro_f1586_0()
{    return streamingBlockSize;}
public void shiro_f1587_0(int streamingBlockSize)
{    this.streamingBlockSize = Math.max(DEFAULT_BLOCK_SIZE, streamingBlockSize);        this.streamingTransformationString = null;}
protected String shiro_f1588_0(boolean streaming)
{    if (streaming) {        if (this.streamingTransformationString == null) {            this.streamingTransformationString = buildStreamingTransformationString();        }        return this.streamingTransformationString;    } else {        if (this.transformationString == null) {            this.transformationString = buildTransformationString();        }        return this.transformationString;    }}
private String shiro_f1589_0()
{    return buildTransformationString(getModeName(), getPaddingSchemeName(), getBlockSize());}
private String shiro_f1590_0()
{    return buildTransformationString(getStreamingModeName(), getStreamingPaddingSchemeName(), 0);}
private String shiro_f1591_0(String modeName, String paddingSchemeName, int blockSize)
{    StringBuilder sb = new StringBuilder(getAlgorithmName());    if (StringUtils.hasText(modeName)) {        sb.append(TRANSFORMATION_STRING_DELIMITER).append(modeName);    }    if (blockSize > 0) {        sb.append(blockSize);    }    if (StringUtils.hasText(paddingSchemeName)) {        sb.append(TRANSFORMATION_STRING_DELIMITER).append(paddingSchemeName);    }    return sb.toString();}
private boolean shiro_f1592_0(String modeName)
{    return modeName != null && !modeName.equalsIgnoreCase(OperationMode.ECB.name()) && !modeName.equalsIgnoreCase(OperationMode.NONE.name());}
protected boolean shiro_f1593_0(boolean streaming)
{    return streaming || super.isGenerateInitializationVectors() && isModeInitializationVectorCompatible(getModeName());}
protected byte[] shiro_f1594_0(boolean streaming)
{    if (streaming) {        String streamingModeName = getStreamingModeName();        if (!isModeInitializationVectorCompatible(streamingModeName)) {            String msg = "streamingMode attribute value [" + streamingModeName + "] does not support " + "Initialization Vectors.  Ensure the streamingMode value represents an operation mode " + "that is compatible with initialization vectors.";            throw new IllegalStateException(msg);        }    } else {        String modeName = getModeName();        if (!isModeInitializationVectorCompatible(modeName)) {            String msg = "mode attribute value [" + modeName + "] does not support " + "Initialization Vectors.  Ensure the mode value represents an operation mode " + "that is compatible with initialization vectors.";            throw new IllegalStateException(msg);        }    }    return super.generateInitializationVector(streaming);}
public String shiro_f1595_0()
{    return algorithmName;}
public int shiro_f1596_0()
{    return keySize;}
public void shiro_f1597_0(int keySize)
{    this.keySize = keySize;}
public boolean shiro_f1598_0()
{    return generateInitializationVectors;}
public void shiro_f1599_0(boolean generateInitializationVectors)
{    this.generateInitializationVectors = generateInitializationVectors;}
public int shiro_f1600_0()
{    return initializationVectorSize;}
public void shiro_f1601_0(int initializationVectorSize) throws IllegalArgumentException
{    if (initializationVectorSize % BITS_PER_BYTE != 0) {        String msg = "Initialization vector sizes are specified in bits, but must be a multiple of 8 so they " + "can be easily represented as a byte array.";        throw new IllegalArgumentException(msg);    }    this.initializationVectorSize = initializationVectorSize;}
protected boolean shiro_f1602_0(boolean streaming)
{    return isGenerateInitializationVectors();}
public int shiro_f1603_0()
{    return streamingBufferSize;}
public void shiro_f1604_0(int streamingBufferSize)
{    this.streamingBufferSize = streamingBufferSize;}
public SecureRandom shiro_f1605_0()
{    return secureRandom;}
public void shiro_f1606_0(SecureRandom secureRandom)
{    this.secureRandom = secureRandom;}
protected static SecureRandom shiro_f1607_1()
{    try {        return java.security.SecureRandom.getInstance(RANDOM_NUM_GENERATOR_ALGORITHM_NAME);    } catch (java.security.NoSuchAlgorithmException e) {                return new java.security.SecureRandom();    }}
protected SecureRandom shiro_f1608_0()
{    SecureRandom random = getSecureRandom();    if (random == null) {        random = getDefaultSecureRandom();    }    return random;}
protected String shiro_f1609_0(boolean streaming)
{    return getAlgorithmName();}
protected byte[] shiro_f1610_0(boolean streaming)
{    int size = getInitializationVectorSize();    if (size <= 0) {        String msg = "initializationVectorSize property must be greater than zero.  This number is " + "typically set in the " + CipherService.class.getSimpleName() + " subclass constructor.  " + "Also check your configuration to ensure that if you are setting a value, it is positive.";        throw new IllegalStateException(msg);    }    if (size % BITS_PER_BYTE != 0) {        String msg = "initializationVectorSize property must be a multiple of 8 to represent as a byte array.";        throw new IllegalStateException(msg);    }    int sizeInBytes = size / BITS_PER_BYTE;    byte[] ivBytes = new byte[sizeInBytes];    SecureRandom random = ensureSecureRandom();    random.nextBytes(ivBytes);    return ivBytes;}
public ByteSource shiro_f1611_0(byte[] plaintext, byte[] key)
{    byte[] ivBytes = null;    boolean generate = isGenerateInitializationVectors(false);    if (generate) {        ivBytes = generateInitializationVector(false);        if (ivBytes == null || ivBytes.length == 0) {            throw new IllegalStateException("Initialization vector generation is enabled - generated vector" + "cannot be null or empty.");        }    }    return encrypt(plaintext, key, ivBytes, generate);}
private ByteSource shiro_f1612_0(byte[] plaintext, byte[] key, byte[] iv, boolean prependIv) throws CryptoException
{    final int MODE = javax.crypto.Cipher.ENCRYPT_MODE;    byte[] output;    if (prependIv && iv != null && iv.length > 0) {        byte[] encrypted = crypt(plaintext, key, iv, MODE);        output = new byte[iv.length + encrypted.length];                        System.arraycopy(iv, 0, output, 0, iv.length);                System.arraycopy(encrypted, 0, output, iv.length, encrypted.length);    } else {        output = crypt(plaintext, key, iv, MODE);    }    if (log.isTraceEnabled()) {        log.trace("Incoming plaintext of size " + (plaintext != null ? plaintext.length : 0) + ".  Ciphertext " + "byte array is size " + (output != null ? output.length : 0));    }    return ByteSource.Util.bytes(output);}
public ByteSource shiro_f1613_0(byte[] ciphertext, byte[] key) throws CryptoException
{    byte[] encrypted = ciphertext;        byte[] iv = null;    if (isGenerateInitializationVectors(false)) {        try {                                                                                                int ivSize = getInitializationVectorSize();            int ivByteSize = ivSize / BITS_PER_BYTE;                        iv = new byte[ivByteSize];            System.arraycopy(ciphertext, 0, iv, 0, ivByteSize);                        int encryptedSize = ciphertext.length - ivByteSize;            encrypted = new byte[encryptedSize];            System.arraycopy(ciphertext, ivByteSize, encrypted, 0, encryptedSize);        } catch (Exception e) {            String msg = "Unable to correctly extract the Initialization Vector or ciphertext.";            throw new CryptoException(msg, e);        }    }    return decrypt(encrypted, key, iv);}
private ByteSource shiro_f1614_0(byte[] ciphertext, byte[] key, byte[] iv) throws CryptoException
{    if (log.isTraceEnabled()) {        log.trace("Attempting to decrypt incoming byte array of length " + (ciphertext != null ? ciphertext.length : 0));    }    byte[] decrypted = crypt(ciphertext, key, iv, javax.crypto.Cipher.DECRYPT_MODE);    return decrypted == null ? null : ByteSource.Util.bytes(decrypted);}
private javax.crypto.Cipher shiro_f1615_0(boolean streaming) throws CryptoException
{    String transformationString = getTransformationString(streaming);    try {        return javax.crypto.Cipher.getInstance(transformationString);    } catch (Exception e) {        String msg = "Unable to acquire a Java JCA Cipher instance using " + javax.crypto.Cipher.class.getName() + ".getInstance( \"" + transformationString + "\" ). " + getAlgorithmName() + " under this configuration is required for the " + getClass().getName() + " instance to function.";        throw new CryptoException(msg, e);    }}
private byte[] shiro_f1616_0(byte[] bytes, byte[] key, byte[] iv, int mode) throws IllegalArgumentException, CryptoException
{    if (key == null || key.length == 0) {        throw new IllegalArgumentException("key argument cannot be null or empty.");    }    javax.crypto.Cipher cipher = initNewCipher(mode, key, iv, false);    return crypt(cipher, bytes);}
private byte[] shiro_f1617_0(javax.crypto.Cipher cipher, byte[] bytes) throws CryptoException
{    try {        return cipher.doFinal(bytes);    } catch (Exception e) {        String msg = "Unable to execute 'doFinal' with cipher instance [" + cipher + "].";        throw new CryptoException(msg, e);    }}
private void shiro_f1618_0(javax.crypto.Cipher cipher, int mode, java.security.Key key, AlgorithmParameterSpec spec, SecureRandom random) throws CryptoException
{    try {        if (random != null) {            if (spec != null) {                cipher.init(mode, key, spec, random);            } else {                cipher.init(mode, key, random);            }        } else {            if (spec != null) {                cipher.init(mode, key, spec);            } else {                cipher.init(mode, key);            }        }    } catch (Exception e) {        String msg = "Unable to init cipher instance.";        throw new CryptoException(msg, e);    }}
public void shiro_f1619_0(InputStream in, OutputStream out, byte[] key) throws CryptoException
{    byte[] iv = null;    boolean generate = isGenerateInitializationVectors(true);    if (generate) {        iv = generateInitializationVector(true);        if (iv == null || iv.length == 0) {            throw new IllegalStateException("Initialization vector generation is enabled - generated vector" + "cannot be null or empty.");        }    }    encrypt(in, out, key, iv, generate);}
private void shiro_f1620_0(InputStream in, OutputStream out, byte[] key, byte[] iv, boolean prependIv) throws CryptoException
{    if (prependIv && iv != null && iv.length > 0) {        try {                        out.write(iv);        } catch (IOException e) {            throw new CryptoException(e);        }    }    crypt(in, out, key, iv, javax.crypto.Cipher.ENCRYPT_MODE);}
public void shiro_f1621_0(InputStream in, OutputStream out, byte[] key) throws CryptoException
{    decrypt(in, out, key, isGenerateInitializationVectors(true));}
private void shiro_f1622_0(InputStream in, OutputStream out, byte[] key, boolean ivPrepended) throws CryptoException
{    byte[] iv = null;        if (ivPrepended) {                        int ivSize = getInitializationVectorSize();        int ivByteSize = ivSize / BITS_PER_BYTE;        iv = new byte[ivByteSize];        int read;        try {            read = in.read(iv);        } catch (IOException e) {            String msg = "Unable to correctly read the Initialization Vector from the input stream.";            throw new CryptoException(msg, e);        }        if (read != ivByteSize) {            throw new CryptoException("Unable to read initialization vector bytes from the InputStream.  " + "This is required when initialization vectors are autogenerated during an encryption " + "operation.");        }    }    decrypt(in, out, key, iv);}
private void shiro_f1623_0(InputStream in, OutputStream out, byte[] decryptionKey, byte[] iv) throws CryptoException
{    crypt(in, out, decryptionKey, iv, javax.crypto.Cipher.DECRYPT_MODE);}
private void shiro_f1624_0(InputStream in, OutputStream out, byte[] keyBytes, byte[] iv, int cryptMode) throws CryptoException
{    if (in == null) {        throw new NullPointerException("InputStream argument cannot be null.");    }    if (out == null) {        throw new NullPointerException("OutputStream argument cannot be null.");    }    javax.crypto.Cipher cipher = initNewCipher(cryptMode, keyBytes, iv, true);    CipherInputStream cis = new CipherInputStream(in, cipher);    int bufSize = getStreamingBufferSize();    byte[] buffer = new byte[bufSize];    int bytesRead;    try {        while ((bytesRead = cis.read(buffer)) != -1) {            out.write(buffer, 0, bytesRead);        }    } catch (IOException e) {        throw new CryptoException(e);    }}
private javax.crypto.Cipher shiro_f1625_0(int jcaCipherMode, byte[] key, byte[] iv, boolean streaming) throws CryptoException
{    javax.crypto.Cipher cipher = newCipherInstance(streaming);    java.security.Key jdkKey = new SecretKeySpec(key, getAlgorithmName());    IvParameterSpec ivSpec = null;    if (iv != null && iv.length > 0) {        ivSpec = new IvParameterSpec(iv);    }    init(cipher, jcaCipherMode, jdkKey, ivSpec, getSecureRandom());    return cipher;}
public String shiro_f1626_0()
{    return this.transformationName;}
public void shiro_f1627_0(byte[] bytes)
{    this.secureRandom.setSeed(bytes);}
public SecureRandom shiro_f1628_0()
{    return secureRandom;}
public void shiro_f1629_0(SecureRandom random) throws NullPointerException
{    if (random == null) {        throw new NullPointerException("SecureRandom argument cannot be null.");    }    this.secureRandom = random;}
public int shiro_f1630_0()
{    return defaultNextBytesSize;}
public void shiro_f1631_0(int defaultNextBytesSize) throws IllegalArgumentException
{    if (defaultNextBytesSize <= 0) {        throw new IllegalArgumentException("size value must be a positive integer (1 or larger)");    }    this.defaultNextBytesSize = defaultNextBytesSize;}
public ByteSource shiro_f1632_0()
{    return nextBytes(getDefaultNextBytesSize());}
public ByteSource shiro_f1633_0(int numBytes)
{    if (numBytes <= 0) {        throw new IllegalArgumentException("numBytes argument must be a positive integer (1 or larger)");    }    byte[] bytes = new byte[numBytes];    this.secureRandom.nextBytes(bytes);    return ByteSource.Util.bytes(bytes);}
public byte[] shiro_f1634_0()
{    return this.bytes;}
public void shiro_f1635_0(byte[] alreadyHashedBytes)
{    this.bytes = alreadyHashedBytes;    this.hexEncoded = null;    this.base64Encoded = null;}
protected MessageDigest shiro_f1636_0(String algorithmName) throws UnknownAlgorithmException
{    try {        return MessageDigest.getInstance(algorithmName);    } catch (NoSuchAlgorithmException e) {        String msg = "No native '" + algorithmName + "' MessageDigest instance available on the current JVM.";        throw new UnknownAlgorithmException(msg, e);    }}
protected byte[] shiro_f1637_0(byte[] bytes)
{    return hash(bytes, null, 1);}
protected byte[] shiro_f1638_0(byte[] bytes, byte[] salt)
{    return hash(bytes, salt, 1);}
protected byte[] shiro_f1639_0(byte[] bytes, byte[] salt, int hashIterations) throws UnknownAlgorithmException
{    MessageDigest digest = getDigest(getAlgorithmName());    if (salt != null) {        digest.reset();        digest.update(salt);    }    byte[] hashed = digest.digest(bytes);        int iterations = hashIterations - 1;        for (int i = 0; i < iterations; i++) {        digest.reset();        hashed = digest.digest(hashed);    }    return hashed;}
public String shiro_f1640_0()
{    if (this.hexEncoded == null) {        this.hexEncoded = Hex.encodeToString(getBytes());    }    return this.hexEncoded;}
public String shiro_f1641_0()
{    if (this.base64Encoded == null) {                this.base64Encoded = Base64.encodeToString(getBytes());    }    return this.base64Encoded;}
public String shiro_f1642_0()
{    return toHex();}
public boolean shiro_f1643_0(Object o)
{    if (o instanceof Hash) {        Hash other = (Hash) o;        return MessageDigest.isEqual(getBytes(), other.getBytes());    }    return false;}
public int shiro_f1644_0()
{    if (this.bytes == null || this.bytes.length == 0) {        return 0;    }    return Arrays.hashCode(this.bytes);}
private static void shiro_f1645_0(Class<? extends AbstractHash> clazz, String type)
{    System.out.println("Prints an " + type + " hash value.");    System.out.println("Usage: java " + clazz.getName() + " [-base64] [-salt <saltValue>] [-times <N>] <valueToHash>");    System.out.println("Options:");    System.out.println("\t-base64\t\tPrints the hash value as a base64 String instead of the default hex.");    System.out.println("\t-salt\t\tSalts the hash with the specified <saltValue>");    System.out.println("\t-times\t\tHashes the input <N> number of times");}
private static boolean shiro_f1646_0(String arg)
{    return "-base64".equals(arg) || "-times".equals(arg) || "-salt".equals(arg);}
 static int shiro_f1647_0(Class<? extends AbstractHash> clazz, String[] args)
{    String simple = clazz.getSimpleName();    int index = simple.indexOf("Hash");    String type = simple.substring(0, index).toUpperCase();    if (args == null || args.length < 1 || args.length > 7) {        printMainUsage(clazz, type);        return -1;    }    boolean hex = true;    String salt = null;    int times = 1;    String text = args[args.length - 1];    for (int i = 0; i < args.length; i++) {        String arg = args[i];        if (arg.equals("-base64")) {            hex = false;        } else if (arg.equals("-salt")) {            if ((i + 1) >= (args.length - 1)) {                String msg = "Salt argument must be followed by a salt value.  The final argument is " + "reserved for the value to hash.";                System.out.println(msg);                printMainUsage(clazz, type);                return -1;            }            salt = args[i + 1];        } else if (arg.equals("-times")) {            if ((i + 1) >= (args.length - 1)) {                String msg = "Times argument must be followed by an integer value.  The final argument is " + "reserved for the value to hash";                System.out.println(msg);                printMainUsage(clazz, type);                return -1;            }            try {                times = Integer.valueOf(args[i + 1]);            } catch (NumberFormatException e) {                String msg = "Times argument must be followed by an integer value.";                System.out.println(msg);                printMainUsage(clazz, type);                return -1;            }        }    }    Hash hash = new Md2Hash(text, salt, times);    String hashed = hex ? hash.toHex() : hash.toBase64();    System.out.print(hex ? "Hex: " : "Base64: ");    System.out.println(hashed);    return 0;}
public Hash shiro_f1648_0(HashRequest request)
{    if (request == null || request.getSource() == null || request.getSource().isEmpty()) {        return null;    }    String algorithmName = getAlgorithmName(request);    ByteSource source = request.getSource();    int iterations = getIterations(request);    ByteSource publicSalt = getPublicSalt(request);    ByteSource privateSalt = getPrivateSalt();    ByteSource salt = combine(privateSalt, publicSalt);    Hash computed = new SimpleHash(algorithmName, source, salt, iterations);    SimpleHash result = new SimpleHash(algorithmName);    result.setBytes(computed.getBytes());    result.setIterations(iterations);        result.setSalt(publicSalt);    return result;}
protected String shiro_f1649_0(HashRequest request)
{    String name = request.getAlgorithmName();    if (name == null) {        name = getHashAlgorithmName();    }    return name;}
protected int shiro_f1650_0(HashRequest request)
{    int iterations = Math.max(0, request.getIterations());    if (iterations < 1) {        iterations = Math.max(1, getHashIterations());    }    return iterations;}
protected ByteSource shiro_f1651_0(HashRequest request)
{    ByteSource publicSalt = request.getSalt();    if (publicSalt != null && !publicSalt.isEmpty()) {                return publicSalt;    }    publicSalt = null;        ByteSource privateSalt = getPrivateSalt();    boolean privateSaltExists = privateSalt != null && !privateSalt.isEmpty();        if (privateSaltExists || isGeneratePublicSalt()) {        publicSalt = getRandomNumberGenerator().nextBytes();    }    return publicSalt;}
protected ByteSource shiro_f1652_0(ByteSource privateSalt, ByteSource publicSalt)
{    byte[] privateSaltBytes = privateSalt != null ? privateSalt.getBytes() : null;    int privateSaltLength = privateSaltBytes != null ? privateSaltBytes.length : 0;    byte[] publicSaltBytes = publicSalt != null ? publicSalt.getBytes() : null;    int extraBytesLength = publicSaltBytes != null ? publicSaltBytes.length : 0;    int length = privateSaltLength + extraBytesLength;    if (length <= 0) {        return null;    }    byte[] combined = new byte[length];    int i = 0;    for (int j = 0; j < privateSaltLength; j++) {        assert privateSaltBytes != null;        combined[i++] = privateSaltBytes[j];    }    for (int j = 0; j < extraBytesLength; j++) {        assert publicSaltBytes != null;        combined[i++] = publicSaltBytes[j];    }    return ByteSource.Util.bytes(combined);}
public void shiro_f1653_0(String name)
{    this.algorithmName = name;}
public String shiro_f1654_0()
{    return this.algorithmName;}
public void shiro_f1655_0(ByteSource privateSalt)
{    this.privateSalt = privateSalt;}
public ByteSource shiro_f1656_0()
{    return this.privateSalt;}
public void shiro_f1657_0(int count)
{    this.iterations = count;}
public int shiro_f1658_0()
{    return this.iterations;}
public void shiro_f1659_0(RandomNumberGenerator rng)
{    this.rng = rng;}
public RandomNumberGenerator shiro_f1660_0()
{    return this.rng;}
public boolean shiro_f1661_0()
{    return generatePublicSalt;}
public void shiro_f1662_0(boolean generatePublicSalt)
{    this.generatePublicSalt = generatePublicSalt;}
public String shiro_f1663_0(Hash hash)
{    return hash != null ? hash.toBase64() : null;}
public Map<String, String> shiro_f1664_0()
{    return formatClassNames;}
public void shiro_f1665_0(Map<String, String> formatClassNames)
{    this.formatClassNames = formatClassNames;}
public Set<String> shiro_f1666_0()
{    return searchPackages;}
public void shiro_f1667_0(Set<String> searchPackages)
{    this.searchPackages = searchPackages;}
public HashFormat shiro_f1668_0(String in)
{    if (in == null) {        return null;    }    HashFormat hashFormat = null;    Class clazz = null;        if (in.startsWith(ModularCryptFormat.TOKEN_DELIMITER)) {                        String test = in.substring(ModularCryptFormat.TOKEN_DELIMITER.length());        String[] tokens = test.split("\\" + ModularCryptFormat.TOKEN_DELIMITER);                String possibleMcfId = (tokens != null && tokens.length > 0) ? tokens[0] : null;        if (possibleMcfId != null) {                        clazz = getHashFormatClass(possibleMcfId);        }    }    if (clazz == null) {                clazz = getHashFormatClass(in);    }    if (clazz != null) {                hashFormat = newHashFormatInstance(clazz);    }    return hashFormat;}
protected Class shiro_f1669_0(String token)
{    Class clazz = null;        if (this.formatClassNames != null) {        String value = this.formatClassNames.get(token);        if (value != null) {                        clazz = lookupHashFormatClass(value);        }    }        if (clazz == null) {        ProvidedHashFormat provided = ProvidedHashFormat.byId(token);        if (provided != null) {            clazz = provided.getHashFormatClass();        }    }    if (clazz == null) {                clazz = lookupHashFormatClass(token);    }    if (clazz == null) {                if (this.searchPackages != null) {            for (String packageName : this.searchPackages) {                clazz = getHashFormatClass(packageName, token);                if (clazz != null) {                                        break;                }            }        }    }    if (clazz != null) {        assertHashFormatImpl(clazz);    }    return clazz;}
protected Class shiro_f1670_0(String packageName, String token)
{    String test = token;    Class clazz = null;    String pkg = packageName == null ? "" : packageName;        clazz = lookupHashFormatClass(test);    if (clazz == null) {        test = pkg + "." + token;        clazz = lookupHashFormatClass(test);    }    if (clazz == null) {        test = pkg + "." + StringUtils.uppercaseFirstChar(token) + "Format";        clazz = lookupHashFormatClass(test);    }    if (clazz == null) {        test = pkg + "." + token + "Format";        clazz = lookupHashFormatClass(test);    }    if (clazz == null) {        test = pkg + "." + StringUtils.uppercaseFirstChar(token) + "HashFormat";        clazz = lookupHashFormatClass(test);    }    if (clazz == null) {        test = pkg + "." + token + "HashFormat";        clazz = lookupHashFormatClass(test);    }    if (clazz == null) {        test = pkg + "." + StringUtils.uppercaseFirstChar(token) + "CryptFormat";        clazz = lookupHashFormatClass(test);    }    if (clazz == null) {        test = pkg + "." + token + "CryptFormat";        clazz = lookupHashFormatClass(test);    }    if (clazz == null) {                return null;    }    assertHashFormatImpl(clazz);    return clazz;}
protected Class shiro_f1671_0(String name)
{    try {        return ClassUtils.forName(name);    } catch (UnknownClassException ignored) {    }    return null;}
protected final void shiro_f1672_0(Class clazz)
{    if (!HashFormat.class.isAssignableFrom(clazz) || clazz.isInterface()) {        throw new IllegalArgumentException("Discovered class [" + clazz.getName() + "] is not a " + HashFormat.class.getName() + " implementation.");    }}
protected final HashFormat shiro_f1673_0(Class clazz)
{    assertHashFormatImpl(clazz);    return (HashFormat) ClassUtils.newInstance(clazz);}
public String shiro_f1674_0(Hash hash)
{    return hash != null ? hash.toHex() : null;}
 Class<? extends HashFormat> shiro_f1675_0()
{    return this.clazz;}
public static ProvidedHashFormat shiro_f1676_0(String id)
{    if (id == null) {        return null;    }    try {                return valueOf(id.toUpperCase(Locale.ENGLISH));    } catch (IllegalArgumentException ignored) {        return null;    }}
public String shiro_f1677_0()
{    return ID;}
public String shiro_f1678_0(Hash hash)
{    if (hash == null) {        return null;    }    String algorithmName = hash.getAlgorithmName();    ByteSource salt = hash.getSalt();    int iterations = hash.getIterations();    StringBuilder sb = new StringBuilder(MCF_PREFIX).append(algorithmName).append(TOKEN_DELIMITER).append(iterations).append(TOKEN_DELIMITER);    if (salt != null) {        sb.append(salt.toBase64());    }    sb.append(TOKEN_DELIMITER);    sb.append(hash.toBase64());    return sb.toString();}
public Hash shiro_f1679_0(String formatted)
{    if (formatted == null) {        return null;    }    if (!formatted.startsWith(MCF_PREFIX)) {                String msg = "The argument is not a valid '" + ID + "' formatted hash.";        throw new IllegalArgumentException(msg);    }    String suffix = formatted.substring(MCF_PREFIX.length());    String[] parts = suffix.split("\\$");        int i = parts.length - 1;    String digestBase64 = parts[i--];        String saltBase64 = parts[i--];    String iterationsString = parts[i--];    String algorithmName = parts[i];    byte[] digest = Base64.decode(digestBase64);    ByteSource salt = null;    if (StringUtils.hasLength(saltBase64)) {        byte[] saltBytes = Base64.decode(saltBase64);        salt = ByteSource.Util.bytes(saltBytes);    }    int iterations;    try {        iterations = Integer.parseInt(iterationsString);    } catch (NumberFormatException e) {        String msg = "Unable to parse formatted hash string: " + formatted;        throw new IllegalArgumentException(msg, e);    }    SimpleHash hash = new SimpleHash(algorithmName);    hash.setBytes(digest);    if (salt != null) {        hash.setSalt(salt);    }    hash.setIterations(iterations);    return hash;}
public Builder shiro_f1680_0(ByteSource source)
{    this.source = source;    return this;}
public Builder shiro_f1681_0(Object source) throws IllegalArgumentException
{    this.source = ByteSource.Util.bytes(source);    return this;}
public Builder shiro_f1682_0(ByteSource salt)
{    this.salt = salt;    return this;}
public Builder shiro_f1683_0(Object salt) throws IllegalArgumentException
{    this.salt = ByteSource.Util.bytes(salt);    return this;}
public Builder shiro_f1684_0(int iterations)
{    this.iterations = iterations;    return this;}
public Builder shiro_f1685_0(String algorithmName)
{    this.algorithmName = algorithmName;    return this;}
public HashRequest shiro_f1686_0()
{    return new SimpleHashRequest(this.algorithmName, this.source, this.salt, this.iterations);}
public static Md2Hash shiro_f1687_0(String hex)
{    Md2Hash hash = new Md2Hash();    hash.setBytes(Hex.decode(hex));    return hash;}
public static Md2Hash shiro_f1688_0(String base64)
{    Md2Hash hash = new Md2Hash();    hash.setBytes(Base64.decode(base64));    return hash;}
public static Md5Hash shiro_f1689_0(String hex)
{    Md5Hash hash = new Md5Hash();    hash.setBytes(Hex.decode(hex));    return hash;}
public static Md5Hash shiro_f1690_0(String base64)
{    Md5Hash hash = new Md5Hash();    hash.setBytes(Base64.decode(base64));    return hash;}
public static Sha1Hash shiro_f1691_0(String hex)
{    Sha1Hash hash = new Sha1Hash();    hash.setBytes(Hex.decode(hex));    return hash;}
public static Sha1Hash shiro_f1692_0(String base64)
{    Sha1Hash hash = new Sha1Hash();    hash.setBytes(Base64.decode(base64));    return hash;}
public static Sha256Hash shiro_f1693_0(String hex)
{    Sha256Hash hash = new Sha256Hash();    hash.setBytes(Hex.decode(hex));    return hash;}
public static Sha256Hash shiro_f1694_0(String base64)
{    Sha256Hash hash = new Sha256Hash();    hash.setBytes(Base64.decode(base64));    return hash;}
public static Sha384Hash shiro_f1695_0(String hex)
{    Sha384Hash hash = new Sha384Hash();    hash.setBytes(Hex.decode(hex));    return hash;}
public static Sha384Hash shiro_f1696_0(String base64)
{    Sha384Hash hash = new Sha384Hash();    hash.setBytes(Base64.decode(base64));    return hash;}
public static Sha512Hash shiro_f1697_0(String hex)
{    Sha512Hash hash = new Sha512Hash();    hash.setBytes(Hex.decode(hex));    return hash;}
public static Sha512Hash shiro_f1698_0(String base64)
{    Sha512Hash hash = new Sha512Hash();    hash.setBytes(Base64.decode(base64));    return hash;}
protected ByteSource shiro_f1699_0(Object source)
{    return toByteSource(source);}
protected ByteSource shiro_f1700_0(Object salt)
{    return toByteSource(salt);}
protected ByteSource shiro_f1701_0(Object o)
{    if (o == null) {        return null;    }    if (o instanceof ByteSource) {        return (ByteSource) o;    }    byte[] bytes = toBytes(o);    return ByteSource.Util.bytes(bytes);}
private void shiro_f1702_0(ByteSource source, ByteSource salt, int hashIterations) throws CodecException, UnknownAlgorithmException
{    byte[] saltBytes = salt != null ? salt.getBytes() : null;    byte[] hashedBytes = hash(source.getBytes(), saltBytes, hashIterations);    setBytes(hashedBytes);}
public String shiro_f1703_0()
{    return this.algorithmName;}
public ByteSource shiro_f1704_0()
{    return this.salt;}
public int shiro_f1705_0()
{    return this.iterations;}
public byte[] shiro_f1706_0()
{    return this.bytes;}
public void shiro_f1707_0(byte[] alreadyHashedBytes)
{    this.bytes = alreadyHashedBytes;    this.hexEncoded = null;    this.base64Encoded = null;}
public void shiro_f1708_0(int iterations)
{    this.iterations = Math.max(DEFAULT_ITERATIONS, iterations);}
public void shiro_f1709_0(ByteSource salt)
{    this.salt = salt;}
protected MessageDigest shiro_f1710_0(String algorithmName) throws UnknownAlgorithmException
{    try {        return MessageDigest.getInstance(algorithmName);    } catch (NoSuchAlgorithmException e) {        String msg = "No native '" + algorithmName + "' MessageDigest instance available on the current JVM.";        throw new UnknownAlgorithmException(msg, e);    }}
protected byte[] shiro_f1711_0(byte[] bytes) throws UnknownAlgorithmException
{    return hash(bytes, null, DEFAULT_ITERATIONS);}
protected byte[] shiro_f1712_0(byte[] bytes, byte[] salt) throws UnknownAlgorithmException
{    return hash(bytes, salt, DEFAULT_ITERATIONS);}
protected byte[] shiro_f1713_0(byte[] bytes, byte[] salt, int hashIterations) throws UnknownAlgorithmException
{    MessageDigest digest = getDigest(getAlgorithmName());    if (salt != null) {        digest.reset();        digest.update(salt);    }    byte[] hashed = digest.digest(bytes);        int iterations = hashIterations - 1;        for (int i = 0; i < iterations; i++) {        digest.reset();        hashed = digest.digest(hashed);    }    return hashed;}
public boolean shiro_f1714_0()
{    return this.bytes == null || this.bytes.length == 0;}
public String shiro_f1715_0()
{    if (this.hexEncoded == null) {        this.hexEncoded = Hex.encodeToString(getBytes());    }    return this.hexEncoded;}
public String shiro_f1716_0()
{    if (this.base64Encoded == null) {                this.base64Encoded = Base64.encodeToString(getBytes());    }    return this.base64Encoded;}
public String shiro_f1717_0()
{    return toHex();}
public boolean shiro_f1718_0(Object o)
{    if (o instanceof Hash) {        Hash other = (Hash) o;        return MessageDigest.isEqual(getBytes(), other.getBytes());    }    return false;}
public int shiro_f1719_0()
{    if (this.bytes == null || this.bytes.length == 0) {        return 0;    }    return Arrays.hashCode(this.bytes);}
public ByteSource shiro_f1720_0()
{    return this.source;}
public ByteSource shiro_f1721_0()
{    return this.salt;}
public int shiro_f1722_0()
{    return iterations;}
public String shiro_f1723_0()
{    return algorithmName;}
public long shiro_f1724_0()
{    return this.timestamp;}
public List<EventListener> shiro_f1725_0(Object instance)
{    if (instance == null) {        return Collections.emptyList();    }    List<Method> methods = ClassUtils.getAnnotatedMethods(instance.getClass(), getAnnotationClass());    if (methods == null || methods.isEmpty()) {        return Collections.emptyList();    }    List<EventListener> listeners = new ArrayList<EventListener>(methods.size());    for (Method m : methods) {        listeners.add(new SingleArgumentMethodEventListener(instance, m));    }    return listeners;}
public Class<? extends Annotation> shiro_f1726_0()
{    return annotationClass;}
public void shiro_f1727_0(Class<? extends Annotation> annotationClass)
{    this.annotationClass = annotationClass;}
public EventListenerResolver shiro_f1728_0()
{    return eventListenerResolver;}
public void shiro_f1729_0(EventListenerResolver eventListenerResolver)
{    this.eventListenerResolver = eventListenerResolver;}
public void shiro_f1730_1(Object event)
{    if (event == null) {                return;    }    registryReadLock.lock();    try {        for (Subscription subscription : this.registry.values()) {            subscription.onEvent(event);        }    } finally {        registryReadLock.unlock();    }}
public void shiro_f1731_1(Object instance)
{    if (instance == null) {                return;    }    unregister(instance);    List<EventListener> listeners = getEventListenerResolver().getEventListeners(instance);    if (listeners == null || listeners.isEmpty()) {                return;    }    Subscription subscription = new Subscription(listeners);    this.registryWriteLock.lock();    try {        this.registry.put(instance, subscription);    } finally {        this.registryWriteLock.unlock();    }}
public void shiro_f1732_0(Object instance)
{    if (instance == null) {        return;    }    this.registryWriteLock.lock();    try {        this.registry.remove(instance);    } finally {        this.registryWriteLock.unlock();    }}
public void shiro_f1733_1(Object event)
{    Set<Object> delivered = new HashSet<Object>();    for (EventListener listener : this.listeners) {        Object target = listener;        if (listener instanceof SingleArgumentMethodEventListener) {            SingleArgumentMethodEventListener singleArgListener = (SingleArgumentMethodEventListener) listener;            target = singleArgListener.getTarget();        }        if (listener.accepts(event) && !delivered.contains(target)) {            try {                listener.onEvent(event);            } catch (Throwable t) {                            }            delivered.add(target);        }    }}
public int shiro_f1734_0(Class a, Class b)
{    if (a == null) {        if (b == null) {            return 0;        } else {            return -1;        }    } else if (b == null) {        return 1;    } else if (a == b || a.equals(b)) {        return 0;    } else {        if (a.isAssignableFrom(b)) {            return 1;        } else if (b.isAssignableFrom(a)) {            return -1;        } else {            return 0;        }    }}
public int shiro_f1735_0(EventListener a, EventListener b)
{    if (a == null) {        if (b == null) {            return 0;        } else {            return -1;        }    } else if (b == null) {        return 1;    } else if (a == b || a.equals(b)) {        return 0;    } else {        if (a instanceof TypedEventListener) {            TypedEventListener ta = (TypedEventListener) a;            if (b instanceof TypedEventListener) {                TypedEventListener tb = (TypedEventListener) b;                return EVENT_CLASS_COMPARATOR.compare(ta.getEventType(), tb.getEventType());            } else {                                return -1;            }        } else {            if (b instanceof TypedEventListener) {                return 1;            } else {                return 0;            }        }    }}
public Object shiro_f1736_0()
{    return this.target;}
public Method shiro_f1737_0()
{    return this.method;}
private void shiro_f1738_0(Method method)
{    int modifiers = method.getModifiers();    if (!Modifier.isPublic(modifiers)) {        throw new IllegalArgumentException("Event handler method [" + method + "] must be public.");    }}
public boolean shiro_f1739_0(Object event)
{    return event != null && getEventType().isInstance(event);}
public Class shiro_f1740_0()
{    return getMethodArgumentType(getMethod());}
public void shiro_f1741_0(Object event)
{    Method method = getMethod();    try {        method.invoke(getTarget(), event);    } catch (Exception e) {        throw new IllegalStateException("Unable to invoke event handler method [" + method + "].", e);    }}
protected Class shiro_f1742_0(Method method)
{    Class[] paramTypes = method.getParameterTypes();    if (paramTypes.length != 1) {                String msg = "Event handler methods must accept a single argument.";        throw new IllegalArgumentException(msg);    }    return paramTypes[0];}
public void shiro_f1743_0(final ServletContextEvent servletContextEvent)
{    this.servletContext = servletContextEvent.getServletContext();    super.contextInitialized(servletContextEvent);}
protected Injector shiro_f1744_0()
{    return Guice.createInjector(new SampleShiroServletModule(servletContext), ShiroWebModule.guiceFilterModule());}
protected void shiro_f1745_0()
{    bindConstant().annotatedWith(Names.named("shiro.loginUrl")).to("/login.jsp");    try {        this.bindRealm().toConstructor(IniRealm.class.getConstructor(Ini.class));    } catch (NoSuchMethodException e) {        addError("Could not locate proper constructor for IniRealm.", e);    }    this.addFilterChain("/login.jsp", AUTHC);    this.addFilterChain("/logout", LOGOUT);    this.addFilterChain("/account/**", AUTHC);    this.addFilterChain("/remoting/**", AUTHC, config(ROLES, "b2bClient"), config(PERMS, "remote:invoke:lan,wan"));}
 Ini shiro_f1746_0() throws MalformedURLException
{    URL iniUrl = servletContext.getResource("/WEB-INF/shiro.ini");    return Ini.fromResourcePath("url:" + iniUrl.toExternalForm());}
protected void shiro_f1747_0(AnnotatedBindingBuilder<? super WebSecurityManager> bind)
{    try {        String cipherKey = loadShiroIni().getSectionProperty("main", "securityManager.rememberMeManager.cipherKey");        DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();        CookieRememberMeManager rememberMeManager = new CookieRememberMeManager();        rememberMeManager.setCipherKey(Base64.decode(cipherKey));        securityManager.setRememberMeManager(rememberMeManager);        bind.toInstance(securityManager);    } catch (MalformedURLException e) {                throw new ConfigurationException("securityManager.rememberMeManager.cipherKey must be set in shiro.ini.");    }}
public void shiro_f1748_0() throws IOException
{        final HtmlPage homePage = webClient.getPage(getBaseUri());    try {        homePage.getAnchorByHref("/logout").click();    } catch (ElementNotFoundException e) {        }}
public void shiro_f1749_0() throws FailingHttpStatusCodeException, MalformedURLException, IOException, InterruptedException
{    HtmlPage page = webClient.getPage(getBaseUri() + "login.jsp");    HtmlForm form = page.getFormByName("loginform");    form.<HtmlInput>getInputByName("username").setValueAttribute("root");    form.<HtmlInput>getInputByName("password").setValueAttribute("secret");    page = form.<HtmlInput>getInputByName("submit").click();        page.getAnchorByHref("/logout");}
public void shiro_f1750_0() throws Exception
{    HtmlPage page = webClient.getPage(getBaseUri() + "login.jsp");    HtmlForm form = page.getFormByName("loginform");    form.<HtmlInput>getInputByName("username").setValueAttribute("root");    form.<HtmlInput>getInputByName("password").setValueAttribute("secret");    HtmlCheckBoxInput checkbox = form.getInputByName("rememberMe");    checkbox.setChecked(true);    page = form.<HtmlInput>getInputByName("submit").click();    jetty.stop();    jetty.start();    page = webClient.getPage(getBaseUri());        WebAssert.assertLinkPresentWithText(page, "Log out");    page = page.getAnchorByHref("/account").click();        WebAssert.assertFormPresent(page, "loginform");}
public void shiro_f1751_0(final ServletContextEvent servletContextEvent)
{    this.servletContext = servletContextEvent.getServletContext();    super.contextInitialized(servletContextEvent);}
protected Injector shiro_f1752_0()
{    return Guice.createInjector(new SampleShiroServletModule(servletContext), ShiroWebModule.guiceFilterModule());}
protected void shiro_f1753_0()
{    bindConstant().annotatedWith(Names.named("shiro.loginUrl")).to("/login.jsp");    try {        this.bindRealm().toConstructor(IniRealm.class.getConstructor(Ini.class));    } catch (NoSuchMethodException e) {        addError("Could not locate proper constructor for IniRealm.", e);    }    this.addFilterChain("/login.jsp", AUTHC);    this.addFilterChain("/logout", LOGOUT);    this.addFilterChain("/account/**", AUTHC);    this.addFilterChain("/remoting/**", filterConfig(AUTHC), filterConfig(ROLES, "b2bClient"), filterConfig(PERMS, "remote:invoke:lan,wan"));}
 Ini shiro_f1754_0() throws MalformedURLException
{    URL iniUrl = servletContext.getResource("/WEB-INF/shiro.ini");    return Ini.fromResourcePath("url:" + iniUrl.toExternalForm());}
protected void shiro_f1755_0(AnnotatedBindingBuilder<? super WebSecurityManager> bind)
{    try {        String cipherKey = loadShiroIni().getSectionProperty("main", "securityManager.rememberMeManager.cipherKey");        DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();        CookieRememberMeManager rememberMeManager = new CookieRememberMeManager();        rememberMeManager.setCipherKey(Base64.decode(cipherKey));        securityManager.setRememberMeManager(rememberMeManager);        bind.toInstance(securityManager);    } catch (MalformedURLException e) {                throw new ConfigurationException("securityManager.rememberMeManager.cipherKey must be set in shiro.ini.");    }}
public void shiro_f1756_0() throws IOException
{        final HtmlPage homePage = webClient.getPage(getBaseUri());    try {        homePage.getAnchorByHref("/logout").click();    } catch (ElementNotFoundException e) {        }}
public void shiro_f1757_0() throws FailingHttpStatusCodeException, MalformedURLException, IOException, InterruptedException
{    HtmlPage page = webClient.getPage(getBaseUri() + "login.jsp");    HtmlForm form = page.getFormByName("loginform");    form.<HtmlInput>getInputByName("username").setValueAttribute("root");    form.<HtmlInput>getInputByName("password").setValueAttribute("secret");    page = form.<HtmlInput>getInputByName("submit").click();        page.getAnchorByHref("/logout");}
public void shiro_f1758_0() throws Exception
{    HtmlPage page = webClient.getPage(getBaseUri() + "login.jsp");    HtmlForm form = page.getFormByName("loginform");    form.<HtmlInput>getInputByName("username").setValueAttribute("root");    form.<HtmlInput>getInputByName("password").setValueAttribute("secret");    HtmlCheckBoxInput checkbox = form.getInputByName("rememberMe");    checkbox.setChecked(true);    page = form.<HtmlInput>getInputByName("submit").click();    jetty.stop();    jetty.start();    page = webClient.getPage(getBaseUri());        WebAssert.assertLinkPresentWithText(page, "Log out");    page = page.getAnchorByHref("/account").click();        WebAssert.assertFormPresent(page, "loginform");}
public static void shiro_f1759_0() throws Exception
{    EmbeddedJettyConfiguration config = EmbeddedJettyConfiguration.builder().withWebapp(getWarDir()).build();    jetty = new EmbeddedJetty(config) {        /**         * Overriding with contents of this pull request, to make fragment scanning work.         * https://github.com/mjeanroy/junit-servers/pull/3         */        protected WebAppContext createdWebAppContext() throws Exception {            final String path = configuration.getPath();            final String webapp = configuration.getWebapp();            final String classpath = configuration.getClasspath();            WebAppContext ctx = new WebAppContext();            ctx.setClassLoader(Thread.currentThread().getContextClassLoader());            ctx.setContextPath(path);                        ctx.setBaseResource(newResource(webapp));            ctx.setConfigurations(new Configuration[] { new WebInfConfiguration(), new WebXmlConfiguration(), new AnnotationConfiguration(), new JettyWebXmlConfiguration(), new MetaInfConfiguration(), new FragmentConfiguration() });            if (isNotBlank(classpath)) {                                                                                File classes = new File(classpath);                FileResource containerResources = new FileResource(classes.toURI());                ctx.getMetaData().addContainerResource(containerResources);            }            Server server = getDelegate();            ctx.setParentLoaderPriority(true);            ctx.setWar(webapp);            ctx.setServer(server);                        server.setHandler(ctx);            return ctx;        }    };    jetty.start();    assertTrue(jetty.isStarted());}
protected WebAppContext shiro_f1760_0() throws Exception
{    final String path = configuration.getPath();    final String webapp = configuration.getWebapp();    final String classpath = configuration.getClasspath();    WebAppContext ctx = new WebAppContext();    ctx.setClassLoader(Thread.currentThread().getContextClassLoader());    ctx.setContextPath(path);        ctx.setBaseResource(newResource(webapp));    ctx.setConfigurations(new Configuration[] { new WebInfConfiguration(), new WebXmlConfiguration(), new AnnotationConfiguration(), new JettyWebXmlConfiguration(), new MetaInfConfiguration(), new FragmentConfiguration() });    if (isNotBlank(classpath)) {                                        File classes = new File(classpath);        FileResource containerResources = new FileResource(classes.toURI());        ctx.getMetaData().addContainerResource(containerResources);    }    Server server = getDelegate();    ctx.setParentLoaderPriority(true);    ctx.setWar(webapp);    ctx.setServer(server);        server.setHandler(ctx);    return ctx;}
protected static String shiro_f1761_0()
{    return "http://localhost:" + jetty.getPort() + "/";}
protected static String shiro_f1762_0()
{    File[] warFiles = new File("target").listFiles(new FilenameFilter() {        @Override        public boolean accept(File dir, String name) {            return name.endsWith(".war");        }    });    assertEquals("Expected only one war file in target directory, run 'mvn clean' and try again", 1, warFiles.length);    return warFiles[0].getAbsolutePath().replaceFirst("\\.war$", "");}
public boolean shiro_f1763_0(File dir, String name)
{    return name.endsWith(".war");}
protected static String shiro_f1764_0(String username, String password) throws UnsupportedEncodingException
{    String authorizationHeader = username + ":" + password;    byte[] valueBytes;    valueBytes = authorizationHeader.getBytes("UTF-8");    authorizationHeader = new String(Base64.encode(valueBytes));    return "Basic " + authorizationHeader;}
public void shiro_f1765_0()
{    webClient.getOptions().setThrowExceptionOnFailingStatusCode(true);}
public static void shiro_f1766_0()
{    if (jetty != null) {        jetty.stop();    }}
private static boolean shiro_f1767_0(byte octect)
{    if (octect == PAD) {        return true;    } else     if (octect < 0 || base64Alphabet[octect] == -1) {        return false;    } else {        return true;    }}
public static boolean shiro_f1768_0(byte[] arrayOctect)
{    arrayOctect = discardWhitespace(arrayOctect);    int length = arrayOctect.length;    if (length == 0) {                return true;    }    for (int i = 0; i < length; i++) {        if (!isBase64(arrayOctect[i])) {            return false;        }    }    return true;}
 static byte[] shiro_f1769_0(byte[] data)
{    byte[] groomedData = new byte[data.length];    int bytesCopied = 0;    for (byte aByte : data) {        switch(aByte) {            case (byte) ' ':            case (byte) '\n':            case (byte) '\r':            case (byte) '\t':                break;            default:                groomedData[bytesCopied++] = aByte;        }    }    byte[] packedData = new byte[bytesCopied];    System.arraycopy(groomedData, 0, packedData, 0, bytesCopied);    return packedData;}
public static String shiro_f1770_0(byte[] bytes)
{    byte[] encoded = encode(bytes);    return CodecSupport.toString(encoded);}
public static byte[] shiro_f1771_0(byte[] binaryData)
{    return encode(binaryData, true);}
public static byte[] shiro_f1772_0(byte[] pArray)
{    return encode(pArray, false);}
public static byte[] shiro_f1773_0(byte[] binaryData, boolean isChunked)
{    long binaryDataLength = binaryData.length;    long lengthDataBits = binaryDataLength * EIGHTBIT;    long fewerThan24bits = lengthDataBits % TWENTYFOURBITGROUP;    long tripletCount = lengthDataBits / TWENTYFOURBITGROUP;    long encodedDataLengthLong;    int chunckCount = 0;    if (fewerThan24bits != 0) {                encodedDataLengthLong = (tripletCount + 1) * 4;    } else {                encodedDataLengthLong = tripletCount * 4;    }        if (isChunked) {        chunckCount = (CHUNK_SEPARATOR.length == 0 ? 0 : (int) Math.ceil((float) encodedDataLengthLong / CHUNK_SIZE));        encodedDataLengthLong += chunckCount * CHUNK_SEPARATOR.length;    }    if (encodedDataLengthLong > Integer.MAX_VALUE) {        throw new IllegalArgumentException("Input array too big, output array would be bigger than Integer.MAX_VALUE=" + Integer.MAX_VALUE);    }    int encodedDataLength = (int) encodedDataLengthLong;    byte[] encodedData = new byte[encodedDataLength];    byte k, l, b1, b2, b3;    int encodedIndex = 0;    int dataIndex;    int i;    int nextSeparatorIndex = CHUNK_SIZE;    int chunksSoFar = 0;        for (i = 0; i < tripletCount; i++) {        dataIndex = i * 3;        b1 = binaryData[dataIndex];        b2 = binaryData[dataIndex + 1];        b3 = binaryData[dataIndex + 2];                l = (byte) (b2 & 0x0f);        k = (byte) (b1 & 0x03);        byte val1 = ((b1 & SIGN) == 0) ? (byte) (b1 >> 2) : (byte) ((b1) >> 2 ^ 0xc0);        byte val2 = ((b2 & SIGN) == 0) ? (byte) (b2 >> 4) : (byte) ((b2) >> 4 ^ 0xf0);        byte val3 = ((b3 & SIGN) == 0) ? (byte) (b3 >> 6) : (byte) ((b3) >> 6 ^ 0xfc);        encodedData[encodedIndex] = lookUpBase64Alphabet[val1];                                encodedData[encodedIndex + 1] = lookUpBase64Alphabet[val2 | (k << 4)];        encodedData[encodedIndex + 2] = lookUpBase64Alphabet[(l << 2) | val3];        encodedData[encodedIndex + 3] = lookUpBase64Alphabet[b3 & 0x3f];        encodedIndex += 4;                if (isChunked) {                        if (encodedIndex == nextSeparatorIndex) {                System.arraycopy(CHUNK_SEPARATOR, 0, encodedData, encodedIndex, CHUNK_SEPARATOR.length);                chunksSoFar++;                nextSeparatorIndex = (CHUNK_SIZE * (chunksSoFar + 1)) + (chunksSoFar * CHUNK_SEPARATOR.length);                encodedIndex += CHUNK_SEPARATOR.length;            }        }    }        dataIndex = i * 3;    if (fewerThan24bits == EIGHTBIT) {        b1 = binaryData[dataIndex];        k = (byte) (b1 & 0x03);                        byte val1 = ((b1 & SIGN) == 0) ? (byte) (b1 >> 2) : (byte) ((b1) >> 2 ^ 0xc0);        encodedData[encodedIndex] = lookUpBase64Alphabet[val1];        encodedData[encodedIndex + 1] = lookUpBase64Alphabet[k << 4];        encodedData[encodedIndex + 2] = PAD;        encodedData[encodedIndex + 3] = PAD;    } else if (fewerThan24bits == SIXTEENBIT) {        b1 = binaryData[dataIndex];        b2 = binaryData[dataIndex + 1];        l = (byte) (b2 & 0x0f);        k = (byte) (b1 & 0x03);        byte val1 = ((b1 & SIGN) == 0) ? (byte) (b1 >> 2) : (byte) ((b1) >> 2 ^ 0xc0);        byte val2 = ((b2 & SIGN) == 0) ? (byte) (b2 >> 4) : (byte) ((b2) >> 4 ^ 0xf0);        encodedData[encodedIndex] = lookUpBase64Alphabet[val1];        encodedData[encodedIndex + 1] = lookUpBase64Alphabet[val2 | (k << 4)];        encodedData[encodedIndex + 2] = lookUpBase64Alphabet[l << 2];        encodedData[encodedIndex + 3] = PAD;    }    if (isChunked) {                if (chunksSoFar < chunckCount) {            System.arraycopy(CHUNK_SEPARATOR, 0, encodedData, encodedDataLength - CHUNK_SEPARATOR.length, CHUNK_SEPARATOR.length);        }    }    return encodedData;}
public static String shiro_f1774_0(String base64Encoded)
{    byte[] encodedBytes = CodecSupport.toBytes(base64Encoded);    return decodeToString(encodedBytes);}
public static String shiro_f1775_0(byte[] base64Encoded)
{    byte[] decoded = decode(base64Encoded);    return CodecSupport.toString(decoded);}
public static byte[] shiro_f1776_0(String base64Encoded)
{    byte[] bytes = CodecSupport.toBytes(base64Encoded);    return decode(bytes);}
public static byte[] shiro_f1777_0(byte[] base64Data)
{        base64Data = discardNonBase64(base64Data);        if (base64Data.length == 0) {        return new byte[0];    }    int numberQuadruple = base64Data.length / FOURBYTE;    byte[] decodedData;    byte b1, b2, b3, b4, marker0, marker1;        int encodedIndex = 0;    int dataIndex;    {                int lastData = base64Data.length;                while (base64Data[lastData - 1] == PAD) {            if (--lastData == 0) {                return new byte[0];            }        }        decodedData = new byte[lastData - numberQuadruple];    }    for (int i = 0; i < numberQuadruple; i++) {        dataIndex = i * 4;        marker0 = base64Data[dataIndex + 2];        marker1 = base64Data[dataIndex + 3];        b1 = base64Alphabet[base64Data[dataIndex]];        b2 = base64Alphabet[base64Data[dataIndex + 1]];        if (marker0 != PAD && marker1 != PAD) {                        b3 = base64Alphabet[marker0];            b4 = base64Alphabet[marker1];            decodedData[encodedIndex] = (byte) (b1 << 2 | b2 >> 4);            decodedData[encodedIndex + 1] = (byte) (((b2 & 0xf) << 4) | ((b3 >> 2) & 0xf));            decodedData[encodedIndex + 2] = (byte) (b3 << 6 | b4);        } else if (marker0 == PAD) {                        decodedData[encodedIndex] = (byte) (b1 << 2 | b2 >> 4);        } else {                        b3 = base64Alphabet[marker0];            decodedData[encodedIndex] = (byte) (b1 << 2 | b2 >> 4);            decodedData[encodedIndex + 1] = (byte) (((b2 & 0xf) << 4) | ((b3 >> 2) & 0xf));        }        encodedIndex += 3;    }    return decodedData;}
 static byte[] shiro_f1778_0(byte[] data)
{    byte[] groomedData = new byte[data.length];    int bytesCopied = 0;    for (byte aByte : data) {        if (isBase64(aByte)) {            groomedData[bytesCopied++] = aByte;        }    }    byte[] packedData = new byte[bytesCopied];    System.arraycopy(groomedData, 0, packedData, 0, bytesCopied);    return packedData;}
public static byte[] shiro_f1779_0(char[] chars)
{    return toBytes(new String(chars), PREFERRED_ENCODING);}
public static byte[] shiro_f1780_0(char[] chars, String encoding) throws CodecException
{    return toBytes(new String(chars), encoding);}
public static byte[] shiro_f1781_0(String source)
{    return toBytes(source, PREFERRED_ENCODING);}
public static byte[] shiro_f1782_0(String source, String encoding) throws CodecException
{    try {        return source.getBytes(encoding);    } catch (UnsupportedEncodingException e) {        String msg = "Unable to convert source [" + source + "] to byte array using " + "encoding '" + encoding + "'";        throw new CodecException(msg, e);    }}
public static String shiro_f1783_0(byte[] bytes)
{    return toString(bytes, PREFERRED_ENCODING);}
public static String shiro_f1784_0(byte[] bytes, String encoding) throws CodecException
{    try {        return new String(bytes, encoding);    } catch (UnsupportedEncodingException e) {        String msg = "Unable to convert byte array to String with encoding '" + encoding + "'.";        throw new CodecException(msg, e);    }}
public static char[] shiro_f1785_0(byte[] bytes)
{    return toChars(bytes, PREFERRED_ENCODING);}
public static char[] shiro_f1786_0(byte[] bytes, String encoding) throws CodecException
{    return toString(bytes, encoding).toCharArray();}
protected boolean shiro_f1787_0(Object o)
{    return o instanceof byte[] || o instanceof char[] || o instanceof String || o instanceof ByteSource || o instanceof File || o instanceof InputStream;}
protected byte[] shiro_f1788_0(Object o)
{    if (o == null) {        String msg = "Argument for byte conversion cannot be null.";        throw new IllegalArgumentException(msg);    }    if (o instanceof byte[]) {        return (byte[]) o;    } else if (o instanceof ByteSource) {        return ((ByteSource) o).getBytes();    } else if (o instanceof char[]) {        return toBytes((char[]) o);    } else if (o instanceof String) {        return toBytes((String) o);    } else if (o instanceof File) {        return toBytes((File) o);    } else if (o instanceof InputStream) {        return toBytes((InputStream) o);    } else {        return objectToBytes(o);    }}
protected String shiro_f1789_0(Object o)
{    if (o == null) {        String msg = "Argument for String conversion cannot be null.";        throw new IllegalArgumentException(msg);    }    if (o instanceof byte[]) {        return toString((byte[]) o);    } else if (o instanceof char[]) {        return new String((char[]) o);    } else if (o instanceof String) {        return (String) o;    } else {        return objectToString(o);    }}
protected byte[] shiro_f1790_0(File file)
{    if (file == null) {        throw new IllegalArgumentException("File argument cannot be null.");    }    try {        return toBytes(new FileInputStream(file));    } catch (FileNotFoundException e) {        String msg = "Unable to acquire InputStream for file [" + file + "]";        throw new CodecException(msg, e);    }}
protected byte[] shiro_f1791_0(InputStream in)
{    if (in == null) {        throw new IllegalArgumentException("InputStream argument cannot be null.");    }    final int BUFFER_SIZE = 512;    ByteArrayOutputStream out = new ByteArrayOutputStream(BUFFER_SIZE);    byte[] buffer = new byte[BUFFER_SIZE];    int bytesRead;    try {        while ((bytesRead = in.read(buffer)) != -1) {            out.write(buffer, 0, bytesRead);        }        return out.toByteArray();    } catch (IOException ioe) {        throw new CodecException(ioe);    } finally {        try {            in.close();        } catch (IOException ignored) {        }        try {            out.close();        } catch (IOException ignored) {        }    }}
protected byte[] shiro_f1792_0(Object o)
{    String msg = "The " + getClass().getName() + " implementation only supports conversion to " + "byte[] if the source is of type byte[], char[], String, " + ByteSource.class.getName() + " File or InputStream.  The instance provided as a method " + "argument is of type [" + o.getClass().getName() + "].  If you would like to convert " + "this argument type to a byte[], you can 1) convert the argument to one of the supported types " + "yourself and then use that as the method argument or 2) subclass " + getClass().getName() + "and override the objectToBytes(Object o) method.";    throw new CodecException(msg);}
protected String shiro_f1793_0(Object o)
{    return o.toString();}
private static short shiro_f1794_0(byte b)
{    return (short) (b & 0xff);}
private static int shiro_f1795_0(byte[] bytes, int offset, int numBytes)
{    if (numBytes < 1 || numBytes > 4) {        throw new IllegalArgumentException("numBytes must be between 1 and 4.");    }        int val = toShort(bytes[offset]);    for (int i = 1; i < numBytes; i++) {                short s = toShort(bytes[offset + i]);        switch(i) {            case 1:                val |= s << 8;                break;            case 2:                val |= s << 16;                break;            case 3:                val |= s << 24;                break;        }    }    return val;}
private static void shiro_f1796_0(Appendable buf, char c)
{    try {        buf.append(c);    } catch (IOException e) {        throw new IllegalStateException("Unable to append character to internal buffer.", e);    }}
private static void shiro_f1797_0(int value, Appendable buf, int numChars)
{    for (int i = 0; i < numChars; i++) {        append(buf, itoa64[value & 0x3f]);        value >>= 6;    }}
public static String shiro_f1798_0(byte[] bytes)
{    if (bytes == null || bytes.length == 0)        return null;    StringBuilder buf = new StringBuilder();    int length = bytes.length;    int remainder = length % 3;        int i = 0;        int last3ByteIndex = length - remainder;    for (; i < last3ByteIndex; i += 3) {        int twentyFourBit = toInt(bytes, i, 3);        encodeAndAppend(twentyFourBit, buf, 4);    }    if (remainder > 0) {                int a = toInt(bytes, i, remainder);        encodeAndAppend(a, buf, remainder + 1);    }    return buf.toString();}
public static String shiro_f1799_0(byte[] bytes)
{    char[] encodedChars = encode(bytes);    return new String(encodedChars);}
public static char[] shiro_f1800_0(byte[] data)
{    int l = data.length;    char[] out = new char[l << 1];        for (int i = 0, j = 0; i < l; i++) {        out[j++] = DIGITS[(0xF0 & data[i]) >>> 4];        out[j++] = DIGITS[0x0F & data[i]];    }    return out;}
public static byte[] shiro_f1801_0(byte[] array) throws IllegalArgumentException
{    String s = CodecSupport.toString(array);    return decode(s);}
public static byte[] shiro_f1802_0(String hex)
{    return decode(hex.toCharArray());}
public static byte[] shiro_f1803_0(char[] data) throws IllegalArgumentException
{    int len = data.length;    if ((len & 0x01) != 0) {        throw new IllegalArgumentException("Odd number of characters.");    }    byte[] out = new byte[len >> 1];        for (int i = 0, j = 0; j < len; i++) {        int f = toDigit(data[j], j) << 4;        j++;        f = f | toDigit(data[j], j);        j++;        out[i] = (byte) (f & 0xFF);    }    return out;}
protected static int shiro_f1804_0(char ch, int index) throws IllegalArgumentException
{    int digit = Character.digit(ch, 16);    if (digit == -1) {        throw new IllegalArgumentException("Illegal hexadecimal character " + ch + " at index " + index);    }    return digit;}
protected Class<?> shiro_f1805_0(ObjectStreamClass osc) throws IOException, ClassNotFoundException
{    try {        return ClassUtils.forName(osc.getName());    } catch (UnknownClassException e) {        throw new ClassNotFoundException("Unable to load ObjectStreamClass [" + osc + "]: ", e);    }}
public byte[] shiro_f1806_0(T o) throws SerializationException
{    if (o == null) {        String msg = "argument cannot be null.";        throw new IllegalArgumentException(msg);    }    ByteArrayOutputStream baos = new ByteArrayOutputStream();    BufferedOutputStream bos = new BufferedOutputStream(baos);    try {        ObjectOutputStream oos = new ObjectOutputStream(bos);        oos.writeObject(o);        oos.close();        return baos.toByteArray();    } catch (IOException e) {        String msg = "Unable to serialize object [" + o + "].  " + "In order for the DefaultSerializer to serialize this object, the [" + o.getClass().getName() + "] " + "class must implement java.io.Serializable.";        throw new SerializationException(msg, e);    }}
public T shiro_f1807_0(byte[] serialized) throws SerializationException
{    if (serialized == null) {        String msg = "argument cannot be null.";        throw new IllegalArgumentException(msg);    }    ByteArrayInputStream bais = new ByteArrayInputStream(serialized);    BufferedInputStream bis = new BufferedInputStream(bais);    try {        ObjectInputStream ois = new ClassResolvingObjectInputStream(bis);        @SuppressWarnings({ "unchecked" })        T deserialized = (T) ois.readObject();        ois.close();        return deserialized;    } catch (Exception e) {        String msg = "Unable to deserialize argument byte array.";        throw new SerializationException(msg, e);    }}
public static boolean shiro_f1808_0(String resourcePath)
{    return resourcePath != null && (resourcePath.startsWith(CLASSPATH_PREFIX) || resourcePath.startsWith(URL_PREFIX) || resourcePath.startsWith(FILE_PREFIX));}
public static boolean shiro_f1809_0(String resourcePath)
{    InputStream stream = null;    boolean exists = false;    try {        stream = getInputStreamForPath(resourcePath);        exists = true;    } catch (IOException e) {        stream = null;    } finally {        if (stream != null) {            try {                stream.close();            } catch (IOException ignored) {            }        }    }    return exists;}
public static InputStream shiro_f1810_0(String resourcePath) throws IOException
{    InputStream is;    if (resourcePath.startsWith(CLASSPATH_PREFIX)) {        is = loadFromClassPath(stripPrefix(resourcePath));    } else if (resourcePath.startsWith(URL_PREFIX)) {        is = loadFromUrl(stripPrefix(resourcePath));    } else if (resourcePath.startsWith(FILE_PREFIX)) {        is = loadFromFile(stripPrefix(resourcePath));    } else {        is = loadFromFile(resourcePath);    }    if (is == null) {        throw new IOException("Resource [" + resourcePath + "] could not be found.");    }    return is;}
private static InputStream shiro_f1811_1(String path) throws IOException
{    if (log.isDebugEnabled()) {            }    return new FileInputStream(path);}
private static InputStream shiro_f1812_1(String urlPath) throws IOException
{        URL url = new URL(urlPath);    return url.openStream();}
private static InputStream shiro_f1813_1(String path)
{        return ClassUtils.getResourceAsStream(path);}
private static String shiro_f1814_0(String resourcePath)
{    return resourcePath.substring(resourcePath.indexOf(":") + 1);}
public static void shiro_f1815_1(InputStream is)
{    if (is != null) {        try {            is.close();        } catch (IOException e) {                    }    }}
public byte[] shiro_f1816_0(Object source)
{    if (source == null) {        String msg = "argument cannot be null.";        throw new IllegalArgumentException(msg);    }    ByteArrayOutputStream bos = new ByteArrayOutputStream();    XMLEncoder encoder = new XMLEncoder(new BufferedOutputStream(bos));    encoder.writeObject(source);    encoder.close();    return bos.toByteArray();}
public Object shiro_f1817_0(byte[] serialized)
{    if (serialized == null) {        throw new IllegalArgumentException("Argument cannot be null.");    }    ByteArrayInputStream bis = new ByteArrayInputStream(serialized);    XMLDecoder decoder = new XMLDecoder(new BufferedInputStream(bis));    Object o = decoder.readObject();    decoder.close();    return o;}
public static void shiro_f1818_0(boolean expression, String message)
{    if (!expression) {        throw new IllegalArgumentException(message);    }}
public static void shiro_f1819_0(boolean expression)
{    isTrue(expression, "[Assertion failed] - this expression must be true");}
public static void shiro_f1820_0(Object object, String message)
{    if (object != null) {        throw new IllegalArgumentException(message);    }}
public static void shiro_f1821_0(Object object)
{    isNull(object, "[Assertion failed] - the object argument must be null");}
public static void shiro_f1822_0(Object object, String message)
{    if (object == null) {        throw new IllegalArgumentException(message);    }}
public static void shiro_f1823_0(Object object)
{    notNull(object, "[Assertion failed] - this argument is required; it must not be null");}
public static void shiro_f1824_0(String text, String message)
{    if (!StringUtils.hasLength(text)) {        throw new IllegalArgumentException(message);    }}
public static void shiro_f1825_0(String text)
{    hasLength(text, "[Assertion failed] - this String argument must have length; it must not be null or empty");}
public static void shiro_f1826_0(String text, String message)
{    if (!StringUtils.hasText(text)) {        throw new IllegalArgumentException(message);    }}
public static void shiro_f1827_0(String text)
{    hasText(text, "[Assertion failed] - this String argument must have text; it must not be null, empty, or blank");}
public static void shiro_f1828_0(String textToSearch, String substring, String message)
{    if (StringUtils.hasLength(textToSearch) && StringUtils.hasLength(substring) && textToSearch.indexOf(substring) != -1) {        throw new IllegalArgumentException(message);    }}
public static void shiro_f1829_0(String textToSearch, String substring)
{    doesNotContain(textToSearch, substring, "[Assertion failed] - this String argument must not contain the substring [" + substring + "]");}
public static void shiro_f1830_0(Object[] array, String message)
{    if (array == null || array.length == 0) {        throw new IllegalArgumentException(message);    }}
public static void shiro_f1831_0(Object[] array)
{    notEmpty(array, "[Assertion failed] - this array must not be empty: it must contain at least 1 element");}
public static void shiro_f1832_0(Object[] array, String message)
{    if (array != null) {        for (int i = 0; i < array.length; i++) {            if (array[i] == null) {                throw new IllegalArgumentException(message);            }        }    }}
public static void shiro_f1833_0(Object[] array)
{    noNullElements(array, "[Assertion failed] - this array must not contain any null elements");}
public static void shiro_f1834_0(Collection collection, String message)
{    if (isEmpty(collection)) {        throw new IllegalArgumentException(message);    }}
public static void shiro_f1835_0(Collection collection)
{    notEmpty(collection, "[Assertion failed] - this collection must not be empty: it must contain at least 1 element");}
public static void shiro_f1836_0(Map map, String message)
{    if (isEmpty(map)) {        throw new IllegalArgumentException(message);    }}
public static void shiro_f1837_0(Map map)
{    notEmpty(map, "[Assertion failed] - this map must not be empty; it must contain at least one entry");}
public static void shiro_f1838_0(Class clazz, Object obj)
{    isInstanceOf(clazz, obj, "");}
public static void shiro_f1839_0(Class type, Object obj, String message)
{    notNull(type, "Type to check against must not be null");    if (!type.isInstance(obj)) {        throw new IllegalArgumentException(message + "Object of class [" + (obj != null ? obj.getClass().getName() : "null") + "] must be an instance of " + type);    }}
public static void shiro_f1840_0(Class superType, Class subType)
{    isAssignable(superType, subType, "");}
public static void shiro_f1841_0(Class superType, Class subType, String message)
{    notNull(superType, "Type to check against must not be null");    if (subType == null || !superType.isAssignableFrom(subType)) {        throw new IllegalArgumentException(message + subType + " is not assignable to " + superType);    }}
public static void shiro_f1842_0(boolean expression, String message)
{    if (!expression) {        throw new IllegalStateException(message);    }}
public static void shiro_f1843_0(boolean expression)
{    state(expression, "[Assertion failed] - this state invariant must be true");}
private static boolean shiro_f1844_0(Map m)
{    return m == null || m.isEmpty();}
private static boolean shiro_f1845_0(Collection c)
{    return c == null || c.isEmpty();}
public static ByteSource shiro_f1846_0(byte[] bytes)
{    return new SimpleByteSource(bytes);}
public static ByteSource shiro_f1847_0(char[] chars)
{    return new SimpleByteSource(chars);}
public static ByteSource shiro_f1848_0(String string)
{    return new SimpleByteSource(string);}
public static ByteSource shiro_f1849_0(ByteSource source)
{    return new SimpleByteSource(source);}
public static ByteSource shiro_f1850_0(File file)
{    return new SimpleByteSource(file);}
public static ByteSource shiro_f1851_0(InputStream stream)
{    return new SimpleByteSource(stream);}
public static boolean shiro_f1852_0(Object source)
{    return SimpleByteSource.isCompatible(source);}
public static ByteSource shiro_f1853_0(Object source) throws IllegalArgumentException
{    if (source == null) {        return null;    }    if (!isCompatible(source)) {        String msg = "Unable to heuristically acquire bytes for object of type [" + source.getClass().getName() + "].  If this type is indeed a byte-backed data type, you might " + "want to write your own ByteSource implementation to extract its bytes explicitly.";        throw new IllegalArgumentException(msg);    }    if (source instanceof byte[]) {        return bytes((byte[]) source);    } else if (source instanceof ByteSource) {        return (ByteSource) source;    } else if (source instanceof char[]) {        return bytes((char[]) source);    } else if (source instanceof String) {        return bytes((String) source);    } else if (source instanceof File) {        return bytes((File) source);    } else if (source instanceof InputStream) {        return bytes((InputStream) source);    } else {        throw new IllegalStateException("Encountered unexpected byte source.  This is a bug - please notify " + "the Shiro developer list asap (the isCompatible implementation does not reflect this " + "method's implementation).");    }}
protected ClassLoader shiro_f1854_0() throws Throwable
{    return Thread.currentThread().getContextClassLoader();}
protected ClassLoader shiro_f1855_0() throws Throwable
{    return ClassUtils.class.getClassLoader();}
protected ClassLoader shiro_f1856_0() throws Throwable
{    return ClassLoader.getSystemClassLoader();}
public static InputStream shiro_f1857_0(String name)
{    InputStream is = THREAD_CL_ACCESSOR.getResourceStream(name);    if (is == null) {        if (log.isTraceEnabled()) {            log.trace("Resource [" + name + "] was not found via the thread context ClassLoader.  Trying the " + "current ClassLoader...");        }        is = CLASS_CL_ACCESSOR.getResourceStream(name);    }    if (is == null) {        if (log.isTraceEnabled()) {            log.trace("Resource [" + name + "] was not found via the current class loader.  Trying the " + "system/application ClassLoader...");        }        is = SYSTEM_CL_ACCESSOR.getResourceStream(name);    }    if (is == null && log.isTraceEnabled()) {        log.trace("Resource [" + name + "] was not found via the thread context, current, or " + "system/application ClassLoaders.  All heuristics have been exhausted.  Returning null.");    }    return is;}
public static Class shiro_f1858_0(String fqcn) throws UnknownClassException
{    Class clazz = THREAD_CL_ACCESSOR.loadClass(fqcn);    if (clazz == null) {        if (log.isTraceEnabled()) {            log.trace("Unable to load class named [" + fqcn + "] from the thread context ClassLoader.  Trying the current ClassLoader...");        }        clazz = CLASS_CL_ACCESSOR.loadClass(fqcn);    }    if (clazz == null) {        if (log.isTraceEnabled()) {            log.trace("Unable to load class named [" + fqcn + "] from the current ClassLoader.  " + "Trying the system/application ClassLoader...");        }        clazz = SYSTEM_CL_ACCESSOR.loadClass(fqcn);    }    if (clazz == null) {        String msg = "Unable to load class named [" + fqcn + "] from the thread context, current, or " + "system/application ClassLoaders.  All heuristics have been exhausted.  Class could not be found.";        throw new UnknownClassException(msg);    }    return clazz;}
public static boolean shiro_f1859_0(String fullyQualifiedClassName)
{    try {        forName(fullyQualifiedClassName);        return true;    } catch (UnknownClassException e) {        return false;    }}
public static Object shiro_f1860_0(String fqcn)
{    return newInstance(forName(fqcn));}
public static Object shiro_f1861_0(String fqcn, Object... args)
{    return newInstance(forName(fqcn), args);}
public static Object shiro_f1862_0(Class clazz)
{    if (clazz == null) {        String msg = "Class method parameter cannot be null.";        throw new IllegalArgumentException(msg);    }    try {        return clazz.newInstance();    } catch (Exception e) {        throw new InstantiationException("Unable to instantiate class [" + clazz.getName() + "]", e);    }}
public static Object shiro_f1863_0(Class clazz, Object... args)
{    Class[] argTypes = new Class[args.length];    for (int i = 0; i < args.length; i++) {        argTypes[i] = args[i].getClass();    }    Constructor ctor = getConstructor(clazz, argTypes);    return instantiate(ctor, args);}
public static Constructor shiro_f1864_0(Class clazz, Class... argTypes)
{    try {        return clazz.getConstructor(argTypes);    } catch (NoSuchMethodException e) {        throw new IllegalStateException(e);    }}
public static Object shiro_f1865_0(Constructor ctor, Object... args)
{    try {        return ctor.newInstance(args);    } catch (Exception e) {        String msg = "Unable to instantiate Permission instance with constructor [" + ctor + "]";        throw new InstantiationException(msg, e);    }}
public static List<Method> shiro_f1866_0(final Class<?> type, final Class<? extends Annotation> annotation)
{    final List<Method> methods = new ArrayList<Method>();    Class<?> clazz = type;    while (!Object.class.equals(clazz)) {        Method[] currentClassMethods = clazz.getDeclaredMethods();        for (final Method method : currentClassMethods) {            if (annotation == null || method.isAnnotationPresent(annotation)) {                methods.add(method);            }        }                clazz = clazz.getSuperclass();    }    return methods;}
public Class shiro_f1867_0(String fqcn)
{    Class clazz = null;    ClassLoader cl = getClassLoader();    if (cl != null) {        try {            clazz = cl.loadClass(fqcn);        } catch (ClassNotFoundException e) {            if (log.isTraceEnabled()) {                log.trace("Unable to load clazz named [" + fqcn + "] from class loader [" + cl + "]");            }        }    }    return clazz;}
public InputStream shiro_f1868_0(String name)
{    InputStream is = null;    ClassLoader cl = getClassLoader();    if (cl != null) {        is = cl.getResourceAsStream(name);    }    return is;}
protected final ClassLoader shiro_f1869_1()
{    try {        return doGetClassLoader();    } catch (Throwable t) {        if (log.isDebugEnabled()) {                    }    }    return null;}
public static void shiro_f1870_0(Object o) throws ShiroException
{    if (o instanceof Initializable) {        init((Initializable) o);    }}
public static void shiro_f1871_0(Initializable initializable) throws ShiroException
{    initializable.init();}
public static void shiro_f1872_0(Collection c) throws ShiroException
{    if (c == null || c.isEmpty()) {        return;    }    for (Object o : c) {        init(o);    }}
public static void shiro_f1873_0(Object o)
{    if (o instanceof Destroyable) {        destroy((Destroyable) o);    } else if (o instanceof Collection) {        destroy((Collection) o);    }}
public static void shiro_f1874_1(Destroyable d)
{    if (d != null) {        try {            d.destroy();        } catch (Throwable t) {            if (log.isDebugEnabled()) {                String msg = "Unable to cleanly destroy instance [" + d + "] of type [" + d.getClass().getName() + "].";                            }        }    }}
public static void shiro_f1875_0(Collection c)
{    if (c == null || c.isEmpty()) {        return;    }    for (Object o : c) {        destroy(o);    }}
public static boolean shiro_f1876_0(Object o)
{    return o instanceof byte[] || o instanceof char[] || o instanceof String || o instanceof ByteSource || o instanceof File || o instanceof InputStream;}
public byte[] shiro_f1877_0()
{    return this.bytes;}
public boolean shiro_f1878_0()
{    return this.bytes == null || this.bytes.length == 0;}
public String shiro_f1879_0()
{    if (this.cachedHex == null) {        this.cachedHex = Hex.encodeToString(getBytes());    }    return this.cachedHex;}
public String shiro_f1880_0()
{    if (this.cachedBase64 == null) {        this.cachedBase64 = Base64.encodeToString(getBytes());    }    return this.cachedBase64;}
public String shiro_f1881_0()
{    return toBase64();}
public int shiro_f1882_0()
{    if (this.bytes == null || this.bytes.length == 0) {        return 0;    }    return Arrays.hashCode(this.bytes);}
public boolean shiro_f1883_0(Object o)
{    if (o == this) {        return true;    }    if (o instanceof ByteSource) {        ByteSource bs = (ByteSource) o;        return Arrays.equals(getBytes(), bs.getBytes());    }    return false;}
public byte[] shiro_f1884_0(File file)
{    return toBytes(file);}
public byte[] shiro_f1885_0(InputStream stream)
{    return toBytes(stream);}
public V shiro_f1886_0(Object key)
{    processQueue();    V result = null;    SoftValue<V, K> value = map.get(key);    if (value != null) {                result = value.get();        if (result == null) {                                    map.remove(key);        } else {                        addToStrongReferences(result);        }    }    return result;}
private void shiro_f1887_0(V result)
{    strongReferencesLock.lock();    try {        strongReferences.add(result);        trimStrongReferencesIfNecessary();    } finally {        strongReferencesLock.unlock();    }}
private void shiro_f1888_0()
{        while (strongReferences.size() > RETENTION_SIZE) {        strongReferences.poll();    }}
private void shiro_f1889_0()
{    SoftValue sv;    while ((sv = (SoftValue) queue.poll()) != null) {                        map.remove(sv.key);    }}
public boolean shiro_f1890_0()
{    processQueue();    return map.isEmpty();}
public boolean shiro_f1891_0(Object key)
{    processQueue();    return map.containsKey(key);}
public boolean shiro_f1892_0(Object value)
{    processQueue();    Collection values = values();    return values != null && values.contains(value);}
public void shiro_f1893_0(Map<? extends K, ? extends V> m)
{    if (m == null || m.isEmpty()) {        processQueue();        return;    }    for (Map.Entry<? extends K, ? extends V> entry : m.entrySet()) {        put(entry.getKey(), entry.getValue());    }}
public Set<K> shiro_f1894_0()
{    processQueue();    return map.keySet();}
public Collection<V> shiro_f1895_0()
{    processQueue();    Collection<K> keys = map.keySet();    if (keys.isEmpty()) {                return Collections.EMPTY_SET;    }    Collection<V> values = new ArrayList<V>(keys.size());    for (K key : keys) {        V v = get(key);        if (v != null) {            values.add(v);        }    }    return values;}
public V shiro_f1896_0(K key, V value)
{        processQueue();    SoftValue<V, K> sv = new SoftValue<V, K>(value, key, queue);    SoftValue<V, K> previous = map.put(key, sv);    addToStrongReferences(value);    return previous != null ? previous.get() : null;}
public V shiro_f1897_0(Object key)
{        processQueue();    SoftValue<V, K> raw = map.remove(key);    return raw != null ? raw.get() : null;}
public void shiro_f1898_0()
{    strongReferencesLock.lock();    try {        strongReferences.clear();    } finally {        strongReferencesLock.unlock();    }        processQueue();    map.clear();}
public int shiro_f1899_0()
{        processQueue();    return map.size();}
public Set<Map.Entry<K, V>> shiro_f1900_0()
{        processQueue();    Collection<K> keys = map.keySet();    if (keys.isEmpty()) {                return Collections.EMPTY_SET;    }    Map<K, V> kvPairs = new HashMap<K, V>(keys.size());    for (K key : keys) {        V v = get(key);        if (v != null) {            kvPairs.put(key, v);        }    }    return kvPairs.entrySet();}
public static boolean shiro_f1901_0(String str)
{    if (!hasLength(str)) {        return false;    }    int strLen = str.length();    for (int i = 0; i < strLen; i++) {        if (!Character.isWhitespace(str.charAt(i))) {            return true;        }    }    return false;}
public static boolean shiro_f1902_0(String str)
{    return (str != null && str.length() > 0);}
public static boolean shiro_f1903_0(String str, String prefix)
{    if (str == null || prefix == null) {        return false;    }    if (str.startsWith(prefix)) {        return true;    }    if (str.length() < prefix.length()) {        return false;    }    String lcStr = str.substring(0, prefix.length()).toLowerCase();    String lcPrefix = prefix.toLowerCase();    return lcStr.equals(lcPrefix);}
public static String shiro_f1904_0(String in)
{    String out = in;    if (in != null) {        out = in.trim();        if (out.equals(EMPTY_STRING)) {            out = null;        }    }    return out;}
public static String shiro_f1905_0(Object[] array)
{    return toDelimitedString(array, ",");}
public static String shiro_f1906_0(Object[] array, String delimiter)
{    if (array == null || array.length == 0) {        return EMPTY_STRING;    }    StringBuilder sb = new StringBuilder();    for (int i = 0; i < array.length; i++) {        if (i > 0) {            sb.append(delimiter);        }        sb.append(array[i]);    }    return sb.toString();}
public static String shiro_f1907_0(Collection c, String delimiter)
{    if (c == null || c.isEmpty()) {        return EMPTY_STRING;    }    return join(c.iterator(), delimiter);}
public static String[] shiro_f1908_0(String str, String delimiters)
{    return tokenizeToStringArray(str, delimiters, true, true);}
public static String[] shiro_f1909_0(String str, String delimiters, boolean trimTokens, boolean ignoreEmptyTokens)
{    if (str == null) {        return null;    }    StringTokenizer st = new StringTokenizer(str, delimiters);    List tokens = new ArrayList();    while (st.hasMoreTokens()) {        String token = st.nextToken();        if (trimTokens) {            token = token.trim();        }        if (!ignoreEmptyTokens || token.length() > 0) {            tokens.add(token);        }    }    return toStringArray(tokens);}
public static String[] shiro_f1910_0(Collection collection)
{    if (collection == null) {        return null;    }    return (String[]) collection.toArray(new String[collection.size()]);}
public static String[] shiro_f1911_0(String aLine) throws ParseException
{    String line = clean(aLine);    if (line == null) {        return null;    }    String[] split = line.split(" ", 2);    if (split.length != 2) {                split = line.split("=", 2);        if (split.length != 2) {            String msg = "Unable to determine Key/Value pair from line [" + line + "].  There is no space from " + "which the split location could be determined.";            throw new ParseException(msg, 0);        }    }    split[0] = clean(split[0]);    split[1] = clean(split[1]);    if (split[1].startsWith("=")) {                        split[1] = clean(split[1].substring(1));    }    if (split[0] == null) {        String msg = "No valid key could be found in line [" + line + "] to form a key/value pair.";        throw new ParseException(msg, 0);    }    if (split[1] == null) {        String msg = "No corresponding value could be found in line [" + line + "] for key [" + split[0] + "]";        throw new ParseException(msg, 0);    }    return split;}
public static String[] shiro_f1912_0(String line)
{    return split(line, DEFAULT_DELIMITER_CHAR);}
public static String[] shiro_f1913_0(String line, char delimiter)
{    return split(line, delimiter, DEFAULT_QUOTE_CHAR);}
public static String[] shiro_f1914_0(String line, char delimiter, char quoteChar)
{    return split(line, delimiter, quoteChar, quoteChar);}
public static String[] shiro_f1915_0(String line, char delimiter, char beginQuoteChar, char endQuoteChar)
{    return split(line, delimiter, beginQuoteChar, endQuoteChar, false, true);}
public static String[] shiro_f1916_0(String aLine, char delimiter, char beginQuoteChar, char endQuoteChar, boolean retainQuotes, boolean trimTokens)
{    String line = clean(aLine);    if (line == null) {        return null;    }    List<String> tokens = new ArrayList<String>();    StringBuilder sb = new StringBuilder();    boolean inQuotes = false;    for (int i = 0; i < line.length(); i++) {        char c = line.charAt(i);        if (c == beginQuoteChar) {                        if (            inQuotes &&             line.length() > (i + 1) && line.charAt(i + 1) == beginQuoteChar) {                                                                sb.append(line.charAt(i + 1));                i++;            } else {                inQuotes = !inQuotes;                if (retainQuotes) {                    sb.append(c);                }            }        } else if (c == endQuoteChar) {            inQuotes = !inQuotes;            if (retainQuotes) {                sb.append(c);            }        } else if (c == delimiter && !inQuotes) {            String s = sb.toString();            if (trimTokens) {                s = s.trim();            }            tokens.add(s);                        sb = new StringBuilder();        } else {            sb.append(c);        }    }    String s = sb.toString();    if (trimTokens) {        s = s.trim();    }    tokens.add(s);    return tokens.toArray(new String[tokens.size()]);}
public static String shiro_f1917_0(Iterator<?> iterator, String separator)
{    final String empty = "";        if (iterator == null) {        return null;    }    if (!iterator.hasNext()) {        return empty;    }    Object first = iterator.next();    if (!iterator.hasNext()) {        return first == null ? empty : first.toString();    }            StringBuilder buf = new StringBuilder(256);    if (first != null) {        buf.append(first);    }    while (iterator.hasNext()) {        if (separator != null) {            buf.append(separator);        }        Object obj = iterator.next();        if (obj != null) {            buf.append(obj);        }    }    return buf.toString();}
public static Set<String> shiro_f1918_0(String delimited, String separator)
{    if (delimited == null || separator == null) {        return null;    }    String[] split = split(delimited, separator.charAt(0));    return asSet(split);}
public static String shiro_f1919_0(String in)
{    if (in == null || in.length() == 0) {        return in;    }    int length = in.length();    StringBuilder sb = new StringBuilder(length);    sb.append(Character.toUpperCase(in.charAt(0)));    if (length > 1) {        String remaining = in.substring(1);        sb.append(remaining);    }    return sb.toString();}
private static Set<E> shiro_f1920_0(E... elements)
{    if (elements == null || elements.length == 0) {        return Collections.emptySet();    }    if (elements.length == 1) {        return Collections.singleton(elements[0]);    }    LinkedHashSet<E> set = new LinkedHashSet<E>(elements.length * 4 / 3 + 1);    Collections.addAll(set, elements);    return set;}
public long shiro_f1921_0()
{    return _id;}
public String shiro_f1922_0()
{    return _ownerName;}
public boolean shiro_f1923_0()
{    return _isActive;}
public void shiro_f1924_0(boolean aIsActive)
{    _isActive = aIsActive;}
public void shiro_f1925_0(String aOwnerName)
{    _ownerName = aOwnerName;}
public double shiro_f1926_0()
{    return _balance;}
public List<AccountTransaction> shiro_f1927_0()
{    return _transactions;}
protected void shiro_f1928_0(AccountTransaction aTransaction) throws NotEnoughFundsException, InactiveAccountException
{    if (!_isActive) {        throw new InactiveAccountException("Unable to apply " + aTransaction.getType() + " of amount " + aTransaction.getAmount() + " to account " + _id);    }    synchronized (_transactions) {        if (AccountTransaction.TransactionType.DEPOSIT == aTransaction.getType()) {            _transactions.add(aTransaction);            _balance += aTransaction.getAmount();        } else if (AccountTransaction.TransactionType.WITHDRAWAL == aTransaction.getType()) {            if (_balance < aTransaction.getAmount()) {                throw new NotEnoughFundsException("Unable to withdraw " + aTransaction.getAmount() + "$ from account " + _id + " - current balance is " + _balance);            }            _transactions.add(aTransaction);            _balance -= aTransaction.getAmount();        } else {            throw new IllegalArgumentException("The transaction passed in has an invalid type: " + aTransaction.getType());        }    }}
protected void shiro_f1929_0(String aCreatedBy)
{    _createdBy = aCreatedBy;}
public String shiro_f1930_0()
{    return _createdBy;}
public Date shiro_f1931_0()
{    return _creationDate;}
public String shiro_f1932_0()
{    return new ToStringBuilder(this, ToStringStyle.SHORT_PREFIX_STYLE).append("id", _id).append("ownerName", _ownerName).append("isActive", _isActive).append("balance", _balance).append("tx.count", _transactions.size()).append("createdBy", _createdBy).append("creationDate", new Timestamp(_creationDate.getTime())).toString();}
public static AccountTransaction shiro_f1933_0(long anAccountId, double anAmount)
{    return new AccountTransaction(TransactionType.DEPOSIT, anAccountId, anAmount);}
public static AccountTransaction shiro_f1934_0(long anAccountId, double anAmount)
{    return new AccountTransaction(TransactionType.WITHDRAWAL, anAccountId, anAmount);}
public long shiro_f1935_0()
{    return _id;}
public TransactionType shiro_f1936_0()
{    return _type;}
public long shiro_f1937_0()
{    return _accountId;}
public double shiro_f1938_0()
{    return _amount;}
protected void shiro_f1939_0(String aCreatedBy)
{    _createdBy = aCreatedBy;}
public String shiro_f1940_0()
{    return _createdBy;}
public Date shiro_f1941_0()
{    return _creationDate;}
public String shiro_f1942_0()
{    return new ToStringBuilder(this, ToStringStyle.SHORT_PREFIX_STYLE).append("id", _id).append("type", _type).append("accountId", _accountId).append("amount", _amount).append("createdBy", _createdBy).append("creationDate", new Timestamp(_creationDate.getTime())).toString();}
public synchronized void shiro_f1943_0() throws Exception
{    if (_bankService == null) {        _bankService = new SecureBankService();        _bankService.start();    }}
public synchronized void shiro_f1944_0()
{    if (_bankService != null) {        try {            _bankService.dispose();        } finally {            _bankService = null;        }    }}
public BankService shiro_f1945_0()
{    return _bankService;}
public static void shiro_f1946_0(String[] args)
{    try {        BankServerRunner server = new BankServerRunner();        server.start();        server.stop();    } catch (Exception e) {        e.printStackTrace();    }}
public Date shiro_f1947_0()
{    return _creationDate;}
public double shiro_f1948_0()
{    return _amount;}
public String shiro_f1949_0()
{    return _madeBy;}
public void shiro_f1950_1() throws Exception
{    _isRunning = true;    }
public void shiro_f1951_1()
{        _isRunning = false;    synchronized (_accounts) {        _accountsById.clear();        _accounts.clear();    }    }
protected void shiro_f1952_0()
{    if (!_isRunning) {        throw new IllegalStateException("This bank service is not running");    }}
public int shiro_f1953_0()
{    return _accounts.size();}
public long shiro_f1954_1(String anOwnerName)
{    assertServiceState();        synchronized (_accounts) {        Account account = new Account(anOwnerName);        account.setCreatedBy(getCurrentUsername());        _accounts.add(account);        _accountsById.put(account.getId(), account);                return account.getId();    }}
public long[] shiro_f1955_1(String anOwnerName)
{    assertServiceState();        ArrayList<Account> matchAccounts = new ArrayList<Account>();    synchronized (_accounts) {        for (Account a : _accounts) {            if (a.getOwnerName().toLowerCase().contains(anOwnerName.toLowerCase())) {                matchAccounts.add(a);            }        }    }    long[] accountIds = new long[matchAccounts.size()];    int index = 0;    for (Account a : matchAccounts) {        accountIds[index++] = a.getId();    }        return accountIds;}
public String shiro_f1956_1(long anAccountId) throws AccountNotFoundException
{    assertServiceState();        Account a = safellyRetrieveAccountForId(anAccountId);    return a.getOwnerName();}
public double shiro_f1957_1(long anAccountId) throws AccountNotFoundException
{    assertServiceState();        Account a = safellyRetrieveAccountForId(anAccountId);    return a.getBalance();}
public double shiro_f1958_1(long anAccountId, double anAmount) throws AccountNotFoundException, InactiveAccountException
{    assertServiceState();        try {        Account a = safellyRetrieveAccountForId(anAccountId);        AccountTransaction tx = AccountTransaction.createDepositTx(anAccountId, anAmount);        tx.setCreatedBy(getCurrentUsername());                a.applyTransaction(tx);                return a.getBalance();    } catch (NotEnoughFundsException nefe) {        throw new IllegalStateException("Should never happen", nefe);    }}
public double shiro_f1959_1(long anAccountId, double anAmount) throws AccountNotFoundException, NotEnoughFundsException, InactiveAccountException
{    assertServiceState();        Account a = safellyRetrieveAccountForId(anAccountId);    AccountTransaction tx = AccountTransaction.createWithdrawalTx(anAccountId, anAmount);    tx.setCreatedBy(getCurrentUsername());        a.applyTransaction(tx);        return a.getBalance();}
public TxLog[] shiro_f1960_1(long anAccountId) throws AccountNotFoundException
{    assertServiceState();        Account a = safellyRetrieveAccountForId(anAccountId);    TxLog[] txs = new TxLog[a.getTransactions().size()];    int index = 0;    for (AccountTransaction tx : a.getTransactions()) {                if (TransactionType.DEPOSIT == tx.getType()) {            txs[index++] = new TxLog(tx.getCreationDate(), tx.getAmount(), tx.getCreatedBy());        } else {            txs[index++] = new TxLog(tx.getCreationDate(), -1.0d * tx.getAmount(), tx.getCreatedBy());        }    }    return txs;}
public double shiro_f1961_1(long anAccountId) throws AccountNotFoundException, InactiveAccountException
{    assertServiceState();        Account a = safellyRetrieveAccountForId(anAccountId);    if (!a.isActive()) {        throw new InactiveAccountException("The account " + anAccountId + " is already closed");    }    try {        AccountTransaction tx = AccountTransaction.createWithdrawalTx(a.getId(), a.getBalance());        tx.setCreatedBy(getCurrentUsername());                a.applyTransaction(tx);        a.setActive(false);                return tx.getAmount();    } catch (NotEnoughFundsException nefe) {        throw new IllegalStateException("Should never happen", nefe);    }}
public boolean shiro_f1962_1(long anAccountId) throws AccountNotFoundException
{    assertServiceState();        Account a = safellyRetrieveAccountForId(anAccountId);    return a.isActive();}
protected Account shiro_f1963_1(long anAccountId) throws AccountNotFoundException
{    Account account = null;    synchronized (_accounts) {        account = _accountsById.get(anAccountId);    }    if (account == null) {        throw new AccountNotFoundException("No account found for the id " + anAccountId);    }        return account;}
protected String shiro_f1964_0()
{    Subject subject = SecurityUtils.getSubject();    if (subject == null || subject.getPrincipal() == null || !subject.isAuthenticated()) {        throw new IllegalStateException("Unable to retrieve the current authenticated subject");    }    return SecurityUtils.getSubject().getPrincipal().toString();}
public static void shiro_f1965_0() throws Exception
{    Factory<SecurityManager> factory = new IniSecurityManagerFactory("classpath:shiroBankServiceTest.ini");    SecurityManager securityManager = factory.getInstance();    SecurityUtils.setSecurityManager(securityManager);    service = new SecureBankService();    service.start();}
public static void shiro_f1966_0()
{    if (service != null) {        service.dispose();    }}
public void shiro_f1967_1() throws Exception
{        Thread.sleep(50);}
public void shiro_f1968_0()
{    if (_subject != null) {        _subject.logout();    }}
protected void shiro_f1969_0()
{    if (_subject != null) {        _subject.logout();    }}
protected void shiro_f1970_0()
{    if (_subject == null) {        _subject = SecurityUtils.getSubject();    }        _subject.login(new UsernamePasswordToken("dan", "123"));}
protected void shiro_f1971_0()
{    if (_subject == null) {        _subject = SecurityUtils.getSubject();    }        _subject.login(new UsernamePasswordToken("sally", "1234"));}
public void shiro_f1972_0() throws Exception
{    loginAsUser();    createAndValidateAccountFor("Bob Smith");}
public void shiro_f1973_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Joe Smith");    makeDepositAndValidateAccount(accountId, 250, "Joe Smith");}
public void shiro_f1974_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Everett Smith");    makeDepositAndValidateAccount(accountId, 50, "Everett Smith");    makeDepositAndValidateAccount(accountId, 300, "Everett Smith");    makeDepositAndValidateAccount(accountId, 85, "Everett Smith");    assertAccount("Everett Smith", true, 435, 3, accountId);}
public void shiro_f1975_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Wally Smith");    service.withdrawFrom(accountId, 100);}
public void shiro_f1976_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Frank Smith");    makeDepositAndValidateAccount(accountId, 50, "Frank Smith");    service.withdrawFrom(accountId, 100);}
public void shiro_f1977_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Al Smith");    makeDepositAndValidateAccount(accountId, 500, "Al Smith");    makeWithdrawalAndValidateAccount(accountId, 100, "Al Smith");    assertAccount("Al Smith", true, 400, 2, accountId);}
public void shiro_f1978_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Zoe Smith");    makeDepositAndValidateAccount(accountId, 500, "Zoe Smith");    makeWithdrawalAndValidateAccount(accountId, 100, "Zoe Smith");    makeWithdrawalAndValidateAccount(accountId, 75, "Zoe Smith");    makeWithdrawalAndValidateAccount(accountId, 125, "Zoe Smith");    assertAccount("Zoe Smith", true, 200, 4, accountId);}
public void shiro_f1979_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Zoe Smith");    makeDepositAndValidateAccount(accountId, 500, "Zoe Smith");    makeWithdrawalAndValidateAccount(accountId, 500, "Zoe Smith");    assertAccount("Zoe Smith", true, 0, 2, accountId);}
public void shiro_f1980_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Chris Smith");    logoutCurrentSubject();    loginAsSuperviser();    double closingBalance = service.closeAccount(accountId);    Assert.assertEquals(0, (int) closingBalance);    assertAccount("Chris Smith", false, 0, 1, accountId);}
public void shiro_f1981_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Gerry Smith");    makeDepositAndValidateAccount(accountId, 385, "Gerry Smith");    logoutCurrentSubject();    loginAsSuperviser();    double closingBalance = service.closeAccount(accountId);    Assert.assertEquals(385, (int) closingBalance);    assertAccount("Gerry Smith", false, 0, 2, accountId);}
public void shiro_f1982_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Chris Smith");    logoutCurrentSubject();    loginAsSuperviser();    double closingBalance = service.closeAccount(accountId);    Assert.assertEquals(0, (int) closingBalance);    assertAccount("Chris Smith", false, 0, 1, accountId);    service.closeAccount(accountId);}
public void shiro_f1983_0() throws Exception
{    loginAsUser();    long accountId = createAndValidateAccountFor("Chris Smith");    service.closeAccount(accountId);}
protected long shiro_f1984_0(String anOwner) throws Exception
{    long createdId = service.createNewAccount(anOwner);    assertAccount(anOwner, true, 0, 0, createdId);    return createdId;}
protected double shiro_f1985_0(long anAccountId, int anAmount, String eOwnerName) throws Exception
{    double previousBalance = service.getBalanceOf(anAccountId);    int previousTxCount = service.getTxHistoryFor(anAccountId).length;    double newBalance = service.depositInto(anAccountId, anAmount);    Assert.assertEquals((int) previousBalance + anAmount, (int) newBalance);    assertAccount(eOwnerName, true, (int) newBalance, 1 + previousTxCount, anAccountId);    return newBalance;}
protected double shiro_f1986_0(long anAccountId, int anAmount, String eOwnerName) throws Exception
{    double previousBalance = service.getBalanceOf(anAccountId);    int previousTxCount = service.getTxHistoryFor(anAccountId).length;    double newBalance = service.withdrawFrom(anAccountId, anAmount);    Assert.assertEquals((int) previousBalance - anAmount, (int) newBalance);    assertAccount(eOwnerName, true, (int) newBalance, 1 + previousTxCount, anAccountId);    return newBalance;}
public static void shiro_f1987_0(String eOwnerName, boolean eIsActive, int eBalance, int eTxLogCount, long actualAccountId) throws Exception
{    Assert.assertEquals(eOwnerName, service.getOwnerOf(actualAccountId));    Assert.assertEquals(eIsActive, service.isAccountActive(actualAccountId));    Assert.assertEquals(eBalance, (int) service.getBalanceOf(actualAccountId));    Assert.assertEquals(eTxLogCount, service.getTxHistoryFor(actualAccountId).length);}
public void shiro_f1988_0(final ServletContextEvent servletContextEvent)
{    this.servletContext = servletContextEvent.getServletContext();    super.contextInitialized(servletContextEvent);}
protected Injector shiro_f1989_0()
{        return Guice.createInjector(new SampleShiroNativeSessionsServletModule(servletContext), ShiroWebModule.guiceFilterModule());}
protected void shiro_f1990_0()
{    bindConstant().annotatedWith(Names.named("shiro.loginUrl")).to("/login.jsp");    try {        this.bindRealm().toConstructor(IniRealm.class.getConstructor(Ini.class));    } catch (NoSuchMethodException e) {        addError("Could not locate proper constructor for IniRealm.", e);    }    this.addFilterChain("/login.jsp", AUTHC);    this.addFilterChain("/logout", LOGOUT);    this.addFilterChain("/account/**", AUTHC);    this.addFilterChain("/remoting/**", filterConfig(AUTHC), filterConfig(ROLES, "b2bClient"), filterConfig(PERMS, "remote:invoke:lan,wan"));}
 Ini shiro_f1991_0() throws MalformedURLException
{    URL iniUrl = servletContext.getResource("/WEB-INF/shiro.ini");    return Ini.fromResourcePath("url:" + iniUrl.toExternalForm());}
protected void shiro_f1992_0(AnnotatedBindingBuilder<SessionManager> bind)
{    bind.to(DefaultWebSessionManager.class);    bindConstant().annotatedWith(Names.named("shiro.globalSessionTimeout")).to(5000L);    bindConstant().annotatedWith(Names.named("shiro.sessionIdUrlRewritingEnabled")).to(false);    bind(DefaultWebSessionManager.class);    bind(Cookie.class).toInstance(new SimpleCookie("myCookie"));}
protected void shiro_f1993_0(AnnotatedBindingBuilder<? super WebSecurityManager> bind)
{    try {        String cipherKey = loadShiroIni().getSectionProperty("main", "securityManager.rememberMeManager.cipherKey");        DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();        CookieRememberMeManager rememberMeManager = new CookieRememberMeManager();        rememberMeManager.setCipherKey(Base64.decode(cipherKey));        securityManager.setRememberMeManager(rememberMeManager);        bind.toInstance(securityManager);    } catch (MalformedURLException e) {                throw new ConfigurationException("securityManager.rememberMeManager.cipherKey must be set in shiro.ini.");    }}
protected void shiro_f1994_0()
{    bindConstant().annotatedWith(Names.named("shiro.loginUrl")).to("/login.jsp");    try {        this.bindRealm().toConstructor(IniRealm.class.getConstructor(Ini.class));    } catch (NoSuchMethodException e) {        addError("Could not locate proper constructor for IniRealm.", e);    }    this.addFilterChain("/login.jsp", AUTHC);    this.addFilterChain("/logout", LOGOUT);    this.addFilterChain("/account/**", AUTHC);    this.addFilterChain("/remoting/**", filterConfig(AUTHC), filterConfig(ROLES, "b2bClient"), filterConfig(PERMS, "remote:invoke:lan,wan"));}
 Ini shiro_f1995_0() throws MalformedURLException
{    URL iniUrl = servletContext.getResource("/WEB-INF/shiro.ini");    return Ini.fromResourcePath("url:" + iniUrl.toExternalForm());}
protected void shiro_f1996_0(AnnotatedBindingBuilder<? super WebSecurityManager> bind)
{    try {        String cipherKey = loadShiroIni().getSectionProperty("main", "securityManager.rememberMeManager.cipherKey");        DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();        CookieRememberMeManager rememberMeManager = new CookieRememberMeManager();        rememberMeManager.setCipherKey(Base64.decode(cipherKey));        securityManager.setRememberMeManager(rememberMeManager);        bind.toInstance(securityManager);    } catch (MalformedURLException e) {                throw new ConfigurationException("securityManager.rememberMeManager.cipherKey must be set in shiro.ini.");    }}
public void shiro_f1997_0() throws IOException
{        final HtmlPage homePage = webClient.getPage(getBaseUri());    try {        homePage.getAnchorByHref("/logout").click();    } catch (ElementNotFoundException e) {        }}
public void shiro_f1998_0() throws FailingHttpStatusCodeException, MalformedURLException, IOException, InterruptedException
{    HtmlPage page = webClient.getPage(getBaseUri() + "login.jsp");    HtmlForm form = page.getFormByName("loginform");    form.<HtmlInput>getInputByName("username").setValueAttribute("root");    form.<HtmlInput>getInputByName("password").setValueAttribute("secret");    page = form.<HtmlInput>getInputByName("submit").click();        page.getAnchorByHref("/logout");}
public void shiro_f1999_0() throws Exception
{    HtmlPage page = webClient.getPage(getBaseUri() + "login.jsp");    HtmlForm form = page.getFormByName("loginform");    form.<HtmlInput>getInputByName("username").setValueAttribute("root");    form.<HtmlInput>getInputByName("password").setValueAttribute("secret");    HtmlCheckBoxInput checkbox = form.getInputByName("rememberMe");    checkbox.setChecked(true);    page = form.<HtmlInput>getInputByName("submit").click();    jetty.stop();    jetty.start();    page = webClient.getPage(getBaseUri());        WebAssert.assertLinkPresentWithText(page, "Log out");    page = page.getAnchorByHref("/account").click();        WebAssert.assertFormPresent(page, "loginform");}
public String shiro_f2000_0(@QueryParam("words") @DefaultValue("Hello!") String words)
{    return words;}
public String shiro_f2001_0()
{    return "protected";}
public String shiro_f2002_0()
{    return "protected";}
public String shiro_f2003_0()
{    return "protected";}
public String shiro_f2004_0()
{    return "not protected";}
public String shiro_f2005_0()
{    return "protected";}
public Set<Class<?>> shiro_f2006_0()
{    Set<Class<?>> classes = new HashSet<Class<?>>();        classes.add(ShiroFeature.class);        classes.add(HelloResource.class);    classes.add(SecureResource.class);    return classes;}
public static void shiro_f2007_1(String[] args)
{                            Factory<SecurityManager> factory = new IniSecurityManagerFactory("classpath:shiro.ini");    SecurityManager securityManager = factory.getInstance();                            SecurityUtils.setSecurityManager(securityManager);            Subject currentUser = SecurityUtils.getSubject();        Session session = currentUser.getSession();    session.setAttribute("someKey", "aValue");    String value = (String) session.getAttribute("someKey");    if (value.equals("aValue")) {            }        if (!currentUser.isAuthenticated()) {        UsernamePasswordToken token = new UsernamePasswordToken("lonestarr", "vespa");        token.setRememberMe(true);        try {            currentUser.login(token);        } catch (UnknownAccountException uae) {                    } catch (IncorrectCredentialsException ice) {                    } catch (LockedAccountException lae) {                    }         catch (AuthenticationException ae) {                }    }                    if (currentUser.hasRole("schwartz")) {            } else {            }        if (currentUser.isPermitted("lightsaber:wield")) {            } else {            }        if (currentUser.isPermitted("winnebago:drive:eagle5")) {            } else {            }        currentUser.logout();    System.exit(0);}
public static void shiro_f2008_1(String[] args)
{        Injector injector = Guice.createInjector(new QuickstartShiroModule());    SecurityManager securityManager = injector.getInstance(SecurityManager.class);                            SecurityUtils.setSecurityManager(securityManager);            Subject currentUser = SecurityUtils.getSubject();        Session session = currentUser.getSession();    session.setAttribute("someKey", "aValue");    String value = (String) session.getAttribute("someKey");    if (value.equals("aValue")) {            }        if (!currentUser.isAuthenticated()) {        UsernamePasswordToken token = new UsernamePasswordToken("lonestarr", "vespa");        token.setRememberMe(true);        try {            currentUser.login(token);        } catch (UnknownAccountException uae) {                    } catch (IncorrectCredentialsException ice) {                    } catch (LockedAccountException lae) {                    }         catch (AuthenticationException ae) {                }    }                    if (currentUser.hasRole("schwartz")) {            } else {            }        if (currentUser.isPermitted("lightsaber:weild")) {            } else {            }        if (currentUser.isPermitted("winnebago:drive:eagle5")) {            } else {            }        currentUser.logout();    System.exit(0);}
protected void shiro_f2009_0()
{    try {        bindRealm().toConstructor(IniRealm.class.getConstructor(Ini.class));    } catch (NoSuchMethodException e) {        addError(e);    }}
 Ini shiro_f2010_0()
{    return Ini.fromResourcePath("classpath:shiro.ini");}
public void shiro_f2011_0() throws IOException
{        final HtmlPage homePage = webClient.getPage(getBaseUri());    try {        homePage.getAnchorByHref("/logout").click();    } catch (ElementNotFoundException e) {        }}
public void shiro_f2012_0() throws FailingHttpStatusCodeException, MalformedURLException, IOException, InterruptedException
{    HtmlPage page = webClient.getPage(getBaseUri() + "login.jsp");    HtmlForm form = page.getFormByName("loginform");    form.<HtmlInput>getInputByName("username").setValueAttribute("root");    form.<HtmlInput>getInputByName("password").setValueAttribute("secret");    page = form.<HtmlInput>getInputByName("submit").click();        page.getAnchorByHref("/logout");}
public Realm shiro_f2013_0()
{    TextConfigurationRealm realm = new TextConfigurationRealm();    realm.setUserDefinitions("joe.coder=password,user\n" + "jill.coder=password,admin");    realm.setRoleDefinitions("admin=read,write\n" + "user=read");    realm.setCachingEnabled(true);    return realm;}
public static void shiro_f2014_0(String[] args)
{    AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(CliApp.class);    context.getBean(QuickStart.class).run();}
public void shiro_f2015_1()
{        Subject subject = SecurityUtils.getSubject();        Assert.isTrue(!subject.isAuthenticated());        UsernamePasswordToken token = new UsernamePasswordToken("joe.coder", "password");    subject.login(token);        subject.checkRole("user");        Assert.isTrue(!subject.hasRole("admin"));        subject.checkPermission("read");        simpleService.readRestrictedCall();    try {                simpleService.writeRestrictedCall();    } catch (AuthorizationException e) {            }        subject.logout();    Assert.isTrue(!subject.isAuthenticated());}
private void shiro_f2016_0()
{    SecurityUtils.setSecurityManager(securityManager);}
public void shiro_f2017_1()
{    }
public void shiro_f2018_1()
{    }
public static void shiro_f2019_0(String[] args)
{    ConfigurableApplicationContext context = SpringApplication.run(CliApp.class, args);        context.getBean(QuickStart.class).run();}
public Realm shiro_f2020_0()
{    TextConfigurationRealm realm = new TextConfigurationRealm();    realm.setUserDefinitions("joe.coder=password,user\n" + "jill.coder=password,admin");    realm.setRoleDefinitions("admin=read,write\n" + "user=read");    realm.setCachingEnabled(true);    return realm;}
public void shiro_f2021_1()
{        Subject subject = SecurityUtils.getSubject();        Assert.isTrue(!subject.isAuthenticated());        UsernamePasswordToken token = new UsernamePasswordToken("joe.coder", "password");    subject.login(token);        subject.checkRole("user");        Assert.isTrue(!subject.hasRole("admin"));        subject.checkPermission("read");        simpleService.readRestrictedCall();    try {                simpleService.writeRestrictedCall();    } catch (AuthorizationException e) {            }        subject.logout();    Assert.isTrue(!subject.isAuthenticated());}
private void shiro_f2022_0()
{    SecurityUtils.setSecurityManager(securityManager);}
public void shiro_f2023_1()
{    }
public void shiro_f2024_1()
{    }
public String shiro_f2025_0(Model model)
{    String name = "World";    Subject subject = SecurityUtils.getSubject();    PrincipalCollection principalCollection = subject.getPrincipals();    if (principalCollection != null && !principalCollection.isEmpty()) {        name = principalCollection.getPrimaryPrincipal().toString();    }    model.addAttribute("name", name);    return "account-info";}
public String shiro_f2026_0(HttpServletRequest request, Model model)
{    String name = "World";    Subject subject = SecurityUtils.getSubject();    PrincipalCollection principalCollection = subject.getPrincipals();    if (principalCollection != null && !principalCollection.isEmpty()) {        Collection<Map> principalMaps = subject.getPrincipals().byType(Map.class);        if (CollectionUtils.isEmpty(principalMaps)) {            name = subject.getPrincipal().toString();        } else {            name = (String) principalMaps.iterator().next().get("username");        }    }    model.addAttribute("name", name);    return "hello";}
public String shiro_f2027_0()
{    return "login";}
public String shiro_f2028_0()
{    return ERROR_PATH;}
 String shiro_f2029_0(HttpServletRequest request, Model model)
{    Map<String, Object> errorMap = errorAttributes.getErrorAttributes(new ServletWebRequest(request), false);    model.addAttribute("errors", errorMap);    return "error";}
public static void shiro_f2030_0(String[] args)
{    SpringApplication.run(WebApp.class, args);}
public String shiro_f2031_1(AuthorizationException e, Model model)
{                Map<String, Object> map = new HashMap<String, Object>();    map.put("status", HttpStatus.FORBIDDEN.value());    map.put("message", "No message available");    model.addAttribute("errors", map);    return "error";}
public Realm shiro_f2032_0()
{    TextConfigurationRealm realm = new TextConfigurationRealm();    realm.setUserDefinitions("joe.coder=password,user\n" + "jill.coder=password,admin");    realm.setRoleDefinitions("admin=read,write\n" + "user=read");    realm.setCachingEnabled(true);    return realm;}
public ShiroFilterChainDefinition shiro_f2033_0()
{    DefaultShiroFilterChainDefinition chainDefinition = new DefaultShiroFilterChainDefinition();        chainDefinition.addPathDefinition("/login.html", "authc");    chainDefinition.addPathDefinition("/logout", "logout");    return chainDefinition;}
public Subject shiro_f2034_0()
{    return SecurityUtils.getSubject();}
public static void shiro_f2035_0(String[] args)
{        if (args.length > 0)        LAUNCH_SESSION_ID = args[0];    new ClassPathXmlApplicationContext("webstart.spring.xml");}
public void shiro_f2036_0(SampleManager sampleManager)
{    this.sampleManager = sampleManager;}
public void shiro_f2037_0() throws Exception
{    ClassPathResource resource = new ClassPathResource("logo.png");    ImageIcon icon = new ImageIcon(resource.getURL());    JLabel logo = new JLabel(icon);    valueField = new JTextField(20);    updateValueLabel();    saveButton = new JButton("Save Value");    saveButton.addActionListener(this);    refreshButton = new JButton("Refresh Value");    refreshButton.addActionListener(this);    JPanel valuePanel = new JPanel(new FlowLayout(FlowLayout.CENTER));    valuePanel.add(valueField);    valuePanel.add(saveButton);    valuePanel.add(refreshButton);    secureMethod1Button = new JButton("Method #1");    secureMethod1Button.addActionListener(this);    secureMethod2Button = new JButton("Method #2");    secureMethod2Button.addActionListener(this);    secureMethod3Button = new JButton("Method #3");    secureMethod3Button.addActionListener(this);    JPanel methodPanel = new JPanel(new FlowLayout(FlowLayout.CENTER));    methodPanel.add(secureMethod1Button);    methodPanel.add(secureMethod2Button);    methodPanel.add(secureMethod3Button);    frame = new JFrame("Apache Shiro Sample Application");    frame.setSize(500, 200);    Container panel = frame.getContentPane();    panel.setLayout(new BorderLayout());    panel.add(logo, BorderLayout.NORTH);    panel.add(valuePanel, BorderLayout.CENTER);    panel.add(methodPanel, BorderLayout.SOUTH);    frame.setVisible(true);    frame.addWindowListener(new WindowAdapter() {        public void windowClosing(WindowEvent e) {            System.exit(0);        }    });}
public void shiro_f2038_0(WindowEvent e)
{    System.exit(0);}
private void shiro_f2039_0()
{    valueField.setText(sampleManager.getValue());}
public void shiro_f2040_0(ActionEvent e)
{    try {        if (e.getSource() == saveButton) {            sampleManager.setValue(valueField.getText());        } else if (e.getSource() == refreshButton) {            updateValueLabel();        } else if (e.getSource() == secureMethod1Button) {            sampleManager.secureMethod1();            JOptionPane.showMessageDialog(frame, "Method #1 successfully called.", "Success", JOptionPane.INFORMATION_MESSAGE);        } else if (e.getSource() == secureMethod2Button) {            sampleManager.secureMethod2();            JOptionPane.showMessageDialog(frame, "Method #2 successfully called.", "Success", JOptionPane.INFORMATION_MESSAGE);        } else if (e.getSource() == secureMethod3Button) {            sampleManager.secureMethod3();            JOptionPane.showMessageDialog(frame, "Method #3 successfully called.", "Success", JOptionPane.INFORMATION_MESSAGE);        } else {            throw new RuntimeException("Unexpected action event from source: " + e.getSource());        }    } catch (AuthorizationException ae) {        JOptionPane.showMessageDialog(frame, "Unauthorized to perform action: " + ae.getMessage(), "Unauthorized", JOptionPane.WARNING_MESSAGE);    }}
public void shiro_f2041_0(DataSource dataSource)
{    this.dataSource = dataSource;}
public void shiro_f2042_0(SessionFactory sessionFactory)
{    this.sessionFactory = sessionFactory;}
public void shiro_f2043_0() throws Exception
{            JdbcTemplate jdbcTemplate = new JdbcTemplate(this.dataSource);    jdbcTemplate.execute("insert into roles values (1, 'user', 'The default role given to all users.')");    jdbcTemplate.execute("insert into roles values (2, 'admin', 'The administrator role only given to site admins')");    jdbcTemplate.execute("insert into roles_permissions values (2, 'user:*')");    jdbcTemplate.execute("insert into users(id,username,email,password) values (1, 'admin', 'sample@shiro.apache.org', '" + new Sha256Hash("admin").toHex() + "')");    jdbcTemplate.execute("insert into users_roles values (1, 2)");}
public void shiro_f2044_0(SessionFactory sessionFactory)
{    this.sessionFactory = sessionFactory;}
public Session shiro_f2045_0()
{    return sessionFactory.getCurrentSession();}
public User shiro_f2046_0(Long userId)
{    return (User) getSession().get(User.class, userId);}
public User shiro_f2047_0(String username)
{    Assert.hasText(username);    String query = "from User u where u.username = :username";    return (User) getSession().createQuery(query).setString("username", username).uniqueResult();}
public void shiro_f2048_0(User user)
{    getSession().save(user);}
public List<User> shiro_f2049_0()
{    return getSession().createQuery("from User order by username").list();}
public void shiro_f2050_0(Long userId)
{    User user = getUser(userId);    if (user != null) {        getSession().delete(user);    }}
public void shiro_f2051_0(User user)
{    getSession().update(user);}
public Long shiro_f2052_0()
{    return id;}
public void shiro_f2053_0(Long id)
{    this.id = id;}
public String shiro_f2054_0()
{    return name;}
public void shiro_f2055_0(String name)
{    this.name = name;}
public String shiro_f2056_0()
{    return description;}
public void shiro_f2057_0(String description)
{    this.description = description;}
public Set<String> shiro_f2058_0()
{    return permissions;}
public void shiro_f2059_0(Set<String> permissions)
{    this.permissions = permissions;}
public Long shiro_f2060_0()
{    return id;}
public void shiro_f2061_0(Long id)
{    this.id = id;}
public String shiro_f2062_0()
{    return username;}
public void shiro_f2063_0(String username)
{    this.username = username;}
public String shiro_f2064_0()
{    return email;}
public void shiro_f2065_0(String email)
{    this.email = email;}
public String shiro_f2066_0()
{    return password;}
public void shiro_f2067_0(String password)
{    this.password = password;}
public Set<Role> shiro_f2068_0()
{    return roles;}
public void shiro_f2069_0(Set<Role> roles)
{    this.roles = roles;}
public void shiro_f2070_0(UserDAO userDAO)
{    this.userDAO = userDAO;}
protected AuthenticationInfo shiro_f2071_0(AuthenticationToken authcToken) throws AuthenticationException
{    UsernamePasswordToken token = (UsernamePasswordToken) authcToken;    User user = userDAO.findUser(token.getUsername());    if (user != null) {        return new SimpleAuthenticationInfo(user.getId(), user.getPassword(), getName());    } else {        return null;    }}
protected AuthorizationInfo shiro_f2072_0(PrincipalCollection principals)
{    Long userId = (Long) principals.fromRealm(getName()).iterator().next();    User user = userDAO.getUser(userId);    if (user != null) {        SimpleAuthorizationInfo info = new SimpleAuthorizationInfo();        for (Role role : user.getRoles()) {            info.addRole(role.getName());            info.addStringPermissions(role.getPermissions());        }        return info;    } else {        return null;    }}
public void shiro_f2073_0(UserDAO userDAO)
{    this.userDAO = userDAO;}
public User shiro_f2074_0()
{    final Long currentUserId = (Long) SecurityUtils.getSubject().getPrincipal();    if (currentUserId != null) {        return getUser(currentUserId);    } else {        return null;    }}
public void shiro_f2075_0(String username, String email, String password)
{    User user = new User();    user.setUsername(username);    user.setEmail(email);    user.setPassword(new Sha256Hash(password).toHex());    userDAO.createUser(user);}
public List<User> shiro_f2076_0()
{    return userDAO.getAllUsers();}
public User shiro_f2077_0(Long userId)
{    return userDAO.getUser(userId);}
public void shiro_f2078_0(Long userId)
{    userDAO.deleteUser(userId);}
public void shiro_f2079_0(User user)
{    userDAO.updateUser(user);}
public void shiro_f2080_0(UserService userService)
{    this.userService = userService;}
public void shiro_f2081_0(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView) throws Exception
{        User currentUser = userService.getCurrentUser();    if (currentUser != null) {        httpServletRequest.setAttribute("currentUser", currentUser);    }}
public Long shiro_f2082_0()
{    return userId;}
public void shiro_f2083_0(Long userId)
{    this.userId = userId;}
public String shiro_f2084_0()
{    return username;}
public void shiro_f2085_0(String username)
{    this.username = username;}
public String shiro_f2086_0()
{    return email;}
public void shiro_f2087_0(String email)
{    this.email = email;}
public String shiro_f2088_0()
{    return password;}
public void shiro_f2089_0(String password)
{    this.password = password;}
public void shiro_f2090_0(User user)
{    Assert.isTrue(userId.equals(user.getId()), "User ID of command must match the user being updated.");    user.setUsername(getUsername());    user.setEmail(getEmail());    if (StringUtils.hasText(getPassword())) {        user.setPassword(new Sha256Hash(getPassword()).toHex());    }}
public boolean shiro_f2091_0(Class aClass)
{    return EditUserCommand.class.isAssignableFrom(aClass);}
public void shiro_f2092_0(Object o, Errors errors)
{    EditUserCommand command = (EditUserCommand) o;    ValidationUtils.rejectIfEmptyOrWhitespace(errors, "username", "error.username.empty", "Please specify a username.");    ValidationUtils.rejectIfEmptyOrWhitespace(errors, "email", "error.email.empty", "Please specify an email address.");    if (StringUtils.hasText(command.getEmail()) && !Pattern.matches(SIMPLE_EMAIL_REGEX, command.getEmail().toUpperCase())) {        errors.rejectValue("email", "error.email.invalid", "Please enter a valid email address.");    }}
public void shiro_f2093_0(UserService userService)
{    this.userService = userService;}
public void shiro_f2094_0(Model model)
{    model.addAttribute("users", userService.getAllUsers());}
public String shiro_f2095_0()
{    return username;}
public void shiro_f2096_0(String username)
{    this.username = username;}
public String shiro_f2097_0()
{    return password;}
public void shiro_f2098_0(String password)
{    this.password = password;}
public boolean shiro_f2099_0()
{    return rememberMe;}
public void shiro_f2100_0(boolean rememberMe)
{    this.rememberMe = rememberMe;}
public boolean shiro_f2101_0(Class aClass)
{    return LoginCommand.class.isAssignableFrom(aClass);}
public void shiro_f2102_0(Object o, Errors errors)
{    ValidationUtils.rejectIfEmptyOrWhitespace(errors, "username", "error.username.empty", "Please specify a username.");    ValidationUtils.rejectIfEmptyOrWhitespace(errors, "password", "error.password.empty", "Please specify a password.");}
public void shiro_f2103_0(UserService userService)
{    this.userService = userService;}
public void shiro_f2104_0(Model model)
{    model.addAttribute("users", userService.getAllUsers());}
public String shiro_f2105_0(Model model, @RequestParam Long userId, @ModelAttribute EditUserCommand command)
{    User user = userService.getUser(userId);    command.setUserId(userId);    command.setUsername(user.getUsername());    command.setEmail(user.getEmail());    return "editUser";}
public String shiro_f2106_0(Model model, @RequestParam Long userId, @ModelAttribute EditUserCommand command, BindingResult errors)
{    editUserValidator.validate(command, errors);    if (errors.hasErrors()) {        return "editUser";    }    User user = userService.getUser(userId);    command.updateUser(user);    userService.updateUser(user);    return "redirect:/s/manageUsers";}
public String shiro_f2107_0(@RequestParam Long userId)
{    Assert.isTrue(userId != 1, "Cannot delete admin user");    userService.deleteUser(userId);    return "redirect:/s/manageUsers";}
public String shiro_f2108_0(Model model, @ModelAttribute LoginCommand command)
{    return "login";}
public String shiro_f2109_0(Model model, @ModelAttribute LoginCommand command, BindingResult errors)
{    loginValidator.validate(command, errors);    if (errors.hasErrors()) {        return showLoginForm(model, command);    }    UsernamePasswordToken token = new UsernamePasswordToken(command.getUsername(), command.getPassword(), command.isRememberMe());    try {        SecurityUtils.getSubject().login(token);    } catch (AuthenticationException e) {        errors.reject("error.login.generic", "Invalid username or password.  Please try again.");    }    if (errors.hasErrors()) {        return showLoginForm(model, command);    } else {        return "redirect:/s/home";    }}
public String shiro_f2110_0()
{    SecurityUtils.getSubject().logout();    return "redirect:/";}
public String shiro_f2111_0()
{    return username;}
public void shiro_f2112_0(String username)
{    this.username = username;}
public String shiro_f2113_0()
{    return email;}
public void shiro_f2114_0(String email)
{    this.email = email;}
public String shiro_f2115_0()
{    return password;}
public void shiro_f2116_0(String password)
{    this.password = password;}
public void shiro_f2117_0(UserService userService)
{    this.userService = userService;}
public String shiro_f2118_0(Model model, @ModelAttribute SignupCommand command)
{    return "signup";}
public String shiro_f2119_0(Model model, @ModelAttribute SignupCommand command, BindingResult errors)
{    signupValidator.validate(command, errors);    if (errors.hasErrors()) {        return showSignupForm(model, command);    }        userService.createUser(command.getUsername(), command.getEmail(), command.getPassword());        SecurityUtils.getSubject().login(new UsernamePasswordToken(command.getUsername(), command.getPassword()));    return "redirect:/s/home";}
public boolean shiro_f2120_0(Class aClass)
{    return SignupCommand.class.isAssignableFrom(aClass);}
public void shiro_f2121_0(Object o, Errors errors)
{    SignupCommand command = (SignupCommand) o;    ValidationUtils.rejectIfEmptyOrWhitespace(errors, "username", "error.username.empty", "Please specify a username.");    ValidationUtils.rejectIfEmptyOrWhitespace(errors, "email", "error.email.empty", "Please specify an email address.");    if (StringUtils.hasText(command.getEmail()) && !Pattern.matches(SIMPLE_EMAIL_REGEX, command.getEmail().toUpperCase())) {        errors.rejectValue("email", "error.email.invalid", "Please enter a valid email address.");    }    ValidationUtils.rejectIfEmptyOrWhitespace(errors, "password", "error.password.empty", "Please specify a password.");}
public void shiro_f2122_0() throws IOException
{        final HtmlPage homePage = webClient.getPage(getBaseUri());    try {        homePage.getAnchorByHref("/s/logout").click();    } catch (ElementNotFoundException e) {        }}
public void shiro_f2123_0() throws FailingHttpStatusCodeException, IOException, InterruptedException
{    HtmlPage page = webClient.getPage(getBaseUri() + "s/login");    HtmlForm form = page.getFormByName("loginForm");    form.<HtmlInput>getInputByName("username").setValueAttribute("admin");    form.<HtmlInput>getInputByName("password").setValueAttribute("admin");    page = form.<HtmlInput>getInputByValue("Login").click();        page.getAnchorByHref("/s/logout");}
public void shiro_f2124_0(DataSource dataSource)
{    this.dataSource = dataSource;}
public void shiro_f2125_1() throws Exception
{            JdbcTemplate jdbcTemplate = new JdbcTemplate(this.dataSource);    jdbcTemplate.execute(CREATE_TABLES);                        String query = "insert into users values ('user1', '" + new Sha256Hash("user1", "user1").toBase64() + "' )";    jdbcTemplate.execute(query);            query = "insert into users values ( 'user2', '" + new Sha256Hash("user2", "user2").toBase64() + "' )";    jdbcTemplate.execute(query);        query = "insert into roles values ( 'role1' )";    jdbcTemplate.execute(query);        query = "insert into roles values ( 'role2' )";    jdbcTemplate.execute(query);        query = "insert into roles_permissions values ( 'role1', 'permission1')";    jdbcTemplate.execute(query);        query = "insert into roles_permissions values ( 'role1', 'permission2')";    jdbcTemplate.execute(query);        query = "insert into roles_permissions values ( 'role2', 'permission1')";    jdbcTemplate.execute(query);        query = "insert into user_roles values ( 'user1', 'role1' )";    jdbcTemplate.execute(query);    query = "insert into user_roles values ( 'user1', 'role2' )";    jdbcTemplate.execute(query);        query = "insert into user_roles values ( 'user2', 'role2' )";    jdbcTemplate.execute(query);    }
protected BootstrapDataPopulator shiro_f2126_0(DataSource dataSource)
{    BootstrapDataPopulator populator = new BootstrapDataPopulator();    populator.setDataSource(dataSource);    return populator;}
protected SaltAwareJdbcRealm shiro_f2127_0(DataSource dataSource)
{    HashedCredentialsMatcher credentialsMatcher = new HashedCredentialsMatcher();    credentialsMatcher.setHashAlgorithmName("SHA-256");    credentialsMatcher.setStoredCredentialsHexEncoded(false);    SaltAwareJdbcRealm jdbcRealm = new SaltAwareJdbcRealm();    jdbcRealm.setName("jdbcRealm");    jdbcRealm.setCredentialsMatcher(credentialsMatcher);    jdbcRealm.setDataSource(dataSource);    return jdbcRealm;}
protected EhCacheManager shiro_f2128_0()
{    EhCacheManager ehCacheManager = new EhCacheManager();    return ehCacheManager;}
protected SecureRemoteInvocationExecutor shiro_f2129_0(SecurityManager securityManager)
{    SecureRemoteInvocationExecutor executor = new SecureRemoteInvocationExecutor();    executor.setSecurityManager(securityManager);    return executor;}
protected DefaultSampleManager shiro_f2130_0()
{    return new DefaultSampleManager();}
protected DriverManagerDataSource shiro_f2131_0()
{    DriverManagerDataSource dataSource = new DriverManagerDataSource();    dataSource.setDriverClassName("org.hsqldb.jdbcDriver");    dataSource.setUrl("jdbc:hsqldb:mem:shiro-spring");    dataSource.setUsername("sa");    return dataSource;}
public ShiroFilterChainDefinition shiro_f2132_0()
{    DefaultShiroFilterChainDefinition chainDefinition = new DefaultShiroFilterChainDefinition();            chainDefinition.addPathDefinition("/favicon.ico", "anon");    chainDefinition.addPathDefinition("/logo.png", "anon");    chainDefinition.addPathDefinition("/shiro.css", "anon");    chainDefinition.addPathDefinition("/s/login", "anon");        chainDefinition.addPathDefinition("/*.jar", "anon");        chainDefinition.addPathDefinition("/remoting/**", "anon");    chainDefinition.addPathDefinition("/**", "authc");    return chainDefinition;}
public ViewResolver shiro_f2133_0()
{    InternalResourceViewResolver resolver = new InternalResourceViewResolver();    resolver.setViewClass(JstlView.class);    resolver.setPrefix("/WEB-INF/resources/");    resolver.setSuffix(".jsp");    return resolver;}
public ViewResolver shiro_f2134_0()
{    InternalResourceViewResolver resolver = new InternalResourceViewResolver();    resolver.setViewClass(JstlView.class);    resolver.setPrefix("/WEB-INF/jnlp/");    resolver.setSuffix(".jsp");    return resolver;}
public void shiro_f2135_0(ResourceHandlerRegistry registry)
{    registry.addResourceHandler("*.css", "*.png").addResourceLocations("/");    registry.addResourceHandler("*.jar", "*.pack").addResourceLocations("/WEB-INF/resources/");}
public HttpInvokerServiceExporter shiro_f2136_0(SampleManager sampleManager, SecureRemoteInvocationExecutor secureRemoteInvocationExecutor)
{    HttpInvokerServiceExporter httpInvokerServiceExporter = new HttpInvokerServiceExporter();    httpInvokerServiceExporter.setService(sampleManager);    httpInvokerServiceExporter.setServiceInterface(SampleManager.class);    httpInvokerServiceExporter.setRemoteInvocationExecutor(secureRemoteInvocationExecutor);    return httpInvokerServiceExporter;}
public void shiro_f2137_0(ServletContext container)
{        AnnotationConfigWebApplicationContext appContext = getContext();        container.addListener(new ContextLoaderListener(appContext));    FilterRegistration.Dynamic shiroFilter = container.addFilter("shiroFilterFactoryBean", DelegatingFilterProxy.class);    shiroFilter.setInitParameter("targetFilterLifecycle", "true");    shiroFilter.addMappingForUrlPatterns(EnumSet.allOf(DispatcherType.class), false, "/*");    ServletRegistration.Dynamic remotingDispatcher = container.addServlet("remoting", new DispatcherServlet(appContext));    remotingDispatcher.setLoadOnStartup(1);    remotingDispatcher.addMapping("/remoting/*");    ServletRegistration.Dynamic dispatcher = container.addServlet("DispatcherServlet", new DispatcherServlet(appContext));    dispatcher.setLoadOnStartup(1);    dispatcher.addMapping("/");}
private AnnotationConfigWebApplicationContext shiro_f2138_0()
{    AnnotationConfigWebApplicationContext context = new AnnotationConfigWebApplicationContext();    context.setConfigLocation(getClass().getPackage().getName());    return context;}
public String shiro_f2139_1()
{    String value = null;    Subject subject = SecurityUtils.getSubject();    Session session = subject.getSession(false);    if (session != null) {        value = (String) session.getAttribute(VALUE_KEY);        if (log.isDebugEnabled()) {                    }    }    return value;}
public void shiro_f2140_1(String newValue)
{    Subject subject = SecurityUtils.getSubject();    Session session = subject.getSession();    if (log.isDebugEnabled()) {            }    session.setAttribute(VALUE_KEY, newValue);}
public void shiro_f2141_1()
{    if (log.isInfoEnabled()) {            }}
public void shiro_f2142_1()
{    if (log.isInfoEnabled()) {            }}
public void shiro_f2143_1()
{    if (log.isInfoEnabled()) {            }}
protected AuthenticationInfo shiro_f2144_1(AuthenticationToken token) throws AuthenticationException
{    UsernamePasswordToken upToken = (UsernamePasswordToken) token;    String username = upToken.getUsername();        if (username == null) {        throw new AccountException("Null usernames are not allowed by this realm.");    }    Connection conn = null;    AuthenticationInfo info = null;    try {        conn = dataSource.getConnection();        String password = getPasswordForUser(conn, username);        if (password == null) {            throw new UnknownAccountException("No account found for user [" + username + "]");        }        SimpleAuthenticationInfo saInfo = new SimpleAuthenticationInfo(username, password, getName());        /**         * This (very bad) example uses the username as the salt in this sample app.  DON'T DO THIS IN A REAL APP!         *         * Salts should not be based on anything that a user could enter (attackers can exploit this).  Instead         * they should ideally be cryptographically-strong randomly generated numbers.         */        saInfo.setCredentialsSalt(ByteSource.Util.bytes(username));        info = saInfo;    } catch (SQLException e) {        final String message = "There was a SQL error while authenticating user [" + username + "]";        if (log.isErrorEnabled()) {                    }                throw new AuthenticationException(message, e);    } finally {        JdbcUtils.closeConnection(conn);    }    return info;}
private String shiro_f2145_0(Connection conn, String username) throws SQLException
{    PreparedStatement ps = null;    ResultSet rs = null;    String password = null;    try {        ps = conn.prepareStatement(authenticationQuery);        ps.setString(1, username);                rs = ps.executeQuery();                boolean foundResult = false;        while (rs.next()) {                        if (foundResult) {                throw new AuthenticationException("More than one user row found for user [" + username + "]. Usernames must be unique.");            }            password = rs.getString(1);            foundResult = true;        }    } finally {        JdbcUtils.closeResultSet(rs);        JdbcUtils.closeStatement(ps);    }    return password;}
public void shiro_f2146_0(SampleManager sampleManager)
{    this.sampleManager = sampleManager;}
protected String shiro_f2147_0(Model model)
{    buildModel(model);    model.addAttribute("value", sampleManager.getValue());    return "sampleIndex";}
protected Model shiro_f2148_0(Model model)
{    Subject subject = SecurityUtils.getSubject();    boolean hasRole1 = subject.hasRole("role1");    boolean hasRole2 = subject.hasRole("role2");    model.addAttribute("hasRole1", hasRole1);    model.addAttribute("hasRole2", hasRole2);    Session session = subject.getSession();    Map<Object, Object> sessionAttributes = new LinkedHashMap<Object, Object>();    for (Object key : session.getAttributeKeys()) {        sessionAttributes.put(key, session.getAttribute(key));    }    model.addAttribute("sessionAttributes", sessionAttributes);    model.addAttribute("subjectSession", subject.getSession());    return model;}
protected String shiro_f2149_0(@RequestParam("value") String newSessionValue, Model model)
{    sampleManager.setValue(newSessionValue);    buildModel(model);    model.addAttribute("value", sampleManager.getValue());    return "sampleIndex";}
public void shiro_f2150_0(String jnlpView)
{    this.jnlpView = jnlpView;}
protected ModelAndView shiro_f2151_0(HttpServletRequest request, HttpServletResponse response) throws Exception
{    Subject subject = SecurityUtils.getSubject();    Session session = null;    if (subject != null) {        session = subject.getSession();    }    if (session == null) {        String msg = "Expected a non-null Shiro session.";        throw new IllegalArgumentException(msg);    }    StringBuilder sb = new StringBuilder();    sb.append("http://");    sb.append(request.getServerName());    if (request.getServerPort() != 80) {        sb.append(":");        sb.append(request.getServerPort());    }    sb.append(request.getContextPath());        response.setHeader("cache-control", "no-cache");    response.setHeader("pragma", "no-cache");    Map<String, Object> model = new HashMap<String, Object>();    model.put("codebaseUrl", sb.toString());    model.put("sessionId", session.getId());    return new ModelAndView(jnlpView, model);}
protected String shiro_f2152_0()
{    return loginView;}
protected String shiro_f2153_1(@RequestParam("username") String username, @RequestParam("password") String password, Model model) throws Exception
{    UsernamePasswordToken token = new UsernamePasswordToken(username, password);    try {        SecurityUtils.getSubject().login(token);    } catch (AuthenticationException e) {                model.addAttribute("errorInvalidLogin", "The username or password was not correct.");        return loginView;    }    return "redirect:/s/index";}
protected ModelAndView shiro_f2154_0(HttpServletRequest request, HttpServletResponse response) throws Exception
{    SecurityUtils.getSubject().logout();    return new ModelAndView("redirect:login");}
public String shiro_f2155_0()
{    return "redirect:/s/login";}
public void shiro_f2156_0() throws IOException
{        final HtmlPage homePage = webClient.getPage(getBaseUri());    try {        homePage.getAnchorByHref("/logout").click();    } catch (ElementNotFoundException e) {        }}
public void shiro_f2157_0() throws FailingHttpStatusCodeException, MalformedURLException, IOException, InterruptedException
{    HtmlPage page = webClient.getPage(getBaseUri() + "login.jsp");    HtmlForm form = page.getFormByName("loginform");    form.<HtmlInput>getInputByName("username").setValueAttribute("root");    form.<HtmlInput>getInputByName("password").setValueAttribute("secret");    page = form.<HtmlInput>getInputByName("submit").click();        page.getAnchorByHref("/logout");}
public void shiro_f2158_0()
{}
 void shiro_f2159_0(JoinPoint thisJoinPoint)
{}
public void shiro_f2160_0(JoinPoint thisJoinPoint) throws Throwable
{    interceptor.performBeforeInterception(thisJoinPoint);}
protected void shiro_f2161_0(JoinPoint aJoinPoint) throws Throwable
{    if (log.isTraceEnabled())        log.trace("#### Invoking a method decorated with a Shiro annotation" + "\n\tkind       : " + aJoinPoint.getKind() + "\n\tjoinPoint  : " + aJoinPoint + "\n\tannotations: " + Arrays.toString(((MethodSignature) aJoinPoint.getSignature()).getMethod().getAnnotations()) + "\n\ttarget     : " + aJoinPoint.getTarget());        BeforeAdviceMethodInvocationAdapter mi = BeforeAdviceMethodInvocationAdapter.createFrom(aJoinPoint);        super.invoke(mi);}
public static BeforeAdviceMethodInvocationAdapter shiro_f2162_0(JoinPoint aJoinPoint)
{    if (aJoinPoint.getSignature() instanceof MethodSignature) {        return new BeforeAdviceMethodInvocationAdapter(aJoinPoint.getThis(), ((MethodSignature) aJoinPoint.getSignature()).getMethod(), aJoinPoint.getArgs());    } else if (aJoinPoint.getSignature() instanceof AdviceSignature) {        return new BeforeAdviceMethodInvocationAdapter(aJoinPoint.getThis(), ((AdviceSignature) aJoinPoint.getSignature()).getAdvice(), aJoinPoint.getArgs());    } else {        throw new IllegalArgumentException("The joint point signature is invalid: expected a MethodSignature or an AdviceSignature but was " + aJoinPoint.getSignature());    }}
public Object[] shiro_f2163_0()
{    return _arguments;}
public Method shiro_f2164_0()
{    return _method;}
public Object shiro_f2165_0() throws Throwable
{        return null;}
public Object shiro_f2166_0()
{    return _object;}
public static void shiro_f2167_0() throws Exception
{    Logger log = Logger.getLogger(AspectjAnnotationsAuthorizingMethodInterceptor.class);    log.addAppender(new ConsoleAppender(new SimpleLayout(), ConsoleAppender.SYSTEM_OUT));    log.setLevel(Level.TRACE);    Factory<SecurityManager> factory = new IniSecurityManagerFactory("classpath:shiroDummyServiceTest.ini");    SecurityManager securityManager = factory.getInstance();    SecurityUtils.setSecurityManager(securityManager);    SECURED_SERVICE = new SecuredDummyService();    RESTRICTED_SERVICE = new RestrictedDummyService();}
public static void shiro_f2168_0() throws Exception
{        SecurityUtils.setSecurityManager(null);}
public void shiro_f2169_0() throws Exception
{    subject = SecurityUtils.getSubject();}
public void shiro_f2170_0() throws Exception
{    subject.logout();}
private void shiro_f2171_0()
{    subject.login(new UsernamePasswordToken("joe", "bob"));}
private void shiro_f2172_0()
{    subject.login(new UsernamePasswordToken("root", "secret"));}
public void shiro_f2173_0() throws Exception
{    SECURED_SERVICE.anonymous();}
public void shiro_f2174_0() throws Exception
{    loginAsUser();    SECURED_SERVICE.anonymous();}
public void shiro_f2175_0() throws Exception
{    loginAsAdmin();    SECURED_SERVICE.anonymous();}
public void shiro_f2176_0() throws Exception
{    SECURED_SERVICE.guest();}
public void shiro_f2177_0() throws Exception
{    loginAsUser();    SECURED_SERVICE.guest();}
public void shiro_f2178_0() throws Exception
{    loginAsAdmin();    SECURED_SERVICE.guest();}
public void shiro_f2179_0() throws Exception
{    SECURED_SERVICE.peek();}
public void shiro_f2180_0() throws Exception
{    loginAsUser();    SECURED_SERVICE.peek();}
public void shiro_f2181_0() throws Exception
{    loginAsAdmin();    SECURED_SERVICE.peek();}
public void shiro_f2182_0() throws Exception
{    SECURED_SERVICE.retrieve();}
public void shiro_f2183_0() throws Exception
{    loginAsUser();    SECURED_SERVICE.retrieve();}
public void shiro_f2184_0() throws Exception
{    loginAsAdmin();    SECURED_SERVICE.retrieve();}
public void shiro_f2185_0() throws Exception
{    SECURED_SERVICE.change();}
public void shiro_f2186_0() throws Exception
{    loginAsUser();    SECURED_SERVICE.change();}
public void shiro_f2187_0() throws Exception
{    loginAsAdmin();    SECURED_SERVICE.change();}
public void shiro_f2188_0() throws Exception
{    RESTRICTED_SERVICE.retrieve();}
public void shiro_f2189_0() throws Exception
{    loginAsUser();    RESTRICTED_SERVICE.retrieve();}
public void shiro_f2190_0() throws Exception
{    loginAsAdmin();    RESTRICTED_SERVICE.retrieve();}
public void shiro_f2191_0()
{    log("retrieve *RESTRICTED*");    super.retrieve();}
public void shiro_f2192_0()
{    retrieve();    log("change");    peek();}
public void shiro_f2193_0()
{    log("anonymous");}
public void shiro_f2194_0()
{    log("guest");}
public void shiro_f2195_0()
{    log("peek");}
public void shiro_f2196_0()
{    log("retrieve");}
public void shiro_f2197_0(String aMessage)
{    if (aMessage != null) {        System.out.println(new Timestamp(System.currentTimeMillis()).toString() + " [" + Thread.currentThread() + "] * LOG * " + aMessage);    } else {        System.out.println("\n\n");    }}
protected AuthenticationToken shiro_f2198_0(ServletRequest request, ServletResponse response) throws Exception
{    HttpServletRequest httpRequest = (HttpServletRequest) request;    String ticket = httpRequest.getParameter(TICKET_PARAMETER);    return new CasToken(ticket);}
protected boolean shiro_f2199_0(ServletRequest request, ServletResponse response) throws Exception
{    return executeLogin(request, response);}
protected boolean shiro_f2200_0(ServletRequest request, ServletResponse response, Object mappedValue)
{    return false;}
protected boolean shiro_f2201_0(AuthenticationToken token, Subject subject, ServletRequest request, ServletResponse response) throws Exception
{    issueSuccessRedirect(request, response);    return false;}
protected boolean shiro_f2202_1(AuthenticationToken token, AuthenticationException ae, ServletRequest request, ServletResponse response)
{    if (logger.isDebugEnabled()) {            }        Subject subject = getSubject(request, response);    if (subject.isAuthenticated() || subject.isRemembered()) {        try {            issueSuccessRedirect(request, response);        } catch (Exception e) {                    }    } else {        try {            WebUtils.issueRedirect(request, response, failureUrl);        } catch (IOException e) {                    }    }    return false;}
public void shiro_f2203_0(String failureUrl)
{    this.failureUrl = failureUrl;}
protected void shiro_f2204_0()
{    super.onInit();    ensureTicketValidator();}
protected TicketValidator shiro_f2205_0()
{    if (this.ticketValidator == null) {        this.ticketValidator = createTicketValidator();    }    return this.ticketValidator;}
protected TicketValidator shiro_f2206_0()
{    String urlPrefix = getCasServerUrlPrefix();    if ("saml".equalsIgnoreCase(getValidationProtocol())) {        return new Saml11TicketValidator(urlPrefix);    }    return new Cas20ServiceTicketValidator(urlPrefix);}
protected AuthenticationInfo shiro_f2207_1(AuthenticationToken token) throws AuthenticationException
{    CasToken casToken = (CasToken) token;    if (token == null) {        return null;    }    String ticket = (String) casToken.getCredentials();    if (!StringUtils.hasText(ticket)) {        return null;    }    TicketValidator ticketValidator = ensureTicketValidator();    try {                Assertion casAssertion = ticketValidator.validate(ticket, getCasService());                AttributePrincipal casPrincipal = casAssertion.getPrincipal();        String userId = casPrincipal.getName();                Map<String, Object> attributes = casPrincipal.getAttributes();                casToken.setUserId(userId);        String rememberMeAttributeName = getRememberMeAttributeName();        String rememberMeStringValue = (String) attributes.get(rememberMeAttributeName);        boolean isRemembered = rememberMeStringValue != null && Boolean.parseBoolean(rememberMeStringValue);        if (isRemembered) {            casToken.setRememberMe(true);        }                List<Object> principals = CollectionUtils.asList(userId, attributes);        PrincipalCollection principalCollection = new SimplePrincipalCollection(principals, getName());        return new SimpleAuthenticationInfo(principalCollection, ticket);    } catch (TicketValidationException e) {        throw new CasAuthenticationException("Unable to validate ticket [" + ticket + "]", e);    }}
protected AuthorizationInfo shiro_f2208_0(PrincipalCollection principals)
{        SimplePrincipalCollection principalCollection = (SimplePrincipalCollection) principals;    List<Object> listPrincipals = principalCollection.asList();    Map<String, String> attributes = (Map<String, String>) listPrincipals.get(1);        SimpleAuthorizationInfo simpleAuthorizationInfo = new SimpleAuthorizationInfo();        addRoles(simpleAuthorizationInfo, split(defaultRoles));        addPermissions(simpleAuthorizationInfo, split(defaultPermissions));        List<String> attributeNames = split(roleAttributeNames);    for (String attributeName : attributeNames) {        String value = attributes.get(attributeName);        addRoles(simpleAuthorizationInfo, split(value));    }        attributeNames = split(permissionAttributeNames);    for (String attributeName : attributeNames) {        String value = attributes.get(attributeName);        addPermissions(simpleAuthorizationInfo, split(value));    }    return simpleAuthorizationInfo;}
private List<String> shiro_f2209_0(String s)
{    List<String> list = new ArrayList<String>();    String[] elements = StringUtils.split(s, ',');    if (elements != null && elements.length > 0) {        for (String element : elements) {            if (StringUtils.hasText(element)) {                list.add(element.trim());            }        }    }    return list;}
private void shiro_f2210_0(SimpleAuthorizationInfo simpleAuthorizationInfo, List<String> roles)
{    for (String role : roles) {        simpleAuthorizationInfo.addRole(role);    }}
private void shiro_f2211_0(SimpleAuthorizationInfo simpleAuthorizationInfo, List<String> permissions)
{    for (String permission : permissions) {        simpleAuthorizationInfo.addStringPermission(permission);    }}
public String shiro_f2212_0()
{    return casServerUrlPrefix;}
public void shiro_f2213_0(String casServerUrlPrefix)
{    this.casServerUrlPrefix = casServerUrlPrefix;}
public String shiro_f2214_0()
{    return casService;}
public void shiro_f2215_0(String casService)
{    this.casService = casService;}
public String shiro_f2216_0()
{    return validationProtocol;}
public void shiro_f2217_0(String validationProtocol)
{    this.validationProtocol = validationProtocol;}
public String shiro_f2218_0()
{    return rememberMeAttributeName;}
public void shiro_f2219_0(String rememberMeAttributeName)
{    this.rememberMeAttributeName = rememberMeAttributeName;}
public String shiro_f2220_0()
{    return defaultRoles;}
public void shiro_f2221_0(String defaultRoles)
{    this.defaultRoles = defaultRoles;}
public String shiro_f2222_0()
{    return defaultPermissions;}
public void shiro_f2223_0(String defaultPermissions)
{    this.defaultPermissions = defaultPermissions;}
public String shiro_f2224_0()
{    return roleAttributeNames;}
public void shiro_f2225_0(String roleAttributeNames)
{    this.roleAttributeNames = roleAttributeNames;}
public String shiro_f2226_0()
{    return permissionAttributeNames;}
public void shiro_f2227_0(String permissionAttributeNames)
{    this.permissionAttributeNames = permissionAttributeNames;}
public Subject shiro_f2228_0(SubjectContext context)
{        boolean authenticated = context.isAuthenticated();        if (authenticated) {        AuthenticationToken token = context.getAuthenticationToken();        if (token != null && token instanceof CasToken) {            CasToken casToken = (CasToken) token;                        if (casToken.isRememberMe()) {                context.setAuthenticated(false);            }        }    }    return super.createSubject(context);}
public Object shiro_f2229_0()
{    return userId;}
public Object shiro_f2230_0()
{    return ticket;}
public void shiro_f2231_0(String userId)
{    this.userId = userId;}
public boolean shiro_f2232_0()
{    return isRememberMe;}
public void shiro_f2233_0(boolean isRememberMe)
{    this.isRememberMe = isRememberMe;}
public V shiro_f2234_0(K key) throws CacheException
{    try {        if (log.isTraceEnabled()) {            log.trace("Getting object from cache [" + cache.getName() + "] for key [" + key + "]");        }        if (key == null) {            return null;        } else {            Element element = cache.get(key);            if (element == null) {                if (log.isTraceEnabled()) {                    log.trace("Element for [" + key + "] is null.");                }                return null;            } else {                                return (V) element.getObjectValue();            }        }    } catch (Throwable t) {        throw new CacheException(t);    }}
public V shiro_f2235_0(K key, V value) throws CacheException
{    if (log.isTraceEnabled()) {        log.trace("Putting object in cache [" + cache.getName() + "] for key [" + key + "]");    }    try {        V previous = get(key);        Element element = new Element(key, value);        cache.put(element);        return previous;    } catch (Throwable t) {        throw new CacheException(t);    }}
public V shiro_f2236_0(K key) throws CacheException
{    if (log.isTraceEnabled()) {        log.trace("Removing object from cache [" + cache.getName() + "] for key [" + key + "]");    }    try {        V previous = get(key);        cache.remove(key);        return previous;    } catch (Throwable t) {        throw new CacheException(t);    }}
public void shiro_f2237_0() throws CacheException
{    if (log.isTraceEnabled()) {        log.trace("Clearing all objects from cache [" + cache.getName() + "]");    }    try {        cache.removeAll();    } catch (Throwable t) {        throw new CacheException(t);    }}
public int shiro_f2238_0()
{    try {        return cache.getSize();    } catch (Throwable t) {        throw new CacheException(t);    }}
public Set<K> shiro_f2239_0()
{    try {        @SuppressWarnings({ "unchecked" })        List<K> keys = cache.getKeys();        if (!isEmpty(keys)) {            return Collections.unmodifiableSet(new LinkedHashSet<K>(keys));        } else {            return Collections.emptySet();        }    } catch (Throwable t) {        throw new CacheException(t);    }}
public Collection<V> shiro_f2240_0()
{    try {        @SuppressWarnings({ "unchecked" })        List<K> keys = cache.getKeys();        if (!isEmpty(keys)) {            List<V> values = new ArrayList<V>(keys.size());            for (K key : keys) {                V value = get(key);                if (value != null) {                    values.add(value);                }            }            return Collections.unmodifiableList(values);        } else {            return Collections.emptyList();        }    } catch (Throwable t) {        throw new CacheException(t);    }}
public long shiro_f2241_0()
{    try {        return cache.calculateInMemorySize();    } catch (Throwable t) {        return -1;    }}
public long shiro_f2242_0()
{    try {        return cache.getMemoryStoreSize();    } catch (Throwable t) {        throw new CacheException(t);    }}
public long shiro_f2243_0()
{    try {        return cache.getDiskStoreSize();    } catch (Throwable t) {        throw new CacheException(t);    }}
public String shiro_f2244_0()
{    return "EhCache [" + cache.getName() + "]";}
private static boolean shiro_f2245_0(Collection c)
{    return c == null || c.isEmpty();}
public net.sf.ehcache.CacheManager shiro_f2246_0()
{    return manager;}
public void shiro_f2247_0(net.sf.ehcache.CacheManager manager)
{    this.manager = manager;}
public String shiro_f2248_0()
{    return this.cacheManagerConfigFile;}
public void shiro_f2249_0(String classpathLocation)
{    this.cacheManagerConfigFile = classpathLocation;}
protected InputStream shiro_f2250_0()
{    String configFile = getCacheManagerConfigFile();    try {        return ResourceUtils.getInputStreamForPath(configFile);    } catch (IOException e) {        throw new IllegalStateException("Unable to obtain input stream for cacheManagerConfigFile [" + configFile + "]", e);    }}
public final Cache<K, V> shiro_f2251_1(String name) throws CacheException
{    if (log.isTraceEnabled()) {        log.trace("Acquiring EhCache instance named [" + name + "]");    }    try {        net.sf.ehcache.Ehcache cache = ensureCacheManager().getEhcache(name);        if (cache == null) {            if (log.isInfoEnabled()) {                            }            this.manager.addCache(name);            cache = manager.getCache(name);            if (log.isInfoEnabled()) {                            }        } else {            if (log.isInfoEnabled()) {                            }        }        return new EhCache<K, V>(cache);    } catch (net.sf.ehcache.CacheException e) {        throw new CacheException(e);    }}
public final void shiro_f2252_0() throws CacheException
{    ensureCacheManager();}
private net.sf.ehcache.CacheManager shiro_f2253_1()
{    try {        if (this.manager == null) {            if (log.isDebugEnabled()) {                            }                                                                        this.manager = new net.sf.ehcache.CacheManager(getCacheManagerConfigFileInputStream());            if (log.isTraceEnabled()) {                log.trace("instantiated Ehcache CacheManager instance.");            }            cacheManagerImplicitlyCreated = true;            if (log.isDebugEnabled()) {                            }        }        return this.manager;    } catch (Exception e) {        throw new CacheException(e);    }}
public void shiro_f2254_1()
{    if (cacheManagerImplicitlyCreated) {        try {            net.sf.ehcache.CacheManager cacheMgr = getCacheManager();            cacheMgr.shutdown();        } catch (Throwable t) {            if (log.isWarnEnabled()) {                            }        } finally {            this.manager = null;            this.cacheManagerImplicitlyCreated = false;        }    }}
public void shiro_f2255_0()
{    cacheManager = new EhCacheManager();}
public void shiro_f2256_0()
{    LifecycleUtils.destroy(cacheManager);}
public void shiro_f2257_0()
{    net.sf.ehcache.CacheManager ehCacheManager = cacheManager.getCacheManager();    assertNull(ehCacheManager);    cacheManager.init();        ehCacheManager = cacheManager.getCacheManager();    assertNotNull(ehCacheManager);}
public void shiro_f2258_0()
{    net.sf.ehcache.CacheManager ehCacheManager = cacheManager.getCacheManager();    assertNull(ehCacheManager);            Cache<String, String> cache = cacheManager.getCache("test");        ehCacheManager = cacheManager.getCacheManager();    assertNotNull(ehCacheManager);    assertNotNull(cache);    cache.put("hello", "world");    String value = cache.get("hello");    assertNotNull(value);    assertEquals(value, "world");}
public Object shiro_f2259_0(MethodInvocation invocation) throws Throwable
{    return shiroInterceptor.invoke(new AopAllianceMethodInvocationAdapter(invocation));}
public String shiro_f2260_0()
{    return "AopAlliance Adapter for " + shiroInterceptor.toString();}
public Method shiro_f2261_0()
{    return mi.getMethod();}
public Object[] shiro_f2262_0()
{    return mi.getArguments();}
public String shiro_f2263_0()
{    return "Method invocation [" + mi.getMethod() + "]";}
public Object shiro_f2264_0() throws Throwable
{    return mi.proceed();}
public Object shiro_f2265_0()
{    return mi.getThis();}
protected final void shiro_f2266_0()
{    AnnotationResolver resolver = createAnnotationResolver();    configureDefaultInterceptors(resolver);    configureInterceptors(resolver);}
protected final void shiro_f2267_0(final AnnotationMethodInterceptor methodInterceptor)
{    bindInterceptor(Matchers.any(), new AbstractMatcher<Method>() {        public boolean matches(Method method) {            Class<? extends Annotation> annotation = methodInterceptor.getHandler().getAnnotationClass();            return method.getAnnotation(annotation) != null || method.getDeclaringClass().getAnnotation(annotation) != null;        }    }, new AopAllianceMethodInterceptorAdapter(methodInterceptor));}
public boolean shiro_f2268_0(Method method)
{    Class<? extends Annotation> annotation = methodInterceptor.getHandler().getAnnotationClass();    return method.getAnnotation(annotation) != null || method.getDeclaringClass().getAnnotation(annotation) != null;}
protected AnnotationResolver shiro_f2269_0()
{    return new DefaultAnnotationResolver();}
protected void shiro_f2270_0(AnnotationResolver resolver)
{    bindShiroInterceptor(new RoleAnnotationMethodInterceptor(resolver));    bindShiroInterceptor(new PermissionAnnotationMethodInterceptor(resolver));    bindShiroInterceptor(new AuthenticatedAnnotationMethodInterceptor(resolver));    bindShiroInterceptor(new UserAnnotationMethodInterceptor(resolver));    bindShiroInterceptor(new GuestAnnotationMethodInterceptor(resolver));}
protected void shiro_f2271_0(AnnotationResolver resolver)
{}
public void shiro_f2272_0(TypeLiteral<I> type, final TypeEncounter<I> encounter)
{    PropertyDescriptor[] propertyDescriptors = beanUtilsBean.getPropertyUtils().getPropertyDescriptors(type.getRawType());    final Map<PropertyDescriptor, Key<?>> propertyDependencies = new HashMap<PropertyDescriptor, Key<?>>(propertyDescriptors.length);    final Provider<Injector> injectorProvider = encounter.getProvider(Injector.class);    for (PropertyDescriptor propertyDescriptor : propertyDescriptors) {        if (propertyDescriptor.getWriteMethod() != null && Modifier.isPublic(propertyDescriptor.getWriteMethod().getModifiers())) {            Type propertyType = propertyDescriptor.getWriteMethod().getGenericParameterTypes()[0];            propertyDependencies.put(propertyDescriptor, createDependencyKey(propertyDescriptor, propertyType));        }    }    encounter.register(new MembersInjector<I>() {        public void injectMembers(I instance) {            for (Map.Entry<PropertyDescriptor, Key<?>> dependency : propertyDependencies.entrySet()) {                try {                    final Injector injector = injectorProvider.get();                    Object value = injector.getInstance(getMappedKey(injector, dependency.getValue()));                    dependency.getKey().getWriteMethod().invoke(instance, value);                } catch (ConfigurationException e) {                                                } catch (InvocationTargetException e) {                    throw new RuntimeException("Couldn't set property " + dependency.getKey().getDisplayName(), e);                } catch (IllegalAccessException e) {                    throw new RuntimeException("We shouldn't have ever reached this point, we don't try to inject to non-accessible methods.", e);                }            }        }    });}
public void shiro_f2273_0(I instance)
{    for (Map.Entry<PropertyDescriptor, Key<?>> dependency : propertyDependencies.entrySet()) {        try {            final Injector injector = injectorProvider.get();            Object value = injector.getInstance(getMappedKey(injector, dependency.getValue()));            dependency.getKey().getWriteMethod().invoke(instance, value);        } catch (ConfigurationException e) {                        } catch (InvocationTargetException e) {            throw new RuntimeException("Couldn't set property " + dependency.getKey().getDisplayName(), e);        } catch (IllegalAccessException e) {            throw new RuntimeException("We shouldn't have ever reached this point, we don't try to inject to non-accessible methods.", e);        }    }}
private static Key<?> shiro_f2274_0(Injector injector, Key<?> key)
{    Map<TypeLiteral, BeanTypeKey> beanTypeMap = getBeanTypeMap(injector);    if (key.getAnnotation() == null && beanTypeMap.containsKey(key.getTypeLiteral())) {        return beanTypeMap.get(key.getTypeLiteral()).key;    } else {        return key;    }}
private static Map<TypeLiteral, BeanTypeKey> shiro_f2275_0(Injector injector)
{    return (Map<TypeLiteral, BeanTypeKey>) injector.getInstance(MAP_KEY);}
private static Key<?> shiro_f2276_0(PropertyDescriptor propertyDescriptor, Type propertyType)
{    if (requiresName(propertyType)) {        return Key.get(propertyType, Names.named("shiro." + propertyDescriptor.getName()));    } else {        return Key.get(propertyType);    }}
private static boolean shiro_f2277_0(Type propertyType)
{    if (propertyType instanceof Class) {        Class<?> aClass = (Class<?>) propertyType;        return aClass.isPrimitive() || aClass.isEnum() || WRAPPER_TYPES.contains(aClass) || CharSequence.class.isAssignableFrom(aClass);    } else {        return false;    }}
 static void shiro_f2278_0(Binder binder)
{    beanTypeMapBinding(binder).addBinding(TypeLiteral.get(BeanTypeKey.class)).toInstance(new BeanTypeKey(null));}
 static void shiro_f2279_0(Binder binder, TypeLiteral<T> typeLiteral, Key<? extends T> key)
{    beanTypeMapBinding(binder).addBinding(typeLiteral).toInstance(new BeanTypeKey(key));}
private static MapBinder<TypeLiteral, BeanTypeKey> shiro_f2280_0(Binder binder)
{    return MapBinder.newMapBinder(binder, TypeLiteral.class, BeanTypeKey.class, Names.named(BEAN_TYPE_MAP_NAME));}
public void shiro_f2281_0(Destroyable injectee)
{    registry.add(injectee);}
public SecurityManager shiro_f2282_0()
{    return securityManager;}
public void shiro_f2283_0(Initializable injectee)
{    injectee.init();}
public void shiro_f2284_0(TypeLiteral<I> type, TypeEncounter<I> encounter)
{    if (InitializableInjectionListener.MATCHER.matches(type)) {        encounter.register(this.<I>castListener(new InitializableInjectionListener<Initializable>()));    }    if (DestroyableInjectionListener.MATCHER.matches(type)) {        encounter.register(this.<I>castListener(new DestroyableInjectionListener<Destroyable>(registry)));    }}
private InjectionListener<? super I> shiro_f2285_0(InjectionListener<?> listener)
{    return (InjectionListener<? super I>) listener;}
public boolean shiro_f2286_0(Class aClass)
{    return aClass.getPackage() != null;}
public static Matcher<TypeLiteral> shiro_f2287_0(final Matcher<Class> classMatcher)
{    return new AbstractMatcher<TypeLiteral>() {        public boolean matches(TypeLiteral typeLiteral) {            return classMatcher.matches(typeLiteral.getRawType());        }    };}
public boolean shiro_f2288_0(TypeLiteral typeLiteral)
{    return classMatcher.matches(typeLiteral.getRawType());}
public void shiro_f2289_0()
{        bindSecurityManager(bind(SecurityManager.class));    bindSessionManager(bind(SessionManager.class));    bindEnvironment(bind(Environment.class));    bindListener(BeanTypeListener.MATCHER, new BeanTypeListener());    bindEventBus(bind(EventBus.class));    bindListener(Matchers.any(), new SubscribedEventTypeListener());    bindListener(Matchers.any(), new EventBusAwareTypeListener());    final DestroyableInjectionListener.DestroyableRegistry registry = new DestroyableInjectionListener.DestroyableRegistry() {        public void add(Destroyable destroyable) {            ShiroModule.this.add(destroyable);        }        @PreDestroy        public void destroy() {            ShiroModule.this.destroy();        }    };    bindListener(LifecycleTypeListener.MATCHER, new LifecycleTypeListener(registry));    expose(SecurityManager.class);    expose(EventBus.class);    configureShiro();    bind(realmCollectionKey()).to(realmSetKey());    bind(DestroyableInjectionListener.DestroyableRegistry.class).toInstance(registry);    BeanTypeListener.ensureBeanTypeMapExists(binder());}
public void shiro_f2290_0(Destroyable destroyable)
{    ShiroModule.this.add(destroyable);}
public void shiro_f2291_0()
{    ShiroModule.this.destroy();}
private Key<Set<Realm>> shiro_f2292_0()
{    return (Key<Set<Realm>>) Key.get(TypeLiteral.get(Types.setOf(Realm.class)));}
private Key<Collection<Realm>> shiro_f2293_0()
{    return (Key<Collection<Realm>>) Key.get(Types.newParameterizedType(Collection.class, Realm.class));}
protected final LinkedBindingBuilder<Realm> shiro_f2294_0()
{    Multibinder<Realm> multibinder = Multibinder.newSetBinder(binder(), Realm.class);    return multibinder.addBinding();}
protected void shiro_f2295_0(AnnotatedBindingBuilder<? super SecurityManager> bind)
{    try {        bind.toConstructor(DefaultSecurityManager.class.getConstructor(Collection.class)).asEagerSingleton();    } catch (NoSuchMethodException e) {        throw new ConfigurationException("This really shouldn't happen.  Either something has changed in Shiro, or there's a bug in " + ShiroModule.class.getSimpleName(), e);    }}
protected void shiro_f2296_0(AnnotatedBindingBuilder<SessionManager> bind)
{    bind.to(DefaultSessionManager.class).asEagerSingleton();}
protected void shiro_f2297_0(AnnotatedBindingBuilder<Environment> bind)
{    bind.to(GuiceEnvironment.class).asEagerSingleton();}
protected final void shiro_f2298_0(TypeLiteral<T> typeLiteral, Key<? extends T> key)
{    BeanTypeListener.bindBeanType(binder(), typeLiteral, key);}
protected void shiro_f2299_0(AnnotatedBindingBuilder<EventBus> bind)
{    bind.to(DefaultEventBus.class).asEagerSingleton();}
public final void shiro_f2300_1()
{    for (Destroyable destroyable : destroyables) {        try {            destroyable.destroy();        } catch (Exception e) {                    }    }}
public void shiro_f2301_0(Destroyable destroyable)
{    this.destroyables.add(destroyable);}
public void shiro_f2302_0(TypeLiteral<I> typeLiteral, TypeEncounter<I> typeEncounter)
{    final Provider<EventBus> eventBusProvider = typeEncounter.getProvider(EventBus.class);    List<Method> methods = ClassUtils.getAnnotatedMethods(typeLiteral.getRawType(), Subscribe.class);    if (methods != null && !methods.isEmpty()) {        typeEncounter.register(new InjectionListener<I>() {            @Override            public void afterInjection(Object o) {                eventBusProvider.get().register(o);            }        });    }}
public void shiro_f2303_0(Object o)
{    eventBusProvider.get().register(o);}
public void shiro_f2304_0(TypeLiteral<I> typeLiteral, TypeEncounter<I> typeEncounter)
{    final Provider<EventBus> eventBusProvider = typeEncounter.getProvider(EventBus.class);    if (EventBusAware.class.isAssignableFrom(typeLiteral.getRawType())) {        typeEncounter.register(new InjectionListener<I>() {            @Override            public void afterInjection(Object o) {                ((EventBusAware) o).setEventBus(eventBusProvider.get());            }        });    }}
public void shiro_f2305_0(Object o)
{    ((EventBusAware) o).setEventBus(eventBusProvider.get());}
public Provider<T> shiro_f2306_0(final Key<T> key, final Provider<T> unscoped)
{    return new Provider<T>() {        public T get() {            Subject subject = ThreadContext.getSubject();            if (subject == null) {                throw new OutOfScopeException("There is no Shiro Session currently in scope.");            }            Session session = subject.getSession();            T scoped = castSessionAttribute(session);            if (scoped == null) {                scoped = unscoped.get();            }            return scoped;        }        @SuppressWarnings({ "unchecked" })        private T castSessionAttribute(Session session) {            return (T) session.getAttribute(key);        }        @Override        public String toString() {            return unscoped.toString();        }    };}
public T shiro_f2307_0()
{    Subject subject = ThreadContext.getSubject();    if (subject == null) {        throw new OutOfScopeException("There is no Shiro Session currently in scope.");    }    Session session = subject.getSession();    T scoped = castSessionAttribute(session);    if (scoped == null) {        scoped = unscoped.get();    }    return scoped;}
private T shiro_f2308_0(Session session)
{    return (T) session.getAttribute(key);}
public String shiro_f2309_0()
{    return unscoped.toString();}
public String shiro_f2310_0()
{    return "ShiroSessionScope";}
public T shiro_f2311_0()
{    Constructor<T> constructor = getConstructor();    Object[] params = new Object[constructor.getParameterTypes().length];    for (Dependency<?> dependency : constructorInjectionPoint.getDependencies()) {        params[dependency.getParameterIndex()] = injector.getInstance(dependency.getKey());    }    T t;    try {        t = constructor.newInstance(params);    } catch (Exception e) {        throw new ProvisionException("Could not instantiate " + key + "", e);    }    injector.injectMembers(t);    return postProcess(t);}
private Constructor<T> shiro_f2312_0()
{    return (Constructor<T>) constructorInjectionPoint.getMember();}
protected T shiro_f2313_0(T t)
{        return t;}
public Set<Dependency<?>> shiro_f2314_0()
{    return dependencies;}
public void shiro_f2315_0(PatternMatcher patternMatcher)
{    this.patternMatcher = patternMatcher;}
public Set<Dependency<?>> shiro_f2316_0()
{    return dependencies;}
public FilterChainResolver shiro_f2317_0()
{    return new SimpleFilterChainResolver(chains, injector, patternMatcher);}
protected T shiro_f2318_0(T filter)
{    for (Map.Entry<String, String> pathConfig : this.pathConfigs.entrySet()) {        filter.processPathConfig(pathConfig.getKey(), pathConfig.getValue());    }    return filter;}
public static void shiro_f2319_0(Binder binder)
{    binder.install(guiceFilterModule());}
public static void shiro_f2320_0(final String pattern, Binder binder)
{    binder.install(guiceFilterModule(pattern));}
public static ServletModule shiro_f2321_0()
{    return guiceFilterModule("/*");}
public static ServletModule shiro_f2322_0(final String pattern)
{    return new ServletModule() {        @Override        protected void configureServlets() {            filter(pattern).through(GuiceShiroFilter.class);        }    };}
protected void shiro_f2323_0()
{    filter(pattern).through(GuiceShiroFilter.class);}
protected final void shiro_f2324_0()
{    bindBeanType(TypeLiteral.get(ServletContext.class), Key.get(ServletContext.class, Names.named(NAME)));    bind(Key.get(ServletContext.class, Names.named(NAME))).toInstance(this.servletContext);    bindWebSecurityManager(bind(WebSecurityManager.class));    bindWebEnvironment(bind(WebEnvironment.class));    bind(GuiceShiroFilter.class).asEagerSingleton();    expose(GuiceShiroFilter.class);    this.configureShiroWeb();    bind(FilterChainResolver.class).toProvider(new FilterChainResolverProvider(setupFilterChainConfigs()));}
private Map<String, Key<? extends Filter>[]> shiro_f2325_0()
{        Map<Key<? extends Filter>, Map<String, String>> filterToPathToConfig = new HashMap<Key<? extends Filter>, Map<String, String>>();        Map<String, Key<? extends Filter>[]> resultConfigMap = new LinkedHashMap<String, Key<? extends Filter>[]>();    for (Map.Entry<String, FilterConfig<? extends Filter>[]> filterChain : filterChains.entrySet()) {        String path = filterChain.getKey();                List<Key<? extends Filter>> keysForPath = new ArrayList<Key<? extends Filter>>();        for (int i = 0; i < filterChain.getValue().length; i++) {            FilterConfig<? extends Filter> filterConfig = filterChain.getValue()[i];            Key<? extends Filter> key = filterConfig.getKey();            String config = filterConfig.getConfigValue();                        if (filterToPathToConfig.get(key) == null) {                                filterToPathToConfig.put((key), new LinkedHashMap<String, String>());            }                        filterToPathToConfig.get(key).put(path, config);                        if (StringUtils.hasText(config) && !PathMatchingFilter.class.isAssignableFrom(key.getTypeLiteral().getRawType())) {                throw new ConfigurationException("Config information requires a PathMatchingFilter - can't apply to " + key.getTypeLiteral().getRawType());            }                        keysForPath.add(key);        }                resultConfigMap.put(path, keysForPath.toArray(new Key[keysForPath.size()]));    }        for (Key<? extends Filter> key : filterToPathToConfig.keySet()) {        if (PathMatchingFilter.class.isAssignableFrom(key.getTypeLiteral().getRawType())) {            bindPathMatchingFilter(castToPathMatching(key), filterToPathToConfig.get(key));        } else {            bind(key);        }    }    return resultConfigMap;}
private void shiro_f2326_0(Key<T> filterKey, Map<String, String> configs)
{    bind(filterKey).toProvider(new PathMatchingFilterProvider<T>(filterKey, configs)).asEagerSingleton();}
private Key<? extends PathMatchingFilter> shiro_f2327_0(Key<? extends Filter> key)
{    return (Key<? extends PathMatchingFilter>) key;}
protected final void shiro_f2328_0(AnnotatedBindingBuilder<? super SecurityManager> bind)
{        bind.to(WebSecurityManager.class);}
protected void shiro_f2329_0(AnnotatedBindingBuilder<? super WebSecurityManager> bind)
{    try {        bind.toConstructor(DefaultWebSecurityManager.class.getConstructor(Collection.class)).asEagerSingleton();    } catch (NoSuchMethodException e) {        throw new ConfigurationException("This really shouldn't happen.  Either something has changed in Shiro, or there's a bug in ShiroModule.", e);    }}
protected void shiro_f2330_0(AnnotatedBindingBuilder<SessionManager> bind)
{    bind.to(ServletContainerSessionManager.class).asEagerSingleton();}
protected final void shiro_f2331_0(AnnotatedBindingBuilder<Environment> bind)
{        bind.to(WebEnvironment.class);}
protected void shiro_f2332_0(AnnotatedBindingBuilder<? super WebEnvironment> bind)
{    bind.to(WebGuiceEnvironment.class).asEagerSingleton();}
protected final void shiro_f2333_0(String pattern, Key<? extends Filter> key)
{        if (key instanceof FilterConfigKey) {        addLegacyFilterChain(pattern, (FilterConfigKey) key);    } else {        addFilterChain(pattern, new FilterConfig<Filter>((Key<Filter>) key, ""));    }}
protected final void shiro_f2334_0(String pattern, FilterConfig<? extends Filter>... filterConfigs)
{    filterChains.put(pattern, filterConfigs);}
protected static FilterConfig<T> shiro_f2335_0(Key<T> baseKey, String configValue)
{    return new FilterConfig<T>(baseKey, configValue);}
protected static FilterConfig<T> shiro_f2336_0(Key<T> baseKey)
{    return filterConfig(baseKey, "");}
protected static FilterConfig<T> shiro_f2337_0(TypeLiteral<T> typeLiteral, String configValue)
{    return filterConfig(Key.get(typeLiteral), configValue);}
protected static FilterConfig<T> shiro_f2338_0(Class<T> type, String configValue)
{    return filterConfig(Key.get(type), configValue);}
public Key<T> shiro_f2339_0()
{    return key;}
public String shiro_f2340_0()
{    return configValue;}
 static boolean shiro_f2341_0()
{    try {        Class.forName("com.google.inject.multibindings.MapKey");        return false;    } catch (ClassNotFoundException e) {        return true;    }}
private void shiro_f2342_0(String pattern, FilterConfigKey filterConfigKey)
{    FilterConfig<Filter> filterConfig = new FilterConfig<Filter>(filterConfigKey.getKey(), filterConfigKey.getConfigValue());    addFilterChain(pattern, filterConfig);}
protected final void shiro_f2343_0(String pattern, Key<? extends Filter>... keys)
{        FilterConfig[] filterConfigs = new FilterConfig[keys.length];    for (int ii = 0; ii < keys.length; ii++) {        Key<? extends Filter> key = keys[ii];                if (key instanceof FilterConfigKey) {                        FilterConfigKey legacyKey = (FilterConfigKey) key;            filterConfigs[ii] = new FilterConfig(legacyKey.getKey(), legacyKey.getConfigValue());        } else {                        filterConfigs[ii] = new FilterConfig(key, "");        }    }    filterChains.put(pattern, filterConfigs);}
protected static Key<T> shiro_f2344_0(Key<T> baseKey, String configValue)
{    if (!isGuiceVersion3()) {        throw new ConfigurationException("Method ShiroWebModule.config(Key<? extends PathMatchingFilter>, String configValue), is not supported when using Guice 4+");    }    return new FilterConfigKey<T>(baseKey, configValue);}
protected static Key<T> shiro_f2345_0(TypeLiteral<T> typeLiteral, String configValue)
{    return config(Key.get(typeLiteral), configValue);}
protected static Key<T> shiro_f2346_0(Class<T> type, String configValue)
{    return config(Key.get(type), configValue);}
public Key<T> shiro_f2347_0()
{    return key;}
public String shiro_f2348_0()
{    return configValue;}
public void shiro_f2349_0(ServletRequest request, ServletResponse response) throws IOException, ServletException
{    if (chain.hasNext()) {        Filter filter = chain.next();        filter.doFilter(request, response, this);    } else if (!originalCalled) {        originalCalled = true;        originalChain.doFilter(request, response);    }}
 Iterator<? extends Filter> shiro_f2350_0()
{    return chain;}
public FilterChain shiro_f2351_0(ServletRequest request, ServletResponse response, final FilterChain originalChain)
{    String path = WebUtils.getPathWithinApplication(WebUtils.toHttp(request));    for (final String pathPattern : chains.keySet()) {        if (patternMatcher.matches(pathPattern, path)) {            final Iterator<Key<? extends Filter>> chain = Arrays.asList(chains.get(pathPattern)).iterator();            return new SimpleFilterChain(originalChain, new Iterator<Filter>() {                public boolean hasNext() {                    return chain.hasNext();                }                public Filter next() {                    return injector.getInstance(chain.next());                }                public void remove() {                    throw new UnsupportedOperationException();                }            });        }    }    return null;}
public boolean shiro_f2352_0()
{    return chain.hasNext();}
public Filter shiro_f2353_0()
{    return injector.getInstance(chain.next());}
public void shiro_f2354_0()
{    throw new UnsupportedOperationException();}
public FilterChainResolver shiro_f2355_0()
{    return filterChainResolver;}
public ServletContext shiro_f2356_0()
{    return servletContext;}
public WebSecurityManager shiro_f2357_0()
{    return securityManager;}
public SecurityManager shiro_f2358_0()
{    return securityManager;}
public void shiro_f2359_0() throws Throwable
{    MethodInvocation allianceInvocation = createMock(MethodInvocation.class);    MethodInterceptor mockShiroInterceptor = createMock(MethodInterceptor.class);    expect(mockShiroInterceptor.invoke(anyObject(AopAllianceMethodInvocationAdapter.class))).andAnswer(new IAnswer<Object>() {        public Object answer() throws Throwable {            return getCurrentArguments()[0];        }    });    final Object expectedValue = new Object();    expect(allianceInvocation.proceed()).andReturn(expectedValue);    replay(mockShiroInterceptor, allianceInvocation);    AopAllianceMethodInterceptorAdapter underTest = new AopAllianceMethodInterceptorAdapter(mockShiroInterceptor);    Object invocation = underTest.invoke(allianceInvocation);    Object value = ((AopAllianceMethodInvocationAdapter) invocation).proceed();    assertSame("Adapter invocation returned a different value.", expectedValue, value);    verify(mockShiroInterceptor, allianceInvocation);}
public Object shiro_f2360_0() throws Throwable
{    return getCurrentArguments()[0];}
public void shiro_f2361_0() throws Exception
{    MethodInvocation mock = createMock(MethodInvocation.class);    Method method = AopAllianceMethodInvocationAdapterTest.class.getMethod("testGetMethod");    expect(mock.getMethod()).andReturn(method);    AopAllianceMethodInvocationAdapter underTest = new AopAllianceMethodInvocationAdapter(mock);    replay(mock);    assertSame(method, underTest.getMethod());    verify(mock);}
public void shiro_f2362_0() throws Exception
{    MethodInvocation mock = createMock(MethodInvocation.class);    Object[] args = new Object[0];    expect(mock.getArguments()).andReturn(args);    AopAllianceMethodInvocationAdapter underTest = new AopAllianceMethodInvocationAdapter(mock);    replay(mock);    assertSame(args, underTest.getArguments());    verify(mock);}
public void shiro_f2363_0() throws Throwable
{    MethodInvocation mock = createMock(MethodInvocation.class);    Object value = new Object();    expect(mock.proceed()).andReturn(value);    AopAllianceMethodInvocationAdapter underTest = new AopAllianceMethodInvocationAdapter(mock);    replay(mock);    assertSame(value, underTest.proceed());    verify(mock);}
public void shiro_f2364_0() throws Exception
{    MethodInvocation mock = createMock(MethodInvocation.class);    Object value = new Object();    expect(mock.getThis()).andReturn(value);    AopAllianceMethodInvocationAdapter underTest = new AopAllianceMethodInvocationAdapter(mock);    replay(mock);    assertSame(value, underTest.getThis());    verify(mock);}
public void shiro_f2365_0()
{    final AnnotationResolver annotationResolver = new DefaultAnnotationResolver();    ShiroAopModule underTest = new ShiroAopModule() {        @Override        protected AnnotationResolver createAnnotationResolver() {            return annotationResolver;        }        @Override        protected void configureDefaultInterceptors(AnnotationResolver resolver) {            assertSame(annotationResolver, resolver);            bind(Object.class).annotatedWith(Names.named("configureDefaultInterceptors"));        }        @Override        protected void configureInterceptors(AnnotationResolver resolver) {            assertSame(annotationResolver, resolver);            bind(Object.class).annotatedWith(Names.named("configureInterceptors"));        }    };    boolean calledDefault = false;    boolean calledCustom = false;    for (Element e : Elements.getElements(underTest)) {        if (e instanceof Binding) {            Key key = ((Binding) e).getKey();            if (Named.class.isAssignableFrom(key.getAnnotation().annotationType()) && "configureInterceptors".equals(((Named) key.getAnnotation()).value()) && key.getTypeLiteral().getRawType().equals(Object.class)) {                calledCustom = true;            }            if (Named.class.isAssignableFrom(key.getAnnotation().annotationType()) && "configureDefaultInterceptors".equals(((Named) key.getAnnotation()).value()) && key.getTypeLiteral().getRawType().equals(Object.class)) {                calledDefault = true;            }        }    }}
protected AnnotationResolver shiro_f2366_0()
{    return annotationResolver;}
protected void shiro_f2367_0(AnnotationResolver resolver)
{    assertSame(annotationResolver, resolver);    bind(Object.class).annotatedWith(Names.named("configureDefaultInterceptors"));}
protected void shiro_f2368_0(AnnotationResolver resolver)
{    assertSame(annotationResolver, resolver);    bind(Object.class).annotatedWith(Names.named("configureInterceptors"));}
public void shiro_f2369_0()
{    ShiroAopModule underTest = new ShiroAopModule() {        @Override        protected void configureInterceptors(AnnotationResolver resolver) {            bindShiroInterceptor(new MyAnnotationMethodInterceptor());        }    };    List<Element> elements = Elements.getElements(underTest);    for (Element element : elements) {        if (element instanceof InterceptorBinding) {            InterceptorBinding binding = (InterceptorBinding) element;            assertTrue(binding.getClassMatcher().matches(getClass()));            Method method = null;            Class<? extends Annotation> theAnnotation = null;            for (Class<? extends Annotation> annotation : protectedMethods.keySet()) {                if (binding.getMethodMatcher().matches(protectedMethods.get(annotation))) {                    method = protectedMethods.get(annotation);                    theAnnotation = annotation;                    protectedMethods.remove(annotation);                    break;                }            }            if (method == null) {                fail("Did not expect interceptor binding " + binding.getInterceptors());            }            List<MethodInterceptor> interceptors = binding.getInterceptors();            assertEquals(1, interceptors.size());            assertTrue(interceptors.get(0) instanceof AopAllianceMethodInterceptorAdapter);            assertTrue(interceptorTypes.get(theAnnotation).isInstance(((AopAllianceMethodInterceptorAdapter) interceptors.get(0)).shiroInterceptor));        }    }    assertTrue("Not all interceptors were bound.", protectedMethods.isEmpty());}
protected void shiro_f2370_0(AnnotationResolver resolver)
{    bindShiroInterceptor(new MyAnnotationMethodInterceptor());}
public Object shiro_f2371_0(MethodInvocation methodInvocation) throws Throwable
{    return null;}
public void shiro_f2372_0()
{}
public void shiro_f2373_0()
{}
public void shiro_f2374_0()
{}
public void shiro_f2375_0()
{}
public void shiro_f2376_0()
{}
public void shiro_f2377_0()
{}
public void shiro_f2378_0() throws NoSuchMethodException
{    protectedMethods = new HashMap<Class<? extends Annotation>, Method>();    protectedMethods.put(RequiresRoles.class, getClass().getMethod("roleProtected"));    protectedMethods.put(RequiresPermissions.class, getClass().getMethod("permissionProtected"));    protectedMethods.put(RequiresAuthentication.class, getClass().getMethod("authProtected"));    protectedMethods.put(RequiresUser.class, getClass().getMethod("userProtected"));    protectedMethods.put(RequiresGuest.class, getClass().getMethod("guestProtected"));    protectedMethods.put(MyTestAnnotation.class, getClass().getMethod("myTestProtected"));    interceptorTypes = new HashMap<Class<? extends Annotation>, Class<? extends AnnotationMethodInterceptor>>();    interceptorTypes.put(RequiresRoles.class, RoleAnnotationMethodInterceptor.class);    interceptorTypes.put(RequiresPermissions.class, PermissionAnnotationMethodInterceptor.class);    interceptorTypes.put(RequiresAuthentication.class, AuthenticatedAnnotationMethodInterceptor.class);    interceptorTypes.put(RequiresUser.class, UserAnnotationMethodInterceptor.class);    interceptorTypes.put(RequiresGuest.class, GuestAnnotationMethodInterceptor.class);    interceptorTypes.put(MyTestAnnotation.class, MyAnnotationMethodInterceptor.class);}
public void shiro_f2379_0() throws Exception
{    assertFalse(BeanTypeListener.MATCHER.matches(TypeLiteral.get(GuiceEnvironment.class)));    assertFalse(BeanTypeListener.MATCHER.matches(TypeLiteral.get(ShiroWebModule.class)));    assertFalse(BeanTypeListener.MATCHER.matches(TypeLiteral.get(ShiroAopModule.class)));}
public void shiro_f2380_0() throws Exception
{    assertTrue(BeanTypeListener.MATCHER.matches(TypeLiteral.get(SecurityUtils.class)));    assertTrue(BeanTypeListener.MATCHER.matches(TypeLiteral.get(DefaultAnnotationResolver.class)));    assertTrue(BeanTypeListener.MATCHER.matches(TypeLiteral.get(BlowfishCipherService.class)));}
public void shiro_f2381_0() throws Exception
{    IMocksControl control = createControl();    TypeEncounter<SomeInjectableBean> encounter = control.createMock(TypeEncounter.class);    Provider<Injector> injectorProvider = control.createMock(Provider.class);    Injector injector = control.createMock(Injector.class);    expect(encounter.getProvider(Injector.class)).andReturn(injectorProvider);    expect(injectorProvider.get()).andReturn(injector).anyTimes();    Capture<MembersInjector<SomeInjectableBean>> capture = Capture.newInstance();    encounter.register(and(anyObject(MembersInjector.class), capture(capture)));    SecurityManager securityManager = control.createMock(SecurityManager.class);    String property = "myPropertyValue";    expect(injector.getInstance(Key.get(SecurityManager.class))).andReturn(securityManager);    expect(injector.getInstance(Key.get(String.class, Names.named("shiro.myProperty")))).andReturn(property);    expect(injector.getInstance(Key.get(String.class, Names.named("shiro.unavailableProperty")))).andThrow(new ConfigurationException(Collections.singleton(new Message("Not Available!"))));    expect((Map) injector.getInstance(BeanTypeListener.MAP_KEY)).andReturn(Collections.EMPTY_MAP).anyTimes();    control.replay();    BeanTypeListener underTest = new BeanTypeListener();    underTest.hear(TypeLiteral.get(SomeInjectableBean.class), encounter);    SomeInjectableBean bean = new SomeInjectableBean();    capture.getValue().injectMembers(bean);    assertSame(securityManager, bean.securityManager);    assertSame(property, bean.myProperty);    assertNull(bean.unavailableProperty);    control.verify();}
public void shiro_f2382_0(SecurityManager securityManager)
{    this.securityManager = securityManager;}
public void shiro_f2383_0(String myProperty)
{    this.myProperty = myProperty;}
public void shiro_f2384_0(String unavailableProperty)
{    this.unavailableProperty = unavailableProperty;}
public void shiro_f2385_0() throws Exception
{    DestroyableInjectionListener.DestroyableRegistry registry = createMock(DestroyableInjectionListener.DestroyableRegistry.class);    Destroyable destroyable = createMock(Destroyable.class);    registry.add(destroyable);    replay(registry, destroyable);    DestroyableInjectionListener underTest = new DestroyableInjectionListener(registry);    underTest.afterInjection(destroyable);    verify(registry, destroyable);}
public void shiro_f2386_0() throws Exception
{    SecurityManager securityManager = createMock(SecurityManager.class);    GuiceEnvironment underTest = new GuiceEnvironment(securityManager);    assertSame(securityManager, underTest.getSecurityManager());}
public void shiro_f2387_0()
{    try {        InjectionPoint ip = InjectionPoint.forConstructorOf(GuiceEnvironment.class);    } catch (Exception e) {        fail("Could not create constructor injection point.");    }}
public void shiro_f2388_0() throws Exception
{    Initializable initializable = createMock(Initializable.class);    initializable.init();    replay(initializable);    InitializableInjectionListener underTest = new InitializableInjectionListener();    underTest.afterInjection(initializable);    verify(initializable);}
public void shiro_f2389_0() throws Exception
{    TypeEncounter encounter = createMock(TypeEncounter.class);    encounter.register(anyObject(InitializableInjectionListener.class));    replay(encounter);    LifecycleTypeListener underTest = new LifecycleTypeListener(null);    underTest.hear(TypeLiteral.get(MyInitializable.class), encounter);    verify(encounter);}
public void shiro_f2390_0() throws Exception
{    TypeEncounter encounter = createMock(TypeEncounter.class);    encounter.register(anyObject(DestroyableInjectionListener.class));    replay(encounter);    LifecycleTypeListener underTest = new LifecycleTypeListener(null);    underTest.hear(TypeLiteral.get(MyDestroyable.class), encounter);    verify(encounter);}
public void shiro_f2391_0() throws ShiroException
{}
public void shiro_f2392_0() throws Exception
{}
public void shiro_f2393_0() throws Exception
{    Matcher<Class> classMatcher = createMock(Matcher.class);    expect(classMatcher.matches(MatchingClass.class)).andReturn(true);    expect(classMatcher.matches(NotMatchingClass.class)).andReturn(false);    replay(classMatcher);    Matcher<TypeLiteral> underTest = ShiroMatchers.typeLiteral(classMatcher);    assertTrue(underTest.matches(TypeLiteral.get(MatchingClass.class)));    assertFalse(underTest.matches(TypeLiteral.get(NotMatchingClass.class)));    verify(classMatcher);}
public void shiro_f2394_0()
{    final MockRealm mockRealm = createMock(MockRealm.class);    Injector injector = Guice.createInjector(new ShiroModule() {        @Override        protected void configureShiro() {            bindRealm().to(MockRealm.class);        }        @Provides        public MockRealm createRealm() {            return mockRealm;        }    });    SecurityManager securityManager = injector.getInstance(SecurityManager.class);    assertNotNull(securityManager);}
protected void shiro_f2395_0()
{    bindRealm().to(MockRealm.class);}
public MockRealm shiro_f2396_0()
{    return mockRealm;}
public void shiro_f2397_0()
{    final MockRealm mockRealm = createMock(MockRealm.class);    AuthenticationToken authToken = createMock(AuthenticationToken.class);    AuthenticationInfo info = new SimpleAuthenticationInfo("mockUser", "password", "mockRealm");    expect(mockRealm.supports(authToken)).andReturn(true);    expect(mockRealm.getAuthenticationInfo(authToken)).andReturn(info);    replay(mockRealm);    Injector injector = Guice.createInjector(new ShiroModule() {        @Override        protected void configureShiro() {            bindRealm().to(MockRealm.class);        }        @Provides        public MockRealm createRealm() {            return mockRealm;        }    });    SecurityManager securityManager = injector.getInstance(SecurityManager.class);    assertNotNull(securityManager);    SecurityUtils.setSecurityManager(securityManager);    final Subject subject = new Subject.Builder(securityManager).buildSubject();    securityManager.login(subject, authToken);    verify(mockRealm);}
protected void shiro_f2398_0()
{    bindRealm().to(MockRealm.class);}
public MockRealm shiro_f2399_0()
{    return mockRealm;}
public void shiro_f2400_0()
{    final MockRealm mockRealm = createMock(MockRealm.class);    Injector injector = Guice.createInjector(new ShiroModule() {        @Override        protected void configureShiro() {            bindRealm().to(MockRealm.class);        }        @Provides        public MockRealm createRealm() {            return mockRealm;        }        @Override        protected void bindSecurityManager(AnnotatedBindingBuilder<? super SecurityManager> bind) {            bind.to(MyDefaultSecurityManager.class);        }    });    SecurityManager securityManager = injector.getInstance(SecurityManager.class);    assertNotNull(securityManager);    assertTrue(securityManager instanceof MyDefaultSecurityManager);}
protected void shiro_f2401_0()
{    bindRealm().to(MockRealm.class);}
public MockRealm shiro_f2402_0()
{    return mockRealm;}
protected void shiro_f2403_0(AnnotatedBindingBuilder<? super SecurityManager> bind)
{    bind.to(MyDefaultSecurityManager.class);}
public void shiro_f2404_0()
{    final MockRealm mockRealm = createMock(MockRealm.class);    Injector injector = Guice.createInjector(new ShiroModule() {        @Override        protected void configureShiro() {            bindRealm().to(MockRealm.class);        }        @Provides        public MockRealm createRealm() {            return mockRealm;        }        @Override        protected void bindSessionManager(AnnotatedBindingBuilder<SessionManager> bind) {            bind.to(MyDefaultSessionManager.class);        }    });    DefaultSecurityManager securityManager = (DefaultSecurityManager) injector.getInstance(SecurityManager.class);    assertNotNull(securityManager);    assertNotNull(securityManager.getSessionManager());    assertTrue(securityManager.getSessionManager() instanceof MyDefaultSessionManager);}
protected void shiro_f2405_0()
{    bindRealm().to(MockRealm.class);}
public MockRealm shiro_f2406_0()
{    return mockRealm;}
protected void shiro_f2407_0(AnnotatedBindingBuilder<SessionManager> bind)
{    bind.to(MyDefaultSessionManager.class);}
public void shiro_f2408_0()
{    final MockRealm mockRealm = createMock(MockRealm.class);    Injector injector = Guice.createInjector(new ShiroModule() {        @Override        protected void configureShiro() {            bindRealm().to(MockRealm.class);            expose(Environment.class);        }        @Provides        public MockRealm createRealm() {            return mockRealm;        }        @Override        protected void bindEnvironment(AnnotatedBindingBuilder<Environment> bind) {            bind.to(MyEnvironment.class);        }    });    Environment environment = injector.getInstance(Environment.class);    assertNotNull(environment);    assertTrue(environment instanceof MyEnvironment);}
protected void shiro_f2409_0()
{    bindRealm().to(MockRealm.class);    expose(Environment.class);}
public MockRealm shiro_f2410_0()
{    return mockRealm;}
protected void shiro_f2411_0(AnnotatedBindingBuilder<Environment> bind)
{    bind.to(MyEnvironment.class);}
public void shiro_f2412_0() throws Exception
{    final MockRealm mockRealm = createMock(MockRealm.class);    final MyDestroyable myDestroyable = createMock(MyDestroyable.class);    myDestroyable.destroy();    replay(myDestroyable);    final ShiroModule shiroModule = new ShiroModule() {        @Override        protected void configureShiro() {            bindRealm().to(MockRealm.class);            bind(MyDestroyable.class).toInstance(myDestroyable);            expose(MyDestroyable.class);        }        @Provides        public MockRealm createRealm() {            return mockRealm;        }    };    Injector injector = Guice.createInjector(shiroModule);    injector.getInstance(MyDestroyable.class);    shiroModule.destroy();    verify(myDestroyable);}
protected void shiro_f2413_0()
{    bindRealm().to(MockRealm.class);    bind(MyDestroyable.class).toInstance(myDestroyable);    expose(MyDestroyable.class);}
public MockRealm shiro_f2414_0()
{    return mockRealm;}
public void shiro_f2415_0() throws Exception
{    final MockRealm mockRealm = createMock(MockRealm.class);    final EventBus eventBus = createMock(EventBus.class);        eventBus.register(anyObject(MockEventListener1.class));    eventBus.register(anyObject(MockEventListener2.class));    replay(eventBus);    final ShiroModule shiroModule = new ShiroModule() {        @Override        protected void configureShiro() {            bindRealm().to(MockRealm.class);                        binder().bind(MockEventListener1.class).asEagerSingleton();            binder().bind(MockEventListener2.class).asEagerSingleton();        }        @Override        protected void bindEventBus(AnnotatedBindingBuilder<EventBus> bind) {            bind.toInstance(eventBus);        }        @Provides        public MockRealm createRealm() {            return mockRealm;        }    };    Guice.createInjector(shiroModule);    verify(eventBus);}
protected void shiro_f2416_0()
{    bindRealm().to(MockRealm.class);        binder().bind(MockEventListener1.class).asEagerSingleton();    binder().bind(MockEventListener2.class).asEagerSingleton();}
protected void shiro_f2417_0(AnnotatedBindingBuilder<EventBus> bind)
{    bind.toInstance(eventBus);}
public MockRealm shiro_f2418_0()
{    return mockRealm;}
public void shiro_f2419_0() throws Exception
{    final MockRealm mockRealm = createMock(MockRealm.class);    final ShiroModule shiroModule = new ShiroModule() {        @Override        protected void configureShiro() {            bindRealm().to(MockRealm.class);            binder().bind(MockEventBusAware.class).asEagerSingleton();            expose(MockEventBusAware.class);        }        @Provides        public MockRealm createRealm() {            return mockRealm;        }    };    Injector injector = Guice.createInjector(shiroModule);    EventBus eventBus = injector.getInstance(EventBus.class);    SecurityManager securityManager = injector.getInstance(SecurityManager.class);    MockEventBusAware eventBusAware = injector.getInstance(MockEventBusAware.class);    assertSame(eventBus, eventBusAware.eventBus);    assertSame(eventBus, ((DefaultSecurityManager) securityManager).getEventBus());}
protected void shiro_f2420_0()
{    bindRealm().to(MockRealm.class);    binder().bind(MockEventBusAware.class).asEagerSingleton();    expose(MockEventBusAware.class);}
public MockRealm shiro_f2421_0()
{    return mockRealm;}
public void shiro_f2422_0(Object o)
{}
public void shiro_f2423_0(Object o)
{}
public EventBus shiro_f2424_0()
{    return eventBus;}
public void shiro_f2425_0(EventBus eventBus)
{    this.eventBus = eventBus;}
public void shiro_f2426_0() throws Exception
{    Subject subject = createMock(Subject.class);    try {        ThreadContext.bind(subject);        final Key<SomeClass> key = Key.get(SomeClass.class);        Provider<SomeClass> mockProvider = createMock(Provider.class);        Session session = createMock(Session.class);        SomeClass retuned = new SomeClass();        expect(subject.getSession()).andReturn(session);        expect(session.getAttribute(key)).andReturn(null);        expect(mockProvider.get()).andReturn(retuned);        expect(subject.getSession()).andReturn(session);        expect(session.getAttribute(key)).andReturn(retuned);        replay(subject, mockProvider, session);        ShiroSessionScope underTest = new ShiroSessionScope();                assertSame(retuned, underTest.scope(key, mockProvider).get());                assertSame(retuned, underTest.scope(key, mockProvider).get());        verify(subject, mockProvider, session);    } finally {        ThreadContext.unbindSubject();    }}
public void shiro_f2427_0() throws Exception
{    ShiroSessionScope underTest = new ShiroSessionScope();    Provider<SomeClass> mockProvider = createMock(Provider.class);    replay(mockProvider);    underTest.scope(Key.get(SomeClass.class), mockProvider).get();}
public void shiro_f2428_0() throws Exception
{    Injector mockInjector = createMock(Injector.class);    Object c1 = new Object();    Object c2 = new Object();    final AtomicBoolean postProcessCalled = new AtomicBoolean(false);    expect(mockInjector.getInstance(keyC1)).andReturn(c1);    expect(mockInjector.getInstance(keyC2)).andReturn(c2);    mockInjector.injectMembers(anyObject(SomeInjectedClass.class));    replay(mockInjector);    AbstractInjectionProvider<SomeInjectedClass> underTest = new AbstractInjectionProvider<SomeInjectedClass>(Key.get(SomeInjectedClass.class)) {        @Override        protected SomeInjectedClass postProcess(SomeInjectedClass someInjectedClass) {            postProcessCalled.set(true);            return super.postProcess(someInjectedClass);        }    };    underTest.injector = mockInjector;    SomeInjectedClass got = underTest.get();    assertEquals("Wrong parameter passed to constructor (index 0).", c1, got.c1);    assertEquals("Wrong parameter passed to constructor (index 1).", c2, got.c2);    assertTrue("postProcess method was not called.", postProcessCalled.get());    verify(mockInjector);}
protected SomeInjectedClass shiro_f2429_0(SomeInjectedClass someInjectedClass)
{    postProcessCalled.set(true);    return super.postProcess(someInjectedClass);}
public void shiro_f2430_0() throws Exception
{    AbstractInjectionProvider<SomeInjectedClass> underTest = new AbstractInjectionProvider<SomeInjectedClass>(Key.get(SomeInjectedClass.class));    boolean foundC1 = false;    boolean foundC2 = false;    boolean foundV1 = false;    boolean foundV2 = false;    boolean foundF1 = false;    for (Dependency<?> dependency : underTest.getDependencies()) {        if (dependency.getInjectionPoint().getMember() instanceof Constructor) {            if (dependency.getParameterIndex() == 0 && dependency.getKey().equals(keyC1)) {                foundC1 = true;            } else if (dependency.getParameterIndex() == 1 && dependency.getKey().equals(keyC2)) {                foundC2 = true;            } else {                fail("Did not expect constructor dependency with key " + dependency.getKey() + " at parameter index " + dependency.getParameterIndex());            }        } else if (dependency.getInjectionPoint().getMember() instanceof Method) {            if (dependency.getKey().equals(keyV1)) {                foundV1 = true;            } else if (dependency.getKey().equals(keyV2)) {                foundV2 = true;            } else {                fail("Did not expect method dependency with key " + dependency.getKey());            }        } else if (dependency.getInjectionPoint().getMember() instanceof Field) {            if (dependency.getKey().equals(keyF1)) {                foundF1 = true;            } else {                fail("Did not expect field dependency with key " + dependency.getKey());            }        } else {            fail("Did not expect dependency with key " + dependency.getKey());        }    }    assertTrue("Did not find dependency C1", foundC1);    assertTrue("Did not find dependency C2", foundC2);    assertTrue("Did not find dependency V1", foundV1);    assertTrue("Did not find dependency V2", foundV2);    assertTrue("Did not find dependency F1", foundF1);}
public void shiro_f2431_0(@Named("val1") Object v1)
{}
public void shiro_f2432_0(@Named("val2") Object v2)
{}
public void shiro_f2433_0() throws Exception
{    EnumSet<DefaultFilter> defaultFilters = EnumSet.allOf(DefaultFilter.class);    for (Field field : ShiroWebModule.class.getFields()) {        if (Modifier.isStatic(field.getModifiers()) && Key.class.isAssignableFrom(field.getType())) {            Class<? extends Filter> filterType = ((Key) field.get(null)).getTypeLiteral().getRawType();            boolean found = false;            for (DefaultFilter filter : defaultFilters) {                if (filterType.equals(filter.getFilterClass())) {                    found = true;                    defaultFilters.remove(filter);                    break;                }            }            if (!found) {                fail("Guice ShiroWebModule containts a default filter that Shiro proper does not. (" + filterType.getName() + ")");            }        }    }    if (!defaultFilters.isEmpty()) {        fail("Guice ShiroWebModule is missing one or more filters. " + defaultFilters);    }}
public void shiro_f2434_0()
{    chains = new LinkedHashMap<String, Key<? extends Filter>[]>();    key1a = Key.get(Filter.class, Names.named("key1a"));    key1b = Key.get(Filter.class, Names.named("key1b"));    key1c = Key.get(Filter.class, Names.named("key1c"));    key2a = Key.get(Filter.class, Names.named("key2a"));    chains.put("one", new Key[] { key1a, key1b, key1c });    chains.put("two", new Key[] { key2a });    underTest = new FilterChainResolverProvider(chains);}
public void shiro_f2435_0() throws Exception
{    Set<Dependency<?>> dependencySet = underTest.getDependencies();    assertEquals(4, dependencySet.size());    assertTrue("Dependency set doesn't contain key1a.", dependencySet.contains(Dependency.get(key1a)));    assertTrue("Dependency set doesn't contain key1b.", dependencySet.contains(Dependency.get(key1b)));    assertTrue("Dependency set doesn't contain key1c.", dependencySet.contains(Dependency.get(key1c)));    assertTrue("Dependency set doesn't contain key2a.", dependencySet.contains(Dependency.get(key2a)));}
public void shiro_f2436_0() throws Exception
{    Injector injector = createMock(Injector.class);    PatternMatcher patternMatcher = createMock(PatternMatcher.class);    underTest.injector = injector;    underTest.setPatternMatcher(patternMatcher);    FilterChainResolver resolver = underTest.get();    Field chainsField = SimpleFilterChainResolver.class.getDeclaredField("chains");    chainsField.setAccessible(true);    Field injectorField = SimpleFilterChainResolver.class.getDeclaredField("injector");    injectorField.setAccessible(true);    Field patternMatcherField = SimpleFilterChainResolver.class.getDeclaredField("patternMatcher");    patternMatcherField.setAccessible(true);    assertSame(chains, chainsField.get(resolver));    assertSame(injector, injectorField.get(resolver));    assertSame(patternMatcher, patternMatcherField.get(resolver));}
private FilterChainResolver shiro_f2437_0()
{    final ShiroModuleTest.MockRealm mockRealm = createMock(ShiroModuleTest.MockRealm.class);    ServletContext servletContext = createMock(ServletContext.class);    Injector injector = Guice.createInjector(new ShiroWebModule(servletContext) {        @Override        protected void configureShiroWeb() {            bindRealm().to(ShiroModuleTest.MockRealm.class);            addFilterChain("/index.html", AUTHC_BASIC);                        addFilterChain("/index2.html", filterConfig(PERMS, "permission"));        }        @Provides        public ShiroModuleTest.MockRealm createRealm() {            return mockRealm;        }    });    GuiceShiroFilter filter = injector.getInstance(GuiceShiroFilter.class);    return filter.getFilterChainResolver();}
protected void shiro_f2438_0()
{    bindRealm().to(ShiroModuleTest.MockRealm.class);    addFilterChain("/index.html", AUTHC_BASIC);        addFilterChain("/index2.html", filterConfig(PERMS, "permission"));}
public ShiroModuleTest.MockRealm shiro_f2439_0()
{    return mockRealm;}
public void shiro_f2440_0() throws Exception
{    FilterChainResolver resolver = setupResolver();    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    FilterChain chain = createNiceMock(FilterChain.class);    HttpServletRequest request = createMockRequest("/index.html");    FilterChain resolved = resolver.getChain(request, response, chain);    assertNotNull(resolved);    verify(request);}
public void shiro_f2441_0() throws Exception
{    FilterChainResolver resolver = setupResolver();    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    FilterChain chain = createNiceMock(FilterChain.class);    HttpServletRequest request = createMockRequest("/index2.html");    FilterChain resolved = resolver.getChain(request, response, chain);    assertNotNull(resolved);    verify(request);}
private HttpServletRequest shiro_f2442_0(String path)
{    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn(null).anyTimes();    expect(request.getContextPath()).andReturn("");    expect(request.getRequestURI()).andReturn(path);    replay(request);    return request;}
public void shiro_f2443_0()
{    try {        InjectionPoint ip = InjectionPoint.forConstructorOf(GuiceShiroFilter.class);    } catch (Exception e) {        fail("Could not create constructor injection point.");    }}
public void shiro_f2444_0()
{    WebSecurityManager securityManager = createMock(WebSecurityManager.class);    FilterChainResolver filterChainResolver = createMock(FilterChainResolver.class);    GuiceShiroFilter underTest = new GuiceShiroFilter(securityManager, filterChainResolver);    assertSame(securityManager, underTest.getSecurityManager());    assertSame(filterChainResolver, underTest.getFilterChainResolver());}
public void shiro_f2445_0()
{    PathMatchingFilter filter = createMock(PathMatchingFilter.class);    expect(filter.processPathConfig("/1", "first")).andReturn(filter);    expect(filter.processPathConfig("/2", "second")).andReturn(filter);    replay(filter);    Map<String, String> pathConfigMap = new HashMap<String, String>();    pathConfigMap.put("/1", "first");    pathConfigMap.put("/2", "second");    PathMatchingFilterProvider underTest = new PathMatchingFilterProvider(Key.get(PathMatchingFilter.class), pathConfigMap);    underTest.postProcess(filter);    verify(filter);}
public void shiro_f2446_0()
{    final ShiroModuleTest.MockRealm mockRealm = createMock(ShiroModuleTest.MockRealm.class);    ServletContext servletContext = createMock(ServletContext.class);    Injector injector = Guice.createInjector(new ShiroWebModule(servletContext) {        @Override        protected void configureShiroWeb() {            bindRealm().to(ShiroModuleTest.MockRealm.class);            expose(SessionManager.class);        }        @Provides        public ShiroModuleTest.MockRealm createRealm() {            return mockRealm;        }    });            SecurityManager securityManager = injector.getInstance(SecurityManager.class);    assertNotNull(securityManager);    assertTrue(securityManager instanceof WebSecurityManager);    SessionManager sessionManager = injector.getInstance(SessionManager.class);    assertNotNull(sessionManager);    assertTrue(sessionManager instanceof ServletContainerSessionManager);    assertTrue(((DefaultWebSecurityManager) securityManager).getSessionManager() instanceof ServletContainerSessionManager);}
protected void shiro_f2447_0()
{    bindRealm().to(ShiroModuleTest.MockRealm.class);    expose(SessionManager.class);}
public ShiroModuleTest.MockRealm shiro_f2448_0()
{    return mockRealm;}
public void shiro_f2449_0() throws Exception
{}
public void shiro_f2450_0() throws Exception
{    final ShiroModuleTest.MockRealm mockRealm = createMock(ShiroModuleTest.MockRealm.class);    ServletContext servletContext = createMock(ServletContext.class);    Injector injector = Guice.createInjector(new ShiroWebModule(servletContext) {        @Override        protected void configureShiroWeb() {            bindRealm().to(ShiroModuleTest.MockRealm.class);            expose(WebSecurityManager.class);        }        @Provides        public ShiroModuleTest.MockRealm createRealm() {            return mockRealm;        }        @Override        protected void bindWebSecurityManager(AnnotatedBindingBuilder<? super WebSecurityManager> bind) {            bind.to(MyDefaultWebSecurityManager.class).asEagerSingleton();        }    });    SecurityManager securityManager = injector.getInstance(SecurityManager.class);    assertNotNull(securityManager);    assertTrue(securityManager instanceof MyDefaultWebSecurityManager);    WebSecurityManager webSecurityManager = injector.getInstance(WebSecurityManager.class);    assertNotNull(webSecurityManager);    assertTrue(webSecurityManager instanceof MyDefaultWebSecurityManager);        assertTrue(securityManager == webSecurityManager);}
protected void shiro_f2451_0()
{    bindRealm().to(ShiroModuleTest.MockRealm.class);    expose(WebSecurityManager.class);}
public ShiroModuleTest.MockRealm shiro_f2452_0()
{    return mockRealm;}
protected void shiro_f2453_0(AnnotatedBindingBuilder<? super WebSecurityManager> bind)
{    bind.to(MyDefaultWebSecurityManager.class).asEagerSingleton();}
public void shiro_f2454_0() throws Exception
{    final ShiroModuleTest.MockRealm mockRealm = createMock(ShiroModuleTest.MockRealm.class);    ServletContext servletContext = createMock(ServletContext.class);    Injector injector = Guice.createInjector(new ShiroWebModule(servletContext) {        @Override        protected void configureShiroWeb() {            bindRealm().to(ShiroModuleTest.MockRealm.class);            expose(WebEnvironment.class);            expose(Environment.class);        }        @Provides        public ShiroModuleTest.MockRealm createRealm() {            return mockRealm;        }        @Override        protected void bindWebEnvironment(AnnotatedBindingBuilder<? super WebEnvironment> bind) {            bind.to(MyWebEnvironment.class).asEagerSingleton();        }    });    Environment environment = injector.getInstance(Environment.class);    assertNotNull(environment);    assertTrue(environment instanceof MyWebEnvironment);    WebEnvironment webEnvironment = injector.getInstance(WebEnvironment.class);    assertNotNull(webEnvironment);    assertTrue(webEnvironment instanceof MyWebEnvironment);        assertTrue(environment == webEnvironment);}
protected void shiro_f2455_0()
{    bindRealm().to(ShiroModuleTest.MockRealm.class);    expose(WebEnvironment.class);    expose(Environment.class);}
public ShiroModuleTest.MockRealm shiro_f2456_0()
{    return mockRealm;}
protected void shiro_f2457_0(AnnotatedBindingBuilder<? super WebEnvironment> bind)
{    bind.to(MyWebEnvironment.class).asEagerSingleton();}
public void shiro_f2458_0()
{    final ShiroModuleTest.MockRealm mockRealm = createMock(ShiroModuleTest.MockRealm.class);    ServletContext servletContext = createMock(ServletContext.class);    HttpServletRequest request = createMock(HttpServletRequest.class);    servletContext.setAttribute(eq(EnvironmentLoader.ENVIRONMENT_ATTRIBUTE_KEY), EasyMock.anyObject());    expect(request.getAttribute("javax.servlet.include.context_path")).andReturn("").anyTimes();    expect(request.getCharacterEncoding()).andReturn("UTF-8").anyTimes();    expect(request.getAttribute("javax.servlet.include.request_uri")).andReturn("/test_authc");    expect(request.getAttribute("javax.servlet.include.request_uri")).andReturn("/test_custom_filter");    expect(request.getAttribute("javax.servlet.include.request_uri")).andReturn("/test_authc_basic");    expect(request.getAttribute("javax.servlet.include.request_uri")).andReturn("/test_perms");    expect(request.getAttribute("javax.servlet.include.request_uri")).andReturn("/multiple_configs");    replay(servletContext, request);    Injector injector = Guice.createInjector(new ShiroWebModule(servletContext) {        @Override        protected void configureShiroWeb() {            bindRealm().to(ShiroModuleTest.MockRealm.class);            expose(FilterChainResolver.class);            this.addFilterChain("/test_authc/**", filterConfig(AUTHC));            this.addFilterChain("/test_custom_filter/**", Key.get(CustomFilter.class));            this.addFilterChain("/test_authc_basic/**", AUTHC_BASIC);            this.addFilterChain("/test_perms/**", filterConfig(PERMS, "remote:invoke:lan,wan"));            this.addFilterChain("/multiple_configs/**", filterConfig(AUTHC), filterConfig(ROLES, "b2bClient"), filterConfig(PERMS, "remote:invoke:lan,wan"));        }        @Provides        public ShiroModuleTest.MockRealm createRealm() {            return mockRealm;        }    });    FilterChainResolver resolver = injector.getInstance(FilterChainResolver.class);    assertThat(resolver, instanceOf(SimpleFilterChainResolver.class));    SimpleFilterChainResolver simpleFilterChainResolver = (SimpleFilterChainResolver) resolver;        FilterChain filterChain = simpleFilterChainResolver.getChain(request, null, null);    assertThat(filterChain, instanceOf(SimpleFilterChain.class));    Filter nextFilter = getNextFilter((SimpleFilterChain) filterChain);    assertThat(nextFilter, instanceOf(FormAuthenticationFilter.class));        filterChain = simpleFilterChainResolver.getChain(request, null, null);    assertThat(filterChain, instanceOf(SimpleFilterChain.class));    nextFilter = getNextFilter((SimpleFilterChain) filterChain);    assertThat(nextFilter, instanceOf(CustomFilter.class));        filterChain = simpleFilterChainResolver.getChain(request, null, null);    assertThat(filterChain, instanceOf(SimpleFilterChain.class));    nextFilter = getNextFilter((SimpleFilterChain) filterChain);    assertThat(nextFilter, instanceOf(BasicHttpAuthenticationFilter.class));        filterChain = simpleFilterChainResolver.getChain(request, null, null);    assertThat(filterChain, instanceOf(SimpleFilterChain.class));    nextFilter = getNextFilter((SimpleFilterChain) filterChain);    assertThat(nextFilter, instanceOf(PermissionsAuthorizationFilter.class));        filterChain = simpleFilterChainResolver.getChain(request, null, null);    assertThat(filterChain, instanceOf(SimpleFilterChain.class));    assertThat(getNextFilter((SimpleFilterChain) filterChain), instanceOf(FormAuthenticationFilter.class));    assertThat(getNextFilter((SimpleFilterChain) filterChain), instanceOf(RolesAuthorizationFilter.class));    assertThat(getNextFilter((SimpleFilterChain) filterChain), instanceOf(PermissionsAuthorizationFilter.class));    verify(servletContext, request);}
protected void shiro_f2459_0()
{    bindRealm().to(ShiroModuleTest.MockRealm.class);    expose(FilterChainResolver.class);    this.addFilterChain("/test_authc/**", filterConfig(AUTHC));    this.addFilterChain("/test_custom_filter/**", Key.get(CustomFilter.class));    this.addFilterChain("/test_authc_basic/**", AUTHC_BASIC);    this.addFilterChain("/test_perms/**", filterConfig(PERMS, "remote:invoke:lan,wan"));    this.addFilterChain("/multiple_configs/**", filterConfig(AUTHC), filterConfig(ROLES, "b2bClient"), filterConfig(PERMS, "remote:invoke:lan,wan"));}
public ShiroModuleTest.MockRealm shiro_f2460_0()
{    return mockRealm;}
public void shiro_f2461_0()
{    Assume.assumeTrue("This test only runs agains Guice 3.x", ShiroWebModule.isGuiceVersion3());    final ShiroModuleTest.MockRealm mockRealm = createMock(ShiroModuleTest.MockRealm.class);    ServletContext servletContext = createMock(ServletContext.class);    HttpServletRequest request = createMock(HttpServletRequest.class);    servletContext.setAttribute(eq(EnvironmentLoader.ENVIRONMENT_ATTRIBUTE_KEY), EasyMock.anyObject());    expect(request.getAttribute("javax.servlet.include.context_path")).andReturn("").anyTimes();    expect(request.getCharacterEncoding()).andReturn("UTF-8").anyTimes();    expect(request.getAttribute("javax.servlet.include.request_uri")).andReturn("/test_authc");    expect(request.getAttribute("javax.servlet.include.request_uri")).andReturn("/test_custom_filter");    expect(request.getAttribute("javax.servlet.include.request_uri")).andReturn("/test_perms");    expect(request.getAttribute("javax.servlet.include.request_uri")).andReturn("/multiple_configs");    replay(servletContext, request);    Injector injector = Guice.createInjector(new ShiroWebModule(servletContext) {        @Override        protected void configureShiroWeb() {            bindRealm().to(ShiroModuleTest.MockRealm.class);            expose(FilterChainResolver.class);            this.addFilterChain("/test_authc/**", AUTHC);            this.addFilterChain("/test_custom_filter/**", Key.get(CustomFilter.class));            this.addFilterChain("/test_perms/**", config(PERMS, "remote:invoke:lan,wan"));            this.addFilterChain("/multiple_configs/**", AUTHC, config(ROLES, "b2bClient"), config(PERMS, "remote:invoke:lan,wan"));        }        @Provides        public ShiroModuleTest.MockRealm createRealm() {            return mockRealm;        }    });    FilterChainResolver resolver = injector.getInstance(FilterChainResolver.class);    assertThat(resolver, instanceOf(SimpleFilterChainResolver.class));    SimpleFilterChainResolver simpleFilterChainResolver = (SimpleFilterChainResolver) resolver;        FilterChain filterChain = simpleFilterChainResolver.getChain(request, null, null);    assertThat(filterChain, instanceOf(SimpleFilterChain.class));    Filter nextFilter = getNextFilter((SimpleFilterChain) filterChain);    assertThat(nextFilter, instanceOf(FormAuthenticationFilter.class));        filterChain = simpleFilterChainResolver.getChain(request, null, null);    assertThat(filterChain, instanceOf(SimpleFilterChain.class));    nextFilter = getNextFilter((SimpleFilterChain) filterChain);    assertThat(nextFilter, instanceOf(CustomFilter.class));        filterChain = simpleFilterChainResolver.getChain(request, null, null);    assertThat(filterChain, instanceOf(SimpleFilterChain.class));    nextFilter = getNextFilter((SimpleFilterChain) filterChain);    assertThat(nextFilter, instanceOf(PermissionsAuthorizationFilter.class));        filterChain = simpleFilterChainResolver.getChain(request, null, null);    assertThat(filterChain, instanceOf(SimpleFilterChain.class));    assertThat(getNextFilter((SimpleFilterChain) filterChain), instanceOf(FormAuthenticationFilter.class));    assertThat(getNextFilter((SimpleFilterChain) filterChain), instanceOf(RolesAuthorizationFilter.class));    assertThat(getNextFilter((SimpleFilterChain) filterChain), instanceOf(PermissionsAuthorizationFilter.class));    verify(servletContext, request);}
protected void shiro_f2462_0()
{    bindRealm().to(ShiroModuleTest.MockRealm.class);    expose(FilterChainResolver.class);    this.addFilterChain("/test_authc/**", AUTHC);    this.addFilterChain("/test_custom_filter/**", Key.get(CustomFilter.class));    this.addFilterChain("/test_perms/**", config(PERMS, "remote:invoke:lan,wan"));    this.addFilterChain("/multiple_configs/**", AUTHC, config(ROLES, "b2bClient"), config(PERMS, "remote:invoke:lan,wan"));}
public ShiroModuleTest.MockRealm shiro_f2463_0()
{    return mockRealm;}
private Filter shiro_f2464_0(SimpleFilterChain filterChain)
{    Iterator<? extends Filter> filters = filterChain.getFilters();    if (filters.hasNext()) {        return filters.next();    }    return null;}
public void shiro_f2465_0(FilterConfig filterConfig) throws ServletException
{}
public void shiro_f2466_0(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException
{}
public void shiro_f2467_0()
{}
public void shiro_f2468_0() throws Exception
{                        IMocksControl ctrl = createStrictControl();    Injector injector = ctrl.createMock(Injector.class);    Map<String, Key<? extends Filter>[]> chainMap = new LinkedHashMap<String, Key<? extends Filter>[]>();    final String chainOne = "one";    final String chainTwo = "two";    final String chainThree = "three";    final Key<? extends Filter> key1a = Key.get(Filter.class, Names.named("key1a"));    final Key<? extends Filter> key1b = Key.get(Filter.class, Names.named("key1b"));    final Key<? extends Filter> key2a = Key.get(Filter.class, Names.named("key2a"));    final Key<? extends Filter> key2b = Key.get(Filter.class, Names.named("key2b"));    final Key<? extends Filter> key3a = Key.get(Filter.class, Names.named("key3a"));    final Key<? extends Filter> key3b = Key.get(Filter.class, Names.named("key3b"));    chainMap.put(chainOne, new Key[] { key1a, key1b });    chainMap.put(chainTwo, new Key[] { key2a, key2b });    chainMap.put(chainThree, new Key[] { key3a, key3b });    PatternMatcher patternMatcher = ctrl.createMock(PatternMatcher.class);    ServletRequest request = ctrl.createMock(HttpServletRequest.class);    ServletResponse response = ctrl.createMock(HttpServletResponse.class);    FilterChain originalChain = ctrl.createMock(FilterChain.class);    expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn("/context");    expect(request.getAttribute(WebUtils.INCLUDE_REQUEST_URI_ATTRIBUTE)).andReturn("/mychain");    expect(request.getCharacterEncoding()).andStubReturn(null);    expect(patternMatcher.matches(chainOne, "/mychain")).andReturn(false);    expect(patternMatcher.matches(chainTwo, "/mychain")).andReturn(true);    Filter filter2a = ctrl.createMock(Filter.class);    Filter filter2b = ctrl.createMock(Filter.class);    expect((Filter) injector.getInstance(key2a)).andReturn(filter2a);    filter2a.doFilter(same(request), same(response), anyObject(FilterChain.class));    expect((Filter) injector.getInstance(key2b)).andReturn(filter2b);    filter2b.doFilter(same(request), same(response), anyObject(FilterChain.class));    originalChain.doFilter(request, response);    ctrl.replay();    SimpleFilterChainResolver underTest = new SimpleFilterChainResolver(chainMap, injector, patternMatcher);    FilterChain got = underTest.getChain(request, response, originalChain);    got.doFilter(request, response);    got.doFilter(request, response);    got.doFilter(request, response);    ctrl.verify();    ctrl.reset();    expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn("/context");    expect(request.getAttribute(WebUtils.INCLUDE_REQUEST_URI_ATTRIBUTE)).andReturn("/nochain");    expect(request.getCharacterEncoding()).andStubReturn(null);    expect(patternMatcher.matches(chainOne, "/nochain")).andReturn(false);    expect(patternMatcher.matches(chainTwo, "/nochain")).andReturn(false);    expect(patternMatcher.matches(chainThree, "/nochain")).andReturn(false);    ctrl.replay();    assertNull("Expected no chain to match, did not get a null value in return.", underTest.getChain(request, response, originalChain));    ctrl.verify();}
public void shiro_f2469_0() throws Exception
{    IMocksControl ctrl = createStrictControl();    FilterChain originalChain = ctrl.createMock(FilterChain.class);    Filter filter1 = ctrl.createMock("filter1", Filter.class);    Filter filter2 = ctrl.createMock("filter2", Filter.class);    ServletRequest request = ctrl.createMock(ServletRequest.class);    ServletResponse response = ctrl.createMock(ServletResponse.class);    Capture<FilterChain> fc1 = Capture.newInstance();    Capture<FilterChain> fc2 = Capture.newInstance();    filter1.doFilter(same(request), same(response), and(anyObject(FilterChain.class), capture(fc1)));    filter2.doFilter(same(request), same(response), and(anyObject(FilterChain.class), capture(fc2)));    originalChain.doFilter(request, response);    ctrl.replay();    SimpleFilterChain underTest = new SimpleFilterChain(originalChain, Arrays.asList(filter1, filter2).iterator());            underTest.doFilter(request, response);    fc1.getValue().doFilter(request, response);    fc2.getValue().doFilter(request, response);    ctrl.verify();}
public void shiro_f2470_0()
{    try {        InjectionPoint ip = InjectionPoint.forConstructorOf(WebGuiceEnvironment.class);    } catch (Exception e) {        fail("Could not create constructor injection point.");    }}
public void shiro_f2471_0()
{    WebSecurityManager securityManager = createMock(WebSecurityManager.class);    FilterChainResolver filterChainResolver = createMock(FilterChainResolver.class);    ServletContext servletContext = createMock(ServletContext.class);    Capture<WebGuiceEnvironment> capture = Capture.newInstance();    servletContext.setAttribute(eq(EnvironmentLoaderListener.ENVIRONMENT_ATTRIBUTE_KEY), and(anyObject(WebGuiceEnvironment.class), capture(capture)));    replay(servletContext, securityManager, filterChainResolver);    WebGuiceEnvironment underTest = new WebGuiceEnvironment(filterChainResolver, servletContext, securityManager);    assertSame(securityManager, underTest.getSecurityManager());    assertSame(filterChainResolver, underTest.getFilterChainResolver());    assertSame(securityManager, underTest.getWebSecurityManager());    assertSame(servletContext, underTest.getServletContext());    assertSame(underTest, capture.getValue());    verify(servletContext);}
public Cache<K, V> shiro_f2472_0(String name) throws CacheException
{        Map<K, V> map = ensureHazelcastInstance().getMap(name);    return new MapCache<K, V>(name, map);}
protected HazelcastInstance shiro_f2473_0()
{    if (this.hazelcastInstance == null) {        this.hazelcastInstance = createHazelcastInstance();        this.implicitlyCreated = true;    }    return this.hazelcastInstance;}
public void shiro_f2474_0() throws ShiroException
{    ensureHazelcastInstance();}
protected HazelcastInstance shiro_f2475_0()
{    return Hazelcast.newHazelcastInstance(this.config);}
protected final boolean shiro_f2476_0()
{    return this.implicitlyCreated;}
public void shiro_f2477_1() throws Exception
{    if (this.implicitlyCreated) {        try {            this.hazelcastInstance.getLifecycleService().shutdown();        } catch (Throwable t) {            if (log.isWarnEnabled()) {                            }        } finally {            this.hazelcastInstance = null;            this.implicitlyCreated = false;        }    }}
public HazelcastInstance shiro_f2478_0()
{    return hazelcastInstance;}
public void shiro_f2479_0(HazelcastInstance hazelcastInstance)
{    this.hazelcastInstance = hazelcastInstance;}
public Config shiro_f2480_0()
{    return config;}
public void shiro_f2481_0(Config config)
{    this.config = config;}
private static AuthorizingAnnotationHandler shiro_f2482_0(Annotation annotation)
{    Class<?> t = annotation.annotationType();    if (RequiresPermissions.class.equals(t))        return new PermissionAnnotationHandler();    else if (RequiresRoles.class.equals(t))        return new RoleAnnotationHandler();    else if (RequiresUser.class.equals(t))        return new UserAnnotationHandler();    else if (RequiresGuest.class.equals(t))        return new GuestAnnotationHandler();    else if (RequiresAuthentication.class.equals(t))        return new AuthenticatedAnnotationHandler();    else        throw new IllegalArgumentException("Cannot create a handler for the unknown for annotation " + t);}
public void shiro_f2483_0(ContainerRequestContext requestContext) throws IOException
{    for (Map.Entry<AuthorizingAnnotationHandler, Annotation> authzCheck : authzChecks.entrySet()) {        AuthorizingAnnotationHandler handler = authzCheck.getKey();        Annotation authzSpec = authzCheck.getValue();        handler.assertAuthorized(authzSpec);    }}
public Response shiro_f2484_0(AuthorizationException exception)
{    Status status;    if (exception instanceof UnauthorizedException) {        status = Status.FORBIDDEN;    } else {        status = Status.UNAUTHORIZED;    }    return Response.status(status).build();}
public void shiro_f2485_0(ResourceInfo resourceInfo, FeatureContext context)
{    List<Annotation> authzSpecs = new ArrayList<Annotation>();    for (Class<? extends Annotation> annotationClass : shiroAnnotations) {                Annotation classAuthzSpec = resourceInfo.getResourceClass().getAnnotation(annotationClass);        Annotation methodAuthzSpec = resourceInfo.getResourceMethod().getAnnotation(annotationClass);        if (classAuthzSpec != null)            authzSpecs.add(classAuthzSpec);        if (methodAuthzSpec != null)            authzSpecs.add(methodAuthzSpec);    }    if (!authzSpecs.isEmpty()) {        context.register(new AnnotationAuthorizationFilter(authzSpecs), Priorities.AUTHORIZATION);    }}
public boolean shiro_f2486_0(FeatureContext context)
{    context.register(ExceptionMapper.class);    context.register(SubjectPrincipalRequestFilter.class);    context.register(ShiroAnnotationFilterFeature.class);    return true;}
public Principal shiro_f2487_0()
{    Principal result;    Subject subject = getSubject();    PrincipalCollection shiroPrincipals = subject.getPrincipals();    if (shiroPrincipals != null) {        result = shiroPrincipals.oneByType(Principal.class);        if (result == null) {            result = new ObjectPrincipal(shiroPrincipals.getPrimaryPrincipal());        }    } else {        result = originalSecurityContext.getUserPrincipal();    }    return result;}
public boolean shiro_f2488_0(String role)
{    return getSubject().hasRole(role);}
public boolean shiro_f2489_0()
{    return containerRequestContext.getSecurityContext().isSecure();}
public String shiro_f2490_0()
{    return containerRequestContext.getSecurityContext().getAuthenticationScheme();}
private Subject shiro_f2491_0()
{    return SecurityUtils.getSubject();}
public Object shiro_f2492_0()
{    return object;}
public String shiro_f2493_0()
{    return getObject().toString();}
public boolean shiro_f2494_0(Object o)
{    if (this == o)        return true;    if (o == null || getClass() != o.getClass())        return false;    ObjectPrincipal that = (ObjectPrincipal) o;    return object.equals(that.object);}
public int shiro_f2495_0()
{    return object.hashCode();}
public String shiro_f2496_0()
{    return object.toString();}
public void shiro_f2497_0(ContainerRequestContext requestContext) throws IOException
{    requestContext.setSecurityContext(new ShiroSecurityContext(requestContext));}
public void shiro_f2498_1(JobExecutionContext context) throws JobExecutionException
{    JobDataMap jobDataMap = context.getMergedJobDataMap();    ValidatingSessionManager sessionManager = (ValidatingSessionManager) jobDataMap.get(SESSION_MANAGER_KEY);    if (log.isDebugEnabled()) {            }    sessionManager.validateSessions();    if (log.isDebugEnabled()) {            }}
protected Scheduler shiro_f2499_0() throws SchedulerException
{    if (scheduler == null) {        scheduler = StdSchedulerFactory.getDefaultScheduler();        schedulerImplicitlyCreated = true;    }    return scheduler;}
public void shiro_f2500_0(Scheduler scheduler)
{    this.scheduler = scheduler;}
public void shiro_f2501_0(ValidatingSessionManager sessionManager)
{    this.sessionManager = sessionManager;}
public boolean shiro_f2502_0()
{    return this.enabled;}
public void shiro_f2503_0(long sessionValidationInterval)
{    this.sessionValidationInterval = sessionValidationInterval;}
public void shiro_f2504_1()
{    if (log.isDebugEnabled()) {            }    try {        SimpleTrigger trigger = new SimpleTrigger(getClass().getName(), Scheduler.DEFAULT_GROUP, SimpleTrigger.REPEAT_INDEFINITELY, sessionValidationInterval);        JobDetail detail = new JobDetail(JOB_NAME, Scheduler.DEFAULT_GROUP, QuartzSessionValidationJob.class);        detail.getJobDataMap().put(QuartzSessionValidationJob.SESSION_MANAGER_KEY, sessionManager);        Scheduler scheduler = getScheduler();        scheduler.scheduleJob(detail, trigger);        if (schedulerImplicitlyCreated) {            scheduler.start();            if (log.isDebugEnabled()) {                            }        }        this.enabled = true;        if (log.isDebugEnabled()) {                    }    } catch (SchedulerException e) {        if (log.isErrorEnabled()) {                    }    }}
public void shiro_f2505_1()
{    if (log.isDebugEnabled()) {            }    Scheduler scheduler;    try {        scheduler = getScheduler();        if (scheduler == null) {            if (log.isWarnEnabled()) {                            }            return;        }    } catch (SchedulerException e) {        if (log.isWarnEnabled()) {                    }        return;    }    try {        scheduler.unscheduleJob(JOB_NAME, Scheduler.DEFAULT_GROUP);        if (log.isDebugEnabled()) {                    }    } catch (SchedulerException e) {        if (log.isDebugEnabled()) {                    }    }    this.enabled = false;    if (schedulerImplicitlyCreated) {        try {            scheduler.shutdown();        } catch (SchedulerException e) {            if (log.isWarnEnabled()) {                            }        } finally {            setScheduler(null);            schedulerImplicitlyCreated = false;        }    }}
public Annotation shiro_f2506_0(MethodInvocation mi, Class<? extends Annotation> clazz)
{    Method m = mi.getMethod();    Annotation a = AnnotationUtils.findAnnotation(m, clazz);    if (a != null)        return a;                        Class<?> targetClass = mi.getThis().getClass();    m = ClassUtils.getMostSpecificMethod(m, targetClass);    a = AnnotationUtils.findAnnotation(m, clazz);    if (a != null)        return a;        return AnnotationUtils.findAnnotation(mi.getThis().getClass(), clazz);}
protected DefaultAdvisorAutoProxyCreator shiro_f2507_0()
{    return new DefaultAdvisorAutoProxyCreator();}
protected AuthorizationAttributeSourceAdvisor shiro_f2508_0(SecurityManager securityManager)
{    AuthorizationAttributeSourceAdvisor advisor = new AuthorizationAttributeSourceAdvisor();    advisor.setSecurityManager(securityManager);    return advisor;}
protected LifecycleBeanPostProcessor shiro_f2509_0()
{    return new LifecycleBeanPostProcessor();}
protected EventBus shiro_f2510_0()
{    return new DefaultEventBus();}
protected ShiroEventBusBeanPostProcessor shiro_f2511_0()
{    return new ShiroEventBusBeanPostProcessor(eventBus());}
protected SessionsSecurityManager shiro_f2512_0(List<Realm> realms)
{    SessionsSecurityManager securityManager = createSecurityManager();    securityManager.setAuthenticator(authenticator());    securityManager.setAuthorizer(authorizer());    securityManager.setRealms(realms);    securityManager.setSessionManager(sessionManager());    securityManager.setEventBus(eventBus);    if (cacheManager != null) {        securityManager.setCacheManager(cacheManager);    }    return securityManager;}
protected SessionManager shiro_f2513_0()
{    DefaultSessionManager sessionManager = new DefaultSessionManager();    sessionManager.setSessionDAO(sessionDAO());    sessionManager.setSessionFactory(sessionFactory());    sessionManager.setDeleteInvalidSessions(sessionManagerDeleteInvalidSessions);    return sessionManager;}
protected SessionsSecurityManager shiro_f2514_0()
{    DefaultSecurityManager securityManager = new DefaultSecurityManager();    securityManager.setSubjectDAO(subjectDAO());    securityManager.setSubjectFactory(subjectFactory());    RememberMeManager rememberMeManager = rememberMeManager();    if (rememberMeManager != null) {        securityManager.setRememberMeManager(rememberMeManager);    }    return securityManager;}
protected RememberMeManager shiro_f2515_0()
{    return null;}
protected SubjectDAO shiro_f2516_0()
{    DefaultSubjectDAO subjectDAO = new DefaultSubjectDAO();    subjectDAO.setSessionStorageEvaluator(sessionStorageEvaluator());    return subjectDAO;}
protected SessionStorageEvaluator shiro_f2517_0()
{    return new DefaultSessionStorageEvaluator();}
protected SubjectFactory shiro_f2518_0()
{    return new DefaultSubjectFactory();}
protected SessionFactory shiro_f2519_0()
{    return new SimpleSessionFactory();}
protected SessionDAO shiro_f2520_0()
{    return new MemorySessionDAO();}
protected Authorizer shiro_f2521_0()
{    ModularRealmAuthorizer authorizer = new ModularRealmAuthorizer();    if (permissionResolver != null) {        authorizer.setPermissionResolver(permissionResolver);    }    if (rolePermissionResolver != null) {        authorizer.setRolePermissionResolver(rolePermissionResolver);    }    return authorizer;}
protected AuthenticationStrategy shiro_f2522_0()
{    return new AtLeastOneSuccessfulStrategy();}
protected Authenticator shiro_f2523_0()
{    ModularRealmAuthenticator authenticator = new ModularRealmAuthenticator();    authenticator.setAuthenticationStrategy(authenticationStrategy());    return authenticator;}
protected Realm shiro_f2524_0(String iniLocation)
{    Ini ini = Ini.fromResourcePath(iniLocation);    return new IniRealm(ini);}
protected DefaultAdvisorAutoProxyCreator shiro_f2525_0()
{    return super.defaultAdvisorAutoProxyCreator();}
protected AuthorizationAttributeSourceAdvisor shiro_f2526_0(SecurityManager securityManager)
{    return super.authorizationAttributeSourceAdvisor(securityManager);}
public LifecycleBeanPostProcessor shiro_f2527_0()
{    return super.lifecycleBeanPostProcessor();}
protected EventBus shiro_f2528_0()
{    return super.eventBus();}
public ShiroEventBusBeanPostProcessor shiro_f2529_0()
{    return super.shiroEventBusAwareBeanPostProcessor();}
protected SessionsSecurityManager shiro_f2530_0(List<Realm> realms)
{    return super.securityManager(realms);}
protected SessionManager shiro_f2531_0()
{    return super.sessionManager();}
protected SubjectDAO shiro_f2532_0()
{    return super.subjectDAO();}
protected SessionStorageEvaluator shiro_f2533_0()
{    return super.sessionStorageEvaluator();}
protected SubjectFactory shiro_f2534_0()
{    return super.subjectFactory();}
protected SessionFactory shiro_f2535_0()
{    return super.sessionFactory();}
protected SessionDAO shiro_f2536_0()
{    return super.sessionDAO();}
protected Authorizer shiro_f2537_0()
{    return super.authorizer();}
protected AuthenticationStrategy shiro_f2538_0()
{    return super.authenticationStrategy();}
protected Authenticator shiro_f2539_0()
{    return super.authenticator();}
protected RememberMeManager shiro_f2540_0()
{    return super.rememberMeManager();}
public Object shiro_f2541_1(Object object, String name) throws BeansException
{    if (object instanceof Initializable) {        try {            if (log.isDebugEnabled()) {                            }            ((Initializable) object).init();        } catch (Exception e) {            throw new FatalBeanException("Error initializing bean [" + name + "]", e);        }    }    return object;}
public Object shiro_f2542_0(Object object, String name) throws BeansException
{        return object;}
public void shiro_f2543_1(Object object, String name) throws BeansException
{    if (object instanceof Destroyable) {        try {            if (log.isDebugEnabled()) {                            }            ((Destroyable) object).destroy();        } catch (Exception e) {            throw new FatalBeanException("Error destroying bean [" + name + "]", e);        }    }}
public int shiro_f2544_0()
{        return order;}
public boolean shiro_f2545_0(Object bean)
{    return (bean instanceof Destroyable);}
public void shiro_f2546_0(org.apache.shiro.mgt.SecurityManager securityManager)
{    this.securityManager = securityManager;}
public Object shiro_f2547_0(final RemoteInvocation invocation, final Object targetObject) throws NoSuchMethodException, IllegalAccessException, InvocationTargetException
{    try {        SecurityManager securityManager = this.securityManager != null ? this.securityManager : SecurityUtils.getSecurityManager();        Subject.Builder builder = new Subject.Builder(securityManager);        String host = (String) invocation.getAttribute(SecureRemoteInvocationFactory.HOST_KEY);        if (host != null) {            builder.host(host);        }        Serializable sessionId = invocation.getAttribute(SecureRemoteInvocationFactory.SESSION_ID_KEY);        if (sessionId != null) {            builder.sessionId(sessionId);        } else {            if (log.isTraceEnabled()) {                log.trace("RemoteInvocation did not contain a Shiro Session id attribute under " + "key [" + SecureRemoteInvocationFactory.SESSION_ID_KEY + "].  A Subject based " + "on an existing Session will not be available during the method invocation.");            }        }        Subject subject = builder.buildSubject();        return subject.execute(new Callable() {            public Object call() throws Exception {                return SecureRemoteInvocationExecutor.super.invoke(invocation, targetObject);            }        });    } catch (ExecutionException e) {        Throwable cause = e.getCause();        if (cause instanceof NoSuchMethodException) {            throw (NoSuchMethodException) cause;        } else if (cause instanceof IllegalAccessException) {            throw (IllegalAccessException) cause;        } else if (cause instanceof InvocationTargetException) {            throw (InvocationTargetException) cause;        } else {            throw new InvocationTargetException(cause);        }    } catch (Throwable t) {        throw new InvocationTargetException(t);    }}
public Object shiro_f2548_0() throws Exception
{    return SecureRemoteInvocationExecutor.super.invoke(invocation, targetObject);}
public RemoteInvocation shiro_f2549_0(MethodInvocation mi)
{    Serializable sessionId = null;    String host = null;    boolean sessionManagerMethodInvocation = false;            Class miDeclaringClass = mi.getMethod().getDeclaringClass();    if (SessionManager.class.equals(miDeclaringClass) || NativeSessionManager.class.equals(miDeclaringClass)) {        sessionManagerMethodInvocation = true;                if (!mi.getMethod().getName().equals("start")) {            SessionKey key = (SessionKey) mi.getArguments()[0];            sessionId = key.getSessionId();        }    }        if (sessionId == null)        sessionId = this.sessionId;        if (sessionId == null) {        try {                        SecurityUtils.getSecurityManager();            if (!sessionManagerMethodInvocation) {                Subject subject = SecurityUtils.getSubject();                Session session = subject.getSession(false);                if (session != null) {                    sessionId = session.getId();                    host = session.getHost();                }            }        } catch (Exception e) {            log.trace("No security manager set. Trying next to get session id from system property");        }    }        if (sessionId == null) {        if (log.isTraceEnabled()) {            log.trace("No Session found for the currently executing subject via subject.getSession(false).  " + "Attempting to revert back to the 'shiro.session.id' system property...");        }        sessionId = System.getProperty(SESSION_ID_SYSTEM_PROPERTY_NAME);        if (sessionId == null && log.isTraceEnabled()) {            log.trace("No 'shiro.session.id' system property found.  Heuristics have been exhausted; " + "RemoteInvocation will not contain a sessionId.");        }    }    RemoteInvocation ri = new RemoteInvocation(mi);    if (sessionId != null) {        ri.addAttribute(SESSION_ID_KEY, sessionId);    }    if (host != null) {        ri.addAttribute(HOST_KEY, host);    }    return ri;}
protected org.apache.shiro.aop.MethodInvocation shiro_f2550_0(Object implSpecificMethodInvocation)
{    final MethodInvocation mi = (MethodInvocation) implSpecificMethodInvocation;    return new org.apache.shiro.aop.MethodInvocation() {        public Method getMethod() {            return mi.getMethod();        }        public Object[] getArguments() {            return mi.getArguments();        }        public String toString() {            return "Method invocation [" + mi.getMethod() + "]";        }        public Object proceed() throws Throwable {            return mi.proceed();        }        public Object getThis() {            return mi.getThis();        }    };}
public Method shiro_f2551_0()
{    return mi.getMethod();}
public Object[] shiro_f2552_0()
{    return mi.getArguments();}
public String shiro_f2553_0()
{    return "Method invocation [" + mi.getMethod() + "]";}
public Object shiro_f2554_0() throws Throwable
{    return mi.proceed();}
public Object shiro_f2555_0()
{    return mi.getThis();}
protected Object shiro_f2556_0(Object aopAllianceMethodInvocation) throws Throwable
{    MethodInvocation mi = (MethodInvocation) aopAllianceMethodInvocation;    return mi.proceed();}
public Object shiro_f2557_0(MethodInvocation methodInvocation) throws Throwable
{    org.apache.shiro.aop.MethodInvocation mi = createMethodInvocation(methodInvocation);    return super.invoke(mi);}
public SecurityManager shiro_f2558_0()
{    return securityManager;}
public void shiro_f2559_0(org.apache.shiro.mgt.SecurityManager securityManager)
{    this.securityManager = securityManager;}
public boolean shiro_f2560_0(Method method, Class targetClass)
{    Method m = method;    if (isAuthzAnnotationPresent(m)) {        return true;    }        if (targetClass != null) {        try {            m = targetClass.getMethod(m.getName(), m.getParameterTypes());            return isAuthzAnnotationPresent(m) || isAuthzAnnotationPresent(targetClass);        } catch (NoSuchMethodException ignored) {                        }    }    return false;}
private boolean shiro_f2561_0(Class<?> targetClazz)
{    for (Class<? extends Annotation> annClass : AUTHZ_ANNOTATION_CLASSES) {        Annotation a = AnnotationUtils.findAnnotation(targetClazz, annClass);        if (a != null) {            return true;        }    }    return false;}
private boolean shiro_f2562_0(Method method)
{    for (Class<? extends Annotation> annClass : AUTHZ_ANNOTATION_CLASSES) {        Annotation a = AnnotationUtils.findAnnotation(method, annClass);        if (a != null) {            return true;        }    }    return false;}
public Object shiro_f2563_0(Object bean, String beanName) throws BeansException
{    return bean;}
public Object shiro_f2564_0(Object bean, String beanName) throws BeansException
{    if (bean instanceof EventBusAware) {        ((EventBusAware) bean).setEventBus(eventBus);    } else if (isEventSubscriber(bean)) {        eventBus.register(bean);    }    return bean;}
private boolean shiro_f2565_0(Object bean)
{    List annotatedMethods = ClassUtils.getAnnotatedMethods(bean.getClass(), Subscribe.class);    return !CollectionUtils.isEmpty(annotatedMethods);}
protected SessionManager shiro_f2566_0()
{    DefaultWebSessionManager webSessionManager = new DefaultWebSessionManager();    webSessionManager.setSessionIdCookieEnabled(sessionIdCookieEnabled);    webSessionManager.setSessionIdUrlRewritingEnabled(sessionIdUrlRewritingEnabled);    webSessionManager.setSessionIdCookie(sessionCookieTemplate());    webSessionManager.setSessionFactory(sessionFactory());    webSessionManager.setSessionDAO(sessionDAO());    webSessionManager.setDeleteInvalidSessions(sessionManagerDeleteInvalidSessions);    return webSessionManager;}
protected Cookie shiro_f2567_0()
{    return buildCookie(sessionIdCookieName, sessionIdCookieMaxAge, sessionIdCookiePath, sessionIdCookieDomain, sessionIdCookieSecure);}
protected Cookie shiro_f2568_0()
{    return buildCookie(rememberMeCookieName, rememberMeCookieMaxAge, rememberMeCookiePath, rememberMeCookieDomain, rememberMeCookieSecure);}
protected Cookie shiro_f2569_0(String name, int maxAge, String path, String domain, boolean secure)
{    Cookie cookie = new SimpleCookie(name);    cookie.setHttpOnly(true);    cookie.setMaxAge(maxAge);    cookie.setPath(path);    cookie.setDomain(domain);    cookie.setSecure(secure);    return cookie;}
protected SessionManager shiro_f2570_0()
{    if (useNativeSessionManager) {        return nativeSessionManager();    }    return new ServletContainerSessionManager();}
protected RememberMeManager shiro_f2571_0()
{    CookieRememberMeManager cookieRememberMeManager = new CookieRememberMeManager();    cookieRememberMeManager.setCookie(rememberMeCookieTemplate());    return cookieRememberMeManager;}
protected SubjectFactory shiro_f2572_0()
{    return new DefaultWebSubjectFactory();}
protected SessionStorageEvaluator shiro_f2573_0()
{    return new DefaultWebSessionStorageEvaluator();}
protected SessionsSecurityManager shiro_f2574_0()
{    DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();    securityManager.setSubjectDAO(subjectDAO());    securityManager.setSubjectFactory(subjectFactory());    securityManager.setRememberMeManager(rememberMeManager());    return securityManager;}
protected ShiroFilterChainDefinition shiro_f2575_0()
{    DefaultShiroFilterChainDefinition chainDefinition = new DefaultShiroFilterChainDefinition();    chainDefinition.addPathDefinition("/**", "authc");    return chainDefinition;}
protected ShiroFilterFactoryBean shiro_f2576_0()
{    ShiroFilterFactoryBean filterFactoryBean = new ShiroFilterFactoryBean();    filterFactoryBean.setLoginUrl(loginUrl);    filterFactoryBean.setSuccessUrl(successUrl);    filterFactoryBean.setUnauthorizedUrl(unauthorizedUrl);    filterFactoryBean.setSecurityManager(securityManager);    filterFactoryBean.setFilterChainDefinitionMap(shiroFilterChainDefinition.getFilterChainMap());    return filterFactoryBean;}
public void shiro_f2577_0(String antPath, String definition)
{    filterChainDefinitionMap.put(antPath, definition);}
public void shiro_f2578_0(Map<String, String> pathDefinitions)
{    filterChainDefinitionMap.putAll(pathDefinitions);}
public Map<String, String> shiro_f2579_0()
{    return filterChainDefinitionMap;}
protected SubjectDAO shiro_f2580_0()
{    return super.subjectDAO();}
protected SessionStorageEvaluator shiro_f2581_0()
{    return super.sessionStorageEvaluator();}
protected SessionFactory shiro_f2582_0()
{    return super.sessionFactory();}
protected SessionDAO shiro_f2583_0()
{    return super.sessionDAO();}
protected Cookie shiro_f2584_0()
{    return super.sessionCookieTemplate();}
protected Cookie shiro_f2585_0()
{    return super.rememberMeCookieTemplate();}
protected RememberMeManager shiro_f2586_0()
{    return super.rememberMeManager();}
protected SubjectFactory shiro_f2587_0()
{    return super.subjectFactory();}
protected Authorizer shiro_f2588_0()
{    return super.authorizer();}
protected AuthenticationStrategy shiro_f2589_0()
{    return super.authenticationStrategy();}
protected Authenticator shiro_f2590_0()
{    return super.authenticator();}
protected SessionManager shiro_f2591_0()
{    return super.sessionManager();}
protected SessionsSecurityManager shiro_f2592_0(List<Realm> realms)
{    return super.securityManager(realms);}
protected ShiroFilterChainDefinition shiro_f2593_0()
{    return super.shiroFilterChainDefinition();}
protected ShiroFilterFactoryBean shiro_f2594_0()
{    return super.shiroFilterFactoryBean();}
public SecurityManager shiro_f2595_0()
{    return securityManager;}
public void shiro_f2596_0(SecurityManager securityManager)
{    this.securityManager = securityManager;}
public String shiro_f2597_0()
{    return loginUrl;}
public void shiro_f2598_0(String loginUrl)
{    this.loginUrl = loginUrl;}
public String shiro_f2599_0()
{    return successUrl;}
public void shiro_f2600_0(String successUrl)
{    this.successUrl = successUrl;}
public String shiro_f2601_0()
{    return unauthorizedUrl;}
public void shiro_f2602_0(String unauthorizedUrl)
{    this.unauthorizedUrl = unauthorizedUrl;}
public Map<String, Filter> shiro_f2603_0()
{    return filters;}
public void shiro_f2604_0(Map<String, Filter> filters)
{    this.filters = filters;}
public Map<String, String> shiro_f2605_0()
{    return filterChainDefinitionMap;}
public void shiro_f2606_0(Map<String, String> filterChainDefinitionMap)
{    this.filterChainDefinitionMap = filterChainDefinitionMap;}
public void shiro_f2607_0(String definitions)
{    Ini ini = new Ini();    ini.load(definitions);        Ini.Section section = ini.getSection(IniFilterChainResolverFactory.URLS);    if (CollectionUtils.isEmpty(section)) {                        section = ini.getSection(Ini.DEFAULT_SECTION_NAME);    }    setFilterChainDefinitionMap(section);}
public Object shiro_f2608_0() throws Exception
{    if (instance == null) {        instance = createInstance();    }    return instance;}
public Class shiro_f2609_0()
{    return SpringShiroFilter.class;}
public boolean shiro_f2610_0()
{    return true;}
protected FilterChainManager shiro_f2611_0()
{    DefaultFilterChainManager manager = new DefaultFilterChainManager();    Map<String, Filter> defaultFilters = manager.getFilters();        for (Filter filter : defaultFilters.values()) {        applyGlobalPropertiesIfNecessary(filter);    }        Map<String, Filter> filters = getFilters();    if (!CollectionUtils.isEmpty(filters)) {        for (Map.Entry<String, Filter> entry : filters.entrySet()) {            String name = entry.getKey();            Filter filter = entry.getValue();            applyGlobalPropertiesIfNecessary(filter);            if (filter instanceof Nameable) {                ((Nameable) filter).setName(name);            }                                    manager.addFilter(name, filter, false);        }    }        Map<String, String> chains = getFilterChainDefinitionMap();    if (!CollectionUtils.isEmpty(chains)) {        for (Map.Entry<String, String> entry : chains.entrySet()) {            String url = entry.getKey();            String chainDefinition = entry.getValue();            manager.createChain(url, chainDefinition);        }    }    return manager;}
protected AbstractShiroFilter shiro_f2612_1() throws Exception
{        SecurityManager securityManager = getSecurityManager();    if (securityManager == null) {        String msg = "SecurityManager property must be set.";        throw new BeanInitializationException(msg);    }    if (!(securityManager instanceof WebSecurityManager)) {        String msg = "The security manager does not implement the WebSecurityManager interface.";        throw new BeanInitializationException(msg);    }    FilterChainManager manager = createFilterChainManager();                PathMatchingFilterChainResolver chainResolver = new PathMatchingFilterChainResolver();    chainResolver.setFilterChainManager(manager);        return new SpringShiroFilter((WebSecurityManager) securityManager, chainResolver);}
private void shiro_f2613_0(Filter filter)
{    String loginUrl = getLoginUrl();    if (StringUtils.hasText(loginUrl) && (filter instanceof AccessControlFilter)) {        AccessControlFilter acFilter = (AccessControlFilter) filter;                String existingLoginUrl = acFilter.getLoginUrl();        if (AccessControlFilter.DEFAULT_LOGIN_URL.equals(existingLoginUrl)) {            acFilter.setLoginUrl(loginUrl);        }    }}
private void shiro_f2614_0(Filter filter)
{    String successUrl = getSuccessUrl();    if (StringUtils.hasText(successUrl) && (filter instanceof AuthenticationFilter)) {        AuthenticationFilter authcFilter = (AuthenticationFilter) filter;                String existingSuccessUrl = authcFilter.getSuccessUrl();        if (AuthenticationFilter.DEFAULT_SUCCESS_URL.equals(existingSuccessUrl)) {            authcFilter.setSuccessUrl(successUrl);        }    }}
private void shiro_f2615_0(Filter filter)
{    String unauthorizedUrl = getUnauthorizedUrl();    if (StringUtils.hasText(unauthorizedUrl) && (filter instanceof AuthorizationFilter)) {        AuthorizationFilter authzFilter = (AuthorizationFilter) filter;                String existingUnauthorizedUrl = authzFilter.getUnauthorizedUrl();        if (existingUnauthorizedUrl == null) {            authzFilter.setUnauthorizedUrl(unauthorizedUrl);        }    }}
private void shiro_f2616_0(Filter filter)
{    applyLoginUrlIfNecessary(filter);    applySuccessUrlIfNecessary(filter);    applyUnauthorizedUrlIfNecessary(filter);}
public Object shiro_f2617_1(Object bean, String beanName) throws BeansException
{    if (bean instanceof Filter) {                Filter filter = (Filter) bean;        applyGlobalPropertiesIfNecessary(filter);        getFilters().put(beanName, filter);    } else {        log.trace("Ignoring non-Filter bean '{}'", beanName);    }    return bean;}
public Object shiro_f2618_0(Object bean, String beanName) throws BeansException
{    return bean;}
protected EventBusAwareObject shiro_f2619_0()
{    return new EventBusAwareObject();}
protected EventSubscriber shiro_f2620_0()
{    return new EventSubscriber();}
public EventBus shiro_f2621_0()
{    return eventBus;}
public void shiro_f2622_0(EventBus eventBus)
{    this.eventBus = eventBus;}
public void shiro_f2623_0(Object object)
{}
protected EventBus shiro_f2624_0()
{    return new DefaultEventBus();}
 CacheManager shiro_f2625_0()
{    return new MemoryConstrainedCacheManager();}
 RolePermissionResolver shiro_f2626_0()
{    return new RolePermissionResolver() {        @Override        public Collection<Permission> resolvePermissionsInRole(String roleString) {            return Collections.emptySet();        }    };}
public Collection<Permission> shiro_f2627_0(String roleString)
{    return Collections.emptySet();}
 PermissionResolver shiro_f2628_0()
{        return new WildcardPermissionResolver();}
 Realm shiro_f2629_0()
{    TextConfigurationRealm realm = new TextConfigurationRealm();    realm.setUserDefinitions("joe.coder=password,user\n" + "jill.coder=password,admin");    realm.setRoleDefinitions("admin=read,write\n" + "user=read");    realm.setCachingEnabled(true);    return realm;}
public void shiro_f2630_0()
{    ThreadContext.remove();}
public void shiro_f2631_0()
{    ThreadContext.remove();}
protected Method shiro_f2632_0(String name, Class clazz)
{    Method[] methods = clazz.getMethods();    for (Method method : methods) {        if (method.getName().equals(name)) {            return method;        }    }    throw new IllegalStateException("'" + name + "' method should exist.");}
public void shiro_f2633_0() throws Exception
{    SecureRemoteInvocationFactory factory = new SecureRemoteInvocationFactory();    MethodInvocation mi = createMock(MethodInvocation.class);    Method startMethod = getMethod("start", SessionManager.class);    expect(mi.getMethod()).andReturn(startMethod).anyTimes();    Object[] args = { "localhost" };    expect(mi.getArguments()).andReturn(args).anyTimes();    replay(mi);    RemoteInvocation ri = factory.createRemoteInvocation(mi);    verify(mi);    assertNull(ri.getAttribute(SecureRemoteInvocationFactory.SESSION_ID_KEY));}
public void shiro_f2634_0() throws Exception
{    SecureRemoteInvocationFactory factory = new SecureRemoteInvocationFactory();    MethodInvocation mi = createMock(MethodInvocation.class);    Method method = getMethod("getSession", SessionManager.class);    expect(mi.getMethod()).andReturn(method).anyTimes();    String dummySessionId = UUID.randomUUID().toString();    SessionKey sessionKey = new DefaultSessionKey(dummySessionId);    Object[] args = { sessionKey };    expect(mi.getArguments()).andReturn(args).anyTimes();    replay(mi);    RemoteInvocation ri = factory.createRemoteInvocation(mi);    verify(mi);    assertEquals(dummySessionId, ri.getAttribute(SecureRemoteInvocationFactory.SESSION_ID_KEY));}
protected void shiro_f2635_0(Subject subject)
{    clearSubject();    this.threadState = new SubjectThreadState(subject);    this.threadState.bind();}
public void shiro_f2636_0()
{    if (threadState != null) {        threadState.clear();    }}
protected void shiro_f2637_0()
{    bind(new Subject.Builder(securityManager).buildSubject());}
protected void shiro_f2638_0()
{    PrincipalCollection principals = new SimplePrincipalCollection("test", realm.getName());    bind(new Subject.Builder(securityManager).principals(principals).buildSubject());}
protected void shiro_f2639_0()
{    PrincipalCollection principals = new SimplePrincipalCollection("test", realm.getName());    bind(new Subject.Builder(securityManager).principals(principals).authenticated(true).buildSubject());}
public void shiro_f2640_0()
{    bindGuest();    testService.guestImplementation();}
public void shiro_f2641_0()
{    bindUser();    testService.guestImplementation();}
public void shiro_f2642_0()
{    bindGuest();    testService.guestInterface();}
public void shiro_f2643_0()
{    bindUser();    testService.userImplementation();}
public void shiro_f2644_0()
{    bindGuest();    testService.userImplementation();}
public void shiro_f2645_0()
{    bindUser();    testService.userInterface();}
public void shiro_f2646_0()
{    bindAuthenticatedUser();    testService.authenticatedImplementation();}
public void shiro_f2647_0()
{    bindUser();    testService.authenticatedImplementation();}
public void shiro_f2648_0()
{    bindAuthenticatedUser();    testService.authenticatedInterface();}
public void shiro_f2649_0()
{}
public void shiro_f2650_0()
{}
public String shiro_f2651_0()
{    return "";}
public String shiro_f2652_0()
{    return "";}
public String shiro_f2653_0()
{    return "";}
public void shiro_f2654_0() throws NoSuchMethodException
{    assertTrue("the method is annotated, should match", new AuthorizationAttributeSourceAdvisor().matches(Secured.class.getDeclaredMethod("secureMethod"), Secured.class));    assertFalse("the method is not annotated, should not match", new AuthorizationAttributeSourceAdvisor().matches(Secured.class.getDeclaredMethod("unsecuredMethod"), Secured.class));    assertTrue("the method declaration is annotated in the interface, should match", new AuthorizationAttributeSourceAdvisor().matches(ServiceInterface.class.getDeclaredMethod("secureMethod"), ServiceImpl.class));    assertFalse("not annotated method, should not match", new AuthorizationAttributeSourceAdvisor().matches(ServiceInterface.class.getDeclaredMethod("unsecuredMethod"), ServiceImpl.class));    assertTrue("the method declaration is in the interface with type-annotation, should match", new AuthorizationAttributeSourceAdvisor().matches(SafeServiceInterface.class.getDeclaredMethod("someMethod"), SafeServiceInterface.class));    assertTrue("the method declaration is in the interface with type-annotation, should match", new AuthorizationAttributeSourceAdvisor().matches(SafeServiceImpl.class.getDeclaredMethod("someMethod"), SafeServiceImpl.class));}
public void shiro_f2655_0()
{    bindUser();    testService.guestInterface();}
public void shiro_f2656_0()
{    bindGuest();    testService.userInterface();}
public void shiro_f2657_0()
{    bindGuest();    testService.authenticatedInterface();}
public void shiro_f2658_0()
{}
public void shiro_f2659_0()
{}
public void shiro_f2660_0()
{}
public void shiro_f2661_0()
{}
public void shiro_f2662_0()
{}
public void shiro_f2663_0()
{}
public void shiro_f2664_0()
{}
public void shiro_f2665_0()
{}
public void shiro_f2666_0()
{}
public void shiro_f2667_0()
{}
 CacheManager shiro_f2668_0()
{    return new MemoryConstrainedCacheManager();}
public void shiro_f2669_0(FilterConfig filterConfig) throws ServletException
{}
public void shiro_f2670_0(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException
{    chain.doFilter(request, response);}
public void shiro_f2671_0()
{}
public void shiro_f2672_0()
{    ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("org/apache/shiro/spring/web/ShiroFilterFactoryBeanTest.xml");    AbstractShiroFilter shiroFilter = (AbstractShiroFilter) context.getBean("shiroFilter");    PathMatchingFilterChainResolver resolver = (PathMatchingFilterChainResolver) shiroFilter.getFilterChainResolver();    DefaultFilterChainManager fcManager = (DefaultFilterChainManager) resolver.getFilterChainManager();    NamedFilterList chain = fcManager.getChain("/test");    assertNotNull(chain);    assertEquals(chain.size(), 2);    Filter[] filters = new Filter[chain.size()];    filters = chain.toArray(filters);    assertTrue(filters[0] instanceof DummyFilter);    assertTrue(filters[1] instanceof FormAuthenticationFilter);}
public void shiro_f2673_0() throws Exception
{    ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("org/apache/shiro/spring/web/ShiroFilterFactoryBeanTest.xml");    AbstractShiroFilter shiroFilter = (AbstractShiroFilter) context.getBean("shiroFilter");    FilterConfig mockFilterConfig = createNiceMock(FilterConfig.class);    ServletContext mockServletContext = createNiceMock(ServletContext.class);    expect(mockFilterConfig.getServletContext()).andReturn(mockServletContext).anyTimes();    HttpServletRequest mockRequest = createNiceMock(HttpServletRequest.class);    expect(mockRequest.getContextPath()).andReturn("/").anyTimes();    expect(mockRequest.getRequestURI()).andReturn("/").anyTimes();    HttpServletResponse mockResponse = createNiceMock(HttpServletResponse.class);    replay(mockFilterConfig);    replay(mockServletContext);    shiroFilter.init(mockFilterConfig);    verify(mockServletContext);    verify(mockFilterConfig);    FilterChain filterChain = new FilterChain() {        public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse) throws IOException, ServletException {            HttpServletRequest request = (HttpServletRequest) servletRequest;            assertNotNull(request.getSession());                        assertNotNull(request.getSession().getServletContext());        }    };    replay(mockRequest);    replay(mockResponse);    shiroFilter.doFilter(mockRequest, mockResponse, filterChain);    verify(mockResponse);    verify(mockRequest);}
public void shiro_f2674_0(ServletRequest servletRequest, ServletResponse servletResponse) throws IOException, ServletException
{    HttpServletRequest request = (HttpServletRequest) servletRequest;    assertNotNull(request.getSession());        assertNotNull(request.getSession().getServletContext());}
public DefaultAdvisorAutoProxyCreator shiro_f2675_0()
{    return super.defaultAdvisorAutoProxyCreator();}
public AuthorizationAttributeSourceAdvisor shiro_f2676_0(SecurityManager securityManager)
{    return super.authorizationAttributeSourceAdvisor(securityManager);}
protected AuthenticationStrategy shiro_f2677_0()
{    return super.authenticationStrategy();}
protected Authenticator shiro_f2678_0()
{    return super.authenticator();}
protected Authorizer shiro_f2679_0()
{    return super.authorizer();}
protected SubjectDAO shiro_f2680_0()
{    return super.subjectDAO();}
protected SessionStorageEvaluator shiro_f2681_0()
{    return super.sessionStorageEvaluator();}
protected SubjectFactory shiro_f2682_0()
{    return super.subjectFactory();}
protected SessionFactory shiro_f2683_0()
{    return super.sessionFactory();}
protected SessionDAO shiro_f2684_0()
{    return super.sessionDAO();}
protected SessionManager shiro_f2685_0()
{    return super.sessionManager();}
protected SessionsSecurityManager shiro_f2686_0(List<Realm> realms)
{    return super.securityManager(realms);}
protected Realm shiro_f2687_0()
{    return iniRealmFromLocation("classpath:shiro.ini");}
protected Realm shiro_f2688_0()
{    return iniRealmFromLocation("classpath:META-INF/shiro.ini");}
protected Realm shiro_f2689_0()
{    throw new NoRealmBeanConfiguredException();}
public LifecycleBeanPostProcessor shiro_f2690_0()
{    return super.lifecycleBeanPostProcessor();}
protected EventBus shiro_f2691_0()
{    return super.eventBus();}
public ShiroEventBusBeanPostProcessor shiro_f2692_0()
{    return super.shiroEventBusAwareBeanPostProcessor();}
protected FailureAnalysis shiro_f2693_0(Throwable rootFailure, NoRealmBeanConfiguredException cause)
{    return new FailureAnalysis("No bean of type 'org.apache.shiro.realm.Realm' found.", "Please create bean of type 'Realm' or add a shiro.ini in the root classpath (src/main/resources/shiro.ini) or in the META-INF folder (src/main/resources/META-INF/shiro.ini).", cause);}
public static void shiro_f2694_0(String[] args)
{    SpringApplication.run(ShiroAutoConfigurationTestApplication.class, args);}
 Realm shiro_f2695_0()
{    TextConfigurationRealm realm = new TextConfigurationRealm();    realm.setUserDefinitions("joe.coder=password,user\n" + "jill.coder=password,admin");    realm.setRoleDefinitions("admin=read,write\n" + "user=read");    realm.setCachingEnabled(true);    return realm;}
 EventBusAwareObject shiro_f2696_0()
{    return new EventBusAwareObject();}
 SubscribedListener shiro_f2697_0()
{    return new SubscribedListener();}
public void shiro_f2698_0(EventBus bus)
{    this.eventBus = bus;}
public EventBus shiro_f2699_0()
{    return eventBus;}
public void shiro_f2700_0(Object object)
{}
protected AuthenticationStrategy shiro_f2701_0()
{    return super.authenticationStrategy();}
protected Authenticator shiro_f2702_0()
{    return super.authenticator();}
protected Authorizer shiro_f2703_0()
{    return super.authorizer();}
protected SubjectDAO shiro_f2704_0()
{    return super.subjectDAO();}
protected SessionStorageEvaluator shiro_f2705_0()
{    return super.sessionStorageEvaluator();}
protected SubjectFactory shiro_f2706_0()
{    return super.subjectFactory();}
protected SessionFactory shiro_f2707_0()
{    return super.sessionFactory();}
protected SessionDAO shiro_f2708_0()
{    return super.sessionDAO();}
protected SessionManager shiro_f2709_0()
{    return super.sessionManager();}
protected SessionsSecurityManager shiro_f2710_0(List<Realm> realms)
{    return super.securityManager(realms);}
protected Cookie shiro_f2711_0()
{    return super.sessionCookieTemplate();}
protected RememberMeManager shiro_f2712_0()
{    return super.rememberMeManager();}
protected Cookie shiro_f2713_0()
{    return super.rememberMeCookieTemplate();}
protected ShiroFilterChainDefinition shiro_f2714_0()
{    return super.shiroFilterChainDefinition();}
protected ShiroFilterFactoryBean shiro_f2715_0()
{    return super.shiroFilterFactoryBean();}
protected FilterRegistrationBean shiro_f2716_0() throws Exception
{    FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean();    filterRegistrationBean.setDispatcherTypes(DispatcherType.REQUEST, DispatcherType.FORWARD, DispatcherType.INCLUDE, DispatcherType.ERROR);    filterRegistrationBean.setFilter((AbstractShiroFilter) shiroFilterFactoryBean().getObject());    filterRegistrationBean.setOrder(1);    return filterRegistrationBean;}
public static void shiro_f2717_0(String[] args)
{    SpringApplication.run(ShiroWebAutoConfigurationTestApplication.class, args);}
 Realm shiro_f2718_0()
{    TextConfigurationRealm realm = new TextConfigurationRealm();    realm.setUserDefinitions("joe.coder=password,user\n" + "jill.coder=password,admin");    realm.setRoleDefinitions("admin=read,write\n" + "user=read");    realm.setCachingEnabled(true);    return realm;}
 ShiroFilterChainDefinition shiro_f2719_0()
{    return new DefaultShiroFilterChainDefinition();}
 EventBusAwareObject shiro_f2720_0()
{    return new EventBusAwareObject();}
 SubscribedListener shiro_f2721_0()
{    return new SubscribedListener();}
public void shiro_f2722_0(EventBus bus)
{    this.eventBus = bus;}
public EventBus shiro_f2723_0()
{    return eventBus;}
public void shiro_f2724_0(Object object)
{}
public static void shiro_f2725_0(String[] args)
{    CommandLineParser parser = new DefaultParser();    Options options = new Options();    options.addOption(HELP).addOption(DEBUG).addOption(ALGORITHM).addOption(ITERATIONS);    options.addOption(RESOURCE).addOption(PASSWORD).addOption(PASSWORD_NC);    options.addOption(SALT).addOption(SALT_BYTES).addOption(SALT_GEN).addOption(SALT_GEN_SIZE).addOption(NO_SALT_GEN);    options.addOption(PRIVATE_SALT).addOption(PRIVATE_SALT_BYTES);    options.addOption(FORMAT);    boolean debug = false;        String algorithm = null;        int iterations = 0;    boolean resource = false;    boolean password = false;    boolean passwordConfirm = true;    String saltString = null;    String saltBytesString = null;    boolean generateSalt = false;    int generatedSaltSize = DEFAULT_GENERATED_SALT_SIZE;    String privateSaltString = null;    String privateSaltBytesString = null;    String formatString = null;    char[] passwordChars = null;    try {        CommandLine line = parser.parse(options, args);        if (line.hasOption(HELP.getOpt())) {            printHelpAndExit(options, null, debug, 0);        }        if (line.hasOption(DEBUG.getOpt())) {            debug = true;        }        if (line.hasOption(ALGORITHM.getOpt())) {            algorithm = line.getOptionValue(ALGORITHM.getOpt());        }        if (line.hasOption(ITERATIONS.getOpt())) {            iterations = getRequiredPositiveInt(line, ITERATIONS);        }        if (line.hasOption(PASSWORD.getOpt())) {            password = true;            generateSalt = true;        }        if (line.hasOption(RESOURCE.getOpt())) {            resource = true;        }        if (line.hasOption(PASSWORD_NC.getOpt())) {            password = true;            generateSalt = true;            passwordConfirm = false;        }        if (line.hasOption(SALT.getOpt())) {            saltString = line.getOptionValue(SALT.getOpt());        }        if (line.hasOption(SALT_BYTES.getOpt())) {            saltBytesString = line.getOptionValue(SALT_BYTES.getOpt());        }        if (line.hasOption(NO_SALT_GEN.getOpt())) {            generateSalt = false;        }        if (line.hasOption(SALT_GEN.getOpt())) {            generateSalt = true;        }        if (line.hasOption(SALT_GEN_SIZE.getOpt())) {            generateSalt = true;            generatedSaltSize = getRequiredPositiveInt(line, SALT_GEN_SIZE);            if (generatedSaltSize % 8 != 0) {                throw new IllegalArgumentException("Generated salt size must be a multiple of 8 (e.g. 128, 192, 256, 512, etc).");            }        }        if (line.hasOption(PRIVATE_SALT.getOpt())) {            privateSaltString = line.getOptionValue(PRIVATE_SALT.getOpt());        }        if (line.hasOption(PRIVATE_SALT_BYTES.getOpt())) {            privateSaltBytesString = line.getOptionValue(PRIVATE_SALT_BYTES.getOpt());        }        if (line.hasOption(FORMAT.getOpt())) {            formatString = line.getOptionValue(FORMAT.getOpt());        }        String sourceValue;        Object source;        if (password) {            passwordChars = readPassword(passwordConfirm);            source = passwordChars;        } else {            String[] remainingArgs = line.getArgs();            if (remainingArgs == null || remainingArgs.length != 1) {                printHelpAndExit(options, null, debug, -1);            }            assert remainingArgs != null;            sourceValue = toString(remainingArgs);            if (resource) {                if (!ResourceUtils.hasResourcePrefix(sourceValue)) {                    source = toFile(sourceValue);                } else {                    source = ResourceUtils.getInputStreamForPath(sourceValue);                }            } else {                source = sourceValue;            }        }        if (algorithm == null) {            if (password) {                algorithm = DEFAULT_PASSWORD_ALGORITHM_NAME;            } else {                algorithm = DEFAULT_ALGORITHM_NAME;            }        }        if (iterations < DEFAULT_NUM_ITERATIONS) {                        if (password) {                iterations = DEFAULT_PASSWORD_NUM_ITERATIONS;            } else {                iterations = DEFAULT_NUM_ITERATIONS;            }        }        ByteSource publicSalt = getSalt(saltString, saltBytesString, generateSalt, generatedSaltSize);        ByteSource privateSalt = getSalt(privateSaltString, privateSaltBytesString, false, generatedSaltSize);        HashRequest hashRequest = new SimpleHashRequest(algorithm, ByteSource.Util.bytes(source), publicSalt, iterations);        DefaultHashService hashService = new DefaultHashService();        hashService.setPrivateSalt(privateSalt);        Hash hash = hashService.computeHash(hashRequest);        if (formatString == null) {                        if (password) {                formatString = Shiro1CryptFormat.class.getName();            } else {                formatString = HexFormat.class.getName();            }        }        HashFormat format = HASH_FORMAT_FACTORY.getInstance(formatString);        if (format == null) {            throw new IllegalArgumentException("Unrecognized hash format '" + formatString + "'.");        }        String output = format.format(hash);        System.out.println(output);    } catch (IllegalArgumentException iae) {        exit(iae, debug);    } catch (UnknownAlgorithmException uae) {        exit(uae, debug);    } catch (IOException ioe) {        exit(ioe, debug);    } catch (Exception e) {        printHelpAndExit(options, e, debug, -1);    } finally {        if (passwordChars != null && passwordChars.length > 0) {            for (int i = 0; i < passwordChars.length; i++) {                passwordChars[i] = ' ';            }        }    }}
private static String shiro_f2726_0(Option... options)
{    StringBuilder sb = new StringBuilder();    sb.append("The ");    for (int i = 0; i < options.length; i++) {        if (i > 0) {            sb.append(", ");        }        Option o = options[0];        sb.append("-").append(o.getOpt()).append("/--").append(o.getLongOpt());    }    sb.append(" and generated salt options are mutually exclusive.  Only one of them may be used at a time");    return sb.toString();}
private static void shiro_f2727_0(Exception e, boolean debug)
{    printException(e, debug);    System.exit(-1);}
private static int shiro_f2728_0(CommandLine line, Option option)
{    String iterVal = line.getOptionValue(option.getOpt());    try {        return Integer.parseInt(iterVal);    } catch (NumberFormatException e) {        String msg = "'" + option.getLongOpt() + "' value must be a positive integer.";        throw new IllegalArgumentException(msg, e);    }}
private static ByteSource shiro_f2729_0(String saltString, String saltBytesString, boolean generateSalt, int generatedSaltSize)
{    if (saltString != null) {        if (generateSalt || (saltBytesString != null)) {            throw new IllegalArgumentException(SALT_MUTEX_MSG);        }        return ByteSource.Util.bytes(saltString);    }    if (saltBytesString != null) {        if (generateSalt) {            throw new IllegalArgumentException(SALT_MUTEX_MSG);        }        String value = saltBytesString;        boolean base64 = true;        if (saltBytesString.startsWith(HEX_PREFIX)) {                        base64 = false;            value = value.substring(HEX_PREFIX.length());        }        byte[] bytes;        if (base64) {            bytes = Base64.decode(value);        } else {            bytes = Hex.decode(value);        }        return ByteSource.Util.bytes(bytes);    }    if (generateSalt) {        SecureRandomNumberGenerator generator = new SecureRandomNumberGenerator();                int byteSize = generatedSaltSize / 8;        return generator.nextBytes(byteSize);    }        return null;}
private static void shiro_f2730_0(Exception e, boolean debug)
{    if (e != null) {        System.out.println();        if (debug) {            System.out.println("Error: ");            e.printStackTrace(System.out);            System.out.println(e.getMessage());        } else {            System.out.println("Error: " + e.getMessage());            System.out.println();            System.out.println("Specify -d or --debug for more information.");        }    }}
private static void shiro_f2731_0(Options options, Exception e, boolean debug)
{    HelpFormatter help = new HelpFormatter();    String command = "java -jar shiro-tools-hasher-<version>.jar [options] [<value>]";    String header = "\nPrint a cryptographic hash (aka message digest) of the specified <value>.\n--\nOptions:";    String footer = "\n" + "<value> is optional only when hashing passwords (see below).  It is\n" + "required all other times." + "\n\n" + "Password Hashing:\n" + "---------------------------------\n" + "Specify the -p/--password option and DO NOT enter a <value>.  You will\n" + "be prompted for a password and characters will not echo as you type." + "\n\n" + "Salting:\n" + "---------------------------------\n" + "Specifying a salt:" + "\n\n" + "You may specify a salt using the -s/--salt option followed by the salt\n" + "value.  If the salt value is a base64 or hex string representing a\n" + "byte array, you must specify the -sb/--saltbytes option to indicate this,\n" + "otherwise the text value bytes will be used directly." + "\n\n" + "When using -sb/--saltbytes, the -s/--salt value is expected to be a\n" + "base64-encoded string by default.  If the value is a hex-encoded string,\n" + "you must prefix the string with 0x (zero x) to indicate a hex value." + "\n\n" + "Generating a salt:" + "\n\n" + "Use the -gs/--gensalt option if you don't want to specify a salt,\n" + "but want a strong random salt to be generated and used during hashing.\n" + "The generated salt size defaults to 128 bits.  You may specify\n" + "a different size by using the -gss/--gensaltsize option followed by\n" + "a positive integer (size is in bits, not bytes)." + "\n\n" + "Because a salt must be specified if computing the hash later,\n" + "generated salts are only useful with the shiro1 output format;\n" + "the other formats do not include the generated salt." + "\n\n" + "Specifying a private salt:" + "\n\n" + "You may specify a private salt using the -ps/--privatesalt option followed\n" + "by the private salt value.  If the private salt value is a base64 or hex \n" + "string representing a byte array, you must specify the -psb/--privatesaltbytes\n" + "option to indicate this, otherwise the text value bytes will be used directly." + "\n\n" + "When using -psb/--privatesaltbytes, the -ps/--privatesalt value is expected to\n" + "be a base64-encoded string by default.  If the value is a hex-encoded string,\n" + "you must prefix the string with 0x (zero x) to indicate a hex value." + "\n\n" + "Files, URLs and classpath resources:\n" + "---------------------------------\n" + "If using the -r/--resource option, the <value> represents a resource path.\n" + "By default this is expected to be a file path, but you may specify\n" + "classpath or URL resources by using the classpath: or url: prefix\n" + "respectively." + "\n\n" + "Some examples:" + "\n\n" + "<command> -r fileInCurrentDirectory.txt\n" + "<command> -r ../../relativePathFile.xml\n" + "<command> -r ~/documents/myfile.pdf\n" + "<command> -r /usr/local/logs/absolutePathFile.log\n" + "<command> -r url:http://foo.com/page.html\n" + "<command> -r classpath:/WEB-INF/lib/something.jar" + "\n\n" + "Output Format:\n" + "---------------------------------\n" + "Specify the -f/--format option followed by either 1) the format ID (as defined\n" + "by the " + DefaultHashFormatFactory.class.getName() + "\n" + "JavaDoc) or 2) the fully qualified " + HashFormat.class.getName() + "\n" + "implementation class name to instantiate and use for formatting.\n\n" + "The default output format is 'shiro1' which is a Modular Crypt Format (MCF)\n" + "that shows all relevant information as a dollar-sign ($) delimited string.\n" + "This format is ideal for use in Shiro's text-based user configuration (e.g.\n" + "shiro.ini or a properties file).";    printException(e, debug);    System.out.println();    help.printHelp(command, header, options, null);    System.out.println(footer);}
private static void shiro_f2732_0(Options options, Exception e, boolean debug, int exitCode)
{    printHelp(options, e, debug);    System.exit(exitCode);}
private static char[] shiro_f2733_0(boolean confirm)
{    java.io.Console console = System.console();    if (console == null) {        throw new IllegalStateException("java.io.Console is not available on the current JVM.  Cannot read passwords.");    }    char[] first = console.readPassword("%s", "Password to hash: ");    if (first == null || first.length == 0) {        throw new IllegalArgumentException("No password specified.");    }    if (confirm) {        char[] second = console.readPassword("%s", "Password to hash (confirm): ");        if (!Arrays.equals(first, second)) {            String msg = "Password entries do not match.";            throw new IllegalArgumentException(msg);        }    }    return first;}
private static File shiro_f2734_0(String path)
{    String resolved = path;    if (path.startsWith("~/") || path.startsWith(("~\\"))) {        resolved = path.replaceFirst("\\~", System.getProperty("user.home"));    }    return new File(resolved);}
private static String shiro_f2735_0(String[] strings)
{    int len = strings != null ? strings.length : 0;    if (len == 0) {        return null;    }    return StringUtils.toDelimitedString(strings, " ");}
public FilterConfig shiro_f2736_0()
{    return filterConfig;}
public void shiro_f2737_0(FilterConfig filterConfig)
{    this.filterConfig = filterConfig;}
protected FilterChainResolver shiro_f2738_0(Ini ini)
{    FilterChainResolver filterChainResolver = createDefaultInstance();    if (filterChainResolver instanceof PathMatchingFilterChainResolver) {        PathMatchingFilterChainResolver resolver = (PathMatchingFilterChainResolver) filterChainResolver;        FilterChainManager manager = resolver.getFilterChainManager();        buildChains(manager, ini);    }    return filterChainResolver;}
protected FilterChainResolver shiro_f2739_0()
{    FilterConfig filterConfig = getFilterConfig();    if (filterConfig != null) {        return new PathMatchingFilterChainResolver(filterConfig);    } else {        return new PathMatchingFilterChainResolver();    }}
protected void shiro_f2740_1(FilterChainManager manager, Ini ini)
{        Ini.Section section = ini.getSection(FILTERS);    if (!CollectionUtils.isEmpty(section)) {        String msg = "The [{}] section has been deprecated and will be removed in a future release!  Please " + "move all object configuration (filters and all other objects) to the [{}] section.";            }    Map<String, Object> defaults = new LinkedHashMap<String, Object>();    Map<String, Filter> defaultFilters = manager.getFilters();        if (!CollectionUtils.isEmpty(defaultFilters)) {        defaults.putAll(defaultFilters);    }            Map<String, ?> defaultBeans = getDefaults();    if (!CollectionUtils.isEmpty(defaultBeans)) {        defaults.putAll(defaultBeans);    }    Map<String, Filter> filters = getFilters(section, defaults);        registerFilters(filters, manager);        section = ini.getSection(URLS);    createChains(section, manager);}
protected void shiro_f2741_0(Map<String, Filter> filters, FilterChainManager manager)
{    if (!CollectionUtils.isEmpty(filters)) {                boolean init = getFilterConfig() != null;        for (Map.Entry<String, Filter> entry : filters.entrySet()) {            String name = entry.getKey();            Filter filter = entry.getValue();            manager.addFilter(name, filter, init);        }    }}
protected Map<String, Filter> shiro_f2742_0(Map<String, String> section, Map<String, ?> defaults)
{    Map<String, Filter> filters = extractFilters(defaults);    if (!CollectionUtils.isEmpty(section)) {        ReflectionBuilder builder = new ReflectionBuilder(defaults);        Map<String, ?> built = builder.buildObjects(section);        Map<String, Filter> sectionFilters = extractFilters(built);        if (CollectionUtils.isEmpty(filters)) {            filters = sectionFilters;        } else {            if (!CollectionUtils.isEmpty(sectionFilters)) {                filters.putAll(sectionFilters);            }        }    }    return filters;}
private Map<String, Filter> shiro_f2743_0(Map<String, ?> objects)
{    if (CollectionUtils.isEmpty(objects)) {        return null;    }    Map<String, Filter> filterMap = new LinkedHashMap<String, Filter>();    for (Map.Entry<String, ?> entry : objects.entrySet()) {        String key = entry.getKey();        Object value = entry.getValue();        if (value instanceof Filter) {            filterMap.put(key, (Filter) value);        }    }    return filterMap;}
protected void shiro_f2744_1(Map<String, String> urls, FilterChainManager manager)
{    if (CollectionUtils.isEmpty(urls)) {        if (log.isDebugEnabled()) {                    }        return;    }    if (log.isTraceEnabled()) {        log.trace("Before url processing.");    }    for (Map.Entry<String, String> entry : urls.entrySet()) {        String path = entry.getKey();        String value = entry.getValue();        manager.createChain(path, value);    }}
protected SecurityManager shiro_f2745_0()
{    return new DefaultWebSecurityManager();}
protected Map<String, ?> shiro_f2746_0(Ini ini, Ini.Section mainSection)
{    Map defaults = super.createDefaults(ini, mainSection);        Map<String, Filter> defaultFilters = DefaultFilter.createInstanceMap(null);    defaults.putAll(defaultFilters);    return defaults;}
public FilterChainResolver shiro_f2747_0()
{    return getObject(DEFAULT_FILTER_CHAIN_RESOLVER_NAME, FilterChainResolver.class);}
public void shiro_f2748_0(FilterChainResolver filterChainResolver)
{    setObject(DEFAULT_FILTER_CHAIN_RESOLVER_NAME, filterChainResolver);}
public SecurityManager shiro_f2749_0() throws IllegalStateException
{    return getWebSecurityManager();}
public void shiro_f2750_0(SecurityManager securityManager)
{    assertWebSecurityManager(securityManager);    super.setSecurityManager(securityManager);}
public WebSecurityManager shiro_f2751_0()
{    SecurityManager sm = super.getSecurityManager();    assertWebSecurityManager(sm);    return (WebSecurityManager) sm;}
public void shiro_f2752_0(WebSecurityManager wsm)
{    super.setSecurityManager(wsm);}
private void shiro_f2753_0(SecurityManager sm)
{    if (!(sm instanceof WebSecurityManager)) {        String msg = "SecurityManager instance must be a " + WebSecurityManager.class.getName() + " instance.";        throw new IllegalStateException(msg);    }}
public ServletContext shiro_f2754_0()
{    return this.servletContext;}
public void shiro_f2755_0(ServletContext servletContext)
{    this.servletContext = servletContext;}
public WebEnvironment shiro_f2756_1(ServletContext servletContext) throws IllegalStateException
{    if (servletContext.getAttribute(ENVIRONMENT_ATTRIBUTE_KEY) != null) {        String msg = "There is already a Shiro environment associated with the current ServletContext.  " + "Check if you have multiple EnvironmentLoader* definitions in your web.xml!";        throw new IllegalStateException(msg);    }    servletContext.log("Initializing Shiro environment");        long startTime = System.currentTimeMillis();    try {        WebEnvironment environment = createEnvironment(servletContext);        servletContext.setAttribute(ENVIRONMENT_ATTRIBUTE_KEY, environment);                if (log.isInfoEnabled()) {            long elapsed = System.currentTimeMillis() - startTime;                    }        return environment;    } catch (RuntimeException ex) {                servletContext.setAttribute(ENVIRONMENT_ATTRIBUTE_KEY, ex);        throw ex;    } catch (Error err) {                servletContext.setAttribute(ENVIRONMENT_ATTRIBUTE_KEY, err);        throw err;    }}
protected Class<?> shiro_f2757_0(ServletContext servletContext)
{    Class<? extends WebEnvironment> webEnvironmentClass = webEnvironmentClassFromServletContext(servletContext);    if (webEnvironmentClass != null) {        return webEnvironmentClass;    } else {        return getDefaultWebEnvironmentClass();    }}
private Class<? extends WebEnvironment> shiro_f2758_0(ServletContext servletContext)
{    Class<? extends WebEnvironment> webEnvironmentClass = null;    String className = servletContext.getInitParameter(ENVIRONMENT_CLASS_PARAM);    if (className != null) {        try {            webEnvironmentClass = ClassUtils.forName(className);        } catch (UnknownClassException ex) {            throw new ConfigurationException("Failed to load custom WebEnvironment class [" + className + "]", ex);        }    }    return webEnvironmentClass;}
private WebEnvironment shiro_f2759_0()
{    WebEnvironment webEnvironment = null;        ServiceLoader<WebEnvironment> serviceLoader = ServiceLoader.load(WebEnvironment.class);    Iterator<WebEnvironment> iterator = serviceLoader.iterator();        if (iterator.hasNext()) {        webEnvironment = iterator.next();    }        if (iterator.hasNext()) {        List<String> allWebEnvironments = new ArrayList<String>();        allWebEnvironments.add(webEnvironment.getClass().getName());        while (iterator.hasNext()) {            allWebEnvironments.add(iterator.next().getClass().getName());        }        throw new ConfigurationException("ServiceLoader for class [" + WebEnvironment.class + "] returned more then one " + "result.  ServiceLoader must return zero or exactly one result for this class. Select one using the " + "servlet init parameter '" + ENVIRONMENT_CLASS_PARAM + "'. Found: " + allWebEnvironments);    }    return webEnvironment;}
protected Class<? extends WebEnvironment> shiro_f2760_0()
{    return IniWebEnvironment.class;}
protected WebEnvironment shiro_f2761_0(ServletContext servletContext)
{    Class<? extends WebEnvironment> webEnvironmentClass = webEnvironmentClassFromServletContext(servletContext);    WebEnvironment webEnvironment = null;        if (webEnvironmentClass == null) {        webEnvironment = webEnvironmentFromServiceLoader();    }        if (webEnvironmentClass == null && webEnvironment == null) {        webEnvironmentClass = getDefaultWebEnvironmentClass();    }        if (webEnvironmentClass != null) {        webEnvironment = (WebEnvironment) ClassUtils.newInstance(webEnvironmentClass);    }    return webEnvironment;}
protected WebEnvironment shiro_f2762_0(ServletContext sc)
{    WebEnvironment webEnvironment = determineWebEnvironment(sc);    if (!MutableWebEnvironment.class.isInstance(webEnvironment)) {        throw new ConfigurationException("Custom WebEnvironment class [" + webEnvironment.getClass().getName() + "] is not of required type [" + MutableWebEnvironment.class.getName() + "]");    }    String configLocations = sc.getInitParameter(CONFIG_LOCATIONS_PARAM);    boolean configSpecified = StringUtils.hasText(configLocations);    if (configSpecified && !(ResourceConfigurable.class.isInstance(webEnvironment))) {        String msg = "WebEnvironment class [" + webEnvironment.getClass().getName() + "] does not implement the " + ResourceConfigurable.class.getName() + "interface.  This is required to accept any " + "configured " + CONFIG_LOCATIONS_PARAM + "value(s).";        throw new ConfigurationException(msg);    }    MutableWebEnvironment environment = (MutableWebEnvironment) webEnvironment;    environment.setServletContext(sc);    if (configSpecified && (environment instanceof ResourceConfigurable)) {        ((ResourceConfigurable) environment).setConfigLocations(configLocations);    }    customizeEnvironment(environment);    LifecycleUtils.init(environment);    return environment;}
protected void shiro_f2763_0(WebEnvironment environment)
{}
public void shiro_f2764_0(ServletContext servletContext)
{    servletContext.log("Cleaning up Shiro Environment");    try {        Object environment = servletContext.getAttribute(ENVIRONMENT_ATTRIBUTE_KEY);        if (environment instanceof WebEnvironment) {            finalizeEnvironment((WebEnvironment) environment);        }        LifecycleUtils.destroy(environment);    } finally {        servletContext.removeAttribute(ENVIRONMENT_ATTRIBUTE_KEY);    }}
protected void shiro_f2765_0(WebEnvironment environment)
{}
public void shiro_f2766_0(ServletContextEvent sce)
{    initEnvironment(sce.getServletContext());}
public void shiro_f2767_0(ServletContextEvent sce)
{    destroyEnvironment(sce.getServletContext());}
public void shiro_f2768_0()
{    setIni(parseConfig());    configure();}
protected Ini shiro_f2769_1()
{    Ini ini = getIni();    String[] configLocations = getConfigLocations();    if (log.isWarnEnabled() && !CollectionUtils.isEmpty(ini) && configLocations != null && configLocations.length > 0) {            }    if (CollectionUtils.isEmpty(ini)) {                ini = getSpecifiedIni(configLocations);    }    if (CollectionUtils.isEmpty(ini)) {                ini = getDefaultIni();    }            ini = mergeIni(getFrameworkIni(), ini);    if (CollectionUtils.isEmpty(ini)) {        String msg = "Shiro INI configuration was either not found or discovered to be empty/unconfigured.";        throw new ConfigurationException(msg);    }    return ini;}
protected void shiro_f2770_0()
{    this.objects.clear();    WebSecurityManager securityManager = createWebSecurityManager();    setWebSecurityManager(securityManager);    FilterChainResolver resolver = createFilterChainResolver();    if (resolver != null) {        setFilterChainResolver(resolver);    }}
protected Ini shiro_f2771_0()
{    return null;}
protected Ini shiro_f2772_1(String[] configLocations) throws ConfigurationException
{    Ini ini = null;    if (configLocations != null && configLocations.length > 0) {        if (configLocations.length > 1) {                    }                ini = createIni(configLocations[0], true);    }    return ini;}
protected Ini shiro_f2773_0(Ini ini1, Ini ini2)
{    if (ini1 == null) {        return ini2;    }    if (ini2 == null) {        return ini1;    }        Ini iniResult = new Ini(ini1);    iniResult.merge(ini2);    return iniResult;}
protected Ini shiro_f2774_1()
{    Ini ini = null;    String[] configLocations = getDefaultConfigLocations();    if (configLocations != null) {        for (String location : configLocations) {            ini = createIni(location, false);            if (!CollectionUtils.isEmpty(ini)) {                                break;            }        }    }    return ini;}
protected Ini shiro_f2775_0(String configLocation, boolean required) throws ConfigurationException
{    Ini ini = null;    if (configLocation != null) {        ini = convertPathToIni(configLocation, required);    }    if (required && CollectionUtils.isEmpty(ini)) {        String msg = "Required configuration location '" + configLocation + "' does not exist or did not " + "contain any INI configuration.";        throw new ConfigurationException(msg);    }    return ini;}
protected FilterChainResolver shiro_f2776_0()
{    FilterChainResolver resolver = null;    Ini ini = getIni();    if (!CollectionUtils.isEmpty(ini)) {                Ini.Section urls = ini.getSection(IniFilterChainResolverFactory.URLS);        Ini.Section filters = ini.getSection(IniFilterChainResolverFactory.FILTERS);        if (!CollectionUtils.isEmpty(urls) || !CollectionUtils.isEmpty(filters)) {                        Factory<FilterChainResolver> factory = (Factory<FilterChainResolver>) this.objects.get(FILTER_CHAIN_RESOLVER_NAME);            if (factory instanceof IniFactorySupport) {                IniFactorySupport iniFactory = (IniFactorySupport) factory;                iniFactory.setIni(ini);                iniFactory.setDefaults(this.objects);            }            resolver = factory.getInstance();        }    }    return resolver;}
protected WebSecurityManager shiro_f2777_0()
{    Ini ini = getIni();    if (!CollectionUtils.isEmpty(ini)) {        factory.setIni(ini);    }    Map<String, Object> defaults = getDefaults();    if (!CollectionUtils.isEmpty(defaults)) {        factory.setDefaults(defaults);    }    WebSecurityManager wsm = (WebSecurityManager) factory.getInstance();            Map<String, ?> beans = factory.getBeans();    if (!CollectionUtils.isEmpty(beans)) {        this.objects.putAll(beans);    }    return wsm;}
protected String[] shiro_f2778_0()
{    return new String[] { DEFAULT_WEB_INI_RESOURCE_PATH, IniFactorySupport.DEFAULT_INI_RESOURCE_PATH };}
private Ini shiro_f2779_1(String path, boolean required)
{        Ini ini = null;    if (StringUtils.hasText(path)) {        InputStream is = null;                if (!ResourceUtils.hasResourcePrefix(path)) {            is = getServletContextResourceStream(path);        } else {            try {                is = ResourceUtils.getInputStreamForPath(path);            } catch (IOException e) {                if (required) {                    throw new ConfigurationException(e);                } else {                    if (log.isDebugEnabled()) {                                            }                }            }        }        if (is != null) {            ini = new Ini();            ini.load(is);        } else {            if (required) {                throw new ConfigurationException("Unable to load resource path '" + path + "'");            }        }    }    return ini;}
private InputStream shiro_f2780_0(String path)
{    InputStream is = null;    path = WebUtils.normalize(path);    ServletContext sc = getServletContext();    if (sc != null) {        is = sc.getResourceAsStream(path);    }    return is;}
public Ini shiro_f2781_0()
{    return this.ini;}
public void shiro_f2782_0(Ini ini)
{    this.ini = ini;}
protected Map<String, Object> shiro_f2783_0()
{    Map<String, Object> defaults = new HashMap<String, Object>();    defaults.put(FILTER_CHAIN_RESOLVER_NAME, new IniFilterChainResolverFactory());    return defaults;}
protected WebIniSecurityManagerFactory shiro_f2784_0()
{    return factory;}
protected void shiro_f2785_0(WebIniSecurityManagerFactory factory)
{    this.factory = factory;}
public String[] shiro_f2786_0()
{    return configLocations;}
public void shiro_f2787_0(String locations)
{    if (!StringUtils.hasText(locations)) {        throw new IllegalArgumentException("Null/empty locations argument not allowed.");    }    String[] arr = StringUtils.split(locations);    setConfigLocations(arr);}
public void shiro_f2788_0(String[] configLocations)
{    this.configLocations = configLocations;}
public String shiro_f2789_0()
{    return loginUrl;}
public void shiro_f2790_0(String loginUrl)
{    this.loginUrl = loginUrl;}
protected Subject shiro_f2791_0(ServletRequest request, ServletResponse response)
{    return SecurityUtils.getSubject();}
protected boolean shiro_f2792_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{    return onAccessDenied(request, response);}
public boolean shiro_f2793_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{    return isAccessAllowed(request, response, mappedValue) || onAccessDenied(request, response, mappedValue);}
protected boolean shiro_f2794_0(ServletRequest request, ServletResponse response)
{    return pathsMatch(getLoginUrl(), request);}
protected void shiro_f2795_0(ServletRequest request, ServletResponse response) throws IOException
{    saveRequest(request);    redirectToLogin(request, response);}
protected void shiro_f2796_0(ServletRequest request)
{    WebUtils.saveRequest(request);}
protected void shiro_f2797_0(ServletRequest request, ServletResponse response) throws IOException
{    String loginUrl = getLoginUrl();    WebUtils.issueRedirect(request, response, loginUrl);}
protected boolean shiro_f2798_0(ServletRequest request, ServletResponse response, Object mappedValue)
{        return true;}
protected boolean shiro_f2799_0(ServletRequest request, ServletResponse response) throws Exception
{    AuthenticationToken token = createToken(request, response);    if (token == null) {        String msg = "createToken method implementation returned null. A valid non-null AuthenticationToken " + "must be created in order to execute a login attempt.";        throw new IllegalStateException(msg);    }    try {        Subject subject = getSubject(request, response);        subject.login(token);        return onLoginSuccess(token, subject, request, response);    } catch (AuthenticationException e) {        return onLoginFailure(token, e, request, response);    }}
protected AuthenticationToken shiro_f2800_0(String username, String password, ServletRequest request, ServletResponse response)
{    boolean rememberMe = isRememberMe(request);    String host = getHost(request);    return createToken(username, password, rememberMe, host);}
protected AuthenticationToken shiro_f2801_0(String username, String password, boolean rememberMe, String host)
{    return new UsernamePasswordToken(username, password, rememberMe, host);}
protected boolean shiro_f2802_0(AuthenticationToken token, Subject subject, ServletRequest request, ServletResponse response) throws Exception
{    return true;}
protected boolean shiro_f2803_0(AuthenticationToken token, AuthenticationException e, ServletRequest request, ServletResponse response)
{    return false;}
protected String shiro_f2804_0(ServletRequest request)
{    return request.getRemoteHost();}
protected boolean shiro_f2805_0(ServletRequest request)
{    return false;}
protected boolean shiro_f2806_0(ServletRequest request, ServletResponse response, Object mappedValue)
{    return super.isAccessAllowed(request, response, mappedValue) || (!isLoginRequest(request, response) && isPermissive(mappedValue));}
protected boolean shiro_f2807_0(Object mappedValue)
{    if (mappedValue != null) {        String[] values = (String[]) mappedValue;        return Arrays.binarySearch(values, PERMISSIVE) >= 0;    }    return false;}
protected void shiro_f2808_0(ServletRequest request, ServletResponse response, Exception existing) throws ServletException, IOException
{    if (existing instanceof UnauthenticatedException || (existing instanceof ServletException && existing.getCause() instanceof UnauthenticatedException)) {        try {            onAccessDenied(request, response);            existing = null;        } catch (Exception e) {            existing = e;        }    }    super.cleanup(request, response, existing);}
public String shiro_f2809_0()
{    return successUrl;}
public void shiro_f2810_0(String successUrl)
{    this.successUrl = successUrl;}
protected boolean shiro_f2811_0(ServletRequest request, ServletResponse response, Object mappedValue)
{    Subject subject = getSubject(request, response);    return subject.isAuthenticated() && subject.getPrincipal() != null;}
protected void shiro_f2812_0(ServletRequest request, ServletResponse response) throws Exception
{    WebUtils.redirectToSavedRequest(request, response, getSuccessUrl());}
protected AuthenticationToken shiro_f2813_1(ServletRequest request, ServletResponse response)
{    String authorizationHeader = getAuthzHeader(request);    if (authorizationHeader == null || authorizationHeader.length() == 0) {                return createToken("", "", request, response);    }        String[] prinCred = getPrincipalsAndCredentials(authorizationHeader, request);    if (prinCred == null || prinCred.length < 2) {                        String username = prinCred == null || prinCred.length == 0 ? "" : prinCred[0];        return createToken(username, "", request, response);    }    String username = prinCred[0];    String password = prinCred[1];    return createToken(username, password, request, response);}
protected String[] shiro_f2814_0(String scheme, String encoded)
{    String decoded = Base64.decodeToString(encoded);    return decoded.split(":", 2);}
protected AuthenticationToken shiro_f2815_1(ServletRequest request, ServletResponse response)
{    String authorizationHeader = getAuthzHeader(request);    if (authorizationHeader == null || authorizationHeader.length() == 0) {                return createBearerToken("", request);    }        String[] prinCred = getPrincipalsAndCredentials(authorizationHeader, request);    if (prinCred == null || prinCred.length < 1) {                return createBearerToken("", request);    }    String token = prinCred[0] != null ? prinCred[0] : "";    return createBearerToken(token, request);}
protected String[] shiro_f2816_0(String scheme, String token)
{    return new String[] { token };}
protected AuthenticationToken shiro_f2817_0(String token, ServletRequest request)
{    return new BearerToken(token, request.getRemoteHost());}
public void shiro_f2818_0(String loginUrl)
{    String previous = getLoginUrl();    if (previous != null) {        this.appliedPaths.remove(previous);    }    super.setLoginUrl(loginUrl);    if (log.isTraceEnabled()) {        log.trace("Adding login url to applied paths.");    }    this.appliedPaths.put(getLoginUrl(), null);}
public String shiro_f2819_0()
{    return usernameParam;}
public void shiro_f2820_0(String usernameParam)
{    this.usernameParam = usernameParam;}
public String shiro_f2821_0()
{    return passwordParam;}
public void shiro_f2822_0(String passwordParam)
{    this.passwordParam = passwordParam;}
public String shiro_f2823_0()
{    return rememberMeParam;}
public void shiro_f2824_0(String rememberMeParam)
{    this.rememberMeParam = rememberMeParam;}
public String shiro_f2825_0()
{    return failureKeyAttribute;}
public void shiro_f2826_0(String failureKeyAttribute)
{    this.failureKeyAttribute = failureKeyAttribute;}
protected boolean shiro_f2827_0(ServletRequest request, ServletResponse response) throws Exception
{    if (isLoginRequest(request, response)) {        if (isLoginSubmission(request, response)) {            if (log.isTraceEnabled()) {                log.trace("Login submission detected.  Attempting to execute login.");            }            return executeLogin(request, response);        } else {            if (log.isTraceEnabled()) {                log.trace("Login page view.");            }                        return true;        }    } else {        if (log.isTraceEnabled()) {            log.trace("Attempting to access a path which requires authentication.  Forwarding to the " + "Authentication url [" + getLoginUrl() + "]");        }        saveRequestAndRedirectToLogin(request, response);        return false;    }}
protected boolean shiro_f2828_0(ServletRequest request, ServletResponse response)
{    return (request instanceof HttpServletRequest) && WebUtils.toHttp(request).getMethod().equalsIgnoreCase(POST_METHOD);}
protected AuthenticationToken shiro_f2829_0(ServletRequest request, ServletResponse response)
{    String username = getUsername(request);    String password = getPassword(request);    return createToken(username, password, request, response);}
protected boolean shiro_f2830_0(ServletRequest request)
{    return WebUtils.isTrue(request, getRememberMeParam());}
protected boolean shiro_f2831_0(AuthenticationToken token, Subject subject, ServletRequest request, ServletResponse response) throws Exception
{    issueSuccessRedirect(request, response);        return false;}
protected boolean shiro_f2832_1(AuthenticationToken token, AuthenticationException e, ServletRequest request, ServletResponse response)
{    if (log.isDebugEnabled()) {            }    setFailureAttribute(request, e);        return true;}
protected void shiro_f2833_0(ServletRequest request, AuthenticationException ae)
{    String className = ae.getClass().getName();    request.setAttribute(getFailureKeyAttribute(), className);}
protected String shiro_f2834_0(ServletRequest request)
{    return WebUtils.getCleanParam(request, getUsernameParam());}
protected String shiro_f2835_0(ServletRequest request)
{    return WebUtils.getCleanParam(request, getPasswordParam());}
public String shiro_f2836_0()
{    return applicationName;}
public void shiro_f2837_0(String applicationName)
{    this.applicationName = applicationName;}
public String shiro_f2838_0()
{    return authzScheme;}
public void shiro_f2839_0(String authzScheme)
{    this.authzScheme = authzScheme;}
public String shiro_f2840_0()
{    return authcScheme;}
public void shiro_f2841_0(String authcScheme)
{    this.authcScheme = authcScheme;}
protected boolean shiro_f2842_0(ServletRequest request, ServletResponse response, Object mappedValue)
{    HttpServletRequest httpRequest = WebUtils.toHttp(request);    String httpMethod = httpRequest.getMethod();                Set<String> methods = httpMethodsFromOptions((String[]) mappedValue);    boolean authcRequired = methods.size() == 0;    for (String m : methods) {        if (httpMethod.toUpperCase(Locale.ENGLISH).equals(m)) {                        authcRequired = true;            break;        }    }    if (authcRequired) {        return super.isAccessAllowed(request, response, mappedValue);    } else {        return true;    }}
private Set<String> shiro_f2843_0(String[] options)
{    Set<String> methods = new HashSet<String>();    if (options != null) {        for (String option : options) {                        if (!option.equalsIgnoreCase(PERMISSIVE)) {                methods.add(option.toUpperCase(Locale.ENGLISH));            }        }    }    return methods;}
protected boolean shiro_f2844_0(ServletRequest request, ServletResponse response) throws Exception
{        boolean loggedIn = false;    if (isLoginAttempt(request, response)) {        loggedIn = executeLogin(request, response);    }    if (!loggedIn) {        sendChallenge(request, response);    }    return loggedIn;}
protected boolean shiro_f2845_0(ServletRequest request, ServletResponse response)
{    String authzHeader = getAuthzHeader(request);    return authzHeader != null && isLoginAttempt(authzHeader);}
protected final boolean shiro_f2846_0(ServletRequest request, ServletResponse response)
{    return this.isLoginAttempt(request, response);}
protected String shiro_f2847_0(ServletRequest request)
{    HttpServletRequest httpRequest = WebUtils.toHttp(request);    return httpRequest.getHeader(AUTHORIZATION_HEADER);}
protected boolean shiro_f2848_0(String authzHeader)
{        String authzScheme = getAuthzScheme().toLowerCase(Locale.ENGLISH);    return authzHeader.toLowerCase(Locale.ENGLISH).startsWith(authzScheme);}
protected boolean shiro_f2849_1(ServletRequest request, ServletResponse response)
{        HttpServletResponse httpResponse = WebUtils.toHttp(response);    httpResponse.setStatus(HttpServletResponse.SC_UNAUTHORIZED);    String authcHeader = getAuthcScheme() + " realm=\"" + getApplicationName() + "\"";    httpResponse.setHeader(AUTHENTICATE_HEADER, authcHeader);    return false;}
protected AuthenticationToken shiro_f2850_1(ServletRequest request, ServletResponse response)
{    String authorizationHeader = getAuthzHeader(request);    if (authorizationHeader == null || authorizationHeader.length() == 0) {                return createToken("", "", request, response);    }        String[] prinCred = getPrincipalsAndCredentials(authorizationHeader, request);    if (prinCred == null || prinCred.length < 2) {                        String username = prinCred == null || prinCred.length == 0 ? "" : prinCred[0];        return createToken(username, "", request, response);    }    String username = prinCred[0];    String password = prinCred[1];    return createToken(username, password, request, response);}
protected String[] shiro_f2851_0(String authorizationHeader, ServletRequest request)
{    if (authorizationHeader == null) {        return null;    }    String[] authTokens = authorizationHeader.split(" ");    if (authTokens == null || authTokens.length < 2) {        return null;    }    return getPrincipalsAndCredentials(authTokens[0], authTokens[1]);}
protected boolean shiro_f2852_1(ServletRequest request, ServletResponse response) throws Exception
{    Subject subject = getSubject(request, response);        if (isPostOnlyLogout()) {                if (!WebUtils.toHttp(request).getMethod().toUpperCase(Locale.ENGLISH).equals("POST")) {            return onLogoutRequestNotAPost(request, response);        }    }    String redirectUrl = getRedirectUrl(request, response, subject);        try {        subject.logout();    } catch (SessionException ise) {            }    issueRedirect(request, response, redirectUrl);    return false;}
protected Subject shiro_f2853_0(ServletRequest request, ServletResponse response)
{    return SecurityUtils.getSubject();}
protected void shiro_f2854_0(ServletRequest request, ServletResponse response, String redirectUrl) throws Exception
{    WebUtils.issueRedirect(request, response, redirectUrl);}
protected String shiro_f2855_0(ServletRequest request, ServletResponse response, Subject subject)
{    return getRedirectUrl();}
public String shiro_f2856_0()
{    return redirectUrl;}
public void shiro_f2857_0(String redirectUrl)
{    this.redirectUrl = redirectUrl;}
protected boolean shiro_f2858_0(ServletRequest request, ServletResponse response)
{    HttpServletResponse httpServletResponse = WebUtils.toHttp(response);    httpServletResponse.setStatus(HttpServletResponse.SC_METHOD_NOT_ALLOWED);    httpServletResponse.setHeader("Allow", "POST");    return false;}
public boolean shiro_f2859_0()
{    return postOnlyLogout;}
public void shiro_f2860_0(boolean postOnlyLogout)
{    this.postOnlyLogout = postOnlyLogout;}
protected boolean shiro_f2861_0(ServletRequest request, ServletResponse response) throws Exception
{    if (isLoginRequest(request, response)) {        return true;    } else {        saveRequestAndRedirectToLogin(request, response);        return false;    }}
protected boolean shiro_f2862_0(ServletRequest request, ServletResponse response, Object mappedValue)
{    if (isLoginRequest(request, response)) {        return true;    } else {        Subject subject = getSubject(request, response);                return subject.getPrincipal() != null;    }}
protected boolean shiro_f2863_0(ServletRequest request, ServletResponse response) throws Exception
{    saveRequestAndRedirectToLogin(request, response);    return false;}
public String shiro_f2864_0()
{    return unauthorizedUrl;}
public void shiro_f2865_0(String unauthorizedUrl)
{    this.unauthorizedUrl = unauthorizedUrl;}
protected boolean shiro_f2866_0(ServletRequest request, ServletResponse response) throws IOException
{    Subject subject = getSubject(request, response);        if (subject.getPrincipal() == null) {        saveRequestAndRedirectToLogin(request, response);    } else {                        String unauthorizedUrl = getUnauthorizedUrl();                if (StringUtils.hasText(unauthorizedUrl)) {            WebUtils.issueRedirect(request, response, unauthorizedUrl);        } else {            WebUtils.toHttp(response).sendError(HttpServletResponse.SC_UNAUTHORIZED);        }    }    return false;}
public void shiro_f2867_0(String authorizedHosts)
{    if (!StringUtils.hasText(authorizedHosts)) {        throw new IllegalArgumentException("authorizedHosts argument cannot be null or empty.");    }    String[] hosts = StringUtils.tokenizeToStringArray(authorizedHosts, ", \t");    for (String host : hosts) {                String periodsReplaced = host.replace(".", "\\.");                String wildcardsReplaced = periodsReplaced.replace("*", IPV4_QUAD_REGEX);        if (IPV4_PATTERN.matcher(wildcardsReplaced).matches()) {            authorizedIps.put(host, wildcardsReplaced);        } else {        }    }}
public void shiro_f2868_0(String deniedHosts)
{    if (!StringUtils.hasText(deniedHosts)) {        throw new IllegalArgumentException("deniedHosts argument cannot be null or empty.");    }}
protected boolean shiro_f2869_0(String host)
{    String[] quads = StringUtils.tokenizeToStringArray(host, ".");    if (quads == null || quads.length != 4) {        return false;    }    for (String quad : quads) {        if (!quad.equals("*")) {            try {                Integer.parseInt(quad);            } catch (NumberFormatException nfe) {                return false;            }        }    }    return true;}
protected boolean shiro_f2870_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{    throw new UnsupportedOperationException("Not yet fully implemented!!!");}
public String shiro_f2871_0()
{    return this.action;}
protected Map<String, String> shiro_f2872_0()
{    return this.httpMethodActions;}
protected String shiro_f2873_0(ServletRequest request)
{    String method = ((HttpServletRequest) request).getMethod();    return getHttpMethodAction(method);}
protected String shiro_f2874_0(String method)
{    String lc = method.toLowerCase();    String resolved = getHttpMethodActions().get(lc);    return resolved != null ? resolved : method;}
protected String[] shiro_f2875_0(HttpServletRequest request, String[] configuredPerms, String action)
{    return buildPermissions(configuredPerms, action);}
protected String[] shiro_f2876_0(String[] configuredPerms, String action)
{    if (configuredPerms == null || configuredPerms.length <= 0 || !StringUtils.hasText(action)) {        return configuredPerms;    }    String[] mappedPerms = new String[configuredPerms.length];        for (int i = 0; i < configuredPerms.length; i++) {        mappedPerms[i] = configuredPerms[i] + ":" + action;    }    if (log.isTraceEnabled()) {        StringBuilder sb = new StringBuilder();        for (int i = 0; i < mappedPerms.length; i++) {            if (i > 0) {                sb.append(", ");            }            sb.append(mappedPerms[i]);        }        log.trace("MAPPED '{}' action to permission(s) '{}'", action, sb);    }    return mappedPerms;}
public boolean shiro_f2877_0(ServletRequest request, ServletResponse response, Object mappedValue) throws IOException
{    String[] perms = (String[]) mappedValue;        String action = getHttpMethodAction(request);    String[] resolvedPerms = buildPermissions(perms, action);    return super.isAccessAllowed(request, response, resolvedPerms);}
public boolean shiro_f2878_0(ServletRequest request, ServletResponse response, Object mappedValue) throws IOException
{    Subject subject = getSubject(request, response);    String[] perms = (String[]) mappedValue;    boolean isPermitted = true;    if (perms != null && perms.length > 0) {        if (perms.length == 1) {            if (!subject.isPermitted(perms[0])) {                isPermitted = false;            }        } else {            if (!subject.isPermittedAll(perms)) {                isPermitted = false;            }        }    }    return isPermitted;}
public int shiro_f2879_0()
{    return port;}
public void shiro_f2880_0(int port)
{    this.port = port;}
protected int shiro_f2881_0(Object mappedValue)
{    String[] ports = (String[]) mappedValue;    if (ports == null || ports.length == 0) {        return getPort();    }    if (ports.length > 1) {        throw new ConfigurationException("PortFilter can only be configured with a single port.  You have " + "configured " + ports.length + ": " + StringUtils.toString(ports));    }    return Integer.parseInt(ports[0]);}
protected boolean shiro_f2882_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{    int requiredPort = toPort(mappedValue);    int requestPort = request.getServerPort();    return requiredPort == requestPort;}
protected String shiro_f2883_0(String requestScheme, int port)
{    if (port == DEFAULT_HTTP_PORT) {        return HTTP_SCHEME;    } else if (port == SslFilter.DEFAULT_HTTPS_PORT) {        return SslFilter.HTTPS_SCHEME;    } else {        return requestScheme;    }}
protected boolean shiro_f2884_0(ServletRequest request, ServletResponse response, Object mappedValue) throws IOException
{        int port = toPort(mappedValue);    String scheme = getScheme(request.getScheme(), port);    StringBuilder sb = new StringBuilder();    sb.append(scheme).append("://");    sb.append(request.getServerName());    if (port != DEFAULT_HTTP_PORT && port != SslFilter.DEFAULT_HTTPS_PORT) {        sb.append(":");        sb.append(port);    }    if (request instanceof HttpServletRequest) {        sb.append(WebUtils.toHttp(request).getRequestURI());        String query = WebUtils.toHttp(request).getQueryString();        if (query != null) {            sb.append("?").append(query);        }    }    WebUtils.issueRedirect(request, response, sb.toString());    return false;}
public boolean shiro_f2885_0(ServletRequest request, ServletResponse response, Object mappedValue) throws IOException
{    Subject subject = getSubject(request, response);    String[] rolesArray = (String[]) mappedValue;    if (rolesArray == null || rolesArray.length == 0) {                return true;    }    Set<String> roles = CollectionUtils.asSet(rolesArray);    return subject.hasAllRoles(roles);}
protected String shiro_f2886_0(String requestScheme, int port)
{    if (port == DEFAULT_HTTP_PORT) {        return PortFilter.HTTP_SCHEME;    } else {        return HTTPS_SCHEME;    }}
protected boolean shiro_f2887_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{    return super.isAccessAllowed(request, response, mappedValue) && request.isSecure();}
public Filter shiro_f2888_0()
{    return (Filter) ClassUtils.newInstance(this.filterClass);}
public Class<? extends Filter> shiro_f2889_0()
{    return this.filterClass;}
public static Map<String, Filter> shiro_f2890_0(FilterConfig config)
{    Map<String, Filter> filters = new LinkedHashMap<String, Filter>(values().length);    for (DefaultFilter defaultFilter : values()) {        Filter filter = defaultFilter.newInstance();        if (config != null) {            try {                filter.init(config);            } catch (ServletException e) {                String msg = "Unable to correctly init default filter instance of type " + filter.getClass().getName();                throw new IllegalStateException(msg, e);            }        }        filters.put(defaultFilter.name(), filter);    }    return filters;}
public FilterConfig shiro_f2891_0()
{    return filterConfig;}
public void shiro_f2892_0(FilterConfig filterConfig)
{    this.filterConfig = filterConfig;}
public Map<String, Filter> shiro_f2893_0()
{    return filters;}
public void shiro_f2894_0(Map<String, Filter> filters)
{    this.filters = filters;}
public Map<String, NamedFilterList> shiro_f2895_0()
{    return filterChains;}
public void shiro_f2896_0(Map<String, NamedFilterList> filterChains)
{    this.filterChains = filterChains;}
public Filter shiro_f2897_0(String name)
{    return this.filters.get(name);}
public void shiro_f2898_0(String name, Filter filter)
{    addFilter(name, filter, false);}
public void shiro_f2899_0(String name, Filter filter, boolean init)
{    addFilter(name, filter, init, true);}
public void shiro_f2900_1(String chainName, String chainDefinition)
{    if (!StringUtils.hasText(chainName)) {        throw new NullPointerException("chainName cannot be null or empty.");    }    if (!StringUtils.hasText(chainDefinition)) {        throw new NullPointerException("chainDefinition cannot be null or empty.");    }    if (log.isDebugEnabled()) {            }                                            String[] filterTokens = splitChainDefinition(chainDefinition);        for (String token : filterTokens) {        String[] nameConfigPair = toNameConfigPair(token);                addToChain(chainName, nameConfigPair[0], nameConfigPair[1]);    }}
protected String[] shiro_f2901_0(String chainDefinition)
{    return StringUtils.split(chainDefinition, StringUtils.DEFAULT_DELIMITER_CHAR, '[', ']', true, true);}
protected String[] shiro_f2902_0(String token) throws ConfigurationException
{    try {        String[] pair = token.split("\\[", 2);        String name = StringUtils.clean(pair[0]);        if (name == null) {            throw new IllegalArgumentException("Filter name not found for filter chain definition token: " + token);        }        String config = null;        if (pair.length == 2) {            config = StringUtils.clean(pair[1]);                        config = config.substring(0, config.length() - 1);            config = StringUtils.clean(config);                        if (config != null && config.startsWith("\"") && config.endsWith("\"")) {                String stripped = config.substring(1, config.length() - 1);                stripped = StringUtils.clean(stripped);                                if (stripped != null && stripped.indexOf('"') == -1) {                    config = stripped;                }                                                            }        }        return new String[] { name, config };    } catch (Exception e) {        String msg = "Unable to parse filter chain definition token: " + token;        throw new ConfigurationException(msg, e);    }}
protected void shiro_f2903_0(String name, Filter filter, boolean init, boolean overwrite)
{    Filter existing = getFilter(name);    if (existing == null || overwrite) {        if (filter instanceof Nameable) {            ((Nameable) filter).setName(name);        }        if (init) {            initFilter(filter);        }        this.filters.put(name, filter);    }}
public void shiro_f2904_0(String chainName, String filterName)
{    addToChain(chainName, filterName, null);}
public void shiro_f2905_0(String chainName, String filterName, String chainSpecificFilterConfig)
{    if (!StringUtils.hasText(chainName)) {        throw new IllegalArgumentException("chainName cannot be null or empty.");    }    Filter filter = getFilter(filterName);    if (filter == null) {        throw new IllegalArgumentException("There is no filter with name '" + filterName + "' to apply to chain [" + chainName + "] in the pool of available Filters.  Ensure a " + "filter with that name/path has first been registered with the addFilter method(s).");    }    applyChainConfig(chainName, filter, chainSpecificFilterConfig);    NamedFilterList chain = ensureChain(chainName);    chain.add(filter);}
protected void shiro_f2906_1(String chainName, Filter filter, String chainSpecificFilterConfig)
{    if (log.isDebugEnabled()) {            }    if (filter instanceof PathConfigProcessor) {        ((PathConfigProcessor) filter).processPathConfig(chainName, chainSpecificFilterConfig);    } else {        if (StringUtils.hasText(chainSpecificFilterConfig)) {                                    String msg = "chainSpecificFilterConfig was specified, but the underlying " + "Filter instance is not an 'instanceof' " + PathConfigProcessor.class.getName() + ".  This is required if the filter is to accept " + "chain-specific configuration.";            throw new ConfigurationException(msg);        }    }}
protected NamedFilterList shiro_f2907_0(String chainName)
{    NamedFilterList chain = getChain(chainName);    if (chain == null) {        chain = new SimpleNamedFilterList(chainName);        this.filterChains.put(chainName, chain);    }    return chain;}
public NamedFilterList shiro_f2908_0(String chainName)
{    return this.filterChains.get(chainName);}
public boolean shiro_f2909_0()
{    return !CollectionUtils.isEmpty(this.filterChains);}
public Set<String> shiro_f2910_0()
{        return this.filterChains != null ? this.filterChains.keySet() : Collections.EMPTY_SET;}
public FilterChain shiro_f2911_0(FilterChain original, String chainName)
{    NamedFilterList configured = getChain(chainName);    if (configured == null) {        String msg = "There is no configured chain under the name/key [" + chainName + "].";        throw new IllegalArgumentException(msg);    }    return configured.proxy(original);}
protected void shiro_f2912_0(Filter filter)
{    FilterConfig filterConfig = getFilterConfig();    if (filterConfig == null) {        throw new IllegalStateException("FilterConfig attribute has not been set.  This must occur before filter " + "initialization can occur.");    }    try {        filter.init(filterConfig);    } catch (ServletException e) {        throw new ConfigurationException(e);    }}
protected void shiro_f2913_0(boolean init)
{    for (DefaultFilter defaultFilter : DefaultFilter.values()) {        addFilter(defaultFilter.name(), defaultFilter.newInstance(), init, false);    }}
public PatternMatcher shiro_f2914_0()
{    return pathMatcher;}
public void shiro_f2915_0(PatternMatcher pathMatcher)
{    this.pathMatcher = pathMatcher;}
public FilterChainManager shiro_f2916_0()
{    return filterChainManager;}
public void shiro_f2917_0(FilterChainManager filterChainManager)
{    this.filterChainManager = filterChainManager;}
public FilterChain shiro_f2918_0(ServletRequest request, ServletResponse response, FilterChain originalChain)
{    FilterChainManager filterChainManager = getFilterChainManager();    if (!filterChainManager.hasChains()) {        return null;    }    String requestURI = getPathWithinApplication(request);        for (String pathPattern : filterChainManager.getChainNames()) {                if (pathMatches(pathPattern, requestURI)) {            if (log.isTraceEnabled()) {                log.trace("Matched path pattern [" + pathPattern + "] for requestURI [" + requestURI + "].  " + "Utilizing corresponding filter chain...");            }            return filterChainManager.proxy(originalChain, pathPattern);        }    }    return null;}
protected boolean shiro_f2919_0(String pattern, String path)
{    PatternMatcher pathMatcher = getPathMatcher();    return pathMatcher.matches(pattern, path);}
protected String shiro_f2920_0(ServletRequest request)
{    return WebUtils.getPathWithinApplication(WebUtils.toHttp(request));}
protected void shiro_f2921_0(String name)
{    if (!StringUtils.hasText(name)) {        throw new IllegalArgumentException("Cannot specify a null or empty name.");    }    this.name = name;}
public String shiro_f2922_0()
{    return name;}
public FilterChain shiro_f2923_0(FilterChain orig)
{    return new ProxiedFilterChain(orig, this);}
public boolean shiro_f2924_0(Filter filter)
{    return this.backingList.add(filter);}
public void shiro_f2925_0(int index, Filter filter)
{    this.backingList.add(index, filter);}
public boolean shiro_f2926_0(Collection<? extends Filter> c)
{    return this.backingList.addAll(c);}
public boolean shiro_f2927_0(int index, Collection<? extends Filter> c)
{    return this.backingList.addAll(index, c);}
public void shiro_f2928_0()
{    this.backingList.clear();}
public boolean shiro_f2929_0(Object o)
{    return this.backingList.contains(o);}
public boolean shiro_f2930_0(Collection<?> c)
{    return this.backingList.containsAll(c);}
public Filter shiro_f2931_0(int index)
{    return this.backingList.get(index);}
public int shiro_f2932_0(Object o)
{    return this.backingList.indexOf(o);}
public boolean shiro_f2933_0()
{    return this.backingList.isEmpty();}
public Iterator<Filter> shiro_f2934_0()
{    return this.backingList.iterator();}
public int shiro_f2935_0(Object o)
{    return this.backingList.lastIndexOf(o);}
public ListIterator<Filter> shiro_f2936_0()
{    return this.backingList.listIterator();}
public ListIterator<Filter> shiro_f2937_0(int index)
{    return this.backingList.listIterator(index);}
public Filter shiro_f2938_0(int index)
{    return this.backingList.remove(index);}
public boolean shiro_f2939_0(Object o)
{    return this.backingList.remove(o);}
public boolean shiro_f2940_0(Collection<?> c)
{    return this.backingList.removeAll(c);}
public boolean shiro_f2941_0(Collection<?> c)
{    return this.backingList.retainAll(c);}
public Filter shiro_f2942_0(int index, Filter filter)
{    return this.backingList.set(index, filter);}
public int shiro_f2943_0()
{    return this.backingList.size();}
public List<Filter> shiro_f2944_0(int fromIndex, int toIndex)
{    return this.backingList.subList(fromIndex, toIndex);}
public Object[] shiro_f2945_0()
{    return this.backingList.toArray();}
public T[] shiro_f2946_0(T[] a)
{        return this.backingList.toArray(a);}
public Filter shiro_f2947_0(String path, String config)
{    String[] values = null;    if (config != null) {        values = split(config);    }    this.appliedPaths.put(path, values);    return this;}
protected String shiro_f2948_0(ServletRequest request)
{    return WebUtils.getPathWithinApplication(WebUtils.toHttp(request));}
protected boolean shiro_f2949_0(String path, ServletRequest request)
{    String requestURI = getPathWithinApplication(request);    log.trace("Attempting to match pattern '{}' with current requestURI '{}'...", path, requestURI);    return pathsMatch(path, requestURI);}
protected boolean shiro_f2950_0(String pattern, String path)
{    return pathMatcher.matches(pattern, path);}
protected boolean shiro_f2951_0(ServletRequest request, ServletResponse response) throws Exception
{    if (this.appliedPaths == null || this.appliedPaths.isEmpty()) {        if (log.isTraceEnabled()) {            log.trace("appliedPaths property is null or empty.  This Filter will passthrough immediately.");        }        return true;    }    for (String path : this.appliedPaths.keySet()) {                if (pathsMatch(path, request)) {            log.trace("Current requestURI matches pattern '{}'.  Determining filter chain execution...", path);            Object config = this.appliedPaths.get(path);            return isFilterChainContinued(request, response, path, config);        }    }        return true;}
private boolean shiro_f2952_0(ServletRequest request, ServletResponse response, String path, Object pathConfig) throws Exception
{    if (isEnabled(request, response, path, pathConfig)) {                if (log.isTraceEnabled()) {            log.trace("Filter '{}' is enabled for the current request under path '{}' with config [{}].  " + "Delegating to subclass implementation for 'onPreHandle' check.", new Object[] { getName(), path, pathConfig });        }                return onPreHandle(request, response, pathConfig);    }    if (log.isTraceEnabled()) {        log.trace("Filter '{}' is disabled for the current request under path '{}' with config [{}].  " + "The next element in the FilterChain will be called immediately.", new Object[] { getName(), path, pathConfig });    }        return true;}
protected boolean shiro_f2953_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{    return true;}
protected boolean shiro_f2954_0(ServletRequest request, ServletResponse response, String path, Object mappedValue) throws Exception
{    return isEnabled(request, response);}
protected boolean shiro_f2955_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{    request.setAttribute(DefaultSubjectContext.SESSION_CREATION_ENABLED, Boolean.FALSE);    return true;}
public Cookie shiro_f2956_0()
{    return cookie;}
public void shiro_f2957_0(Cookie cookie)
{    this.cookie = cookie;}
protected void shiro_f2958_1(Subject subject, byte[] serialized)
{    if (!WebUtils.isHttp(subject)) {        if (log.isDebugEnabled()) {            String msg = "Subject argument is not an HTTP-aware instance.  This is required to obtain a servlet " + "request and response in order to set the rememberMe cookie. Returning immediately and " + "ignoring rememberMe operation.";                    }        return;    }    HttpServletRequest request = WebUtils.getHttpRequest(subject);    HttpServletResponse response = WebUtils.getHttpResponse(subject);        String base64 = Base64.encodeToString(serialized);        Cookie template = getCookie();    Cookie cookie = new SimpleCookie(template);    cookie.setValue(base64);    cookie.saveTo(request, response);}
private boolean shiro_f2959_0(WebSubjectContext subjectContext)
{    ServletRequest request = subjectContext.resolveServletRequest();    if (request != null) {        Boolean removed = (Boolean) request.getAttribute(ShiroHttpServletRequest.IDENTITY_REMOVED_KEY);        return removed != null && removed;    }    return false;}
protected byte[] shiro_f2960_1(SubjectContext subjectContext)
{    if (!WebUtils.isHttp(subjectContext)) {        if (log.isDebugEnabled()) {            String msg = "SubjectContext argument is not an HTTP-aware instance.  This is required to obtain a " + "servlet request and response in order to retrieve the rememberMe cookie. Returning " + "immediately and ignoring rememberMe operation.";                    }        return null;    }    WebSubjectContext wsc = (WebSubjectContext) subjectContext;    if (isIdentityRemoved(wsc)) {        return null;    }    HttpServletRequest request = WebUtils.getHttpRequest(wsc);    HttpServletResponse response = WebUtils.getHttpResponse(wsc);    String base64 = getCookie().readValue(request, response);        if (Cookie.DELETED_COOKIE_VALUE.equals(base64))        return null;    if (base64 != null) {        base64 = ensurePadding(base64);        if (log.isTraceEnabled()) {            log.trace("Acquired Base64 encoded identity [" + base64 + "]");        }        byte[] decoded = Base64.decode(base64);        if (log.isTraceEnabled()) {            log.trace("Base64 decoded byte array length: " + (decoded != null ? decoded.length : 0) + " bytes.");        }        return decoded;    } else {                return null;    }}
private String shiro_f2961_0(String base64)
{    int length = base64.length();    if (length % 4 != 0) {        StringBuilder sb = new StringBuilder(base64);        for (int i = 0; i < length % 4; ++i) {            sb.append('=');        }        base64 = sb.toString();    }    return base64;}
protected void shiro_f2962_0(Subject subject)
{    if (WebUtils.isHttp(subject)) {        HttpServletRequest request = WebUtils.getHttpRequest(subject);        HttpServletResponse response = WebUtils.getHttpResponse(subject);        forgetIdentity(request, response);    }}
public void shiro_f2963_0(SubjectContext subjectContext)
{    if (WebUtils.isHttp(subjectContext)) {        HttpServletRequest request = WebUtils.getHttpRequest(subjectContext);        HttpServletResponse response = WebUtils.getHttpResponse(subjectContext);        forgetIdentity(request, response);    }}
private void shiro_f2964_0(HttpServletRequest request, HttpServletResponse response)
{    getCookie().removeFrom(request, response);}
protected SubjectContext shiro_f2965_0()
{    return new DefaultWebSubjectContext();}
public void shiro_f2966_0(SubjectDAO subjectDAO)
{    super.setSubjectDAO(subjectDAO);    applySessionManagerToSessionStorageEvaluatorIfPossible();}
protected void shiro_f2967_0()
{    super.afterSessionManagerSet();    applySessionManagerToSessionStorageEvaluatorIfPossible();}
private void shiro_f2968_0()
{    SubjectDAO subjectDAO = getSubjectDAO();    if (subjectDAO instanceof DefaultSubjectDAO) {        SessionStorageEvaluator evaluator = ((DefaultSubjectDAO) subjectDAO).getSessionStorageEvaluator();        if (evaluator instanceof DefaultWebSessionStorageEvaluator) {            ((DefaultWebSessionStorageEvaluator) evaluator).setSessionManager(getSessionManager());        }    }}
protected SubjectContext shiro_f2969_0(SubjectContext subjectContext)
{    if (subjectContext instanceof WebSubjectContext) {        return new DefaultWebSubjectContext((WebSubjectContext) subjectContext);    }    return super.copy(subjectContext);}
public String shiro_f2970_0()
{    return sessionMode;}
public void shiro_f2971_1(String sessionMode)
{        String mode = sessionMode;    if (mode == null) {        throw new IllegalArgumentException("sessionMode argument cannot be null.");    }    mode = sessionMode.toLowerCase();    if (!HTTP_SESSION_MODE.equals(mode) && !NATIVE_SESSION_MODE.equals(mode)) {        String msg = "Invalid sessionMode [" + sessionMode + "].  Allowed values are " + "public static final String constants in the " + getClass().getName() + " class: '" + HTTP_SESSION_MODE + "' or '" + NATIVE_SESSION_MODE + "', with '" + HTTP_SESSION_MODE + "' being the default.";        throw new IllegalArgumentException(msg);    }    boolean recreate = this.sessionMode == null || !this.sessionMode.equals(mode);    this.sessionMode = mode;    if (recreate) {        LifecycleUtils.destroy(getSessionManager());        SessionManager sessionManager = createSessionManager(mode);        this.setInternalSessionManager(sessionManager);    }}
public void shiro_f2972_1(SessionManager sessionManager)
{    this.sessionMode = null;    if (sessionManager != null && !(sessionManager instanceof WebSessionManager)) {        if (log.isWarnEnabled()) {            String msg = "The " + getClass().getName() + " implementation expects SessionManager instances " + "that implement the " + WebSessionManager.class.getName() + " interface.  The " + "configured instance is of type [" + sessionManager.getClass().getName() + "] which does not " + "implement this interface..  This may cause unexpected behavior.";                    }    }    setInternalSessionManager(sessionManager);}
private void shiro_f2973_0(SessionManager sessionManager)
{    super.setSessionManager(sessionManager);}
public boolean shiro_f2974_0()
{    SessionManager sessionManager = getSessionManager();    return sessionManager instanceof WebSessionManager && ((WebSessionManager) sessionManager).isServletContainerSessions();}
protected SessionManager shiro_f2975_1(String sessionMode)
{    if (sessionMode == null || !sessionMode.equalsIgnoreCase(NATIVE_SESSION_MODE)) {                return new ServletContainerSessionManager();    } else {                return new DefaultWebSessionManager();    }}
protected SessionContext shiro_f2976_0(SubjectContext subjectContext)
{    SessionContext sessionContext = super.createSessionContext(subjectContext);    if (subjectContext instanceof WebSubjectContext) {        WebSubjectContext wsc = (WebSubjectContext) subjectContext;        ServletRequest request = wsc.resolveServletRequest();        ServletResponse response = wsc.resolveServletResponse();        DefaultWebSessionContext webSessionContext = new DefaultWebSessionContext(sessionContext);        if (request != null) {            webSessionContext.setServletRequest(request);        }        if (response != null) {            webSessionContext.setServletResponse(response);        }        sessionContext = webSessionContext;    }    return sessionContext;}
protected SessionKey shiro_f2977_0(SubjectContext context)
{    if (WebUtils.isWeb(context)) {        Serializable sessionId = context.getSessionId();        ServletRequest request = WebUtils.getRequest(context);        ServletResponse response = WebUtils.getResponse(context);        return new WebSessionKey(sessionId, request, response);    } else {        return super.getSessionKey(context);    }}
protected void shiro_f2978_0(Subject subject)
{    super.beforeLogout(subject);    removeRequestIdentity(subject);}
protected void shiro_f2979_0(Subject subject)
{    if (subject instanceof WebSubject) {        WebSubject webSubject = (WebSubject) subject;        ServletRequest request = webSubject.getServletRequest();        if (request != null) {            request.setAttribute(ShiroHttpServletRequest.IDENTITY_REMOVED_KEY, Boolean.TRUE);        }    }}
 void shiro_f2980_0(SessionManager sessionManager)
{    this.sessionManager = sessionManager;}
public boolean shiro_f2981_0(Subject subject)
{    if (subject.getSession(false) != null) {                return true;    }    if (!isSessionStorageEnabled()) {                return false;    }        if (!(subject instanceof WebSubject) && (this.sessionManager != null && !(this.sessionManager instanceof NativeSessionManager))) {        return false;    }    return WebUtils._isSessionCreationEnabled(subject);}
public Subject shiro_f2982_0(SubjectContext context)
{                boolean isNotBasedOnWebSubject = context.getSubject() != null && !(context.getSubject() instanceof WebSubject);    if (!(context instanceof WebSubjectContext) || isNotBasedOnWebSubject) {        return super.createSubject(context);    }    WebSubjectContext wsc = (WebSubjectContext) context;    SecurityManager securityManager = wsc.resolveSecurityManager();    Session session = wsc.resolveSession();    boolean sessionEnabled = wsc.isSessionCreationEnabled();    PrincipalCollection principals = wsc.resolvePrincipals();    boolean authenticated = wsc.resolveAuthenticated();    String host = wsc.resolveHost();    ServletRequest request = wsc.resolveServletRequest();    ServletResponse response = wsc.resolveServletResponse();    return new WebDelegatingSubject(principals, authenticated, host, session, sessionEnabled, request, response, securityManager);}
protected Subject shiro_f2983_0(PrincipalCollection principals, boolean authenticated, String host, Session session, ServletRequest request, ServletResponse response, SecurityManager securityManager)
{    return new WebDelegatingSubject(principals, authenticated, host, session, true, request, response, securityManager);}
public FilterConfig shiro_f2984_0()
{    return filterConfig;}
public void shiro_f2985_0(FilterConfig filterConfig)
{    this.filterConfig = filterConfig;    setServletContext(filterConfig.getServletContext());}
protected String shiro_f2986_0(String paramName)
{    FilterConfig config = getFilterConfig();    if (config != null) {        return StringUtils.clean(config.getInitParameter(paramName));    }    return null;}
public final void shiro_f2987_1(FilterConfig filterConfig) throws ServletException
{    setFilterConfig(filterConfig);    try {        onFilterConfigSet();    } catch (Exception e) {        if (e instanceof ServletException) {            throw (ServletException) e;        } else {            if (log.isErrorEnabled()) {                            }            throw new ServletException(e);        }    }}
protected void shiro_f2988_0() throws Exception
{}
public void shiro_f2989_0()
{}
public WebSecurityManager shiro_f2990_0()
{    return securityManager;}
public void shiro_f2991_0(WebSecurityManager sm)
{    this.securityManager = sm;}
public FilterChainResolver shiro_f2992_0()
{    return filterChainResolver;}
public void shiro_f2993_0(FilterChainResolver filterChainResolver)
{    this.filterChainResolver = filterChainResolver;}
public boolean shiro_f2994_0()
{    return staticSecurityManagerEnabled;}
public void shiro_f2995_0(boolean staticSecurityManagerEnabled)
{    this.staticSecurityManagerEnabled = staticSecurityManagerEnabled;}
protected final void shiro_f2996_0() throws Exception
{        applyStaticSecurityManagerEnabledConfig();    init();    ensureSecurityManager();        if (isStaticSecurityManagerEnabled()) {        SecurityUtils.setSecurityManager(getSecurityManager());    }}
private void shiro_f2997_0()
{    String value = getInitParam(STATIC_INIT_PARAM_NAME);    if (value != null) {        Boolean b = Boolean.valueOf(value);        if (b != null) {            setStaticSecurityManagerEnabled(b);        }    }}
public void shiro_f2998_0() throws Exception
{}
private void shiro_f2999_1()
{    WebSecurityManager securityManager = getSecurityManager();    if (securityManager == null) {                securityManager = createDefaultSecurityManager();        setSecurityManager(securityManager);    }}
protected WebSecurityManager shiro_f3000_0()
{    return new DefaultWebSecurityManager();}
protected boolean shiro_f3001_0()
{    return getSecurityManager().isHttpSessionMode();}
protected ServletRequest shiro_f3002_0(HttpServletRequest orig)
{    return new ShiroHttpServletRequest(orig, getServletContext(), isHttpSessions());}
protected ServletRequest shiro_f3003_0(ServletRequest request, ServletResponse response, FilterChain chain)
{    ServletRequest toUse = request;    if (request instanceof HttpServletRequest) {        HttpServletRequest http = (HttpServletRequest) request;        toUse = wrapServletRequest(http);    }    return toUse;}
protected ServletResponse shiro_f3004_0(HttpServletResponse orig, ShiroHttpServletRequest request)
{    return new ShiroHttpServletResponse(orig, getServletContext(), request);}
protected ServletResponse shiro_f3005_0(ServletRequest request, ServletResponse response, FilterChain chain)
{    ServletResponse toUse = response;    if (!isHttpSessions() && (request instanceof ShiroHttpServletRequest) && (response instanceof HttpServletResponse)) {                        toUse = wrapServletResponse((HttpServletResponse) response, (ShiroHttpServletRequest) request);    }    return toUse;}
protected WebSubject shiro_f3006_0(ServletRequest request, ServletResponse response)
{    return new WebSubject.Builder(getSecurityManager(), request, response).buildWebSubject();}
protected void shiro_f3007_1(ServletRequest request, ServletResponse response)
{    if (!isHttpSessions()) {                Subject subject = SecurityUtils.getSubject();                if (subject != null) {            Session session = subject.getSession(false);            if (session != null) {                try {                    session.touch();                } catch (Throwable t) {                                    }            }        }    }}
protected void shiro_f3008_0(ServletRequest servletRequest, ServletResponse servletResponse, final FilterChain chain) throws ServletException, IOException
{    Throwable t = null;    try {        final ServletRequest request = prepareServletRequest(servletRequest, servletResponse, chain);        final ServletResponse response = prepareServletResponse(request, servletResponse, chain);        final Subject subject = createSubject(request, response);                subject.execute(new Callable() {            public Object call() throws Exception {                updateSessionLastAccessTime(request, response);                executeChain(request, response, chain);                return null;            }        });    } catch (ExecutionException ex) {        t = ex.getCause();    } catch (Throwable throwable) {        t = throwable;    }    if (t != null) {        if (t instanceof ServletException) {            throw (ServletException) t;        }        if (t instanceof IOException) {            throw (IOException) t;        }                String msg = "Filtered request failed.";        throw new ServletException(msg, t);    }}
public Object shiro_f3009_0() throws Exception
{    updateSessionLastAccessTime(request, response);    executeChain(request, response, chain);    return null;}
protected FilterChain shiro_f3010_1(ServletRequest request, ServletResponse response, FilterChain origChain)
{    FilterChain chain = origChain;    FilterChainResolver resolver = getFilterChainResolver();    if (resolver == null) {                return origChain;    }    FilterChain resolved = resolver.getChain(request, response, origChain);    if (resolved != null) {        log.trace("Resolved a configured FilterChain for the current request.");        chain = resolved;    } else {        log.trace("No FilterChain configured for the current request.  Using the default.");    }    return chain;}
protected void shiro_f3011_0(ServletRequest request, ServletResponse response, FilterChain origChain) throws IOException, ServletException
{    FilterChain chain = getExecutionChain(request, response, origChain);    chain.doFilter(request, response);}
protected boolean shiro_f3012_0(ServletRequest request, ServletResponse response) throws Exception
{    return true;}
protected void shiro_f3013_0(ServletRequest request, ServletResponse response) throws Exception
{}
public void shiro_f3014_0(ServletRequest request, ServletResponse response, Exception exception) throws Exception
{}
protected void shiro_f3015_0(ServletRequest request, ServletResponse response, FilterChain chain) throws Exception
{    chain.doFilter(request, response);}
public void shiro_f3016_0(ServletRequest request, ServletResponse response, FilterChain chain) throws ServletException, IOException
{    Exception exception = null;    try {        boolean continueChain = preHandle(request, response);        if (log.isTraceEnabled()) {            log.trace("Invoked preHandle method.  Continuing chain?: [" + continueChain + "]");        }        if (continueChain) {            executeChain(request, response, chain);        }        postHandle(request, response);        if (log.isTraceEnabled()) {            log.trace("Successfully invoked postHandle method");        }    } catch (Exception e) {        exception = e;    } finally {        cleanup(request, response, exception);    }}
protected void shiro_f3017_1(ServletRequest request, ServletResponse response, Exception existing) throws ServletException, IOException
{    Exception exception = existing;    try {        afterCompletion(request, response, exception);        if (log.isTraceEnabled()) {            log.trace("Successfully invoked afterCompletion method.");        }    } catch (Exception e) {        if (exception == null) {            exception = e;        } else {                    }    }    if (exception != null) {        if (exception instanceof ServletException) {            throw (ServletException) exception;        } else if (exception instanceof IOException) {            throw (IOException) exception;        } else {            if (log.isDebugEnabled()) {                String msg = "Filter execution resulted in an unexpected Exception " + "(not IOException or ServletException as the Filter API recommends).  " + "Wrapping in ServletException and propagating.";                            }            throw new ServletException(exception);        }    }}
public String shiro_f3018_0()
{    return this.config;}
public void shiro_f3019_0(String config)
{    this.config = config;}
public String shiro_f3020_0()
{    return configPath;}
public void shiro_f3021_0(String configPath)
{    this.configPath = StringUtils.clean(configPath);}
public void shiro_f3022_0() throws Exception
{    applyInitParams();    configure();}
protected void shiro_f3023_0() throws Exception
{    String config = getInitParam(CONFIG_INIT_PARAM_NAME);    if (config != null) {        setConfig(config);    }    String configPath = getInitParam(CONFIG_PATH_INIT_PARAM_NAME);    if (configPath != null) {        setConfigPath(configPath);    }}
protected void shiro_f3024_1() throws Exception
{    Ini ini = loadIniFromConfig();    if (CollectionUtils.isEmpty(ini)) {                ini = loadIniFromPath();    }        if (CollectionUtils.isEmpty(ini)) {                ini = getServletContextIniResource(DEFAULT_WEB_INI_RESOURCE_PATH);    }        if (CollectionUtils.isEmpty(ini)) {                ini = IniFactorySupport.loadDefaultClassPathIni();    }    Map<String, ?> objects = applySecurityManager(ini);    applyFilterChainResolver(ini, objects);}
protected Ini shiro_f3025_0()
{    Ini ini = null;    String config = getConfig();    if (config != null) {        ini = convertConfigToIni(config);    }    return ini;}
protected Ini shiro_f3026_0()
{    Ini ini = null;    String path = getConfigPath();    if (path != null) {        ini = convertPathToIni(path);    }    return ini;}
protected Map<String, ?> shiro_f3027_0(Ini ini)
{    WebIniSecurityManagerFactory factory;    if (CollectionUtils.isEmpty(ini)) {        factory = new WebIniSecurityManagerFactory();    } else {        factory = new WebIniSecurityManagerFactory(ini);    }            SecurityManager securityManager = factory.getInstance();    if (!(securityManager instanceof WebSecurityManager)) {        String msg = "The configured security manager is not an instance of WebSecurityManager, so " + "it can not be used with the Shiro servlet filter.";        throw new ConfigurationException(msg);    }    setSecurityManager((WebSecurityManager) securityManager);    return factory.getBeans();}
protected void shiro_f3028_0(Ini ini, Map<String, ?> defaults)
{    if (ini == null || ini.isEmpty()) {                return;    }        Ini.Section urls = ini.getSection(IniFilterChainResolverFactory.URLS);    Ini.Section filters = ini.getSection(IniFilterChainResolverFactory.FILTERS);    if ((urls != null && !urls.isEmpty()) || (filters != null && !filters.isEmpty())) {                        IniFilterChainResolverFactory filterChainResolverFactory = new IniFilterChainResolverFactory(ini, defaults);        filterChainResolverFactory.setFilterConfig(getFilterConfig());        FilterChainResolver resolver = filterChainResolverFactory.getInstance();        setFilterChainResolver(resolver);    }}
protected Ini shiro_f3029_0(String config)
{    Ini ini = new Ini();    ini.load(config);    return ini;}
protected Ini shiro_f3030_1(String servletContextPath)
{    String path = WebUtils.normalize(servletContextPath);    if (getServletContext() != null) {        InputStream is = getServletContext().getResourceAsStream(path);        if (is != null) {            Ini ini = new Ini();            ini.load(is);            if (CollectionUtils.isEmpty(ini)) {                            }            return ini;        }    }    return null;}
protected Ini shiro_f3031_0(String path)
{    Ini ini = new Ini();        if (!ResourceUtils.hasResourcePrefix(path)) {        ini = getServletContextIniResource(path);        if (ini == null) {            String msg = "There is no servlet context resource corresponding to configPath '" + path + "'  If " + "the resource is located elsewhere (not immediately resolveable in the servlet context), " + "specify an appropriate classpath:, url:, or file: resource prefix accordingly.";            throw new ConfigurationException(msg);        }    } else {                ini.loadFromPath(path);    }    return ini;}
protected String shiro_f3032_0()
{    if (this.name == null) {        FilterConfig config = getFilterConfig();        if (config != null) {            this.name = config.getFilterName();        }    }    return this.name;}
public void shiro_f3033_0(String name)
{    this.name = name;}
protected StringBuilder shiro_f3034_0()
{    String name = getName();    if (name == null) {        return super.toStringBuilder();    } else {        StringBuilder sb = new StringBuilder();        sb.append(name);        return sb;    }}
public boolean shiro_f3035_0()
{    return enabled;}
public void shiro_f3036_0(boolean enabled)
{    this.enabled = enabled;}
public final void shiro_f3037_1(ServletRequest request, ServletResponse response, FilterChain filterChain) throws ServletException, IOException
{    String alreadyFilteredAttributeName = getAlreadyFilteredAttributeName();    if (request.getAttribute(alreadyFilteredAttributeName) != null) {        log.trace("Filter '{}' already executed.  Proceeding without invoking this filter.", getName());        filterChain.doFilter(request, response);    } else     if (/* added in 1.2: */    !isEnabled(request, response) || /* retain backwards compatibility: */    shouldNotFilter(request)) {                filterChain.doFilter(request, response);    } else {                log.trace("Filter '{}' not yet executed.  Executing now.", getName());        request.setAttribute(alreadyFilteredAttributeName, Boolean.TRUE);        try {            doFilterInternal(request, response, filterChain);        } finally {                                    request.removeAttribute(alreadyFilteredAttributeName);        }    }}
protected boolean shiro_f3038_0(ServletRequest request, ServletResponse response) throws ServletException, IOException
{    return isEnabled();}
protected String shiro_f3039_0()
{    String name = getName();    if (name == null) {        name = getClass().getName();    }    return name + ALREADY_FILTERED_SUFFIX;}
protected boolean shiro_f3040_0(ServletRequest request) throws ServletException
{    return false;}
public void shiro_f3041_0(ServletRequest request, ServletResponse response) throws IOException, ServletException
{    if (this.filters == null || this.filters.size() == this.index) {                if (log.isTraceEnabled()) {            log.trace("Invoking original filter chain.");        }        this.orig.doFilter(request, response);    } else {        if (log.isTraceEnabled()) {            log.trace("Invoking wrapped filter at index [" + this.index + "]");        }        this.filters.get(this.index++).doFilter(request, response, this);    }}
public ServletContext shiro_f3042_0()
{    return servletContext;}
public void shiro_f3043_0(ServletContext servletContext)
{    this.servletContext = servletContext;}
protected String shiro_f3044_0(String paramName)
{    return getServletContext().getInitParameter(paramName);}
private ServletContext shiro_f3045_0()
{    ServletContext servletContext = getServletContext();    if (servletContext == null) {        String msg = "ServletContext property must be set via the setServletContext method.";        throw new IllegalStateException(msg);    }    return servletContext;}
protected void shiro_f3046_0(String key, Object value)
{    if (value == null) {        removeContextAttribute(key);    } else {        getRequiredServletContext().setAttribute(key, value);    }}
protected Object shiro_f3047_0(String key)
{    return getRequiredServletContext().getAttribute(key);}
protected void shiro_f3048_0(String key)
{    getRequiredServletContext().removeAttribute(key);}
public String shiro_f3049_0()
{    return toStringBuilder().toString();}
protected StringBuilder shiro_f3050_0()
{    return new StringBuilder(super.toString());}
public void shiro_f3051_0() throws Exception
{    WebEnvironment env = WebUtils.getRequiredWebEnvironment(getServletContext());    setSecurityManager(env.getWebSecurityManager());    FilterChainResolver resolver = env.getFilterChainResolver();    if (resolver != null) {        setFilterChainResolver(resolver);    }}
public boolean shiro_f3052_0()
{    return httpSessions;}
public String shiro_f3053_0()
{    String remoteUser;    Object scPrincipal = getSubjectPrincipal();    if (scPrincipal != null) {        if (scPrincipal instanceof String) {            return (String) scPrincipal;        } else if (scPrincipal instanceof Principal) {            remoteUser = ((Principal) scPrincipal).getName();        } else {            remoteUser = scPrincipal.toString();        }    } else {        remoteUser = super.getRemoteUser();    }    return remoteUser;}
protected Subject shiro_f3054_0()
{    return SecurityUtils.getSubject();}
protected Object shiro_f3055_0()
{    Object userPrincipal = null;    Subject subject = getSubject();    if (subject != null) {        userPrincipal = subject.getPrincipal();    }    return userPrincipal;}
public boolean shiro_f3056_0(String s)
{    Subject subject = getSubject();    boolean inRole = (subject != null && subject.hasRole(s));    if (!inRole) {        inRole = super.isUserInRole(s);    }    return inRole;}
public Principal shiro_f3057_0()
{    Principal userPrincipal;    Object scPrincipal = getSubjectPrincipal();    if (scPrincipal != null) {        if (scPrincipal instanceof Principal) {            userPrincipal = (Principal) scPrincipal;        } else {            userPrincipal = new ObjectPrincipal(scPrincipal);        }    } else {        userPrincipal = super.getUserPrincipal();    }    return userPrincipal;}
public String shiro_f3058_0()
{    String requestedSessionId = null;    if (isHttpSessions()) {        requestedSessionId = super.getRequestedSessionId();    } else {        Object sessionId = getAttribute(REFERENCED_SESSION_ID);        if (sessionId != null) {            requestedSessionId = sessionId.toString();        }    }    return requestedSessionId;}
public HttpSession shiro_f3059_0(boolean create)
{    HttpSession httpSession;    if (isHttpSessions()) {        httpSession = super.getSession(false);        if (httpSession == null && create) {                        if (WebUtils._isSessionCreationEnabled(this)) {                httpSession = super.getSession(create);            } else {                throw newNoSessionCreationException();            }        }    } else {        boolean existing = getSubject().getSession(false) != null;        if (this.session == null || !existing) {            Session shiroSession = getSubject().getSession(create);            if (shiroSession != null) {                this.session = new ShiroHttpSession(shiroSession, this, this.servletContext);                if (!existing) {                    setAttribute(REFERENCED_SESSION_IS_NEW, Boolean.TRUE);                }            } else if (this.session != null) {                this.session = null;            }        }        httpSession = this.session;    }    return httpSession;}
private DisabledSessionException shiro_f3060_0()
{    String msg = "Session creation has been disabled for the current request.  This exception indicates " + "that there is either a programming error (using a session when it should never be " + "used) or that Shiro's configuration needs to be adjusted to allow Sessions to be created " + "for the current request.  See the " + DisabledSessionException.class.getName() + " JavaDoc " + "for more.";    return new DisabledSessionException(msg);}
public HttpSession shiro_f3061_0()
{    return getSession(true);}
public boolean shiro_f3062_0()
{    if (isHttpSessions()) {        return super.isRequestedSessionIdValid();    } else {        Boolean value = (Boolean) getAttribute(REFERENCED_SESSION_ID_IS_VALID);        return (value != null && value.equals(Boolean.TRUE));    }}
public boolean shiro_f3063_0()
{    if (isHttpSessions()) {        return super.isRequestedSessionIdFromCookie();    } else {        String value = (String) getAttribute(REFERENCED_SESSION_ID_SOURCE);        return value != null && value.equals(COOKIE_SESSION_ID_SOURCE);    }}
public boolean shiro_f3064_0()
{    if (isHttpSessions()) {        return super.isRequestedSessionIdFromURL();    } else {        String value = (String) getAttribute(REFERENCED_SESSION_ID_SOURCE);        return value != null && value.equals(URL_SESSION_ID_SOURCE);    }}
public boolean shiro_f3065_0()
{    return isRequestedSessionIdFromURL();}
public Object shiro_f3066_0()
{    return object;}
public String shiro_f3067_0()
{    return getObject().toString();}
public int shiro_f3068_0()
{    return object.hashCode();}
public boolean shiro_f3069_0(Object o)
{    if (o instanceof ObjectPrincipal) {        ObjectPrincipal op = (ObjectPrincipal) o;        return getObject().equals(op.getObject());    }    return false;}
public String shiro_f3070_0()
{    return object.toString();}
public ServletContext shiro_f3071_0()
{    return context;}
public void shiro_f3072_0(ServletContext context)
{    this.context = context;}
public ShiroHttpServletRequest shiro_f3073_0()
{    return request;}
public void shiro_f3074_0(ShiroHttpServletRequest request)
{    this.request = request;}
public String shiro_f3075_0(String url)
{    if (isEncodeable(toAbsolute(url))) {        return toEncoded(url, request.getSession().getId());    } else {        return url;    }}
public String shiro_f3076_0(String s)
{    return encodeRedirectURL(s);}
public String shiro_f3077_0(String url)
{    String absolute = toAbsolute(url);    if (isEncodeable(absolute)) {                if (url.equalsIgnoreCase("")) {            url = absolute;        }        return toEncoded(url, request.getSession().getId());    } else {        return url;    }}
public String shiro_f3078_0(String s)
{    return encodeURL(s);}
protected boolean shiro_f3079_0(final String location)
{        if (Boolean.FALSE.equals(request.getAttribute(ShiroHttpServletRequest.SESSION_ID_URL_REWRITING_ENABLED)))        return (false);    if (location == null)        return (false);        if (location.startsWith("#"))        return (false);        final HttpServletRequest hreq = request;    final HttpSession session = hreq.getSession(false);    if (session == null)        return (false);    if (hreq.isRequestedSessionIdFromCookie())        return (false);    return doIsEncodeable(hreq, session, location);}
private boolean shiro_f3080_0(HttpServletRequest hreq, HttpSession session, String location)
{        URL url;    try {        url = new URL(location);    } catch (MalformedURLException e) {        return (false);    }        if (!hreq.getScheme().equalsIgnoreCase(url.getProtocol()))        return (false);    if (!hreq.getServerName().equalsIgnoreCase(url.getHost()))        return (false);    int serverPort = hreq.getServerPort();    if (serverPort == -1) {        if ("https".equals(hreq.getScheme()))            serverPort = 443;        else            serverPort = 80;    }    int urlPort = url.getPort();    if (urlPort == -1) {        if ("https".equals(url.getProtocol()))            urlPort = 443;        else            urlPort = 80;    }    if (serverPort != urlPort)        return (false);    String contextPath = getRequest().getContextPath();    if (contextPath != null) {        String file = url.getFile();        if ((file == null) || !file.startsWith(contextPath))            return (false);        String tok = ";" + DEFAULT_SESSION_ID_PARAMETER_NAME + "=" + session.getId();        if (file.indexOf(tok, contextPath.length()) >= 0)            return (false);    }        return (true);}
private String shiro_f3081_0(String location)
{    if (location == null)        return (location);    boolean leadingSlash = location.startsWith("/");    if (leadingSlash || !hasScheme(location)) {        StringBuilder buf = new StringBuilder();        String scheme = request.getScheme();        String name = request.getServerName();        int port = request.getServerPort();        try {            buf.append(scheme).append("://").append(name);            if ((scheme.equals("http") && port != 80) || (scheme.equals("https") && port != 443)) {                buf.append(':').append(port);            }            if (!leadingSlash) {                String relativePath = request.getRequestURI();                int pos = relativePath.lastIndexOf('/');                relativePath = relativePath.substring(0, pos);                String encodedURI = URLEncoder.encode(relativePath, getCharacterEncoding());                buf.append(encodedURI).append('/');            }            buf.append(location);        } catch (IOException e) {            IllegalArgumentException iae = new IllegalArgumentException(location);            iae.initCause(e);            throw iae;        }        return buf.toString();    } else {        return location;    }}
public static boolean shiro_f3082_0(char c)
{    return Character.isLetterOrDigit(c) || c == '+' || c == '-' || c == '.';}
private boolean shiro_f3083_0(String uri)
{    int len = uri.length();    for (int i = 0; i < len; i++) {        char c = uri.charAt(i);        if (c == ':') {            return i > 0;        } else if (!isSchemeChar(c)) {            return false;        }    }    return false;}
protected String shiro_f3084_0(String url, String sessionId)
{    if ((url == null) || (sessionId == null))        return (url);    String path = url;    String query = "";    String anchor = "";    int question = url.indexOf('?');    if (question >= 0) {        path = url.substring(0, question);        query = url.substring(question);    }    int pound = path.indexOf('#');    if (pound >= 0) {        anchor = path.substring(pound);        path = path.substring(0, pound);    }    StringBuilder sb = new StringBuilder(path);    if (sb.length() > 0) {                sb.append(";");        sb.append(DEFAULT_SESSION_ID_PARAMETER_NAME);        sb.append("=");        sb.append(sessionId);    }    sb.append(anchor);    sb.append(query);    return (sb.toString());}
public boolean shiro_f3085_0()
{    return false;}
public Object shiro_f3086_0()
{    return null;}
public HttpSession shiro_f3087_0(String s)
{    return null;}
public Enumeration shiro_f3088_0()
{    return EMPTY_ENUMERATION;}
public Session shiro_f3089_0()
{    return this.session;}
public long shiro_f3090_0()
{    try {        return getSession().getStartTimestamp().getTime();    } catch (Exception e) {        throw new IllegalStateException(e);    }}
public String shiro_f3091_0()
{    return getSession().getId().toString();}
public long shiro_f3092_0()
{    return getSession().getLastAccessTime().getTime();}
public ServletContext shiro_f3093_0()
{    return this.servletContext;}
public void shiro_f3094_0(int i)
{    try {        getSession().setTimeout(i * 1000);    } catch (InvalidSessionException e) {        throw new IllegalStateException(e);    }}
public int shiro_f3095_0()
{    try {        return (new Long(getSession().getTimeout() / 1000)).intValue();    } catch (InvalidSessionException e) {        throw new IllegalStateException(e);    }}
public javax.servlet.http.HttpSessionContext shiro_f3096_0()
{    return HTTP_SESSION_CONTEXT;}
public Object shiro_f3097_0(String s)
{    try {        return getSession().getAttribute(s);    } catch (InvalidSessionException e) {        throw new IllegalStateException(e);    }}
public Object shiro_f3098_0(String s)
{    return getAttribute(s);}
protected Set<String> shiro_f3099_0()
{    Collection<Object> keySet;    try {        keySet = getSession().getAttributeKeys();    } catch (InvalidSessionException e) {        throw new IllegalStateException(e);    }    Set<String> keyNames;    if (keySet != null && !keySet.isEmpty()) {        keyNames = new HashSet<String>(keySet.size());        for (Object o : keySet) {            keyNames.add(o.toString());        }    } else {        keyNames = Collections.EMPTY_SET;    }    return keyNames;}
public Enumeration shiro_f3100_0()
{    Set<String> keyNames = getKeyNames();    final Iterator iterator = keyNames.iterator();    return new Enumeration() {        public boolean hasMoreElements() {            return iterator.hasNext();        }        public Object nextElement() {            return iterator.next();        }    };}
public boolean shiro_f3101_0()
{    return iterator.hasNext();}
public Object shiro_f3102_0()
{    return iterator.next();}
public String[] shiro_f3103_0()
{    Set<String> keyNames = getKeyNames();    String[] array = new String[keyNames.size()];    if (keyNames.size() > 0) {        array = keyNames.toArray(array);    }    return array;}
protected void shiro_f3104_0(String s, Object o)
{    if (o instanceof HttpSessionBindingListener) {        HttpSessionBindingListener listener = (HttpSessionBindingListener) o;        HttpSessionBindingEvent event = new HttpSessionBindingEvent(this, s, o);        listener.valueBound(event);    }}
protected void shiro_f3105_0(String s, Object o)
{    if (o instanceof HttpSessionBindingListener) {        HttpSessionBindingListener listener = (HttpSessionBindingListener) o;        HttpSessionBindingEvent event = new HttpSessionBindingEvent(this, s, o);        listener.valueUnbound(event);    }}
public void shiro_f3106_0(String s, Object o)
{    try {        getSession().setAttribute(s, o);        afterBound(s, o);    } catch (InvalidSessionException e) {                try {            afterUnbound(s, o);        } finally {                        throw new IllegalStateException(e);        }    }}
public void shiro_f3107_0(String s, Object o)
{    setAttribute(s, o);}
public void shiro_f3108_0(String s)
{    try {        Object attribute = getSession().removeAttribute(s);        afterUnbound(s, attribute);    } catch (InvalidSessionException e) {        throw new IllegalStateException(e);    }}
public void shiro_f3109_0(String s)
{    removeAttribute(s);}
public void shiro_f3110_0()
{    try {        getSession().stop();    } catch (InvalidSessionException e) {        throw new IllegalStateException(e);    }}
public boolean shiro_f3111_0()
{    Boolean value = (Boolean) currentRequest.getAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_IS_NEW);    return value != null && value.equals(Boolean.TRUE);}
public String shiro_f3112_0()
{    return name;}
public void shiro_f3113_0(String name)
{    if (!StringUtils.hasText(name)) {        throw new IllegalArgumentException("Name cannot be null/empty.");    }    this.name = name;}
public String shiro_f3114_0()
{    return value;}
public void shiro_f3115_0(String value)
{    this.value = value;}
public String shiro_f3116_0()
{    return comment;}
public void shiro_f3117_0(String comment)
{    this.comment = comment;}
public String shiro_f3118_0()
{    return domain;}
public void shiro_f3119_0(String domain)
{    this.domain = domain;}
public String shiro_f3120_0()
{    return path;}
public void shiro_f3121_0(String path)
{    this.path = path;}
public int shiro_f3122_0()
{    return maxAge;}
public void shiro_f3123_0(int maxAge)
{    this.maxAge = Math.max(DEFAULT_MAX_AGE, maxAge);}
public int shiro_f3124_0()
{    return version;}
public void shiro_f3125_0(int version)
{    this.version = Math.max(DEFAULT_VERSION, version);}
public boolean shiro_f3126_0()
{    return secure;}
public void shiro_f3127_0(boolean secure)
{    this.secure = secure;}
public boolean shiro_f3128_0()
{    return httpOnly;}
public void shiro_f3129_0(boolean httpOnly)
{    this.httpOnly = httpOnly;}
public SameSiteOptions shiro_f3130_0()
{    return sameSite;}
public void shiro_f3131_0(SameSiteOptions sameSite)
{    this.sameSite = sameSite;}
private String shiro_f3132_0(HttpServletRequest request)
{    String path = StringUtils.clean(getPath());    if (!StringUtils.hasText(path)) {        path = StringUtils.clean(request.getContextPath());    }        if (path == null) {        path = ROOT_PATH;    }    log.trace("calculated path: {}", path);    return path;}
public void shiro_f3133_0(HttpServletRequest request, HttpServletResponse response)
{    String name = getName();    String value = getValue();    String comment = getComment();    String domain = getDomain();    String path = calculatePath(request);    int maxAge = getMaxAge();    int version = getVersion();    boolean secure = isSecure();    boolean httpOnly = isHttpOnly();    SameSiteOptions sameSite = getSameSite();    addCookieHeader(response, name, value, comment, domain, path, maxAge, version, secure, httpOnly, sameSite);}
private void shiro_f3134_1(HttpServletResponse response, String name, String value, String comment, String domain, String path, int maxAge, int version, boolean secure, boolean httpOnly, SameSiteOptions sameSite)
{    String headerValue = buildHeaderValue(name, value, comment, domain, path, maxAge, version, secure, httpOnly, sameSite);    response.addHeader(COOKIE_HEADER_NAME, headerValue);    if (log.isDebugEnabled()) {            }}
protected String shiro_f3135_0(String name, String value, String comment, String domain, String path, int maxAge, int version, boolean secure, boolean httpOnly)
{    return buildHeaderValue(name, value, comment, domain, path, maxAge, version, secure, httpOnly, getSameSite());}
protected String shiro_f3136_0(String name, String value, String comment, String domain, String path, int maxAge, int version, boolean secure, boolean httpOnly, SameSiteOptions sameSite)
{    if (!StringUtils.hasText(name)) {        throw new IllegalStateException("Cookie name cannot be null/empty.");    }    StringBuilder sb = new StringBuilder(name).append(NAME_VALUE_DELIMITER);    if (StringUtils.hasText(value)) {        sb.append(value);    }    appendComment(sb, comment);    appendDomain(sb, domain);    appendPath(sb, path);    appendExpires(sb, maxAge);    appendVersion(sb, version);    appendSecure(sb, secure);    appendHttpOnly(sb, httpOnly);    appendSameSite(sb, sameSite);    return sb.toString();}
private void shiro_f3137_0(StringBuilder sb, String comment)
{    if (StringUtils.hasText(comment)) {        sb.append(ATTRIBUTE_DELIMITER);        sb.append(COMMENT_ATTRIBUTE_NAME).append(NAME_VALUE_DELIMITER).append(comment);    }}
private void shiro_f3138_0(StringBuilder sb, String domain)
{    if (StringUtils.hasText(domain)) {        sb.append(ATTRIBUTE_DELIMITER);        sb.append(DOMAIN_ATTRIBUTE_NAME).append(NAME_VALUE_DELIMITER).append(domain);    }}
private void shiro_f3139_0(StringBuilder sb, String path)
{    if (StringUtils.hasText(path)) {        sb.append(ATTRIBUTE_DELIMITER);        sb.append(PATH_ATTRIBUTE_NAME).append(NAME_VALUE_DELIMITER).append(path);    }}
private void shiro_f3140_0(StringBuilder sb, int maxAge)
{        if (maxAge >= 0) {        sb.append(ATTRIBUTE_DELIMITER);        sb.append(MAXAGE_ATTRIBUTE_NAME).append(NAME_VALUE_DELIMITER).append(maxAge);        sb.append(ATTRIBUTE_DELIMITER);        Date expires;        if (maxAge == 0) {                        expires = new Date(System.currentTimeMillis() - DAY_MILLIS);        } else {                        Calendar cal = Calendar.getInstance();            cal.add(Calendar.SECOND, maxAge);            expires = cal.getTime();        }        String formatted = toCookieDate(expires);        sb.append(EXPIRES_ATTRIBUTE_NAME).append(NAME_VALUE_DELIMITER).append(formatted);    }}
private void shiro_f3141_0(StringBuilder sb, int version)
{    if (version > DEFAULT_VERSION) {        sb.append(ATTRIBUTE_DELIMITER);        sb.append(VERSION_ATTRIBUTE_NAME).append(NAME_VALUE_DELIMITER).append(version);    }}
private void shiro_f3142_0(StringBuilder sb, boolean secure)
{    if (secure) {        sb.append(ATTRIBUTE_DELIMITER);                sb.append(SECURE_ATTRIBUTE_NAME);    }}
private void shiro_f3143_0(StringBuilder sb, boolean httpOnly)
{    if (httpOnly) {        sb.append(ATTRIBUTE_DELIMITER);                sb.append(HTTP_ONLY_ATTRIBUTE_NAME);    }}
private void shiro_f3144_0(StringBuilder sb, SameSiteOptions sameSite)
{    if (sameSite != null) {        sb.append(ATTRIBUTE_DELIMITER);        sb.append(SAME_SITE_ATTRIBUTE_NAME).append(NAME_VALUE_DELIMITER).append(sameSite.toString().toLowerCase(Locale.ENGLISH));    }}
private boolean shiro_f3145_0(String cookiePath, String requestPath)
{    if (!requestPath.startsWith(cookiePath)) {        return false;    }    return requestPath.length() == cookiePath.length() || cookiePath.charAt(cookiePath.length() - 1) == '/' || requestPath.charAt(cookiePath.length()) == '/';}
private static String shiro_f3146_0(Date date)
{    TimeZone tz = TimeZone.getTimeZone(GMT_TIME_ZONE_ID);    DateFormat fmt = new SimpleDateFormat(COOKIE_DATE_FORMAT_STRING, Locale.US);    fmt.setTimeZone(tz);    return fmt.format(date);}
public void shiro_f3147_0(HttpServletRequest request, HttpServletResponse response)
{    String name = getName();    String value = DELETED_COOKIE_VALUE;        String comment = null;    String domain = getDomain();    String path = calculatePath(request);        int maxAge = 0;    int version = getVersion();    boolean secure = isSecure();        boolean httpOnly = false;    SameSiteOptions sameSite = null;    addCookieHeader(response, name, value, comment, domain, path, maxAge, version, secure, httpOnly, sameSite);    log.trace("Removed '{}' cookie by setting maxAge=0", name);}
public String shiro_f3148_1(HttpServletRequest request, HttpServletResponse ignored)
{    String name = getName();    String value = null;    javax.servlet.http.Cookie cookie = getCookie(request, name);    if (cookie != null) {                String path = StringUtils.clean(getPath());        if (path != null && !pathMatches(path, request.getRequestURI())) {                    } else {            value = cookie.getValue();                    }    } else {        log.trace("No '{}' cookie value", name);    }    return value;}
private static javax.servlet.http.Cookie shiro_f3149_0(HttpServletRequest request, String cookieName)
{    javax.servlet.http.Cookie[] cookies = request.getCookies();    if (cookies != null) {        for (javax.servlet.http.Cookie cookie : cookies) {            if (cookie.getName().equals(cookieName)) {                return cookie;            }        }    }    return null;}
public Serializable shiro_f3150_0()
{    return httpSession.getId();}
public Date shiro_f3151_0()
{    return new Date(httpSession.getCreationTime());}
public Date shiro_f3152_0()
{    return new Date(httpSession.getLastAccessedTime());}
public long shiro_f3153_0() throws InvalidSessionException
{    try {        return httpSession.getMaxInactiveInterval() * 1000L;    } catch (Exception e) {        throw new InvalidSessionException(e);    }}
public void shiro_f3154_0(long maxIdleTimeInMillis) throws InvalidSessionException
{    try {        int timeout = Long.valueOf(maxIdleTimeInMillis / 1000).intValue();        httpSession.setMaxInactiveInterval(timeout);    } catch (Exception e) {        throw new InvalidSessionException(e);    }}
protected void shiro_f3155_0(String host)
{    setAttribute(HOST_SESSION_KEY, host);}
public String shiro_f3156_0()
{    return (String) getAttribute(HOST_SESSION_KEY);}
public void shiro_f3157_0() throws InvalidSessionException
{        try {        httpSession.setAttribute(TOUCH_OBJECT_SESSION_KEY, TOUCH_OBJECT_SESSION_KEY);        httpSession.removeAttribute(TOUCH_OBJECT_SESSION_KEY);    } catch (Exception e) {        throw new InvalidSessionException(e);    }}
public void shiro_f3158_0() throws InvalidSessionException
{    try {        httpSession.invalidate();    } catch (Exception e) {        throw new InvalidSessionException(e);    }}
public Collection<Object> shiro_f3159_0() throws InvalidSessionException
{    try {        Enumeration namesEnum = httpSession.getAttributeNames();        Collection<Object> keys = null;        if (namesEnum != null) {            keys = new ArrayList<Object>();            while (namesEnum.hasMoreElements()) {                keys.add(namesEnum.nextElement());            }        }        return keys;    } catch (Exception e) {        throw new InvalidSessionException(e);    }}
private static String shiro_f3160_0(Object key)
{    if (!(key instanceof String)) {        String msg = "HttpSession based implementations of the Shiro Session interface requires attribute keys " + "to be String objects.  The HttpSession class does not support anything other than String keys.";        throw new IllegalArgumentException(msg);    }    return (String) key;}
public Object shiro_f3161_0(Object key) throws InvalidSessionException
{    try {        return httpSession.getAttribute(assertString(key));    } catch (Exception e) {        throw new InvalidSessionException(e);    }}
public void shiro_f3162_0(Object key, Object value) throws InvalidSessionException
{    try {        httpSession.setAttribute(assertString(key), value);    } catch (Exception e) {        throw new InvalidSessionException(e);    }}
public Object shiro_f3163_0(Object key) throws InvalidSessionException
{    try {        String sKey = assertString(key);        Object removed = httpSession.getAttribute(sKey);        httpSession.removeAttribute(sKey);        return removed;    } catch (Exception e) {        throw new InvalidSessionException(e);    }}
public void shiro_f3164_0(ServletRequest request)
{    if (request != null) {        put(SERVLET_REQUEST, request);    }}
public ServletRequest shiro_f3165_0()
{    return getTypedValue(SERVLET_REQUEST, ServletRequest.class);}
public void shiro_f3166_0(ServletResponse response)
{    if (response != null) {        put(SERVLET_RESPONSE, response);    }}
public ServletResponse shiro_f3167_0()
{    return getTypedValue(SERVLET_RESPONSE, ServletResponse.class);}
public Cookie shiro_f3168_0()
{    return sessionIdCookie;}
public void shiro_f3169_0(Cookie sessionIdCookie)
{    this.sessionIdCookie = sessionIdCookie;}
public boolean shiro_f3170_0()
{    return sessionIdCookieEnabled;}
public void shiro_f3171_0(boolean sessionIdCookieEnabled)
{    this.sessionIdCookieEnabled = sessionIdCookieEnabled;}
public boolean shiro_f3172_0()
{    return sessionIdUrlRewritingEnabled;}
public void shiro_f3173_0(boolean sessionIdUrlRewritingEnabled)
{    this.sessionIdUrlRewritingEnabled = sessionIdUrlRewritingEnabled;}
private void shiro_f3174_0(Serializable currentId, HttpServletRequest request, HttpServletResponse response)
{    if (currentId == null) {        String msg = "sessionId cannot be null when persisting for subsequent requests.";        throw new IllegalArgumentException(msg);    }    Cookie template = getSessionIdCookie();    Cookie cookie = new SimpleCookie(template);    String idString = currentId.toString();    cookie.setValue(idString);    cookie.saveTo(request, response);    log.trace("Set session ID cookie for session with id {}", idString);}
private void shiro_f3175_0(HttpServletRequest request, HttpServletResponse response)
{    getSessionIdCookie().removeFrom(request, response);}
private String shiro_f3176_1(ServletRequest request, ServletResponse response)
{    if (!isSessionIdCookieEnabled()) {                return null;    }    if (!(request instanceof HttpServletRequest)) {                return null;    }    HttpServletRequest httpRequest = (HttpServletRequest) request;    return getSessionIdCookie().readValue(httpRequest, WebUtils.toHttp(response));}
private Serializable shiro_f3177_0(ServletRequest request, ServletResponse response)
{    String id = getSessionIdCookieValue(request, response);    if (id != null) {        request.setAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_ID_SOURCE, ShiroHttpServletRequest.COOKIE_SESSION_ID_SOURCE);    } else {                        id = getUriPathSegmentParamValue(request, ShiroHttpSession.DEFAULT_SESSION_ID_NAME);        if (id == null) {                        String name = getSessionIdName();            id = request.getParameter(name);            if (id == null) {                                id = request.getParameter(name.toLowerCase());            }        }        if (id != null) {            request.setAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_ID_SOURCE, ShiroHttpServletRequest.URL_SESSION_ID_SOURCE);        }    }    if (id != null) {        request.setAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_ID, id);                        request.setAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_ID_IS_VALID, Boolean.TRUE);    }        request.setAttribute(ShiroHttpServletRequest.SESSION_ID_URL_REWRITING_ENABLED, isSessionIdUrlRewritingEnabled());    return id;}
private String shiro_f3178_0(ServletRequest servletRequest, String paramName)
{    if (!(servletRequest instanceof HttpServletRequest)) {        return null;    }    HttpServletRequest request = (HttpServletRequest) servletRequest;    String uri = request.getRequestURI();    if (uri == null) {        return null;    }    int queryStartIndex = uri.indexOf('?');    if (queryStartIndex >= 0) {                uri = uri.substring(0, queryStartIndex);    }        int index = uri.indexOf(';');    if (index < 0) {                return null;    }        final String TOKEN = paramName + "=";        uri = uri.substring(index + 1);        index = uri.lastIndexOf(TOKEN);    if (index < 0) {                return null;    }    uri = uri.substring(index + TOKEN.length());        index = uri.indexOf(';');    if (index >= 0) {        uri = uri.substring(0, index);    }        return uri;}
private String shiro_f3179_0()
{    String name = this.sessionIdCookie != null ? this.sessionIdCookie.getName() : null;    if (name == null) {        name = ShiroHttpSession.DEFAULT_SESSION_ID_NAME;    }    return name;}
protected Session shiro_f3180_0(Session session, SessionContext context)
{    if (!WebUtils.isWeb(context)) {        return super.createExposedSession(session, context);    }    ServletRequest request = WebUtils.getRequest(context);    ServletResponse response = WebUtils.getResponse(context);    SessionKey key = new WebSessionKey(session.getId(), request, response);    return new DelegatingSession(this, key);}
protected Session shiro_f3181_0(Session session, SessionKey key)
{    if (!WebUtils.isWeb(key)) {        return super.createExposedSession(session, key);    }    ServletRequest request = WebUtils.getRequest(key);    ServletResponse response = WebUtils.getResponse(key);    SessionKey sessionKey = new WebSessionKey(session.getId(), request, response);    return new DelegatingSession(this, sessionKey);}
protected void shiro_f3182_1(Session session, SessionContext context)
{    super.onStart(session, context);    if (!WebUtils.isHttp(context)) {                return;    }    HttpServletRequest request = WebUtils.getHttpRequest(context);    HttpServletResponse response = WebUtils.getHttpResponse(context);    if (isSessionIdCookieEnabled()) {        Serializable sessionId = session.getId();        storeSessionId(sessionId, request, response);    } else {            }    request.removeAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_ID_SOURCE);    request.setAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_IS_NEW, Boolean.TRUE);}
public Serializable shiro_f3183_0(SessionKey key)
{    Serializable id = super.getSessionId(key);    if (id == null && WebUtils.isWeb(key)) {        ServletRequest request = WebUtils.getRequest(key);        ServletResponse response = WebUtils.getResponse(key);        id = getSessionId(request, response);    }    return id;}
protected Serializable shiro_f3184_0(ServletRequest request, ServletResponse response)
{    return getReferencedSessionId(request, response);}
protected void shiro_f3185_0(Session s, ExpiredSessionException ese, SessionKey key)
{    super.onExpiration(s, ese, key);    onInvalidation(key);}
protected void shiro_f3186_0(Session session, InvalidSessionException ise, SessionKey key)
{    super.onInvalidation(session, ise, key);    onInvalidation(key);}
private void shiro_f3187_1(SessionKey key)
{    ServletRequest request = WebUtils.getRequest(key);    if (request != null) {        request.removeAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_ID_IS_VALID);    }    if (WebUtils.isHttp(key)) {                removeSessionIdCookie(WebUtils.getHttpRequest(key), WebUtils.getHttpResponse(key));    } else {            }}
protected void shiro_f3188_1(Session session, SessionKey key)
{    super.onStop(session, key);    if (WebUtils.isHttp(key)) {        HttpServletRequest request = WebUtils.getHttpRequest(key);        HttpServletResponse response = WebUtils.getHttpResponse(key);                removeSessionIdCookie(request, response);    } else {            }}
public boolean shiro_f3189_0()
{    return false;}
public Session shiro_f3190_0(SessionContext context) throws AuthorizationException
{    return createSession(context);}
public Session shiro_f3191_0(SessionKey key) throws SessionException
{    if (!WebUtils.isHttp(key)) {        String msg = "SessionKey must be an HTTP compatible implementation.";        throw new IllegalArgumentException(msg);    }    HttpServletRequest request = WebUtils.getHttpRequest(key);    Session session = null;    HttpSession httpSession = request.getSession(false);    if (httpSession != null) {        session = createSession(httpSession, request.getRemoteHost());    }    return session;}
private String shiro_f3192_0(SessionContext context)
{    String host = context.getHost();    if (host == null) {        ServletRequest request = WebUtils.getRequest(context);        if (request != null) {            host = request.getRemoteHost();        }    }    return host;}
protected Session shiro_f3193_0(SessionContext sessionContext) throws AuthorizationException
{    if (!WebUtils.isHttp(sessionContext)) {        String msg = "SessionContext must be an HTTP compatible implementation.";        throw new IllegalArgumentException(msg);    }    HttpServletRequest request = WebUtils.getHttpRequest(sessionContext);    HttpSession httpSession = request.getSession();            String host = getHost(sessionContext);    return createSession(httpSession, host);}
protected Session shiro_f3194_0(HttpSession httpSession, String host)
{    return new HttpServletSession(httpSession, host);}
public boolean shiro_f3195_0()
{    return true;}
public ServletRequest shiro_f3196_0()
{    return servletRequest;}
public ServletResponse shiro_f3197_0()
{    return servletResponse;}
public String shiro_f3198_0()
{    String host = super.resolveHost();    if (host == null) {        ServletRequest request = resolveServletRequest();        if (request != null) {            host = request.getRemoteHost();        }    }    return host;}
public ServletRequest shiro_f3199_0()
{    return getTypedValue(SERVLET_REQUEST, ServletRequest.class);}
public void shiro_f3200_0(ServletRequest request)
{    if (request != null) {        put(SERVLET_REQUEST, request);    }}
public ServletRequest shiro_f3201_0()
{    ServletRequest request = getServletRequest();        if (request == null) {        Subject existing = getSubject();        if (existing instanceof WebSubject) {            request = ((WebSubject) existing).getServletRequest();        }    }    return request;}
public ServletResponse shiro_f3202_0()
{    return getTypedValue(SERVLET_RESPONSE, ServletResponse.class);}
public void shiro_f3203_0(ServletResponse response)
{    if (response != null) {        put(SERVLET_RESPONSE, response);    }}
public ServletResponse shiro_f3204_0()
{    ServletResponse response = getServletResponse();        if (response == null) {        Subject existing = getSubject();        if (existing instanceof WebSubject) {            response = ((WebSubject) existing).getServletResponse();        }    }    return response;}
public ServletRequest shiro_f3205_0()
{    return servletRequest;}
public ServletResponse shiro_f3206_0()
{    return servletResponse;}
protected boolean shiro_f3207_0()
{    boolean enabled = super.isSessionCreationEnabled();    return enabled && WebUtils._isSessionCreationEnabled(this);}
protected SessionContext shiro_f3208_0()
{    WebSessionContext wsc = new DefaultWebSessionContext();    String host = getHost();    if (StringUtils.hasText(host)) {        wsc.setHost(host);    }    wsc.setServletRequest(this.servletRequest);    wsc.setServletResponse(this.servletResponse);    return wsc;}
protected SubjectContext shiro_f3209_0()
{    return new DefaultWebSubjectContext();}
protected Builder shiro_f3210_0(ServletRequest request)
{    if (request != null) {        ((WebSubjectContext) getSubjectContext()).setServletRequest(request);    }    return this;}
protected Builder shiro_f3211_0(ServletResponse response)
{    if (response != null) {        ((WebSubjectContext) getSubjectContext()).setServletResponse(response);    }    return this;}
public WebSubject shiro_f3212_0()
{    Subject subject = super.buildSubject();    if (!(subject instanceof WebSubject)) {        String msg = "Subject implementation returned from the SecurityManager was not a " + WebSubject.class.getName() + " implementation.  Please ensure a Web-enabled SecurityManager " + "has been configured and made available to this builder.";        throw new IllegalStateException(msg);    }    return (WebSubject) subject;}
public int shiro_f3213_0() throws JspException
{    if (getSubject() != null && getSubject().isAuthenticated()) {        if (log.isTraceEnabled()) {            log.trace("Subject exists and is authenticated.  Tag body will be evaluated.");        }        return TagSupport.EVAL_BODY_INCLUDE;    } else {        if (log.isTraceEnabled()) {            log.trace("Subject does not exist or is not authenticated.  Tag body will not be evaluated.");        }        return TagSupport.SKIP_BODY;    }}
public int shiro_f3214_0() throws JspException
{    if (getSubject() == null || getSubject().getPrincipal() == null) {        if (log.isTraceEnabled()) {            log.trace("Subject does not exist or does not have a known identity (aka 'principal').  " + "Tag body will be evaluated.");        }        return TagSupport.EVAL_BODY_INCLUDE;    } else {        if (log.isTraceEnabled()) {            log.trace("Subject exists or has a known identity (aka 'principal').  " + "Tag body will not be evaluated.");        }        return TagSupport.SKIP_BODY;    }}
protected boolean shiro_f3215_0(String roleNames)
{    boolean hasAnyRole = false;    Subject subject = getSubject();    if (subject != null) {                for (String role : roleNames.split(ROLE_NAMES_DELIMETER)) {            if (subject.hasRole(role.trim())) {                hasAnyRole = true;                break;            }        }    }    return hasAnyRole;}
protected boolean shiro_f3216_0(String p)
{    return isPermitted(p);}
protected boolean shiro_f3217_0(String roleName)
{    return getSubject() != null && getSubject().hasRole(roleName);}
protected boolean shiro_f3218_0(String p)
{    return !isPermitted(p);}
protected boolean shiro_f3219_0(String roleName)
{    boolean hasRole = getSubject() != null && getSubject().hasRole(roleName);    return !hasRole;}
public int shiro_f3220_0() throws JspException
{    if (getSubject() == null || !getSubject().isAuthenticated()) {        if (log.isTraceEnabled()) {            log.trace("Subject does not exist or is not authenticated.  Tag body will be evaluated.");        }        return TagSupport.EVAL_BODY_INCLUDE;    } else {        if (log.isTraceEnabled()) {            log.trace("Subject exists and is authenticated.  Tag body will not be evaluated.");        }        return TagSupport.SKIP_BODY;    }}
public String shiro_f3221_0()
{    return name;}
public void shiro_f3222_0(String name)
{    this.name = name;}
protected void shiro_f3223_0() throws JspException
{    String permission = getName();    if (permission == null || permission.length() == 0) {        String msg = "The 'name' tag attribute must be set.";        throw new JspException(msg);    }}
public int shiro_f3224_0() throws JspException
{    String p = getName();    boolean show = showTagBody(p);    if (show) {        return TagSupport.EVAL_BODY_INCLUDE;    } else {        return TagSupport.SKIP_BODY;    }}
protected boolean shiro_f3225_0(String p)
{    return getSubject() != null && getSubject().isPermitted(p);}
public String shiro_f3226_0()
{    return type;}
public void shiro_f3227_0(String type)
{    this.type = type;}
public String shiro_f3228_0()
{    return property;}
public void shiro_f3229_0(String property)
{    this.property = property;}
public String shiro_f3230_0()
{    return defaultValue;}
public void shiro_f3231_0(String defaultValue)
{    this.defaultValue = defaultValue;}
public int shiro_f3232_0() throws JspException
{    String strValue = null;    if (getSubject() != null) {                Object principal;        if (type == null) {            principal = getSubject().getPrincipal();        } else {            principal = getPrincipalFromClassName();        }                if (principal != null) {            if (property == null) {                strValue = principal.toString();            } else {                strValue = getPrincipalProperty(principal, property);            }        }    }        if (strValue != null) {        try {            pageContext.getOut().write(strValue);        } catch (IOException e) {            throw new JspTagException("Error writing [" + strValue + "] to JSP.", e);        }    }    return SKIP_BODY;}
private Object shiro_f3233_1()
{    Object principal = null;    try {        Class cls = Class.forName(type);        principal = getSubject().getPrincipals().oneByType(cls);    } catch (ClassNotFoundException e) {        if (log.isErrorEnabled()) {                    }    }    return principal;}
private String shiro_f3234_1(Object principal, String property) throws JspTagException
{    String strValue = null;    try {        BeanInfo bi = Introspector.getBeanInfo(principal.getClass());                boolean foundProperty = false;        for (PropertyDescriptor pd : bi.getPropertyDescriptors()) {            if (pd.getName().equals(property)) {                Object value = pd.getReadMethod().invoke(principal, (Object[]) null);                strValue = String.valueOf(value);                foundProperty = true;                break;            }        }        if (!foundProperty) {            final String message = "Property [" + property + "] not found in principal of type [" + principal.getClass().getName() + "]";            if (log.isErrorEnabled()) {                            }            throw new JspTagException(message);        }    } catch (Exception e) {        final String message = "Error reading property [" + property + "] from principal of type [" + principal.getClass().getName() + "]";        if (log.isErrorEnabled()) {                    }        throw new JspTagException(message, e);    }    return strValue;}
public String shiro_f3235_0()
{    return name;}
public void shiro_f3236_0(String name)
{    this.name = name;}
public int shiro_f3237_0() throws JspException
{    boolean show = showTagBody(getName());    if (show) {        return TagSupport.EVAL_BODY_INCLUDE;    } else {        return TagSupport.SKIP_BODY;    }}
protected Subject shiro_f3238_0()
{    return SecurityUtils.getSubject();}
protected void shiro_f3239_0() throws JspException
{}
public int shiro_f3240_0() throws JspException
{    verifyAttributes();    return onDoStartTag();}
public int shiro_f3241_0() throws JspException
{    if (getSubject() != null && getSubject().getPrincipal() != null) {        if (log.isTraceEnabled()) {            log.trace("Subject has known identity (aka 'principal').  " + "Tag body will be evaluated.");        }        return EVAL_BODY_INCLUDE;    } else {        if (log.isTraceEnabled()) {            log.trace("Subject does not exist or have a known identity (aka 'principal').  " + "Tag body will not be evaluated.");        }        return SKIP_BODY;    }}
public String shiro_f3242_0()
{    return url;}
public void shiro_f3243_0(String url)
{    this.url = url;}
public void shiro_f3244_0(boolean contextRelative)
{    this.contextRelative = contextRelative;}
public void shiro_f3245_0(boolean http10Compatible)
{    this.http10Compatible = http10Compatible;}
public void shiro_f3246_0(String encodingScheme)
{    this.encodingScheme = encodingScheme;}
public final void shiro_f3247_0(Map model, HttpServletRequest request, HttpServletResponse response) throws IOException
{        StringBuilder targetUrl = new StringBuilder();    if (this.contextRelative && getUrl().startsWith("/")) {                targetUrl.append(request.getContextPath());    }    targetUrl.append(getUrl());        appendQueryProperties(targetUrl, model, this.encodingScheme);    sendRedirect(request, response, targetUrl.toString(), this.http10Compatible);}
protected void shiro_f3248_0(StringBuilder targetUrl, Map model, String encodingScheme) throws UnsupportedEncodingException
{                String fragment = null;    int anchorIndex = targetUrl.toString().indexOf('#');    if (anchorIndex > -1) {        fragment = targetUrl.substring(anchorIndex);        targetUrl.delete(anchorIndex, targetUrl.length());    }        boolean first = (getUrl().indexOf('?') < 0);    Map queryProps = queryProperties(model);    if (queryProps != null) {        for (Object o : queryProps.entrySet()) {            if (first) {                targetUrl.append('?');                first = false;            } else {                targetUrl.append('&');            }            Map.Entry entry = (Map.Entry) o;            String encodedKey = urlEncode(entry.getKey().toString(), encodingScheme);            String encodedValue = (entry.getValue() != null ? urlEncode(entry.getValue().toString(), encodingScheme) : "");            targetUrl.append(encodedKey).append('=').append(encodedValue);        }    }        if (fragment != null) {        targetUrl.append(fragment);    }}
protected String shiro_f3249_0(String input, String encodingScheme) throws UnsupportedEncodingException
{    return URLEncoder.encode(input, encodingScheme);}
protected Map shiro_f3250_0(Map model)
{    return model;}
protected void shiro_f3251_0(HttpServletRequest request, HttpServletResponse response, String targetUrl, boolean http10Compatible) throws IOException
{    if (http10Compatible) {                response.sendRedirect(response.encodeRedirectURL(targetUrl));    } else {                response.setStatus(303);        response.setHeader("Location", response.encodeRedirectURL(targetUrl));    }}
public String shiro_f3252_0()
{    return method;}
public String shiro_f3253_0()
{    return queryString;}
public String shiro_f3254_0()
{    return requestURI;}
public String shiro_f3255_0()
{    StringBuilder requestUrl = new StringBuilder(getRequestURI());    if (getQueryString() != null) {        requestUrl.append("?").append(getQueryString());    }    return requestUrl.toString();}
public static String shiro_f3256_0(HttpServletRequest request)
{    String contextPath = getContextPath(request);    String requestUri = getRequestUri(request);    if (StringUtils.startsWithIgnoreCase(requestUri, contextPath)) {                String path = requestUri.substring(contextPath.length());        return (StringUtils.hasText(path) ? path : "/");    } else {                return requestUri;    }}
public static String shiro_f3257_0(HttpServletRequest request)
{    String uri = (String) request.getAttribute(INCLUDE_REQUEST_URI_ATTRIBUTE);    if (uri == null) {        uri = request.getRequestURI();    }    return normalize(decodeAndCleanUriString(request, uri));}
public static String shiro_f3258_0(String path)
{    return normalize(path, true);}
private static String shiro_f3259_0(String path, boolean replaceBackSlash)
{    if (path == null)        return null;        String normalized = path;    if (replaceBackSlash && normalized.indexOf('\\') >= 0)        normalized = normalized.replace('\\', '/');    if (normalized.equals("/."))        return "/";        if (!normalized.startsWith("/"))        normalized = "/" + normalized;        while (true) {        int index = normalized.indexOf("//");        if (index < 0)            break;        normalized = normalized.substring(0, index) + normalized.substring(index + 1);    }        while (true) {        int index = normalized.indexOf("/./");        if (index < 0)            break;        normalized = normalized.substring(0, index) + normalized.substring(index + 2);    }        while (true) {        int index = normalized.indexOf("/../");        if (index < 0)            break;        if (index == 0)                        return (null);        int index2 = normalized.lastIndexOf('/', index - 1);        normalized = normalized.substring(0, index2) + normalized.substring(index + 3);    }        return (normalized);}
private static String shiro_f3260_0(HttpServletRequest request, String uri)
{    uri = decodeRequestString(request, uri);    int semicolonIndex = uri.indexOf(';');    return (semicolonIndex != -1 ? uri.substring(0, semicolonIndex) : uri);}
public static String shiro_f3261_0(HttpServletRequest request)
{    String contextPath = (String) request.getAttribute(INCLUDE_CONTEXT_PATH_ATTRIBUTE);    if (contextPath == null) {        contextPath = request.getContextPath();    }    contextPath = normalize(decodeRequestString(request, contextPath));    if ("/".equals(contextPath)) {                contextPath = "";    }    return contextPath;}
public static WebEnvironment shiro_f3262_0(ServletContext sc) throws IllegalStateException
{    WebEnvironment we = getWebEnvironment(sc);    if (we == null) {        throw new IllegalStateException("No WebEnvironment found: no EnvironmentLoaderListener registered?");    }    return we;}
public static WebEnvironment shiro_f3263_0(ServletContext sc)
{    return getWebEnvironment(sc, EnvironmentLoader.ENVIRONMENT_ATTRIBUTE_KEY);}
public static WebEnvironment shiro_f3264_0(ServletContext sc, String attrName)
{    if (sc == null) {        throw new IllegalArgumentException("ServletContext argument must not be null.");    }    Object attr = sc.getAttribute(attrName);    if (attr == null) {        return null;    }    if (attr instanceof RuntimeException) {        throw (RuntimeException) attr;    }    if (attr instanceof Error) {        throw (Error) attr;    }    if (attr instanceof Exception) {        throw new IllegalStateException((Exception) attr);    }    if (!(attr instanceof WebEnvironment)) {        throw new IllegalStateException("Context attribute is not of type WebEnvironment: " + attr);    }    return (WebEnvironment) attr;}
protected static String shiro_f3266_0(HttpServletRequest request)
{    String enc = request.getCharacterEncoding();    if (enc == null) {        enc = DEFAULT_CHARACTER_ENCODING;    }    return enc;}
public static boolean shiro_f3267_0(Object requestPairSource)
{    return requestPairSource instanceof RequestPairSource && isWeb((RequestPairSource) requestPairSource);}
public static boolean shiro_f3268_0(Object requestPairSource)
{    return requestPairSource instanceof RequestPairSource && isHttp((RequestPairSource) requestPairSource);}
public static ServletRequest shiro_f3269_0(Object requestPairSource)
{    if (requestPairSource instanceof RequestPairSource) {        return ((RequestPairSource) requestPairSource).getServletRequest();    }    return null;}
public static ServletResponse shiro_f3270_0(Object requestPairSource)
{    if (requestPairSource instanceof RequestPairSource) {        return ((RequestPairSource) requestPairSource).getServletResponse();    }    return null;}
public static HttpServletRequest shiro_f3271_0(Object requestPairSource)
{    ServletRequest request = getRequest(requestPairSource);    if (request instanceof HttpServletRequest) {        return (HttpServletRequest) request;    }    return null;}
public static HttpServletResponse shiro_f3272_0(Object requestPairSource)
{    ServletResponse response = getResponse(requestPairSource);    if (response instanceof HttpServletResponse) {        return (HttpServletResponse) response;    }    return null;}
private static boolean shiro_f3273_0(RequestPairSource source)
{    ServletRequest request = source.getServletRequest();    ServletResponse response = source.getServletResponse();    return request != null && response != null;}
private static boolean shiro_f3274_0(RequestPairSource source)
{    ServletRequest request = source.getServletRequest();    ServletResponse response = source.getServletResponse();    return request instanceof HttpServletRequest && response instanceof HttpServletResponse;}
public static boolean shiro_f3275_0(Object requestPairSource)
{    if (requestPairSource instanceof RequestPairSource) {        RequestPairSource source = (RequestPairSource) requestPairSource;        return _isSessionCreationEnabled(source.getServletRequest());    }        return true;}
public static boolean shiro_f3276_0(ServletRequest request)
{    if (request != null) {        Object val = request.getAttribute(DefaultSubjectContext.SESSION_CREATION_ENABLED);        if (val != null && val instanceof Boolean) {            return (Boolean) val;        }    }        return true;}
public static HttpServletRequest shiro_f3277_0(ServletRequest request)
{    return (HttpServletRequest) request;}
public static HttpServletResponse shiro_f3278_0(ServletResponse response)
{    return (HttpServletResponse) response;}
public static void shiro_f3279_0(ServletRequest request, ServletResponse response, String url, Map queryParams, boolean contextRelative, boolean http10Compatible) throws IOException
{    RedirectView view = new RedirectView(url, contextRelative, http10Compatible);    view.renderMergedOutputModel(queryParams, toHttp(request), toHttp(response));}
public static void shiro_f3280_0(ServletRequest request, ServletResponse response, String url) throws IOException
{    issueRedirect(request, response, url, null, true, true);}
public static void shiro_f3281_0(ServletRequest request, ServletResponse response, String url, Map queryParams) throws IOException
{    issueRedirect(request, response, url, queryParams, true, true);}
public static void shiro_f3282_0(ServletRequest request, ServletResponse response, String url, Map queryParams, boolean contextRelative) throws IOException
{    issueRedirect(request, response, url, queryParams, contextRelative, true);}
public static boolean shiro_f3283_0(ServletRequest request, String paramName)
{    String value = getCleanParam(request, paramName);    return value != null && (value.equalsIgnoreCase("true") || value.equalsIgnoreCase("t") || value.equalsIgnoreCase("1") || value.equalsIgnoreCase("enabled") || value.equalsIgnoreCase("y") || value.equalsIgnoreCase("yes") || value.equalsIgnoreCase("on"));}
public static String shiro_f3284_0(ServletRequest request, String paramName)
{    return StringUtils.clean(request.getParameter(paramName));}
public static void shiro_f3285_0(ServletRequest request)
{    Subject subject = SecurityUtils.getSubject();    Session session = subject.getSession();    HttpServletRequest httpRequest = toHttp(request);    SavedRequest savedRequest = new SavedRequest(httpRequest);    session.setAttribute(SAVED_REQUEST_KEY, savedRequest);}
public static SavedRequest shiro_f3286_0(ServletRequest request)
{    SavedRequest savedRequest = getSavedRequest(request);    if (savedRequest != null) {        Subject subject = SecurityUtils.getSubject();        Session session = subject.getSession();        session.removeAttribute(SAVED_REQUEST_KEY);    }    return savedRequest;}
public static SavedRequest shiro_f3287_0(ServletRequest request)
{    SavedRequest savedRequest = null;    Subject subject = SecurityUtils.getSubject();    Session session = subject.getSession(false);    if (session != null) {        savedRequest = (SavedRequest) session.getAttribute(SAVED_REQUEST_KEY);    }    return savedRequest;}
public static void shiro_f3288_0(ServletRequest request, ServletResponse response, String fallbackUrl) throws IOException
{    String successUrl = null;    boolean contextRelative = true;    SavedRequest savedRequest = WebUtils.getAndClearSavedRequest(request);    if (savedRequest != null && savedRequest.getMethod().equalsIgnoreCase(AccessControlFilter.GET_METHOD)) {        successUrl = savedRequest.getRequestUrl();        contextRelative = false;    }    if (successUrl == null) {        successUrl = fallbackUrl;    }    if (successUrl == null) {        throw new IllegalStateException("Success URL not available via saved request or via the " + "successUrlFallback method parameter. One of these must be non-null for " + "issueSuccessRedirect() to work.");    }    WebUtils.issueRedirect(request, response, successUrl, null, contextRelative);}
public void shiro_f3289_0()
{    Ini ini = new Ini();            Ini.Section section = ini.addSection(IniSecurityManagerFactory.MAIN_SECTION_NAME);    section.put("authc.loginUrl", "/login.jsp");    WebIniSecurityManagerFactory factory = new WebIniSecurityManagerFactory(ini);    org.apache.shiro.mgt.SecurityManager sm = factory.getInstance();    assertNotNull(sm);    assertTrue(sm instanceof DefaultWebSecurityManager);        Map<String, ?> beans = factory.getBeans();    for (DefaultFilter defaultFilter : DefaultFilter.values()) {        Filter filter = (Filter) beans.get(defaultFilter.name());        assertNotNull(filter);        assertTrue(defaultFilter.getFilterClass().isAssignableFrom(filter.getClass()));    }}
public void shiro_f3290_0() throws Exception
{    List<WebEnvironmentStub> environmentList = Arrays.asList(new WebEnvironmentStub());    ServletContext servletContext = EasyMock.mock(ServletContext.class);    expect(servletContext.getInitParameter("shiroEnvironmentClass")).andReturn(null);    expect(servletContext.getInitParameter("shiroConfigLocations")).andReturn(null);    PowerMock.mockStaticPartialStrict(ServiceLoader.class, "load");    final ServiceLoader serviceLoader = PowerMock.createMock(ServiceLoader.class);    EasyMock.expect(ServiceLoader.load(WebEnvironment.class)).andReturn(serviceLoader);    EasyMock.expect(serviceLoader.iterator()).andReturn(environmentList.iterator());    EasyMock.replay(servletContext);    PowerMock.replayAll();    WebEnvironment resultEnvironment = new EnvironmentLoader().createEnvironment(servletContext);    PowerMock.verifyAll();    EasyMock.verify(servletContext);    assertThat(resultEnvironment, instanceOf(WebEnvironmentStub.class));    WebEnvironmentStub environmentStub = (WebEnvironmentStub) resultEnvironment;    assertThat(environmentStub.getServletContext(), sameInstance(servletContext));}
public void shiro_f3291_0() throws Exception
{    List<WebEnvironmentStub> environmentList = Arrays.asList(new WebEnvironmentStub(), new WebEnvironmentStub());    ServletContext servletContext = EasyMock.mock(ServletContext.class);    expect(servletContext.getInitParameter("shiroEnvironmentClass")).andReturn(null);    PowerMock.mockStaticPartialStrict(ServiceLoader.class, "load");    final ServiceLoader serviceLoader = PowerMock.createMock(ServiceLoader.class);    EasyMock.expect(ServiceLoader.load(WebEnvironment.class)).andReturn(serviceLoader);    EasyMock.expect(serviceLoader.iterator()).andReturn(environmentList.iterator());    EasyMock.replay(servletContext);    PowerMock.replayAll();    try {        new EnvironmentLoader().createEnvironment(servletContext);        Assert.fail("Expected ConfigurationException to be thrown");    } catch (ConfigurationException e) {        assertThat(e.getMessage(), stringContainsInOrder("zero or exactly one", "shiroEnvironmentClass"));    }    PowerMock.verifyAll();    EasyMock.verify(servletContext);}
public void shiro_f3292_0() throws Exception
{    ServletContext servletContext = EasyMock.mock(ServletContext.class);    expect(servletContext.getInitParameter("shiroEnvironmentClass")).andReturn(WebEnvironmentStub.class.getName());    expect(servletContext.getInitParameter("shiroConfigLocations")).andReturn(null);    PowerMock.mockStaticPartialStrict(ServiceLoader.class, "load");    EasyMock.replay(servletContext);    PowerMock.replayAll();    WebEnvironment resultEnvironment = new EnvironmentLoader().createEnvironment(servletContext);    PowerMock.verifyAll();    EasyMock.verify(servletContext);    assertThat(resultEnvironment, instanceOf(WebEnvironmentStub.class));    WebEnvironmentStub environmentStub = (WebEnvironmentStub) resultEnvironment;    assertThat(environmentStub.getServletContext(), sameInstance(servletContext));}
public FilterChainResolver shiro_f3293_0()
{    return filterChainResolver;}
public void shiro_f3294_0(FilterChainResolver filterChainResolver)
{    this.filterChainResolver = filterChainResolver;}
public ServletContext shiro_f3295_0()
{    return servletContext;}
public void shiro_f3296_0(ServletContext servletContext)
{    this.servletContext = servletContext;}
public WebSecurityManager shiro_f3297_0()
{    return webSecurityManager;}
public void shiro_f3298_0(WebSecurityManager webSecurityManager)
{    this.webSecurityManager = webSecurityManager;}
public SecurityManager shiro_f3299_0()
{    return getWebSecurityManager();}
public void shiro_f3300_0()
{    AnonymousFilter filter = new AnonymousFilter();    boolean allow = filter.onPreHandle(null, null, null);    assertTrue(allow);}
public void shiro_f3301_0()
{}
public void shiro_f3302_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(null);    expect(request.getRemoteHost()).andReturn("localhost");    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(request);    replay(response);    AuthenticationToken token = testFilter.createToken(request, response);    assertNotNull(token);    assertTrue("Token is not a username and password token.", token instanceof UsernamePasswordToken);    assertEquals("", token.getPrincipal());    verify(request);    verify(response);}
public void shiro_f3303_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("", ""));    expect(request.getRemoteHost()).andReturn("localhost");    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(request);    replay(response);    AuthenticationToken token = testFilter.createToken(request, response);    assertNotNull(token);    assertTrue("Token is not a username and password token.", token instanceof UsernamePasswordToken);    assertEquals("", token.getPrincipal());    verify(request);    verify(response);}
public void shiro_f3304_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro", ""));    expect(request.getRemoteHost()).andReturn("localhost");    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(request);    replay(response);    AuthenticationToken token = testFilter.createToken(request, response);    assertNotNull(token);    assertTrue("Token is not a username and password token.", token instanceof UsernamePasswordToken);    UsernamePasswordToken upToken = (UsernamePasswordToken) token;    assertEquals("pedro", upToken.getUsername());    assertEquals("Password is not empty.", 0, upToken.getPassword().length);    verify(request);    verify(response);}
public void shiro_f3305_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro", "pass:word"));    expect(request.getRemoteHost()).andReturn("localhost");    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(request);    replay(response);    AuthenticationToken token = testFilter.createToken(request, response);    assertNotNull(token);    assertTrue("Token is not a username and password token.", token instanceof UsernamePasswordToken);    UsernamePasswordToken upToken = (UsernamePasswordToken) token;    assertEquals("pedro", upToken.getUsername());    assertEquals("pass:word", new String(upToken.getPassword()));    verify(request);    verify(response);}
public void shiro_f3306_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getMethod()).andReturn("GET");    replay(request);    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(response);    boolean accessAllowed = testFilter.isAccessAllowed(request, response, new String[] { "POST", "PUT", "DELETE" });    assertTrue("Access not allowed for GET", accessAllowed);}
public void shiro_f3307_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro", ""));    expect(request.getRemoteHost()).andReturn("localhost");    expect(request.getMethod()).andReturn("POST");    replay(request);    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(response);    boolean accessAllowed = testFilter.isAccessAllowed(request, response, new String[] { "POST", "PUT", "DELETE" });    assertTrue("Access allowed for POST", !accessAllowed);}
public void shiro_f3308_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getMethod()).andReturn("GET");    expect(request.getMethod()).andReturn("post");    expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro", "")).anyTimes();    expect(request.getRemoteHost()).andReturn("localhost").anyTimes();    replay(request);    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(response);    boolean accessAllowed = testFilter.isAccessAllowed(request, response, new String[] { "POST", "put", "delete" });    assertTrue("Access not allowed for GET", accessAllowed);    accessAllowed = testFilter.isAccessAllowed(request, response, new String[] { "post", "put", "delete" });    assertTrue("Access allowed for POST", !accessAllowed);}
public void shiro_f3309_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro", "")).anyTimes();    expect(request.getRemoteHost()).andReturn("localhost").anyTimes();    expect(request.getMethod()).andReturn("GET");    expect(request.getMethod()).andReturn("POST");    replay(request);    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(response);    boolean accessAllowed = testFilter.isAccessAllowed(request, response, new String[0]);    assertTrue("Access allowed for GET", !accessAllowed);    accessAllowed = testFilter.isAccessAllowed(request, response, new String[0]);    assertTrue("Access allowed for POST", !accessAllowed);}
public void shiro_f3310_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro", "")).anyTimes();    expect(request.getRemoteHost()).andReturn("localhost").anyTimes();    expect(request.getMethod()).andReturn("GET");    expect(request.getMethod()).andReturn("POST");    replay(request);    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(response);    boolean accessAllowed = testFilter.isAccessAllowed(request, response, null);    assertTrue("Access allowed for GET", !accessAllowed);    accessAllowed = testFilter.isAccessAllowed(request, response, null);    assertTrue("Access allowed for POST", !accessAllowed);}
public void shiro_f3311_0()
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro", "")).anyTimes();    expect(request.getRemoteHost()).andReturn("localhost").anyTimes();    expect(request.getMethod()).andReturn("GET");    replay(request);    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(response);    String[] mappedValue = { "permissive" };    boolean accessAllowed = testFilter.isAccessAllowed(request, response, mappedValue);        assertTrue("Access allowed for GET", !accessAllowed);}
public void shiro_f3312_0()
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(null).anyTimes();    expect(request.getRemoteHost()).andReturn("localhost").anyTimes();    expect(request.getMethod()).andReturn("GET");    replay(request);    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(response);    String[] mappedValue = { "permissive" };    boolean accessAllowed = testFilter.isAccessAllowed(request, response, mappedValue);        assertTrue("Access should be allowed for GET", accessAllowed);}
public void shiro_f3313_0() throws Exception
{    testFilter = new BasicHttpAuthenticationFilter();    HttpServletRequest request = createMock(HttpServletRequest.class);    expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro", ""));    expect(request.getRemoteHost()).andReturn("localhost");    expect(request.getMethod()).andReturn("POST");    replay(request);    HttpServletResponse response = createMock(HttpServletResponse.class);    replay(response);    boolean accessAllowed = testFilter.isAccessAllowed(request, response, new String[] { "permissive", "POST", "PUT", "DELETE" });    assertTrue("Access allowed for POST", !accessAllowed);}
private String shiro_f3314_0(String username, String password)
{    return "Basic " + new String(Base64.encode((username + ":" + password).getBytes()));}
public void shiro_f3315_0() throws IOException
{                SecurityUtils.getSubject().login(new UsernamePasswordToken("test", "test"));    AuthorizationFilter filter = new AuthorizationFilter() {        @Override        protected boolean isAccessAllowed(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception {                        return false;        }    };    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    response.sendError(HttpServletResponse.SC_UNAUTHORIZED);    replay(response);    filter.onAccessDenied(request, response);    verify(response);}
protected boolean shiro_f3316_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{        return false;}
public void shiro_f3317_0() throws IOException
{                SecurityUtils.getSubject().login(new UsernamePasswordToken("test", "test"));    String unauthorizedUrl = "unauthorized.jsp";    AuthorizationFilter filter = new AuthorizationFilter() {        @Override        protected boolean isAccessAllowed(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception {                        return false;        }    };    filter.setUnauthorizedUrl(unauthorizedUrl);    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    expect(request.getContextPath()).andReturn("/").anyTimes();    String encoded = "/" + unauthorizedUrl;    expect(response.encodeRedirectURL(unauthorizedUrl)).andReturn(encoded);    response.sendRedirect(encoded);    replay(request);    replay(response);    filter.onAccessDenied(request, response);    verify(request);    verify(response);}
protected boolean shiro_f3318_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{        return false;}
public void shiro_f3319_0()
{    Pattern p = Pattern.compile(HostFilter.PRIVATE_CLASS_C_REGEX);    String base = "192.168.";    for (int i = 0; i < 256; i++) {        String ibase = base + i;        for (int j = 0; j < 256; j++) {            String ip = ibase + "." + j;            assertTrue(p.matcher(ip).matches());        }    }}
public void shiro_f3320_0()
{    Pattern p = Pattern.compile(HostFilter.PRIVATE_CLASS_B_REGEX);    String base = "172.";    for (int i = 16; i < 32; i++) {        String ibase = base + i;        for (int j = 0; j < 256; j++) {            String jBase = ibase + "." + j;            for (int k = 0; k < 256; k++) {                String ip = jBase + "." + k;                assertTrue(p.matcher(ip).matches());            }        }    }}
public void shiro_f3321_0()
{        HttpMethodPermissionFilter filter = new HttpMethodPermissionFilter();    String[] permsBefore = { "foo", "bar" };    String[] permsAfter = filter.buildPermissions(permsBefore, filter.getHttpMethodAction("get"));    Assert.assertEquals(2, permsAfter.length);    Assert.assertEquals("foo:read", permsAfter[0]);    Assert.assertEquals("bar:read", permsAfter[1]);    Assert.assertEquals("foo:read", filter.buildPermissions(permsBefore, filter.getHttpMethodAction("head"))[0]);    Assert.assertEquals("foo:update", filter.buildPermissions(permsBefore, filter.getHttpMethodAction("put"))[0]);    Assert.assertEquals("foo:create", filter.buildPermissions(permsBefore, filter.getHttpMethodAction("post"))[0]);    Assert.assertEquals("foo:create", filter.buildPermissions(permsBefore, filter.getHttpMethodAction("mkcol"))[0]);    Assert.assertEquals("foo:delete", filter.buildPermissions(permsBefore, filter.getHttpMethodAction("delete"))[0]);    Assert.assertEquals("foo:read", filter.buildPermissions(permsBefore, filter.getHttpMethodAction("options"))[0]);    Assert.assertEquals("foo:read", filter.buildPermissions(permsBefore, filter.getHttpMethodAction("trace"))[0]);}
protected HttpServletRequest shiro_f3322_0()
{    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    expect(request.getScheme()).andReturn("http");    expect(request.getServerName()).andReturn("localhost");    expect(request.getRequestURI()).andReturn("/");    return request;}
public void shiro_f3323_0() throws Exception
{    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    HttpServletRequest request = createBaseMockRequest();    expect(response.encodeRedirectURL(eq("http://localhost/"))).andReturn("http://localhost/");    replay(request);    replay(response);    PortFilter filter = new PortFilter();    boolean result = filter.onAccessDenied(request, response, null);    verify(request);    verify(response);    assertFalse(result);}
public void shiro_f3324_0() throws Exception
{    int port = 8080;    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    HttpServletRequest request = createBaseMockRequest();    String expected = "http://localhost:" + port + "/";    expect(response.encodeRedirectURL(eq(expected))).andReturn(expected);    replay(request);    replay(response);    PortFilter filter = new PortFilter();    filter.setPort(port);    boolean result = filter.onAccessDenied(request, response, null);    verify(request);    verify(response);    assertFalse(result);}
public void shiro_f3325_0()
{    resolver = new PathMatchingFilterChainResolver();}
public void shiro_f3326_0()
{    assertNotNull(resolver.getPathMatcher());    assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);    assertNotNull(resolver.getFilterChainManager());    assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);}
public void shiro_f3327_0()
{    FilterConfig mock = createNiceMockFilterConfig();    replay(mock);    resolver = new PathMatchingFilterChainResolver(mock);    assertNotNull(resolver.getPathMatcher());    assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);    assertNotNull(resolver.getFilterChainManager());    assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);    assertEquals(((DefaultFilterChainManager) resolver.getFilterChainManager()).getFilterConfig(), mock);    verify(mock);}
public void shiro_f3328_0()
{    resolver.setPathMatcher(new AntPathMatcher());    assertNotNull(resolver.getPathMatcher());    assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);    resolver.setFilterChainManager(new DefaultFilterChainManager());    assertNotNull(resolver.getFilterChainManager());    assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);}
public void shiro_f3329_0()
{    ServletRequest request = createNiceMock(HttpServletRequest.class);    ServletResponse response = createNiceMock(HttpServletResponse.class);    FilterChain chain = createNiceMock(FilterChain.class);    FilterChain resolved = resolver.getChain(request, response, chain);    assertNull(resolved);}
public void shiro_f3330_0()
{    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    FilterChain chain = createNiceMock(FilterChain.class);        resolver.getFilterChainManager().addToChain("/index.html", "authcBasic");    expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn(null).anyTimes();    expect(request.getContextPath()).andReturn("");    expect(request.getRequestURI()).andReturn("/index.html");    replay(request);    FilterChain resolved = resolver.getChain(request, response, chain);    assertNotNull(resolved);    verify(request);}
public void shiro_f3331_0()
{    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    FilterChain chain = createNiceMock(FilterChain.class);        resolver.getFilterChainManager().addToChain("/index.html", "authcBasic");    expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn(null).anyTimes();    expect(request.getContextPath()).andReturn("");    expect(request.getRequestURI()).andReturn("/./index.html");    replay(request);    FilterChain resolved = resolver.getChain(request, response, chain);    assertNotNull(resolved);    verify(request);}
public void shiro_f3332_0()
{    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    FilterChain chain = createNiceMock(FilterChain.class);        resolver.getFilterChainManager().addToChain("/index.html", "authcBasic");    expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn(null).anyTimes();    expect(request.getContextPath()).andReturn("");    expect(request.getRequestURI()).andReturn("/public/../index.html");    replay(request);    FilterChain resolved = resolver.getChain(request, response, chain);    assertNotNull(resolved);    verify(request);}
public void shiro_f3333_0()
{    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    HttpServletResponse response = createNiceMock(HttpServletResponse.class);    FilterChain chain = createNiceMock(FilterChain.class);        resolver.getFilterChainManager().addToChain("/index.html", "authcBasic");    expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn(null).anyTimes();    expect(request.getContextPath()).andReturn("");    expect(request.getRequestURI()).andReturn("/");    replay(request);    FilterChain resolved = resolver.getChain(request, response, chain);    assertNull(resolved);    verify(request);}
public void shiro_f3334_0()
{    @SuppressWarnings({ "MismatchedQueryAndUpdateOfCollection" })    SimpleNamedFilterList list = new SimpleNamedFilterList("test");    assertNotNull(list.getName());    assertEquals("test", list.getName());}
public void shiro_f3335_0()
{    new SimpleNamedFilterList(null);}
public void shiro_f3336_0()
{    new SimpleNamedFilterList("test", new ArrayList<Filter>());}
public void shiro_f3337_0()
{    new SimpleNamedFilterList("test", null);}
public void shiro_f3338_0()
{    FilterChain mock = createNiceMock(FilterChain.class);    Filter filter = createNiceMock(Filter.class);    NamedFilterList list = new SimpleNamedFilterList("test");    list.add(filter);    FilterChain chain = list.proxy(mock);    assertNotNull(chain);    assertNotSame(mock, chain);    Filter singleFilter = new SslFilter();    List<? extends Filter> multipleFilters = CollectionUtils.asList(new PortFilter(), new UserFilter());    list.add(0, singleFilter);    assertEquals(2, list.size());    assertTrue(list.get(0) instanceof SslFilter);    assertTrue(Arrays.equals(list.toArray(), new Object[] { singleFilter, filter }));    list.addAll(multipleFilters);    assertEquals(4, list.size());    assertTrue(list.get(2) instanceof PortFilter);    assertTrue(list.get(3) instanceof UserFilter);    list.addAll(0, CollectionUtils.asList(new PermissionsAuthorizationFilter(), new RolesAuthorizationFilter()));    assertEquals(6, list.size());    assertTrue(list.get(0) instanceof PermissionsAuthorizationFilter);    assertTrue(list.get(1) instanceof RolesAuthorizationFilter);    assertEquals(2, list.indexOf(singleFilter));    assertEquals(multipleFilters, list.subList(4, list.size()));    assertTrue(list.contains(singleFilter));    assertTrue(list.containsAll(multipleFilters));    assertFalse(list.isEmpty());    list.clear();    assertTrue(list.isEmpty());    list.add(singleFilter);    Iterator i = list.iterator();    assertTrue(i.hasNext());    assertEquals(i.next(), singleFilter);    ListIterator li = list.listIterator();    assertTrue(li.hasNext());    assertEquals(li.next(), singleFilter);    li = list.listIterator(0);    assertTrue(li.hasNext());    assertEquals(li.next(), singleFilter);    list.set(0, singleFilter);    assertEquals(list.get(0), singleFilter);    Filter[] filters = new Filter[list.size()];    filters = list.toArray(filters);    assertEquals(1, filters.length);    assertEquals(filters[0], singleFilter);    assertEquals(0, list.lastIndexOf(singleFilter));    list.remove(singleFilter);    assertTrue(list.isEmpty());    list.add(singleFilter);    list.remove(0);    assertTrue(list.isEmpty());    list.add(singleFilter);    list.addAll(multipleFilters);    assertEquals(3, list.size());    list.removeAll(multipleFilters);    assertEquals(1, list.size());    assertEquals(list.get(0), singleFilter);    list.addAll(multipleFilters);    assertEquals(3, list.size());    list.retainAll(multipleFilters);    assertEquals(2, list.size());        assertEquals(new ArrayList(list), multipleFilters);}
public void shiro_f3339_0()
{    request = createNiceMock(HttpServletRequest.class);    response = createNiceMock(ServletResponse.class);    filter = createTestInstance();}
private PathMatchingFilter shiro_f3340_0()
{    final String NAME = "pathMatchingFilter";    PathMatchingFilter filter = new PathMatchingFilter() {        @Override        protected boolean isEnabled(ServletRequest request, ServletResponse response, String path, Object mappedValue) throws Exception {            return !path.equals(DISABLED_PATH);        }        @Override        protected boolean onPreHandle(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception {                        return false;        }    };    filter.setName(NAME);    return filter;}
protected boolean shiro_f3341_0(ServletRequest request, ServletResponse response, String path, Object mappedValue) throws Exception
{    return !path.equals(DISABLED_PATH);}
protected boolean shiro_f3342_0(ServletRequest request, ServletResponse response, Object mappedValue) throws Exception
{        return false;}
public void shiro_f3343_0() throws Exception
{    filter.processPathConfig(DISABLED_PATH, null);    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    ServletResponse response = createNiceMock(ServletResponse.class);    expect(request.getContextPath()).andReturn(CONTEXT_PATH).anyTimes();    expect(request.getRequestURI()).andReturn(DISABLED_PATH).anyTimes();    replay(request);    boolean continueFilterChain = filter.preHandle(request, response);    assertTrue("FilterChain should continue.", continueFilterChain);    verify(request);}
public void shiro_f3344_0() throws Exception
{            filter.processPathConfig(DISABLED_PATH, null);    filter.processPathConfig(ENABLED_PATH, null);    HttpServletRequest request = createNiceMock(HttpServletRequest.class);    ServletResponse response = createNiceMock(ServletResponse.class);    expect(request.getContextPath()).andReturn(CONTEXT_PATH).anyTimes();    expect(request.getRequestURI()).andReturn(ENABLED_PATH).anyTimes();    replay(request);    boolean continueFilterChain = filter.preHandle(request, response);    assertFalse("FilterChain should NOT continue.", continueFilterChain);    verify(request);}
public void shiro_f3345_0()
{    ThreadContext.remove();}
public void shiro_f3346_0()
{    HttpServletRequest mockRequest = createNiceMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createNiceMock(HttpServletResponse.class);    WebSubject mockSubject = createNiceMock(WebSubject.class);    expect(mockSubject.getServletRequest()).andReturn(mockRequest).anyTimes();    expect(mockSubject.getServletResponse()).andReturn(mockResponse).anyTimes();    CookieRememberMeManager mgr = new CookieRememberMeManager();    org.apache.shiro.web.servlet.Cookie cookie = createMock(org.apache.shiro.web.servlet.Cookie.class);    mgr.setCookie(cookie);        cookie.removeFrom(isA(HttpServletRequest.class), isA(HttpServletResponse.class));        expect(cookie.getName()).andReturn("rememberMe");    expect(cookie.getValue()).andReturn(null);    expect(cookie.getComment()).andReturn(null);    expect(cookie.getDomain()).andReturn(null);    expect(cookie.getPath()).andReturn(null);    expect(cookie.getMaxAge()).andReturn(SimpleCookie.DEFAULT_MAX_AGE);    expect(cookie.getVersion()).andReturn(SimpleCookie.DEFAULT_VERSION);    expect(cookie.isSecure()).andReturn(false);    expect(cookie.isHttpOnly()).andReturn(true);    expect(cookie.getSameSite()).andReturn(org.apache.shiro.web.servlet.Cookie.SameSiteOptions.LAX);    UsernamePasswordToken token = new UsernamePasswordToken("user", "secret");    token.setRememberMe(true);    AuthenticationInfo account = new SimpleAuthenticationInfo("user", "secret", "test");    replay(mockSubject);    replay(mockRequest);    replay(cookie);    mgr.onSuccessfulLogin(mockSubject, token, account);    verify(mockRequest);    verify(mockSubject);    verify(cookie);}
public void shiro_f3347_0()
{    HttpServletRequest mockRequest = createMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createMock(HttpServletResponse.class);    WebSubjectContext context = new DefaultWebSubjectContext();    context.setServletRequest(mockRequest);    context.setServletResponse(mockResponse);    expect(mockRequest.getAttribute(ShiroHttpServletRequest.IDENTITY_REMOVED_KEY)).andReturn(null);    Cookie[] cookies = new Cookie[] { new Cookie(CookieRememberMeManager.DEFAULT_REMEMBER_ME_COOKIE_NAME, org.apache.shiro.web.servlet.Cookie.DELETED_COOKIE_VALUE) };    expect(mockRequest.getCookies()).andReturn(cookies);    replay(mockRequest);    CookieRememberMeManager mgr = new CookieRememberMeManager();    assertNull(mgr.getRememberedSerializedIdentity(context));}
public void shiro_f3348_0()
{    HttpServletRequest mockRequest = createMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createMock(HttpServletResponse.class);    WebSubjectContext context = new DefaultWebSubjectContext();    context.setServletRequest(mockRequest);    context.setServletResponse(mockResponse);    expect(mockRequest.getAttribute(ShiroHttpServletRequest.IDENTITY_REMOVED_KEY)).andReturn(null);            final String userPCAesBase64 = "WlD5MLzzZznN3dQ1lPJO/eScSuY245k29aECNmjUs31o7Yu478hWhaM5Sj" + "jmoe900/72JNu3hcJaPG6Q17Vuz4F8x0kBjbFnPVx4PqzsZYT6yreeS2jwO6OwfI+efqXOKyB2a5KPtnr" + "7jt5kZsyH38XJISb81cf6xqTGUru8zC+kNqJFz7E5RpO0kraBofS5jhMm45gDVjDRkjgPJAzocVWMtrza" + "zy67P8eb+kMSBCqGI251JTNAGboVgQ28KjfaAJ/6LXRJUj7kB7CGia7mgRk+hxzEJGDs81at5VOPqODJr" + "xb8tcIdemFUFIkiYVP9bGs4dP3ECtmw7aNrCzv+84sx3vRFUrd5DbDYpEuE12hF2Y9owDK9sxStbXoF0y" + "A32dhfGDIqS+agsass0sWn8WX2TM9i8SxrUjiFbxqyIG49HbqGrZp5QLM9IuIwO+TzGfF1FzumQGdwmWT" + "xkVapw5UESl34YvA615cb+82ue1I=";    Cookie[] cookies = new Cookie[] { new Cookie(CookieRememberMeManager.DEFAULT_REMEMBER_ME_COOKIE_NAME, userPCAesBase64) };    expect(mockRequest.getCookies()).andReturn(cookies);    replay(mockRequest);    CookieRememberMeManager mgr = new CookieRememberMeManager();    mgr.setCipherKey(Base64.decode("kPH+bIxk5D2deZiIxcaaaA=="));    PrincipalCollection collection = mgr.getRememberedPrincipals(context);    verify(mockRequest);    assertTrue(collection != null);        assertTrue(collection.iterator().next().equals("user"));}
public void shiro_f3349_0()
{    HttpServletRequest mockRequest = createMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createMock(HttpServletResponse.class);    WebSubjectContext context = new DefaultWebSubjectContext();    context.setServletRequest(mockRequest);    context.setServletResponse(mockResponse);    expect(mockRequest.getAttribute(ShiroHttpServletRequest.IDENTITY_REMOVED_KEY)).andReturn(null);    expect(mockRequest.getContextPath()).andReturn("/test");            final String userPCAesBase64 = "WlD5MLzzZznN3dQ1lPJO/eScSuY245k29aECNmjUs31o7Yu478hWhaM5Sj" + "jmoe900/72JNu3hcJaPG6Q17Vuz4F8x0kBjbFnPVx4PqzsZYT6yreeS2jwO6OwfI+efqXOKyB2a5KPtnr" + "7jt5kZsyH38XJISb81cf6xqTGUru8zC+kNqJFz7E5RpO0kraBofS5jhMm45gDVjDRkjgPJAzocVWMtrza" + "zy67P8eb+kMSBCqGI251JTNAGboVgQ28KjfaAJ/6LXRJUj7kB7CGia7mgRk+hxzEJGDs81at5VOPqODJr" + "xb8tcIdemFUFIkiYVP9bGs4dP3ECtmw7aNrCzv+84sx3vRFUrd5DbDYpEuE12hF2Y9owDK9sxStbXoF0y" + "A32dhfGDIqS+agsass0sWn8WX2TM9i8SxrUjiFbxqyIG49HbqGrZp5QLM9IuIwO+TzGfF1FzumQGdwmWT" + "xkVapw5UESl34YvA615cb+82ue1I=";    Cookie[] cookies = new Cookie[] { new Cookie(CookieRememberMeManager.DEFAULT_REMEMBER_ME_COOKIE_NAME, userPCAesBase64) };    expect(mockRequest.getCookies()).andReturn(cookies);    replay(mockRequest);    CookieRememberMeManager mgr = new CookieRememberMeManager();                mgr.getRememberedPrincipals(context);}
public void shiro_f3350_0()
{    HttpServletRequest mockRequest = createNiceMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createNiceMock(HttpServletResponse.class);    WebSubjectContext context = new DefaultWebSubjectContext();    context.setServletRequest(mockRequest);    context.setServletResponse(mockResponse);    expect(mockRequest.getAttribute(ShiroHttpServletRequest.IDENTITY_REMOVED_KEY)).andReturn(null);        final String userPCAesBase64 = "garbage";    Cookie[] cookies = new Cookie[] { new Cookie(CookieRememberMeManager.DEFAULT_REMEMBER_ME_COOKIE_NAME, userPCAesBase64) };    expect(mockRequest.getCookies()).andReturn(cookies).anyTimes();    replay(mockRequest);    CookieRememberMeManager mgr = new CookieRememberMeManager();    try {        mgr.getRememberedPrincipals(context);    } catch (CryptoException expected) {        return;    }    fail("CryptoException was expected to be thrown");}
public void shiro_f3351_0()
{    CookieRememberMeManager mgr = new CookieRememberMeManager();    org.apache.shiro.web.servlet.Cookie cookie = createMock(org.apache.shiro.web.servlet.Cookie.class);    mgr.setCookie(cookie);    HttpServletRequest mockRequest = createMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createMock(HttpServletResponse.class);    WebSubject mockSubject = createNiceMock(WebSubject.class);    expect(mockSubject.getServletRequest()).andReturn(mockRequest).anyTimes();    expect(mockSubject.getServletResponse()).andReturn(mockResponse).anyTimes();    expect(mockRequest.getContextPath()).andReturn(null).anyTimes();    cookie.removeFrom(isA(HttpServletRequest.class), isA(HttpServletResponse.class));    replay(mockRequest);    replay(mockResponse);    replay(mockSubject);    replay(cookie);    mgr.onLogout(mockSubject);    verify(mockSubject);    verify(mockRequest);    verify(mockResponse);    verify(cookie);}
public void shiro_f3352_0()
{    sm = new DefaultWebSecurityManager();    sm.setSessionMode(DefaultWebSecurityManager.NATIVE_SESSION_MODE);    Ini ini = new Ini();    Ini.Section section = ini.addSection(IniRealm.USERS_SECTION_NAME);    section.put("lonestarr", "vespa");    sm.setRealm(new IniRealm(ini));}
public void shiro_f3353_0()
{    sm.destroy();    super.tearDown();}
protected Subject shiro_f3354_0(ServletRequest request, ServletResponse response)
{    return new WebSubject.Builder(sm, request, response).buildSubject();}
public void shiro_f3355_0()
{    sm.setSessionMode(DefaultWebSecurityManager.NATIVE_SESSION_MODE);    WebSessionManager sessionManager = createMock(WebSessionManager.class);    expect(sessionManager.isServletContainerSessions()).andReturn(true).anyTimes();    replay(sessionManager);    sm.setSessionManager(sessionManager);    assertTrue("The set SessionManager is not being used to determine isHttpSessionMode.", sm.isHttpSessionMode());    verify(sessionManager);}
public void shiro_f3356_0()
{    sm.setSessionMode(DefaultWebSecurityManager.NATIVE_SESSION_MODE);}
protected void shiro_f3357_0(long millis)
{    try {        Thread.sleep(millis);    } catch (InterruptedException e) {        throw new IllegalStateException(e);    }}
public void shiro_f3358_0()
{    HttpServletRequest mockRequest = createNiceMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createNiceMock(HttpServletResponse.class);    expect(mockRequest.getCookies()).andReturn(null);    expect(mockRequest.getContextPath()).andReturn("/");    replay(mockRequest);    Subject subject = newSubject(mockRequest, mockResponse);    assertFalse(subject.isAuthenticated());    subject.login(new UsernamePasswordToken("lonestarr", "vespa"));    assertTrue(subject.isAuthenticated());    assertNotNull(subject.getPrincipal());    assertTrue(subject.getPrincipal().equals("lonestarr"));}
public void shiro_f3359_0()
{    shiroSessionModeInit();    long globalTimeout = 100;    ((AbstractSessionManager) sm.getSessionManager()).setGlobalSessionTimeout(globalTimeout);    HttpServletRequest mockRequest = createNiceMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createNiceMock(HttpServletResponse.class);    expect(mockRequest.getCookies()).andReturn(null);    expect(mockRequest.getContextPath()).andReturn("/");    replay(mockRequest);    Subject subject = newSubject(mockRequest, mockResponse);    Session session = subject.getSession();    assertEquals(session.getTimeout(), globalTimeout);    session.setTimeout(125);    assertEquals(session.getTimeout(), 125);    sleep(200);    try {        session.getTimeout();        fail("Session should have expired.");    } catch (ExpiredSessionException expected) {    }}
public void shiro_f3360_0()
{    shiroSessionModeInit();    HttpServletRequest mockRequest = createNiceMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createNiceMock(HttpServletResponse.class);    expect(mockRequest.getCookies()).andReturn(null);    replay(mockRequest);    replay(mockResponse);    Subject subject = newSubject(mockRequest, mockResponse);    verify(mockRequest);    verify(mockResponse);    assertNotNull(subject);    assertTrue(subject.getPrincipals() == null || subject.getPrincipals().isEmpty());    assertTrue(subject.getSession(false) == null);    assertFalse(subject.isAuthenticated());}
public void shiro_f3361_0()
{    shiroSessionModeInit();    HttpServletRequest mockRequest = createNiceMock(HttpServletRequest.class);    HttpServletResponse mockResponse = createNiceMock(HttpServletResponse.class);    replay(mockRequest);    replay(mockResponse);    Subject subject = newSubject(mockRequest, mockResponse);    Session session = subject.getSession();    Serializable sessionId = session.getId();    assertNotNull(sessionId);    verify(mockRequest);    verify(mockResponse);    mockRequest = createNiceMock(HttpServletRequest.class);    mockResponse = createNiceMock(HttpServletResponse.class);        Cookie[] cookies = new Cookie[] { new Cookie(ShiroHttpSession.DEFAULT_SESSION_ID_NAME, sessionId.toString()) };    expect(mockRequest.getCookies()).andReturn(cookies).anyTimes();    expect(mockRequest.getParameter(isA(String.class))).andReturn(null).anyTimes();    replay(mockRequest);    replay(mockResponse);    subject = newSubject(mockRequest, mockResponse);    session = subject.getSession(false);    assertNotNull(session);    assertEquals(sessionId, session.getId());    verify(mockRequest);    verify(mockResponse);}
public void shiro_f3362_0()
{    Ini ini = new Ini();    Ini.Section section = ini.addSection(IniRealm.USERS_SECTION_NAME);    section.put("user1", "user1");    WebIniSecurityManagerFactory factory = new WebIniSecurityManagerFactory(ini);    WebSecurityManager securityManager = (WebSecurityManager) factory.getInstance();    PrincipalCollection principals = new SimplePrincipalCollection("user1", "iniRealm");    Subject subject = new Subject.Builder(securityManager).principals(principals).buildSubject();    assertNotNull(subject);    assertEquals("user1", subject.getPrincipal());}
public void shiro_f3363_0()
{    sm = new DefaultWebSecurityManager();    Ini ini = new Ini();    Ini.Section section = ini.addSection(IniRealm.USERS_SECTION_NAME);    section.put("lonestarr", "vespa");    sm.setRealm(new IniRealm(ini));}
public void shiro_f3364_0()
{    sm.destroy();    super.tearDown();}
public void shiro_f3365_0()
{    Subject.Builder builder = new Subject.Builder(sm);    Subject subject = builder.buildSubject();    subject.login(new UsernamePasswordToken("lonestarr", "vespa"));}
public void shiro_f3366_0()
{    FILTERED[0] = false;    filter = createTestInstance();    chain = createNiceMock(FilterChain.class);    request = createNiceMock(ServletRequest.class);    response = createNiceMock(ServletResponse.class);}
private OncePerRequestFilter shiro_f3367_0()
{    OncePerRequestFilter filter = new OncePerRequestFilter() {        @Override        protected void doFilterInternal(ServletRequest request, ServletResponse response, FilterChain chain) throws ServletException, IOException {            FILTERED[0] = true;        }    };    filter.setName(NAME);    return filter;}
protected void shiro_f3368_0(ServletRequest request, ServletResponse response, FilterChain chain) throws ServletException, IOException
{    FILTERED[0] = true;}
public void shiro_f3369_0() throws IOException, ServletException
{    expect(request.getAttribute(ATTR_NAME)).andReturn(null).anyTimes();    replay(request);    filter.doFilter(request, response, chain);    verify(request);    assertTrue("Filter should have executed", FILTERED[0]);}
public void shiro_f3370_0() throws IOException, ServletException
{        filter.setEnabled(false);    expect(request.getAttribute(ATTR_NAME)).andReturn(null).anyTimes();    replay(request);    filter.doFilter(request, response, chain);    verify(request);    assertFalse("Filter should NOT have executed", FILTERED[0]);}
public void shiro_f3371_0() throws Exception
{    this.mockRequest = createMock(HttpServletRequest.class);    this.mockContext = createMock(ServletContext.class);    this.mockSubject = createMock(Subject.class);    ThreadContext.bind(this.mockSubject);    this.request = new ShiroHttpServletRequest(mockRequest, mockContext, false);}
public void shiro_f3372_0() throws Exception
{    Session session1 = createMock(Session.class);    Session session2 = createMock(Session.class);    mockSubject.logout();    expect(mockSubject.getSession(true)).andReturn(session1).times(1).andReturn(session2).times(1);    expect(mockSubject.getSession(false)).andReturn(session1).times(2).andReturn(null).times(3);    replay(mockSubject);    assertNotNull(request.getSession(true));    assertNotNull(request.getSession(false));    mockSubject.logout();    assertNull(request.getSession(false));    assertNotNull(request.getSession(true));    verify(mockSubject);}
public void shiro_f3373_0() throws Exception
{    this.mockRequest = createMock(HttpServletRequest.class);    this.mockResponse = createMock(HttpServletResponse.class);    this.cookie = new SimpleCookie("test");}
public void shiro_f3374_0() throws Exception
{                String name = "test";    String value = "deleteMe";    String path = "/somepath";    String headerValue = this.cookie.buildHeaderValue(name, value, null, null, path, 0, SimpleCookie.DEFAULT_VERSION, false, false, null);    String expectedStart = new StringBuilder().append(name).append(SimpleCookie.NAME_VALUE_DELIMITER).append(value).append(SimpleCookie.ATTRIBUTE_DELIMITER).append(SimpleCookie.PATH_ATTRIBUTE_NAME).append(SimpleCookie.NAME_VALUE_DELIMITER).append(path).toString();    assertTrue(headerValue.startsWith(expectedStart));    expect(mockRequest.getContextPath()).andReturn(path).times(1);        mockResponse.addHeader(eq(SimpleCookie.COOKIE_HEADER_NAME), isA(String.class));    replay(mockRequest);    replay(mockResponse);    this.cookie.removeFrom(mockRequest, mockResponse);    verify(mockRequest);    verify(mockResponse);}
private void shiro_f3375_0(String contextPath)
{    this.cookie.setValue("blah");    String expectedCookieValue = new StringBuilder().append("test").append(SimpleCookie.NAME_VALUE_DELIMITER).append("blah").append(SimpleCookie.ATTRIBUTE_DELIMITER).append(SimpleCookie.PATH_ATTRIBUTE_NAME).append(SimpleCookie.NAME_VALUE_DELIMITER).append(Cookie.ROOT_PATH).append(SimpleCookie.ATTRIBUTE_DELIMITER).append(SimpleCookie.HTTP_ONLY_ATTRIBUTE_NAME).append(SimpleCookie.ATTRIBUTE_DELIMITER).append(SimpleCookie.SAME_SITE_ATTRIBUTE_NAME).append(SimpleCookie.NAME_VALUE_DELIMITER).append(Cookie.SameSiteOptions.LAX.toString().toLowerCase(Locale.ENGLISH)).toString();    expect(mockRequest.getContextPath()).andReturn(contextPath);    mockResponse.addHeader(SimpleCookie.COOKIE_HEADER_NAME, expectedCookieValue);    replay(mockRequest);    replay(mockResponse);    this.cookie.saveTo(mockRequest, mockResponse);    verify(mockRequest);    verify(mockResponse);}
public void shiro_f3376_0() throws Exception
{    testRootContextPath("");}
public void shiro_f3377_0() throws Exception
{    testRootContextPath(null);}
public void shiro_f3378_0() throws Exception
{    expect(mockRequest.getRequestURI()).andStubReturn("/foo/index.jsp");    expect(mockRequest.getCookies()).andStubReturn(new javax.servlet.http.Cookie[] { new javax.servlet.http.Cookie(this.cookie.getName(), "value") });    replay(mockRequest);    replay(mockResponse);    this.cookie.setPath("/bar/index.jsp");    assertEquals(null, this.cookie.readValue(mockRequest, mockResponse));}
public void shiro_f3379_0() throws Exception
{    expect(mockRequest.getRequestURI()).andStubReturn("/bar/index.jsp");    expect(mockRequest.getCookies()).andStubReturn(new javax.servlet.http.Cookie[] { new javax.servlet.http.Cookie(this.cookie.getName(), "value") });    replay(mockRequest);    replay(mockResponse);    this.cookie.setPath("/bar");    assertEquals("value", this.cookie.readValue(mockRequest, mockResponse));}
public void shiro_f3380_0() throws Exception
{    expect(mockRequest.getRequestURI()).andStubReturn("/foobar/index.jsp");    expect(mockRequest.getCookies()).andStubReturn(new javax.servlet.http.Cookie[] { new javax.servlet.http.Cookie(this.cookie.getName(), "value") });    replay(mockRequest);    replay(mockResponse);    this.cookie.setPath("/foo");    assertEquals(null, this.cookie.readValue(mockRequest, mockResponse));}
private static T shiro_f3381_0(final T in)
{    reportMatcher(new IArgumentMatcher() {        public boolean matches(Object o) {            javax.servlet.http.Cookie c = (javax.servlet.http.Cookie) o;            return c.getName().equals(in.getName()) && c.getValue().equals(in.getValue()) && c.getPath().equals(in.getPath()) && c.getMaxAge() == in.getMaxAge() && c.getSecure() == in.getSecure() && c.getValue().equals(in.getValue());        }        public void appendTo(StringBuffer sb) {            sb.append("eqCookie(");            sb.append(in.getClass().getName());            sb.append(")");        }    });    return null;}
public boolean shiro_f3382_0(Object o)
{    javax.servlet.http.Cookie c = (javax.servlet.http.Cookie) o;    return c.getName().equals(in.getName()) && c.getValue().equals(in.getValue()) && c.getPath().equals(in.getPath()) && c.getMaxAge() == in.getMaxAge() && c.getSecure() == in.getSecure() && c.getValue().equals(in.getValue());}
public void shiro_f3383_0(StringBuffer sb)
{    sb.append("eqCookie(");    sb.append(in.getClass().getName());    sb.append(")");}
public void shiro_f3384_0() throws Exception
{    this.mockSession = createMock(HttpSession.class);}
public void shiro_f3385_0() throws Exception
{        final int expectedTimeoutInSeconds = 30 * 24 * 60 * 60;    final long expectedLongValue = expectedTimeoutInSeconds * 1000L;    Capture<Integer> capturedInt = Capture.newInstance();        mockSession.setMaxInactiveInterval(captureInt(capturedInt));    expect(mockSession.getMaxInactiveInterval()).andReturn(expectedTimeoutInSeconds);    replay(mockSession);    HttpServletSession servletSession = new HttpServletSession(mockSession, null);    servletSession.setTimeout(expectedLongValue);    long timeoutInMilliseconds = servletSession.getTimeout();    assertEquals(expectedLongValue, timeoutInMilliseconds);    assertEquals(expectedTimeoutInSeconds, capturedInt.getValue().intValue());}
protected FilterConfig shiro_f3386_0()
{    FilterConfig mock = createNiceMock(FilterConfig.class);    ServletContext mockServletContext = createNiceMock(ServletContext.class);    expect(mock.getServletContext()).andReturn(mockServletContext);    return mock;}
